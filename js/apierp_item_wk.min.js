/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.0.4
*/

const _0x56ec43=_0x579a;(function(_0x2f7b50,_0x5e3e3c){const _0x10ac18=_0x579a,_0x24459d=_0x2f7b50();while(!![]){try{const _0x501dec=parseInt(_0x10ac18(0x1ab))/0x1*(-parseInt(_0x10ac18(0x169))/0x2)+parseInt(_0x10ac18(0x122))/0x3*(parseInt(_0x10ac18(0x20b))/0x4)+parseInt(_0x10ac18(0x211))/0x5+parseInt(_0x10ac18(0x1e7))/0x6*(-parseInt(_0x10ac18(0x199))/0x7)+-parseInt(_0x10ac18(0x1b7))/0x8*(-parseInt(_0x10ac18(0x14c))/0x9)+-parseInt(_0x10ac18(0x168))/0xa*(parseInt(_0x10ac18(0x16c))/0xb)+-parseInt(_0x10ac18(0x200))/0xc;if(_0x501dec===_0x5e3e3c)break;else _0x24459d['push'](_0x24459d['shift']());}catch(_0x46d810){_0x24459d['push'](_0x24459d['shift']());}}}(_0xe498,0x7b703));const _0x48f904=(function(){let _0x3282db=!![];return function(_0x51aa91,_0x58deee){const _0x4f3549=_0x3282db?function(){const _0x23a1ec=_0x579a;if(_0x58deee){const _0x19c001=_0x58deee[_0x23a1ec(0x206)](_0x51aa91,arguments);return _0x58deee=null,_0x19c001;}}:function(){};return _0x3282db=![],_0x4f3549;};}()),_0x47f905=_0x48f904(this,function(){const _0x18f0d7=_0x579a;return _0x47f905[_0x18f0d7(0x17d)]()['search'](_0x18f0d7(0x1aa))['toString']()[_0x18f0d7(0x1c6)](_0x47f905)['search']('(((.+)+)+)+$');});function _0xe498(){const _0x32a581=['FOT','Alias\x202','error','parse_date_code','METRO\x20CUADRADO','MGM','exportItems:\x20productos\x20no\x20clonables:\x20','Modelo\x20de\x20Manga','Inafecto\x20Gratuito\x20(0%)','PLIEGO','1642711xozlam','TAMBOR','Material','QUINTAL','setItemBarCode2','FARDO','MMQ','Equivalencia\x203','setItemBarCode3','LTN','Precio\x20Venta\x20Dólares','forEach','PEN_setMtoPrecioUnitario2','CMQ','message','SheetNames','setItemCommissionPercentage3','(((.+)+)+)+$','1CdUaMg','Marca','setUnitId3','LTR','MEGAWATT\x20HORA','GRM','done','MILIMETRO','MTR','sheet_to_json','setUnitId','Gravado\x20Gratuito\x20(10%)','1020488uUMOIu','FTQ','METRO','Código\x20de\x20Barras\x203','LBR','number','Precio\x20Costo\x20Dólares\x202','Precio\x20Venta\x20Dólares\x203','some','code','Tipo*','Unidad\x20de\x20Medida\x202','BALDE','ID\x20UNIT\x202','setWarehouseStockMin','constructor','Exonerado\x20(0%)','CMT','PAR','DOCENA\x20POR\x2010**6','BOBINAS','SACO','setUnidadCodigo','console','setItemType','Rastrear\x20Inventario','Código\x20de\x20Barras\x202','setInventariable','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','setItemBarCode','Gravado\x20(18%)','getDate','Descripción','KILOMETRO','bind','CENTIMETRO\x20CUBICO','BOTELLAS','Se\x20Compra','CONOS','KWH','setItemUnitAlias','Precio\x20Costo\x20Soles\x202','PULGADAS','PIES\x20CUADRADOS','Unidad\x20de\x20Medida\x203','Precio\x20Costo\x20Dólares','Unidad\x20de\x20Medida*','decode_range','12dpitgt','MMT','TONELADAS','map','push','KILOGRAMO','value','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','GRO','Precio\x20Venta\x20Soles\x202','padStart','GRAMO','Género','MIL','trace','HOJA','GLI','setTaxId','YRD','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','Comisión\x20Venta\x20(%)','SSF','filter','Comisión\x20Venta\x202\x20(%)','Alias','1484616SsRYxx','table','Precio\x20Venta\x20Dólares\x202','ONZAS','HECTOLITRO','Stock\x20Actual','apply','toLowerCase','setItemIsSold','LATAS','UND\x20(NIU)','1548ArhnoC','CILINDRO','setItemUnitAlias3','buffer','Talla','TNE','2945875XAjSON','MMK','ID\x20UNIT','USD_setMtoPrecioUnitario3','setCodProducto','Código\x20de\x20Barras','USD_setMtoPrecioCostoUnitario2','setSucursalStock','El\x20archivo\x20tiene\x20','USD_setMtoPrecioCostoUnitario3','PEN_setMtoPrecioCostoUnitario2','BLL','STN','log','METRO\x20CUBICO','Ubicación','warn','Precio\x20Venta\x20Soles\x203','import','Lote','PLACAS','Código\x20SKU*','CEN','round','Sheets','3981yvKdLL','setUnidadCodigo3','PIES','setItemVariantValues','Precio\x20Costo\x20Soles\x203','write','isArray','Exportando\x20filas\x20','setUnidadCodigo2','getFullYear','GRUESA','INH','__proto__','\x20de\x20','US\x20GALON\x20(3,7843\x20L)','CMK','DOCENA','BOLSA','MILILITRO','MTQ','USD_setMtoPrecioUnitario','setMarca','PEN_setMtoPrecioUnitario','xlsx','Gravado\x20Gratuito\x20(18%)','LIBRAS','!ref','GALON\x20INGLES\x20(4,545956L)','Exonerado\x20Gratuito\x20(0%)','YARDA','setItemCommissionPercentage','DZN','Impuesto*','read','Categoría','prototype','MWH','MILIMETRO\x20CUADRADO','Serie','PALETAS','return\x20(function()\x20','Iniciando\x20parseo…','63XlKOQG','KIT','LITRO','PEN_setMtoPrecioUnitario3','utils','MILLARES','ID\x20UNIT\x203','Modelo\x20de\x20Cuello','Precio\x20Costo\x20Dólares\x203','findIndex','length','YARDA\x20CUADRADA','CENTIMETRO\x20LINEAL','Nombre*','Equivalencia\x202','UNIDAD\x20(NIU)','exportItems','CAJA','MTK','trim','CENTIMETRO\x20CUADRADO','C62','Fabricado','setItemDescription','Modelo','Artículo','Fecha\x20de\x20Vencimiento','PAQUETE','44610oLXkgo','1026676ShqWoJ','RESMA','array','946SktUSm','TONELADA\x20LARGA','{}.constructor(\x22return\x20this\x22)(\x20)','QQM','Materia\x20Prima','Precio\x20Costo\x20Soles','Color','setItemUnitAlias2','setDescripcion','HLT','CARTONES','Stock\x20Mínimo','Se\x20Vende','exportDone','UNIDAD\x20(ZZ)','USD_setMtoPrecioUnitario2','GLL','toString','TUBOS','Alias\x203','MILIMETRO\x20CUBICO','MILIGRAMOS','exportItems:\x20products\x20no\x20es\x20Array.','TONELADA\x20CORTA','setUnidadEquivalencia2','PIEZAS','NIU','progress','USD_setMtoPrecioCostoUnitario','Comisión\x20Venta\x203\x20(%)','slice','BARRILES','JUEGO','PEN_setMtoPrecioCostoUnitario3','CIENTO\x20DE\x20UNIDADES'];_0xe498=function(){return _0x32a581;};return _0xe498();}_0x47f905();const _0x4fb37a=(function(){let _0x2b8ecd=!![];return function(_0x2e8480,_0x15414e){const _0x5d82c4=_0x2b8ecd?function(){const _0x2968a6=_0x579a;if(_0x15414e){const _0xc93f0d=_0x15414e[_0x2968a6(0x206)](_0x2e8480,arguments);return _0x15414e=null,_0xc93f0d;}}:function(){};return _0x2b8ecd=![],_0x5d82c4;};}()),_0x4facf1=_0x4fb37a(this,function(){const _0x5ad0b0=_0x579a,_0x536ee7=function(){const _0x14f248=_0x579a;let _0x24b870;try{_0x24b870=Function(_0x14f248(0x14a)+_0x14f248(0x16e)+');')();}catch(_0x38c3b4){_0x24b870=window;}return _0x24b870;},_0x49a8df=_0x536ee7(),_0x57497c=_0x49a8df[_0x5ad0b0(0x1ce)]=_0x49a8df['console']||{},_0x1a8adc=[_0x5ad0b0(0x21e),_0x5ad0b0(0x221),'info',_0x5ad0b0(0x191),'exception',_0x5ad0b0(0x201),_0x5ad0b0(0x1f5)];for(let _0x247089=0x0;_0x247089<_0x1a8adc[_0x5ad0b0(0x156)];_0x247089++){const _0x59167c=_0x4fb37a['constructor'][_0x5ad0b0(0x145)][_0x5ad0b0(0x1d9)](_0x4fb37a),_0x220c77=_0x1a8adc[_0x247089],_0xcaaf32=_0x57497c[_0x220c77]||_0x59167c;_0x59167c[_0x5ad0b0(0x12e)]=_0x4fb37a[_0x5ad0b0(0x1d9)](_0x4fb37a),_0x59167c[_0x5ad0b0(0x17d)]=_0xcaaf32[_0x5ad0b0(0x17d)][_0x5ad0b0(0x1d9)](_0xcaaf32),_0x57497c[_0x220c77]=_0x59167c;}});function _0x579a(_0x3185c9,_0x4c83bf){const _0x4758f8=_0xe498();return _0x579a=function(_0x4facf1,_0x4fb37a){_0x4facf1=_0x4facf1-0x11e;let _0x41177b=_0x4758f8[_0x4facf1];return _0x41177b;},_0x579a(_0x3185c9,_0x4c83bf);}_0x4facf1(),importScripts(_0x56ec43(0x1d3)),onmessage=({data:_0x179a2d})=>{const _0x48e40f=_0x56ec43,{action:_0x5a8235}=_0x179a2d;if(_0x5a8235===_0x48e40f(0x223)){const {buf:_0x20502f,maxRows:_0x28e93f}=_0x179a2d;try{postMessage({'type':_0x48e40f(0x187),'payload':{'percent':0x5,'message':_0x48e40f(0x14b)}});const _0x48e50d=XLSX[_0x48e40f(0x143)](_0x20502f,{'type':_0x48e40f(0x16b),'cellDates':!![]}),_0x27c0d5=_0x48e50d[_0x48e40f(0x121)][_0x48e50d[_0x48e40f(0x1a8)][0x0]],_0x11c411=XLSX[_0x48e40f(0x150)][_0x48e40f(0x1b4)](_0x27c0d5,{'defval':'','range':0x1,'cellDates':!![]}),_0x3f9353=_0x11c411[_0x48e40f(0x155)](_0x42ac45=>(!_0x42ac45[_0x48e40f(0x1c1)]||String(_0x42ac45[_0x48e40f(0x1c1)])[_0x48e40f(0x15f)]()==='')&&(!_0x42ac45[_0x48e40f(0x11e)]||String(_0x42ac45[_0x48e40f(0x11e)])[_0x48e40f(0x15f)]()==='')&&(!_0x42ac45[_0x48e40f(0x159)]||String(_0x42ac45[_0x48e40f(0x159)])[_0x48e40f(0x15f)]()==='')&&(!_0x42ac45[_0x48e40f(0x1e5)]||String(_0x42ac45[_0x48e40f(0x1e5)])[_0x48e40f(0x15f)]()==='')),_0x342b2e=_0x3f9353>=0x0?_0x11c411['slice'](0x0,_0x3f9353):_0x11c411,_0x250490=_0x342b2e[_0x48e40f(0x1fd)](_0x3c9419=>_0x3c9419[_0x48e40f(0x1c1)]&&String(_0x3c9419[_0x48e40f(0x1c1)])[_0x48e40f(0x15f)]()!==''&&_0x3c9419[_0x48e40f(0x11e)]&&String(_0x3c9419[_0x48e40f(0x11e)])[_0x48e40f(0x15f)]()!==''&&_0x3c9419[_0x48e40f(0x159)]&&String(_0x3c9419[_0x48e40f(0x159)])['trim']()!==''&&_0x3c9419[_0x48e40f(0x1e5)]&&String(_0x3c9419[_0x48e40f(0x1e5)])['trim']()!==''),_0x4dc0b3=_0x250490['length'];if(_0x4dc0b3===0x0){postMessage({'type':'error','payload':_0x48e40f(0x1fa)});return;}if(_0x4dc0b3>_0x28e93f)throw _0x48e40f(0x219)+_0x4dc0b3+'\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20'+_0x28e93f+'.';const _0x5c1c8a=0x1f4,_0x4304d6=[],_0x4e312d=[{'codigo':'4A','nombre':_0x48e40f(0x1cb)},{'codigo':'BJ','nombre':_0x48e40f(0x1c3)},{'codigo':_0x48e40f(0x21c),'nombre':_0x48e40f(0x18b)},{'codigo':'BG','nombre':'BOLSA'},{'codigo':'BO','nombre':_0x48e40f(0x1db)},{'codigo':'BX','nombre':_0x48e40f(0x15d)},{'codigo':'CT','nombre':'CARTONES'},{'codigo':_0x48e40f(0x131),'nombre':_0x48e40f(0x160)},{'codigo':_0x48e40f(0x1a6),'nombre':_0x48e40f(0x1da)},{'codigo':_0x48e40f(0x1c8),'nombre':_0x48e40f(0x158)},{'codigo':_0x48e40f(0x11f),'nombre':_0x48e40f(0x18e)},{'codigo':'CY','nombre':_0x48e40f(0x20c)},{'codigo':'CJ','nombre':_0x48e40f(0x1dd)},{'codigo':_0x48e40f(0x141),'nombre':_0x48e40f(0x132)},{'codigo':'DZP','nombre':'DOCENA\x20POR\x2010**6'},{'codigo':'BE','nombre':_0x48e40f(0x19e)},{'codigo':_0x48e40f(0x1f7),'nombre':_0x48e40f(0x13d)},{'codigo':_0x48e40f(0x1b0),'nombre':_0x48e40f(0x1f2)},{'codigo':_0x48e40f(0x1ef),'nombre':_0x48e40f(0x12c)},{'codigo':_0x48e40f(0x175),'nombre':_0x48e40f(0x204)},{'codigo':'LEF','nombre':_0x48e40f(0x1f6)},{'codigo':'SET','nombre':_0x48e40f(0x18c)},{'codigo':'KGM','nombre':_0x48e40f(0x1ec)},{'codigo':'KTM','nombre':_0x48e40f(0x1d8)},{'codigo':_0x48e40f(0x1de),'nombre':'KILOVATIO\x20HORA'},{'codigo':'KT','nombre':_0x48e40f(0x14d)},{'codigo':'CA','nombre':_0x48e40f(0x209)},{'codigo':_0x48e40f(0x1bb),'nombre':_0x48e40f(0x13b)},{'codigo':_0x48e40f(0x1ae),'nombre':_0x48e40f(0x14e)},{'codigo':_0x48e40f(0x146),'nombre':_0x48e40f(0x1af)},{'codigo':_0x48e40f(0x1b3),'nombre':_0x48e40f(0x1b9)},{'codigo':_0x48e40f(0x15e),'nombre':_0x48e40f(0x193)},{'codigo':_0x48e40f(0x135),'nombre':_0x48e40f(0x21f)},{'codigo':_0x48e40f(0x194),'nombre':_0x48e40f(0x181)},{'codigo':'MLT','nombre':'MILILITRO'},{'codigo':_0x48e40f(0x1e8),'nombre':'MILIMETRO'},{'codigo':_0x48e40f(0x212),'nombre':_0x48e40f(0x147)},{'codigo':_0x48e40f(0x19f),'nombre':_0x48e40f(0x180)},{'codigo':_0x48e40f(0x1f4),'nombre':'MILLARES'},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':'ONZ','nombre':_0x48e40f(0x203)},{'codigo':'PF','nombre':_0x48e40f(0x149)},{'codigo':'PK','nombre':_0x48e40f(0x167)},{'codigo':'PR','nombre':_0x48e40f(0x1c9)},{'codigo':_0x48e40f(0x18f),'nombre':_0x48e40f(0x124)},{'codigo':'FTK','nombre':_0x48e40f(0x1e2)},{'codigo':_0x48e40f(0x1b8),'nombre':'PIES\x20CUBICOS'},{'codigo':_0x48e40f(0x161),'nombre':_0x48e40f(0x185)},{'codigo':'PG','nombre':_0x48e40f(0x225)},{'codigo':'ST','nombre':_0x48e40f(0x198)},{'codigo':_0x48e40f(0x12d),'nombre':_0x48e40f(0x1e1)},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':'SACO'},{'codigo':'DR','nombre':_0x48e40f(0x19a)},{'codigo':_0x48e40f(0x21d),'nombre':_0x48e40f(0x183)},{'codigo':_0x48e40f(0x1a2),'nombre':'TONELADA\x20LARGA'},{'codigo':_0x48e40f(0x210),'nombre':_0x48e40f(0x1e9)},{'codigo':'TU','nombre':_0x48e40f(0x17e)},{'codigo':_0x48e40f(0x186),'nombre':_0x48e40f(0x15b)},{'codigo':'ZZ','nombre':_0x48e40f(0x17a)},{'codigo':_0x48e40f(0x17c),'nombre':_0x48e40f(0x130)},{'codigo':_0x48e40f(0x1f9),'nombre':_0x48e40f(0x13f)},{'codigo':'YDK','nombre':_0x48e40f(0x157)},{'codigo':_0x48e40f(0x16f),'nombre':_0x48e40f(0x19c)}],_0x3dee9e=_0x4e312d['reduce']((_0x2af87e,{nombre:_0x11d269,codigo:_0x11d25f})=>{const _0x1f4359=_0x48e40f;return _0x2af87e[_0x11d269['trim']()]=_0x11d25f[_0x1f4359(0x15f)](),_0x2af87e;},{});for(let _0x2c01ea=0x0;_0x2c01ea<_0x4dc0b3;_0x2c01ea+=_0x5c1c8a){const _0x77a8fa=_0x250490[_0x48e40f(0x18a)](_0x2c01ea,_0x2c01ea+_0x5c1c8a)[_0x48e40f(0x1ea)]((_0x4a1243,_0x3b2253)=>{const _0x1fc16e=_0x48e40f;let _0x258fda={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x4a1243[_0x1fc16e(0x1c1)]]||'1';const _0x27f1bf=String(_0x4a1243[_0x1fc16e(0x142)])[_0x1fc16e(0x15f)](),_0xb89d9={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x757a05=_0xb89d9[_0x27f1bf]||'1',_0x242cee={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x757a05]||{'code':'10','value':0x12},_0x29cff9={};let _0x27e71d=String(_0x4a1243[_0x1fc16e(0x159)])[_0x1fc16e(0x15f)]();const _0x38f077=[_0x1fc16e(0x224),_0x1fc16e(0x20f),_0x1fc16e(0x172),_0x1fc16e(0x1f3),_0x1fc16e(0x164),_0x1fc16e(0x148),_0x1fc16e(0x19b),_0x1fc16e(0x153),_0x1fc16e(0x196)];_0x38f077[_0x1fc16e(0x1a4)](_0x4202ab=>{const _0x51ac0a=_0x1fc16e,_0x16fd8b=String(_0x4a1243[_0x4202ab]||'')[_0x51ac0a(0x15f)]();_0x16fd8b&&(_0x29cff9[_0x4202ab]=_0x16fd8b,_0x27e71d+='\x20'+_0x4202ab+'\x20'+_0x16fd8b);});const _0x24445e=[],_0x203ab6=String(_0x4a1243[_0x1fc16e(0x1e5)]||_0x1fc16e(0x15b))[_0x1fc16e(0x15f)](),_0x3d6f2b=_0x3dee9e[_0x203ab6]||_0x1fc16e(0x186),_0x502e6a=String(_0x4a1243[_0x1fc16e(0x1ff)])[_0x1fc16e(0x15f)]();_0x24445e[_0x1fc16e(0x1eb)]({'setItemUnitId':String(_0x4a1243[_0x1fc16e(0x213)])['trim']()||'','setItemBarCode':String(_0x4a1243[_0x1fc16e(0x216)])[_0x1fc16e(0x15f)]()||'','setAlias':_0x502e6a,'setUnitCode':_0x3d6f2b,'setPrice':parseFloat(_0x4a1243['Precio\x20Venta\x20Soles']),'setCost':parseFloat(_0x4a1243[_0x1fc16e(0x171)]),'setPriceUSD':parseFloat(_0x4a1243[_0x1fc16e(0x1a3)]),'setCostUSD':parseFloat(_0x4a1243[_0x1fc16e(0x1e4)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x4a1243[_0x1fc16e(0x1fb)])});const _0x361a5d=[_0x1fc16e(0x1c4),'Alias\x202',_0x1fc16e(0x1d1),'Equivalencia\x202','Precio\x20Venta\x20Soles\x202',_0x1fc16e(0x1e0),_0x1fc16e(0x202),_0x1fc16e(0x1bd)][_0x1fc16e(0x1bf)](_0x26e716=>{const _0x1a8ca9=_0x4a1243[_0x26e716];return _0x1a8ca9!=null&&String(_0x1a8ca9)['trim']()!=='';});if(_0x361a5d){const _0xb7a78=String(_0x4a1243[_0x1fc16e(0x1c2)]||_0x1fc16e(0x20a))['trim'](),_0x1eddd6=_0x3dee9e[_0xb7a78]||'NIU';_0x24445e['push']({'setItemUnitId':String(_0x4a1243[_0x1fc16e(0x1c4)])[_0x1fc16e(0x15f)]()||'','setItemBarCode':String(_0x4a1243[_0x1fc16e(0x1d1)])[_0x1fc16e(0x15f)]()||'','setAlias':String(_0x4a1243[_0x1fc16e(0x190)])[_0x1fc16e(0x15f)](),'setUnitCode':_0x1eddd6,'setPrice':parseFloat(_0x4a1243['Precio\x20Venta\x20Soles\x202']),'setCost':parseFloat(_0x4a1243[_0x1fc16e(0x1e0)]),'setPriceUSD':parseFloat(_0x4a1243['Precio\x20Venta\x20Dólares\x202']),'setCostUSD':parseFloat(_0x4a1243[_0x1fc16e(0x1bd)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x4a1243[_0x1fc16e(0x15a)])||0x1,'setFactor':parseFloat(_0x4a1243[_0x1fc16e(0x15a)])||0x1,'setItemCommissionPercentage':parseFloat(_0x4a1243[_0x1fc16e(0x1fe)])});}const _0x2b6646=['ID\x20UNIT\x203',_0x1fc16e(0x17f),_0x1fc16e(0x1ba),'Equivalencia\x203',_0x1fc16e(0x222),'Precio\x20Costo\x20Soles\x203',_0x1fc16e(0x1be),_0x1fc16e(0x154)]['some'](_0xd27a58=>{const _0x23e495=_0x1fc16e,_0x28ca3a=_0x4a1243[_0xd27a58];return _0x28ca3a!=null&&String(_0x28ca3a)[_0x23e495(0x15f)]()!=='';});if(_0x2b6646){const _0x3d3f5e=String(_0x4a1243[_0x1fc16e(0x1e3)]||_0x1fc16e(0x20a))[_0x1fc16e(0x15f)](),_0x5fec45=_0x3dee9e[_0x3d3f5e]||_0x1fc16e(0x186);_0x24445e[_0x1fc16e(0x1eb)]({'setItemUnitId':String(_0x4a1243[_0x1fc16e(0x152)])['trim']()||'','setItemBarCode':String(_0x4a1243[_0x1fc16e(0x1ba)])[_0x1fc16e(0x15f)]()||'','setAlias':String(_0x4a1243[_0x1fc16e(0x17f)])[_0x1fc16e(0x15f)](),'setUnitCode':_0x5fec45,'setPrice':parseFloat(_0x4a1243[_0x1fc16e(0x222)]),'setCost':parseFloat(_0x4a1243[_0x1fc16e(0x126)]),'setPriceUSD':parseFloat(_0x4a1243[_0x1fc16e(0x1be)]),'setCostUSD':parseFloat(_0x4a1243[_0x1fc16e(0x154)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x4a1243[_0x1fc16e(0x1a0)])||0x1,'setFactor':parseFloat(_0x4a1243[_0x1fc16e(0x1a0)])||0x1,'setItemCommissionPercentage':parseFloat(_0x4a1243[_0x1fc16e(0x189)])});}let _0x957e61=_0x4a1243[_0x1fc16e(0x166)],_0x55dea7='';if(_0x957e61 instanceof Date){const _0x3d3939=_0x957e61[_0x1fc16e(0x12b)](),_0x52875f=String(_0x957e61['getMonth']()+0x1)['padStart'](0x2,'0'),_0xd4e365=String(_0x957e61[_0x1fc16e(0x1d6)]())[_0x1fc16e(0x1f1)](0x2,'0');_0x55dea7=_0x3d3939+'-'+_0x52875f+'-'+_0xd4e365;}else{if(typeof _0x957e61===_0x1fc16e(0x1bc)){const _0x4671d7=XLSX[_0x1fc16e(0x1fc)][_0x1fc16e(0x192)](_0x957e61);if(_0x4671d7){const _0x5ec37f=_0x4671d7['y'],_0x2e68c6=String(_0x4671d7['m'])[_0x1fc16e(0x1f1)](0x2,'0'),_0x4dc54a=String(_0x4671d7['d'])[_0x1fc16e(0x1f1)](0x2,'0');_0x55dea7=_0x5ec37f+'-'+_0x2e68c6+'-'+_0x4dc54a;}}else _0x55dea7=String(_0x957e61||'')['trim']();}return{'setItemId':String(_0x4a1243['ID'])[_0x1fc16e(0x15f)](),'setItemType':_0x258fda,'setItemCode':String(_0x4a1243[_0x1fc16e(0x11e)])[_0x1fc16e(0x15f)](),'setItemName':String(_0x4a1243[_0x1fc16e(0x159)])[_0x1fc16e(0x15f)](),'setItemDescription':String(_0x4a1243[_0x1fc16e(0x1d7)])[_0x1fc16e(0x15f)]()||'','setItemIsSold':_0x4a1243[_0x1fc16e(0x178)]=='SI'?0x1:0x0,'setItemIsBought':_0x4a1243[_0x1fc16e(0x1dc)]=='SI'?0x1:0x0,'setItemCategories':_0x4a1243[_0x1fc16e(0x144)]?[String(_0x4a1243[_0x1fc16e(0x144)])[_0x1fc16e(0x15f)]()]:[],'setItemBrands':_0x4a1243[_0x1fc16e(0x1ac)]?[String(_0x4a1243[_0x1fc16e(0x1ac)])[_0x1fc16e(0x15f)]()]:[],'setItemTaxId':_0x757a05,'setItemTaxCode':_0x242cee[_0x1fc16e(0x1c0)],'setItemTaxValue':_0x242cee[_0x1fc16e(0x1ed)],'setItemUnits':_0x24445e,'setItemInventoriable':_0x4a1243[_0x1fc16e(0x1d0)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x4a1243['Stock\x20Actual'])||0x0,'setStockMinimum':parseFloat(_0x4a1243[_0x1fc16e(0x177)])||0x0,'setItemLocation':String(_0x4a1243[_0x1fc16e(0x220)])[_0x1fc16e(0x15f)]()||'','setBatchName':String(_0x4a1243[_0x1fc16e(0x224)])['trim']()||'','setItemDateExpiry':_0x55dea7,'setItemVariantName':_0x27e71d,'setItemVariantValues':_0x29cff9,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x4304d6[_0x48e40f(0x1eb)](..._0x77a8fa),postMessage({'type':'progress','payload':{'percent':Math[_0x48e40f(0x120)]((_0x2c01ea+_0x77a8fa[_0x48e40f(0x156)])/_0x4dc0b3*0x64),'message':'Procesadas\x20filas\x20'+(_0x2c01ea+0x1)+'–'+(_0x2c01ea+_0x77a8fa[_0x48e40f(0x156)])+'/'+_0x4dc0b3}});}postMessage({'type':_0x48e40f(0x1b1),'payload':{'items':_0x4304d6}});}catch(_0x36b26f){postMessage({'type':_0x48e40f(0x191),'payload':_0x36b26f[_0x48e40f(0x1a7)]||_0x36b26f});}}if(_0x5a8235===_0x48e40f(0x15c)){const {products:_0x3e927b,plantillaBuf:_0xff66c4}=_0x179a2d;if(!(_0xff66c4 instanceof ArrayBuffer)){postMessage({'type':_0x48e40f(0x191),'payload':_0x48e40f(0x1ee)});return;}if(!Array[_0x48e40f(0x128)](_0x3e927b)){postMessage({'type':_0x48e40f(0x191),'payload':_0x48e40f(0x182)});return;}try{structuredClone(_0x3e927b);}catch(_0x3276be){postMessage({'type':_0x48e40f(0x191),'payload':_0x48e40f(0x195)+_0x3276be[_0x48e40f(0x1a7)]});return;}try{const _0x1f5a2={'1':_0x48e40f(0x165),'2':'Servicio','3':_0x48e40f(0x170),'4':'Combo','5':_0x48e40f(0x162)};function _0x53999b(_0x2b8992){const _0x10656e=_0x48e40f;return _0x1f5a2[String(_0x2b8992)]||_0x10656e(0x165);}const _0x5330c1={'1':_0x48e40f(0x1d5),'2':_0x48e40f(0x1c7),'3':'Inafecto\x20(0%)','4':_0x48e40f(0x13a),'5':_0x48e40f(0x197),'6':'Gravado\x20(10%)','7':_0x48e40f(0x13e),'8':'Exportación\x20(0%)','9':_0x48e40f(0x1b6)};function _0x184956(_0x31ac7){const _0x480815=_0x48e40f;return _0x5330c1[String(_0x31ac7)]||_0x480815(0x1d5);}const _0x248668={'4A':_0x48e40f(0x1cb),'BJ':_0x48e40f(0x1c3),'BLL':_0x48e40f(0x18b),'BG':_0x48e40f(0x133),'BO':_0x48e40f(0x1db),'BX':_0x48e40f(0x15d),'CT':_0x48e40f(0x176),'CMK':_0x48e40f(0x160),'CMQ':_0x48e40f(0x1da),'CMT':_0x48e40f(0x158),'CEN':'CIENTO\x20DE\x20UNIDADES','CY':_0x48e40f(0x20c),'CJ':_0x48e40f(0x1dd),'DZN':_0x48e40f(0x132),'DZP':_0x48e40f(0x1ca),'BE':'FARDO','GLI':_0x48e40f(0x13d),'GRM':_0x48e40f(0x1f2),'GRO':'GRUESA','HLT':_0x48e40f(0x204),'LEF':_0x48e40f(0x1f6),'SET':_0x48e40f(0x18c),'KGM':'KILOGRAMO','KTM':'KILOMETRO','KWH':'KILOVATIO\x20HORA','KT':_0x48e40f(0x14d),'CA':_0x48e40f(0x209),'LBR':_0x48e40f(0x13b),'LTR':_0x48e40f(0x14e),'MWH':'MEGAWATT\x20HORA','MTR':'METRO','MTK':_0x48e40f(0x193),'MTQ':_0x48e40f(0x21f),'MGM':_0x48e40f(0x181),'MLT':_0x48e40f(0x134),'MMT':_0x48e40f(0x1b2),'MMK':_0x48e40f(0x147),'MMQ':_0x48e40f(0x180),'MIL':_0x48e40f(0x151),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0x48e40f(0x203),'PF':_0x48e40f(0x149),'PK':_0x48e40f(0x167),'PR':_0x48e40f(0x1c9),'FOT':_0x48e40f(0x124),'FTK':'PIES\x20CUADRADOS','FTQ':'PIES\x20CUBICOS','C62':_0x48e40f(0x185),'PG':_0x48e40f(0x225),'ST':'PLIEGO','INH':_0x48e40f(0x1e1),'RM':_0x48e40f(0x16a),'SA':_0x48e40f(0x1cc),'DR':_0x48e40f(0x19a),'STN':_0x48e40f(0x183),'LTN':_0x48e40f(0x16d),'TNE':_0x48e40f(0x1e9),'TU':_0x48e40f(0x17e),'NIU':'UNIDAD\x20(NIU)','ZZ':_0x48e40f(0x17a),'GLL':_0x48e40f(0x130),'YRD':_0x48e40f(0x13f),'YDK':_0x48e40f(0x157),'QQM':'QUINTAL'};function _0x524969(_0x1501fd){return _0x248668[String(_0x1501fd)]||'';}const _0x206746=XLSX['read'](_0xff66c4,{'type':_0x48e40f(0x16b),'cellDates':!![]}),_0x987250=_0x206746['SheetNames'][0x0],_0x48f4ba=_0x206746[_0x48e40f(0x121)][_0x987250],_0x298902=XLSX['utils']['sheet_to_json'](_0x48f4ba,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x581ba6=XLSX[_0x48e40f(0x150)][_0x48e40f(0x1e6)](_0x48f4ba['!ref']||'');for(let _0x200400=0x2;_0x200400<=_0x581ba6['e']['r'];++_0x200400){for(let _0x239075=_0x581ba6['s']['c'];_0x239075<=_0x581ba6['e']['c'];++_0x239075){const _0x567cfd=XLSX[_0x48e40f(0x150)]['encode_cell']({'r':_0x200400,'c':_0x239075});if(_0x48f4ba[_0x567cfd])delete _0x48f4ba[_0x567cfd];}}const _0x444bc1=_0x3e927b[_0x48e40f(0x1ea)](_0x5d994d=>{const _0x173217=_0x48e40f;_0x5d994d[_0x173217(0x125)]=_0x5d994d[_0x173217(0x125)]||{};const _0x3fa2fb={};return _0x298902['forEach'](_0x4fc8d0=>{const _0x5ae68d=_0x173217,_0x2d81e3=String(_0x4fc8d0)[_0x5ae68d(0x15f)](),_0x3d7a27=_0x2d81e3['toLowerCase'](),_0xfe4d64=Object['keys'](_0x5d994d)['find'](_0x1f225f=>_0x1f225f[_0x5ae68d(0x15f)]()[_0x5ae68d(0x207)]()===_0x3d7a27);if(_0xfe4d64){_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0xfe4d64]??'';return;}switch(_0x2d81e3){case'ID':_0x3fa2fb[_0x2d81e3]=_0x5d994d['id']??'';break;case _0x5ae68d(0x1c1):_0x3fa2fb[_0x2d81e3]=_0x53999b(_0x5d994d[_0x5ae68d(0x1cf)]);break;case _0x5ae68d(0x11e):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x215)]??'';break;case'Nombre*':_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x174)]??'';break;case _0x5ae68d(0x1d7):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x163)]??'';break;case _0x5ae68d(0x178):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x208)]==0x1?'SI':'NO';break;case _0x5ae68d(0x1dc):_0x3fa2fb[_0x2d81e3]=_0x5d994d['setItemIsBought']==0x1?'SI':'NO';break;case'Categoría':_0x3fa2fb[_0x2d81e3]=_0x5d994d['setCategoria']??'';break;case _0x5ae68d(0x1ac):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x137)]??'';break;case'Impuesto*':_0x3fa2fb[_0x2d81e3]=_0x184956(_0x5d994d[_0x5ae68d(0x1f8)]);break;case _0x5ae68d(0x213):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1b5)]??'';break;case _0x5ae68d(0x1ff):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1df)]??'';break;case _0x5ae68d(0x216):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1d4)]??'';break;case _0x5ae68d(0x1e5):_0x3fa2fb[_0x2d81e3]=_0x524969(_0x5d994d[_0x5ae68d(0x1cd)]);break;case'Precio\x20Venta\x20Soles':_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x138)]??'';break;case _0x5ae68d(0x171):_0x3fa2fb[_0x2d81e3]=_0x5d994d['PEN_setMtoPrecioCostoUnitario']??'';break;case'Precio\x20Venta\x20Dólares':_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x136)]??'';break;case _0x5ae68d(0x1e4):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x188)]??'';break;case _0x5ae68d(0x1fb):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x140)];break;case _0x5ae68d(0x1c4):_0x3fa2fb[_0x2d81e3]=_0x5d994d['setUnitId2']??'';break;case _0x5ae68d(0x190):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x173)]??'';break;case _0x5ae68d(0x1d1):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x19d)]??'';break;case _0x5ae68d(0x1c2):_0x3fa2fb[_0x2d81e3]=_0x524969(_0x5d994d[_0x5ae68d(0x12a)]);break;case'Equivalencia\x202':_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x184)]??'1';break;case _0x5ae68d(0x1f0):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1a5)]??'';break;case _0x5ae68d(0x1e0):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x21b)]??'';break;case _0x5ae68d(0x202):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x17b)]??'';break;case _0x5ae68d(0x1bd):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x217)]??'';break;case _0x5ae68d(0x1fe):_0x3fa2fb[_0x2d81e3]=_0x5d994d['setItemCommissionPercentage2'];break;case _0x5ae68d(0x152):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1ad)]??'';break;case'Alias\x203':_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x20d)]??'';break;case _0x5ae68d(0x1ba):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1a1)]??'';break;case _0x5ae68d(0x1e3):_0x3fa2fb[_0x2d81e3]=_0x524969(_0x5d994d[_0x5ae68d(0x123)]);break;case _0x5ae68d(0x1a0):_0x3fa2fb[_0x2d81e3]=_0x5d994d['setUnidadEquivalencia3']??'1';break;case _0x5ae68d(0x222):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x14f)]??'';break;case _0x5ae68d(0x126):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x18d)]??'';break;case _0x5ae68d(0x1be):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x214)]??'';break;case _0x5ae68d(0x154):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x21a)]??'';break;case _0x5ae68d(0x189):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1a9)];break;case _0x5ae68d(0x1d0):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1d2)]==0x1?'SI':'NO';break;case _0x5ae68d(0x205):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x218)]??'';break;case _0x5ae68d(0x177):_0x3fa2fb[_0x2d81e3]=_0x5d994d[_0x5ae68d(0x1c5)]??'';break;case'Fecha\x20de\x20Vencimiento':_0x3fa2fb[_0x2d81e3]=_0x5d994d['setBatchExpirationDate']??'';break;default:_0x3fa2fb[_0x2d81e3]='';}}),_0x3fa2fb;}),_0x1cc01e=0x3e8,_0xb4ab17=_0x444bc1[_0x48e40f(0x156)];for(let _0x55ccd1=0x0;_0x55ccd1<_0xb4ab17;_0x55ccd1+=_0x1cc01e){const _0x276c6a=_0x444bc1['slice'](_0x55ccd1,_0x55ccd1+_0x1cc01e);XLSX['utils']['sheet_add_json'](_0x48f4ba,_0x276c6a,{'origin':{'r':_0x55ccd1+0x2,'c':0x0},'skipHeader':!![],'header':_0x298902}),postMessage({'type':_0x48e40f(0x187),'payload':{'percent':Math[_0x48e40f(0x120)]((_0x55ccd1+_0x276c6a[_0x48e40f(0x156)])/_0xb4ab17*0x64),'message':_0x48e40f(0x129)+(_0x55ccd1+0x1)+'–'+(_0x55ccd1+_0x276c6a[_0x48e40f(0x156)])+_0x48e40f(0x12f)+_0xb4ab17}});}const _0xafd075={'s':{'r':0x0,'c':0x0},'e':{'r':_0xb4ab17+0x1,'c':_0x298902[_0x48e40f(0x156)]-0x1}};_0x48f4ba[_0x48e40f(0x13c)]=XLSX[_0x48e40f(0x150)]['encode_range'](_0xafd075);const _0x8cff64=XLSX[_0x48e40f(0x127)](_0x206746,{'bookType':_0x48e40f(0x139),'type':_0x48e40f(0x16b)});let _0x4783f6,_0x234d58;if(_0x8cff64 instanceof Uint8Array)_0x4783f6=_0x8cff64,_0x234d58=[_0x8cff64[_0x48e40f(0x20e)]];else{if(_0x8cff64 instanceof ArrayBuffer)_0x4783f6=new Uint8Array(_0x8cff64),_0x234d58=[_0x8cff64];else{const _0x20e33a=new Uint8Array(_0x8cff64);_0x4783f6=_0x20e33a,_0x234d58=[_0x20e33a[_0x48e40f(0x20e)]];}}postMessage({'type':_0x48e40f(0x179),'payload':{'wbout':_0x4783f6,'count':_0x444bc1[_0x48e40f(0x156)]}},_0x234d58);}catch(_0x2fdeab){postMessage({'type':'error','payload':_0x2fdeab['message']||String(_0x2fdeab)});}return;}};