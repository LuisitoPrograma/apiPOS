/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.1.4
*/

const _0x2a5844=_0x1e4a;(function(_0x4ad62f,_0x4f222e){const _0x294fd3=_0x1e4a,_0xa594e6=_0x4ad62f();while(!![]){try{const _0x3b6a01=parseInt(_0x294fd3(0x15c))/0x1*(parseInt(_0x294fd3(0x14c))/0x2)+-parseInt(_0x294fd3(0x19f))/0x3+parseInt(_0x294fd3(0x142))/0x4+parseInt(_0x294fd3(0x185))/0x5+-parseInt(_0x294fd3(0xfe))/0x6+-parseInt(_0x294fd3(0x111))/0x7+parseInt(_0x294fd3(0x123))/0x8;if(_0x3b6a01===_0x4f222e)break;else _0xa594e6['push'](_0xa594e6['shift']());}catch(_0x1748b0){_0xa594e6['push'](_0xa594e6['shift']());}}}(_0x2531,0x98323));function _0x1e4a(_0x2d7d05,_0x5b7eed){const _0x39d49e=_0x2531();return _0x1e4a=function(_0x5f6f16,_0x53942b){_0x5f6f16=_0x5f6f16-0xca;let _0x1c4487=_0x39d49e[_0x5f6f16];return _0x1c4487;},_0x1e4a(_0x2d7d05,_0x5b7eed);}const _0x1d9d94=(function(){let _0x54f136=!![];return function(_0x96de98,_0x3c493d){const _0x50f832=_0x54f136?function(){if(_0x3c493d){const _0x361f41=_0x3c493d['apply'](_0x96de98,arguments);return _0x3c493d=null,_0x361f41;}}:function(){};return _0x54f136=![],_0x50f832;};}()),_0x39aedd=_0x1d9d94(this,function(){const _0x5d63c4=_0x1e4a;return _0x39aedd['toString']()[_0x5d63c4(0x17b)](_0x5d63c4(0xd3))[_0x5d63c4(0x197)]()[_0x5d63c4(0x116)](_0x39aedd)[_0x5d63c4(0x17b)](_0x5d63c4(0xd3));});function _0x2531(){const _0x2184b8=['QUINTAL','MMK','PIEZAS','map','setItemBarCode','{}.constructor(\x22return\x20this\x22)(\x20)','!ref','2261420ZRjVqU','ONZ','YARDA\x20CUADRADA','Serie','YARDA','getDate','setItemBarCode2','MILLARES','message','RESMA','Combo','round','Comisión\x20Venta\x202\x20(%)','setItemUnitAlias3','filter','Precio\x20Costo\x20Soles\x202','ID\x20UNIT\x203','toLowerCase','toString','exportDone','DOCENA\x20POR\x2010**6','setItemIsBought','Gravado\x20(18%)','NIU','MLT','BOLSA','1760712WbfNdB','Gravado\x20Gratuito\x20(18%)','info','PIES','reduce','setUnitId3','BOTELLAS','Precio\x20Costo\x20Dólares','value','setItemCommissionPercentage2','LITRO','MILIMETRO','Código\x20SKU*','PEN_setMtoPrecioUnitario3','LTR','Comisión\x20Venta\x203\x20(%)','Precio\x20Venta\x20Soles\x202','Impuesto*','MTR','\x20de\x20','setItemCommissionPercentage','some','Unidad\x20de\x20Medida\x202','Exportando\x20filas\x20','Servicio','Precio\x20Costo\x20Soles','bind','Unidad\x20de\x20Medida*','Precio\x20Costo\x20Dólares\x202','Tipo*','progress','GLL','DZN','USD_setMtoPrecioCostoUnitario2','MMT','HOJA','MIL','QQM','CMK','CENTIMETRO\x20CUADRADO','number','isArray','push','Se\x20Vende','US\x20GALON\x20(3,7843\x20L)','(((.+)+)+)+$','MILIMETRO\x20CUADRADO','BARRILES','Código\x20de\x20Barras\x202','setTaxId','Exportación\x20(0%)','HLT','CIENTO\x20DE\x20UNIDADES','Modelo\x20de\x20Cuello','BOBINAS','C62','Artículo','SheetNames','CENTIMETRO\x20CUBICO','GRUESA','PLACAS','__proto__','Marca','Precio\x20Costo\x20Dólares\x203','CEN','KIT','Nombre*','done','ID\x20UNIT\x202','METRO\x20CUBICO','USD_setMtoPrecioCostoUnitario3','KWH','setUnidadCodigo','LEF','ID\x20UNIT','CONOS','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','forEach','DZP','GALON\x20INGLES\x20(4,545956L)','keys','Género','read','setMarca','USD_setMtoPrecioUnitario3','Gravado\x20Gratuito\x20(10%)','setItemIsSold','MMQ','876144bzXDec','array','Rastrear\x20Inventario','CAJA','METRO\x20CUADRADO','MEGAWATT\x20HORA','Stock\x20Actual','UND\x20(NIU)','Talla','table','length','setBatchExpirationDate','KILOVATIO\x20HORA','SACO','setItemType','HECTOLITRO','xlsx','TONELADAS','TONELADA\x20LARGA','8218091AdyFFw','Alias\x202','PEN_setMtoPrecioCostoUnitario2','setCodProducto','KTM','constructor','find','LATAS','exportItems:\x20products\x20no\x20es\x20Array.','Alias\x203','CILINDRO','USD_setMtoPrecioCostoUnitario','ONZAS','setUnidadCodigo3','setUnidadEquivalencia2','Procesadas\x20filas\x20','Equivalencia\x202','utils','7525712NDxVKi','Equivalencia\x203','MILIMETRO\x20CUBICO','LTN','JUEGO','PAR','KILOGRAMO','SSF','INH','BALDE','TONELADA\x20CORTA','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','CENTIMETRO\x20LINEAL','setUnidadCodigo2','KGM','MILILITRO','setInventariable','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','TNE','setItemVariantValues','setUnitId2','PLIEGO','Exonerado\x20Gratuito\x20(0%)','PEN_setMtoPrecioCostoUnitario3','LIBRAS','Unidad\x20de\x20Medida\x203','CARTONES','Precio\x20Venta\x20Soles','setItemDescription','Se\x20Compra','decode_range','2601740tYscQQ','setItemUnitAlias','Fecha\x20de\x20Vencimiento','Modelo\x20de\x20Manga','STN','PALETAS','parse_date_code','METRO','Código\x20de\x20Barras\x203','PULGADAS','8934YmpvvR','TAMBOR','error','write','Stock\x20Mínimo','Precio\x20Venta\x20Dólares\x203','Precio\x20Costo\x20Soles\x203','PIES\x20CUADRADOS','Lote','slice','Iniciando\x20parseo…','Categoría','buffer','PIES\x20CUBICOS','GLI','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','109lJFFRW','SET','MILIGRAMOS','log','Color','GRM','FARDO','Alias','UNIDAD\x20(ZZ)','UNIDAD\x20(NIU)','trim','setDescripcion','KILOMETRO','setSucursalStock','FTQ','MILLON\x20DE\x20UNIDADES','Sheets','Exonerado\x20(0%)','encode_cell','console','PEN_setMtoPrecioUnitario2','DOCENA','setUnidadEquivalencia3','TUBOS','MGM','setItemUnitAlias2','padStart','exportItems:\x20productos\x20no\x20clonables:\x20','Precio\x20Venta\x20Soles\x203','setUnitId','code','search','Código\x20de\x20Barras','Precio\x20Venta\x20Dólares\x202'];_0x2531=function(){return _0x2184b8;};return _0x2531();}_0x39aedd();const _0x53942b=(function(){let _0x198e05=!![];return function(_0x518c71,_0x286f1b){const _0x144d70=_0x198e05?function(){if(_0x286f1b){const _0x27da97=_0x286f1b['apply'](_0x518c71,arguments);return _0x286f1b=null,_0x27da97;}}:function(){};return _0x198e05=![],_0x144d70;};}()),_0x5f6f16=_0x53942b(this,function(){const _0x23fab6=_0x1e4a;let _0x568f44;try{const _0x5d3037=Function('return\x20(function()\x20'+_0x23fab6(0x183)+');');_0x568f44=_0x5d3037();}catch(_0x51e37c){_0x568f44=window;}const _0x30302d=_0x568f44[_0x23fab6(0x16f)]=_0x568f44[_0x23fab6(0x16f)]||{},_0x54ddb8=[_0x23fab6(0x15f),'warn',_0x23fab6(0x1a1),_0x23fab6(0x14e),'exception',_0x23fab6(0x107),'trace'];for(let _0x264a76=0x0;_0x264a76<_0x54ddb8[_0x23fab6(0x108)];_0x264a76++){const _0x1c3f27=_0x53942b['constructor']['prototype'][_0x23fab6(0x1b9)](_0x53942b),_0x3180b0=_0x54ddb8[_0x264a76],_0x224bf7=_0x30302d[_0x3180b0]||_0x1c3f27;_0x1c3f27[_0x23fab6(0xe3)]=_0x53942b['bind'](_0x53942b),_0x1c3f27[_0x23fab6(0x197)]=_0x224bf7['toString'][_0x23fab6(0x1b9)](_0x224bf7),_0x30302d[_0x3180b0]=_0x1c3f27;}});_0x5f6f16(),importScripts(_0x2a5844(0x15b)),onmessage=({data:_0x2a1018})=>{const _0x381fda=_0x2a5844,{action:_0x5a4a5f}=_0x2a1018;if(_0x5a4a5f==='import'){const {buf:_0x472d69,maxRows:_0x7b15d8}=_0x2a1018;try{postMessage({'type':_0x381fda(0x1bd),'payload':{'percent':0x5,'message':_0x381fda(0x156)}});const _0x377ce0=XLSX[_0x381fda(0xf8)](_0x472d69,{'type':_0x381fda(0xff),'cellDates':!![]}),_0x1b8948=_0x377ce0[_0x381fda(0x16c)][_0x377ce0[_0x381fda(0xdf)][0x0]],_0x4afca2=XLSX[_0x381fda(0x122)]['sheet_to_json'](_0x1b8948,{'defval':'','range':0x1,'cellDates':!![]}),_0x5cfa38=_0x4afca2['findIndex'](_0x36d941=>(!_0x36d941[_0x381fda(0x1bc)]||String(_0x36d941[_0x381fda(0x1bc)])['trim']()==='')&&(!_0x36d941[_0x381fda(0x1ab)]||String(_0x36d941['Código\x20SKU*'])['trim']()==='')&&(!_0x36d941[_0x381fda(0xe8)]||String(_0x36d941['Nombre*'])['trim']()==='')&&(!_0x36d941[_0x381fda(0x1ba)]||String(_0x36d941[_0x381fda(0x1ba)])[_0x381fda(0x166)]()==='')),_0x5bd3a6=_0x5cfa38>=0x0?_0x4afca2[_0x381fda(0x155)](0x0,_0x5cfa38):_0x4afca2,_0x2dfc7e=_0x5bd3a6[_0x381fda(0x193)](_0x588a5a=>_0x588a5a[_0x381fda(0x1bc)]&&String(_0x588a5a[_0x381fda(0x1bc)])[_0x381fda(0x166)]()!==''&&_0x588a5a['Código\x20SKU*']&&String(_0x588a5a[_0x381fda(0x1ab)])[_0x381fda(0x166)]()!==''&&_0x588a5a['Nombre*']&&String(_0x588a5a[_0x381fda(0xe8)])[_0x381fda(0x166)]()!==''&&_0x588a5a[_0x381fda(0x1ba)]&&String(_0x588a5a['Unidad\x20de\x20Medida*'])[_0x381fda(0x166)]()!==''),_0x4ead9d=_0x2dfc7e[_0x381fda(0x108)];if(_0x4ead9d===0x0){postMessage({'type':_0x381fda(0x14e),'payload':_0x381fda(0x134)});return;}if(_0x4ead9d>_0x7b15d8)throw'El\x20archivo\x20tiene\x20'+_0x4ead9d+_0x381fda(0xf2)+_0x7b15d8+'.';const _0x227584=0x1f4,_0xbfa74d=[],_0x53bfa5=[{'codigo':'4A','nombre':_0x381fda(0xdc)},{'codigo':'BJ','nombre':_0x381fda(0x12c)},{'codigo':'BLL','nombre':_0x381fda(0xd5)},{'codigo':'BG','nombre':'BOLSA'},{'codigo':'BO','nombre':'BOTELLAS'},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':_0x381fda(0x13d)},{'codigo':_0x381fda(0xcc),'nombre':_0x381fda(0xcd)},{'codigo':'CMQ','nombre':'CENTIMETRO\x20CUBICO'},{'codigo':'CMT','nombre':_0x381fda(0x12f)},{'codigo':_0x381fda(0xe6),'nombre':_0x381fda(0xda)},{'codigo':'CY','nombre':_0x381fda(0x11b)},{'codigo':'CJ','nombre':_0x381fda(0xf1)},{'codigo':_0x381fda(0x1bf),'nombre':_0x381fda(0x171)},{'codigo':_0x381fda(0xf4),'nombre':_0x381fda(0x199)},{'codigo':'BE','nombre':_0x381fda(0x162)},{'codigo':_0x381fda(0x15a),'nombre':'GALON\x20INGLES\x20(4,545956L)'},{'codigo':_0x381fda(0x161),'nombre':'GRAMO'},{'codigo':'GRO','nombre':_0x381fda(0xe1)},{'codigo':_0x381fda(0xd9),'nombre':_0x381fda(0x10d)},{'codigo':_0x381fda(0xef),'nombre':_0x381fda(0x1c2)},{'codigo':_0x381fda(0x15d),'nombre':'JUEGO'},{'codigo':_0x381fda(0x131),'nombre':_0x381fda(0x129)},{'codigo':_0x381fda(0x115),'nombre':_0x381fda(0x168)},{'codigo':_0x381fda(0xed),'nombre':_0x381fda(0x10a)},{'codigo':'KT','nombre':_0x381fda(0xe7)},{'codigo':'CA','nombre':'LATAS'},{'codigo':'LBR','nombre':'LIBRAS'},{'codigo':_0x381fda(0x1ad),'nombre':_0x381fda(0x1a9)},{'codigo':'MWH','nombre':_0x381fda(0x103)},{'codigo':_0x381fda(0x1b1),'nombre':_0x381fda(0x149)},{'codigo':'MTK','nombre':_0x381fda(0x102)},{'codigo':'MTQ','nombre':_0x381fda(0xeb)},{'codigo':_0x381fda(0x174),'nombre':_0x381fda(0x15e)},{'codigo':_0x381fda(0x19d),'nombre':_0x381fda(0x132)},{'codigo':_0x381fda(0x1c1),'nombre':_0x381fda(0x1aa)},{'codigo':_0x381fda(0x17f),'nombre':_0x381fda(0xd4)},{'codigo':_0x381fda(0xfd),'nombre':_0x381fda(0x125)},{'codigo':_0x381fda(0xca),'nombre':_0x381fda(0x18c)},{'codigo':'UM','nombre':_0x381fda(0x16b)},{'codigo':_0x381fda(0x186),'nombre':'ONZAS'},{'codigo':'PF','nombre':_0x381fda(0x147)},{'codigo':'PK','nombre':'PAQUETE'},{'codigo':'PR','nombre':'PAR'},{'codigo':'FOT','nombre':_0x381fda(0x1a2)},{'codigo':'FTK','nombre':'PIES\x20CUADRADOS'},{'codigo':_0x381fda(0x16a),'nombre':_0x381fda(0x159)},{'codigo':_0x381fda(0xdd),'nombre':'PIEZAS'},{'codigo':'PG','nombre':_0x381fda(0xe2)},{'codigo':'ST','nombre':_0x381fda(0x138)},{'codigo':_0x381fda(0x12b),'nombre':_0x381fda(0x14b)},{'codigo':'RM','nombre':_0x381fda(0x18e)},{'codigo':'SA','nombre':_0x381fda(0x10b)},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':_0x381fda(0x146),'nombre':_0x381fda(0x12d)},{'codigo':_0x381fda(0x126),'nombre':_0x381fda(0x110)},{'codigo':_0x381fda(0x135),'nombre':_0x381fda(0x10f)},{'codigo':'TU','nombre':_0x381fda(0x173)},{'codigo':_0x381fda(0x19c),'nombre':_0x381fda(0x165)},{'codigo':'ZZ','nombre':_0x381fda(0x164)},{'codigo':_0x381fda(0x1be),'nombre':'US\x20GALON\x20(3,7843\x20L)'},{'codigo':'YRD','nombre':_0x381fda(0x189)},{'codigo':'YDK','nombre':_0x381fda(0x187)},{'codigo':_0x381fda(0xcb),'nombre':_0x381fda(0x17e)}],_0x55b115=_0x53bfa5[_0x381fda(0x1a3)]((_0x212d72,{nombre:_0x3beab6,codigo:_0x2ae50a})=>{const _0x523c52=_0x381fda;return _0x212d72[_0x3beab6[_0x523c52(0x166)]()]=_0x2ae50a[_0x523c52(0x166)](),_0x212d72;},{});for(let _0x28a250=0x0;_0x28a250<_0x4ead9d;_0x28a250+=_0x227584){const _0x5791ea=_0x2dfc7e[_0x381fda(0x155)](_0x28a250,_0x28a250+_0x227584)[_0x381fda(0x181)]((_0x170237,_0xe3bd86)=>{const _0xfb75f=_0x381fda;let _0x20cf2f={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x170237[_0xfb75f(0x1bc)]]||'1';const _0xbec900=String(_0x170237[_0xfb75f(0x1b0)])[_0xfb75f(0x166)](),_0x1bcb14={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x220a63=_0x1bcb14[_0xbec900]||'1',_0x35a4f1={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x220a63]||{'code':'10','value':0x12},_0x2bb073={};let _0x59c2bb=String(_0x170237[_0xfb75f(0xe8)])[_0xfb75f(0x166)]();const _0x407ed8=['Lote',_0xfb75f(0x106),_0xfb75f(0x160),_0xfb75f(0xf7),'Modelo',_0xfb75f(0x188),'Material',_0xfb75f(0xdb),_0xfb75f(0x145)];_0x407ed8[_0xfb75f(0xf3)](_0x48691c=>{const _0x1fa524=_0xfb75f,_0x424f17=String(_0x170237[_0x48691c]||'')[_0x1fa524(0x166)]();_0x424f17&&(_0x2bb073[_0x48691c]=_0x424f17,_0x59c2bb+='\x20'+_0x48691c+'\x20'+_0x424f17);});const _0x49c6fe=[],_0x59745c=String(_0x170237[_0xfb75f(0x1ba)]||'UNIDAD\x20(NIU)')[_0xfb75f(0x166)](),_0x4fd46d=_0x55b115[_0x59745c]||_0xfb75f(0x19c),_0x4e9469=String(_0x170237[_0xfb75f(0x163)])[_0xfb75f(0x166)]();_0x49c6fe[_0xfb75f(0xd0)]({'setItemUnitId':String(_0x170237['ID\x20UNIT'])['trim']()||'','setItemBarCode':String(_0x170237[_0xfb75f(0x17c)])[_0xfb75f(0x166)]()||'','setAlias':_0x4e9469,'setUnitCode':_0x4fd46d,'setPrice':parseFloat(_0x170237[_0xfb75f(0x13e)]),'setCost':parseFloat(_0x170237[_0xfb75f(0x1b8)]),'setPriceUSD':parseFloat(_0x170237['Precio\x20Venta\x20Dólares']),'setCostUSD':parseFloat(_0x170237[_0xfb75f(0x1a6)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x170237['Comisión\x20Venta\x20(%)'])});const _0x4ed268=[_0xfb75f(0xea),'Alias\x202',_0xfb75f(0xd6),_0xfb75f(0x121),'Precio\x20Venta\x20Soles\x202','Precio\x20Costo\x20Soles\x202',_0xfb75f(0x17d),_0xfb75f(0x1bb)][_0xfb75f(0x1b4)](_0x372b24=>{const _0x3554b5=_0xfb75f,_0x3aa339=_0x170237[_0x372b24];return _0x3aa339!=null&&String(_0x3aa339)[_0x3554b5(0x166)]()!=='';});if(_0x4ed268){const _0x315f81=String(_0x170237[_0xfb75f(0x1b5)]||_0xfb75f(0x105))[_0xfb75f(0x166)](),_0xd41674=_0x55b115[_0x315f81]||_0xfb75f(0x19c);_0x49c6fe[_0xfb75f(0xd0)]({'setItemUnitId':String(_0x170237[_0xfb75f(0xea)])['trim']()||'','setItemBarCode':String(_0x170237['Código\x20de\x20Barras\x202'])[_0xfb75f(0x166)]()||'','setAlias':String(_0x170237['Alias\x202'])['trim'](),'setUnitCode':_0xd41674,'setPrice':parseFloat(_0x170237[_0xfb75f(0x1af)]),'setCost':parseFloat(_0x170237[_0xfb75f(0x194)]),'setPriceUSD':parseFloat(_0x170237[_0xfb75f(0x17d)]),'setCostUSD':parseFloat(_0x170237[_0xfb75f(0x1bb)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x170237[_0xfb75f(0x121)])||0x1,'setFactor':parseFloat(_0x170237[_0xfb75f(0x121)])||0x1,'setItemCommissionPercentage':parseFloat(_0x170237[_0xfb75f(0x191)])});}const _0x5ed818=[_0xfb75f(0x195),_0xfb75f(0x11a),'Código\x20de\x20Barras\x203','Equivalencia\x203',_0xfb75f(0x178),_0xfb75f(0x152),'Precio\x20Venta\x20Dólares\x203',_0xfb75f(0xe5)]['some'](_0x352183=>{const _0x54a6ac=_0xfb75f,_0x315d2b=_0x170237[_0x352183];return _0x315d2b!=null&&String(_0x315d2b)[_0x54a6ac(0x166)]()!=='';});if(_0x5ed818){const _0x345a51=String(_0x170237[_0xfb75f(0x13c)]||_0xfb75f(0x105))['trim'](),_0x3911bf=_0x55b115[_0x345a51]||'NIU';_0x49c6fe['push']({'setItemUnitId':String(_0x170237[_0xfb75f(0x195)])[_0xfb75f(0x166)]()||'','setItemBarCode':String(_0x170237[_0xfb75f(0x14a)])[_0xfb75f(0x166)]()||'','setAlias':String(_0x170237['Alias\x203'])[_0xfb75f(0x166)](),'setUnitCode':_0x3911bf,'setPrice':parseFloat(_0x170237[_0xfb75f(0x178)]),'setCost':parseFloat(_0x170237[_0xfb75f(0x152)]),'setPriceUSD':parseFloat(_0x170237[_0xfb75f(0x151)]),'setCostUSD':parseFloat(_0x170237[_0xfb75f(0xe5)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x170237['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0x170237[_0xfb75f(0x124)])||0x1,'setItemCommissionPercentage':parseFloat(_0x170237[_0xfb75f(0x1ae)])});}let _0x2874fa=_0x170237[_0xfb75f(0x144)],_0x5cd3bd='';if(_0x2874fa instanceof Date){const _0x1d2301=_0x2874fa['getFullYear'](),_0x4f68d3=String(_0x2874fa['getMonth']()+0x1)[_0xfb75f(0x176)](0x2,'0'),_0x523706=String(_0x2874fa[_0xfb75f(0x18a)]())[_0xfb75f(0x176)](0x2,'0');_0x5cd3bd=_0x1d2301+'-'+_0x4f68d3+'-'+_0x523706;}else{if(typeof _0x2874fa===_0xfb75f(0xce)){const _0xc6615=XLSX[_0xfb75f(0x12a)][_0xfb75f(0x148)](_0x2874fa);if(_0xc6615){const _0x14fc91=_0xc6615['y'],_0x4f25e3=String(_0xc6615['m'])['padStart'](0x2,'0'),_0x54f0ea=String(_0xc6615['d'])['padStart'](0x2,'0');_0x5cd3bd=_0x14fc91+'-'+_0x4f25e3+'-'+_0x54f0ea;}}else _0x5cd3bd=String(_0x2874fa||'')[_0xfb75f(0x166)]();}return{'setItemId':String(_0x170237['ID'])[_0xfb75f(0x166)](),'setItemType':_0x20cf2f,'setItemCode':String(_0x170237[_0xfb75f(0x1ab)])['trim'](),'setItemName':String(_0x170237[_0xfb75f(0xe8)])[_0xfb75f(0x166)](),'setItemDescription':String(_0x170237['Descripción'])[_0xfb75f(0x166)]()||'','setItemIsSold':_0x170237[_0xfb75f(0xd1)]=='SI'?0x1:0x0,'setItemIsBought':_0x170237[_0xfb75f(0x140)]=='SI'?0x1:0x0,'setItemCategories':_0x170237[_0xfb75f(0x157)]?[String(_0x170237[_0xfb75f(0x157)])[_0xfb75f(0x166)]()]:[],'setItemBrands':_0x170237[_0xfb75f(0xe4)]?[String(_0x170237[_0xfb75f(0xe4)])[_0xfb75f(0x166)]()]:[],'setItemTaxId':_0x220a63,'setItemTaxCode':_0x35a4f1[_0xfb75f(0x17a)],'setItemTaxValue':_0x35a4f1[_0xfb75f(0x1a7)],'setItemUnits':_0x49c6fe,'setItemInventoriable':_0x170237['Rastrear\x20Inventario']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x170237[_0xfb75f(0x104)])||0x0,'setStockMinimum':parseFloat(_0x170237[_0xfb75f(0x150)])||0x0,'setItemLocation':String(_0x170237['Ubicación'])[_0xfb75f(0x166)]()||'','setBatchName':String(_0x170237[_0xfb75f(0x154)])[_0xfb75f(0x166)]()||'','setItemDateExpiry':_0x5cd3bd,'setItemVariantName':_0x59c2bb,'setItemVariantValues':_0x2bb073,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0xbfa74d['push'](..._0x5791ea),postMessage({'type':_0x381fda(0x1bd),'payload':{'percent':Math[_0x381fda(0x190)]((_0x28a250+_0x5791ea[_0x381fda(0x108)])/_0x4ead9d*0x64),'message':_0x381fda(0x120)+(_0x28a250+0x1)+'–'+(_0x28a250+_0x5791ea[_0x381fda(0x108)])+'/'+_0x4ead9d}});}postMessage({'type':_0x381fda(0xe9),'payload':{'items':_0xbfa74d}});}catch(_0x43dcda){postMessage({'type':_0x381fda(0x14e),'payload':_0x43dcda[_0x381fda(0x18d)]||_0x43dcda});}}if(_0x5a4a5f==='exportItems'){const {products:_0x7b6937,plantillaBuf:_0x305528}=_0x2a1018;if(!(_0x305528 instanceof ArrayBuffer)){postMessage({'type':_0x381fda(0x14e),'payload':_0x381fda(0x12e)});return;}if(!Array[_0x381fda(0xcf)](_0x7b6937)){postMessage({'type':'error','payload':_0x381fda(0x119)});return;}try{structuredClone(_0x7b6937);}catch(_0xe1a7e0){postMessage({'type':_0x381fda(0x14e),'payload':_0x381fda(0x177)+_0xe1a7e0[_0x381fda(0x18d)]});return;}try{const _0x5b0575={'1':_0x381fda(0xde),'2':_0x381fda(0x1b7),'3':'Materia\x20Prima','4':_0x381fda(0x18f),'5':'Fabricado'};function _0x422cdc(_0x568708){const _0x3cf99d=_0x381fda;return _0x5b0575[String(_0x568708)]||_0x3cf99d(0xde);}const _0x537803={'1':_0x381fda(0x19b),'2':_0x381fda(0x16d),'3':'Inafecto\x20(0%)','4':_0x381fda(0x1a0),'5':'Inafecto\x20Gratuito\x20(0%)','6':'Gravado\x20(10%)','7':_0x381fda(0x139),'8':_0x381fda(0xd8),'9':_0x381fda(0xfb)};function _0x4a8c23(_0xa45293){const _0x179b4b=_0x381fda;return _0x537803[String(_0xa45293)]||_0x179b4b(0x19b);}const _0x322a57={'4A':_0x381fda(0xdc),'BJ':_0x381fda(0x12c),'BLL':_0x381fda(0xd5),'BG':_0x381fda(0x19e),'BO':_0x381fda(0x1a5),'BX':_0x381fda(0x101),'CT':_0x381fda(0x13d),'CMK':_0x381fda(0xcd),'CMQ':_0x381fda(0xe0),'CMT':_0x381fda(0x12f),'CEN':_0x381fda(0xda),'CY':_0x381fda(0x11b),'CJ':'CONOS','DZN':'DOCENA','DZP':'DOCENA\x20POR\x2010**6','BE':_0x381fda(0x162),'GLI':_0x381fda(0xf5),'GRM':'GRAMO','GRO':_0x381fda(0xe1),'HLT':_0x381fda(0x10d),'LEF':_0x381fda(0x1c2),'SET':_0x381fda(0x127),'KGM':_0x381fda(0x129),'KTM':'KILOMETRO','KWH':'KILOVATIO\x20HORA','KT':'KIT','CA':_0x381fda(0x118),'LBR':_0x381fda(0x13b),'LTR':_0x381fda(0x1a9),'MWH':_0x381fda(0x103),'MTR':'METRO','MTK':_0x381fda(0x102),'MTQ':_0x381fda(0xeb),'MGM':_0x381fda(0x15e),'MLT':_0x381fda(0x132),'MMT':_0x381fda(0x1aa),'MMK':_0x381fda(0xd4),'MMQ':_0x381fda(0x125),'MIL':'MILLARES','UM':_0x381fda(0x16b),'ONZ':_0x381fda(0x11d),'PF':_0x381fda(0x147),'PK':'PAQUETE','PR':_0x381fda(0x128),'FOT':_0x381fda(0x1a2),'FTK':_0x381fda(0x153),'FTQ':'PIES\x20CUBICOS','C62':_0x381fda(0x180),'PG':_0x381fda(0xe2),'ST':_0x381fda(0x138),'INH':_0x381fda(0x14b),'RM':_0x381fda(0x18e),'SA':_0x381fda(0x10b),'DR':_0x381fda(0x14d),'STN':_0x381fda(0x12d),'LTN':_0x381fda(0x110),'TNE':_0x381fda(0x10f),'TU':_0x381fda(0x173),'NIU':'UNIDAD\x20(NIU)','ZZ':'UNIDAD\x20(ZZ)','GLL':_0x381fda(0xd2),'YRD':'YARDA','YDK':_0x381fda(0x187),'QQM':_0x381fda(0x17e)};function _0x4e0aab(_0x52eb4a){return _0x322a57[String(_0x52eb4a)]||'';}const _0x16a716=XLSX[_0x381fda(0xf8)](_0x305528,{'type':_0x381fda(0xff),'cellDates':!![]}),_0x1bb751=_0x16a716['SheetNames'][0x0],_0x3f27a3=_0x16a716[_0x381fda(0x16c)][_0x1bb751],_0x2998c4=XLSX[_0x381fda(0x122)]['sheet_to_json'](_0x3f27a3,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x2dc5c8=XLSX[_0x381fda(0x122)][_0x381fda(0x141)](_0x3f27a3[_0x381fda(0x184)]||'');for(let _0x360d9c=0x2;_0x360d9c<=_0x2dc5c8['e']['r'];++_0x360d9c){for(let _0x13c831=_0x2dc5c8['s']['c'];_0x13c831<=_0x2dc5c8['e']['c'];++_0x13c831){const _0x1a42fc=XLSX['utils'][_0x381fda(0x16e)]({'r':_0x360d9c,'c':_0x13c831});if(_0x3f27a3[_0x1a42fc])delete _0x3f27a3[_0x1a42fc];}}const _0x59ffdc=_0x7b6937[_0x381fda(0x181)](_0x21fb73=>{const _0x43eab8=_0x381fda;_0x21fb73[_0x43eab8(0x136)]=_0x21fb73[_0x43eab8(0x136)]||{};const _0x5b8c45={};return _0x2998c4[_0x43eab8(0xf3)](_0x399854=>{const _0x56694e=_0x43eab8,_0x1b3f7f=String(_0x399854)[_0x56694e(0x166)](),_0x392eef=_0x1b3f7f[_0x56694e(0x196)](),_0x1f45d4=Object[_0x56694e(0xf6)](_0x21fb73)[_0x56694e(0x117)](_0xf8a67c=>_0xf8a67c[_0x56694e(0x166)]()[_0x56694e(0x196)]()===_0x392eef);if(_0x1f45d4){_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x1f45d4]??'';return;}switch(_0x1b3f7f){case'ID':_0x5b8c45[_0x1b3f7f]=_0x21fb73['id']??'';break;case'Tipo*':_0x5b8c45[_0x1b3f7f]=_0x422cdc(_0x21fb73[_0x56694e(0x10c)]);break;case'Código\x20SKU*':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x114)]??'';break;case _0x56694e(0xe8):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x167)]??'';break;case'Descripción':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x13f)]??'';break;case _0x56694e(0xd1):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0xfc)]==0x1?'SI':'NO';break;case _0x56694e(0x140):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x19a)]==0x1?'SI':'NO';break;case _0x56694e(0x157):_0x5b8c45[_0x1b3f7f]=_0x21fb73['setCategoria']??'';break;case'Marca':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0xf9)]??'';break;case _0x56694e(0x1b0):_0x5b8c45[_0x1b3f7f]=_0x4a8c23(_0x21fb73[_0x56694e(0xd7)]);break;case _0x56694e(0xf0):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x179)]??'';break;case _0x56694e(0x163):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x143)]??'';break;case _0x56694e(0x17c):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x182)]??'';break;case _0x56694e(0x1ba):_0x5b8c45[_0x1b3f7f]=_0x4e0aab(_0x21fb73[_0x56694e(0xee)]);break;case'Precio\x20Venta\x20Soles':_0x5b8c45[_0x1b3f7f]=_0x21fb73['PEN_setMtoPrecioUnitario']??'';break;case _0x56694e(0x1b8):_0x5b8c45[_0x1b3f7f]=_0x21fb73['PEN_setMtoPrecioCostoUnitario']??'';break;case'Precio\x20Venta\x20Dólares':_0x5b8c45[_0x1b3f7f]=_0x21fb73['USD_setMtoPrecioUnitario']??'';break;case _0x56694e(0x1a6):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x11c)]??'';break;case'Comisión\x20Venta\x20(%)':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x1b3)];break;case _0x56694e(0xea):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x137)]??'';break;case _0x56694e(0x112):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x175)]??'';break;case _0x56694e(0xd6):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x18b)]??'';break;case _0x56694e(0x1b5):_0x5b8c45[_0x1b3f7f]=_0x4e0aab(_0x21fb73[_0x56694e(0x130)]);break;case'Equivalencia\x202':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x11f)]??'1';break;case'Precio\x20Venta\x20Soles\x202':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x170)]??'';break;case _0x56694e(0x194):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x113)]??'';break;case _0x56694e(0x17d):_0x5b8c45[_0x1b3f7f]=_0x21fb73['USD_setMtoPrecioUnitario2']??'';break;case _0x56694e(0x1bb):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x1c0)]??'';break;case _0x56694e(0x191):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x1a8)];break;case _0x56694e(0x195):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x1a4)]??'';break;case'Alias\x203':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x192)]??'';break;case _0x56694e(0x14a):_0x5b8c45[_0x1b3f7f]=_0x21fb73['setItemBarCode3']??'';break;case _0x56694e(0x13c):_0x5b8c45[_0x1b3f7f]=_0x4e0aab(_0x21fb73[_0x56694e(0x11e)]);break;case _0x56694e(0x124):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x172)]??'1';break;case _0x56694e(0x178):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x1ac)]??'';break;case _0x56694e(0x152):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x13a)]??'';break;case'Precio\x20Venta\x20Dólares\x203':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0xfa)]??'';break;case _0x56694e(0xe5):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0xec)]??'';break;case _0x56694e(0x1ae):_0x5b8c45[_0x1b3f7f]=_0x21fb73['setItemCommissionPercentage3'];break;case _0x56694e(0x100):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x133)]==0x1?'SI':'NO';break;case'Stock\x20Actual':_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x169)]??'';break;case _0x56694e(0x150):_0x5b8c45[_0x1b3f7f]=_0x21fb73['setWarehouseStockMin']??'';break;case _0x56694e(0x144):_0x5b8c45[_0x1b3f7f]=_0x21fb73[_0x56694e(0x109)]??'';break;default:_0x5b8c45[_0x1b3f7f]='';}}),_0x5b8c45;}),_0x1b167e=0x3e8,_0x42125f=_0x59ffdc[_0x381fda(0x108)];for(let _0x3cdea1=0x0;_0x3cdea1<_0x42125f;_0x3cdea1+=_0x1b167e){const _0xa389ed=_0x59ffdc[_0x381fda(0x155)](_0x3cdea1,_0x3cdea1+_0x1b167e);XLSX[_0x381fda(0x122)]['sheet_add_json'](_0x3f27a3,_0xa389ed,{'origin':{'r':_0x3cdea1+0x2,'c':0x0},'skipHeader':!![],'header':_0x2998c4}),postMessage({'type':_0x381fda(0x1bd),'payload':{'percent':Math[_0x381fda(0x190)]((_0x3cdea1+_0xa389ed['length'])/_0x42125f*0x64),'message':_0x381fda(0x1b6)+(_0x3cdea1+0x1)+'–'+(_0x3cdea1+_0xa389ed[_0x381fda(0x108)])+_0x381fda(0x1b2)+_0x42125f}});}const _0x2aa48b={'s':{'r':0x0,'c':0x0},'e':{'r':_0x42125f+0x1,'c':_0x2998c4[_0x381fda(0x108)]-0x1}};_0x3f27a3[_0x381fda(0x184)]=XLSX['utils']['encode_range'](_0x2aa48b);const _0x146575=XLSX[_0x381fda(0x14f)](_0x16a716,{'bookType':_0x381fda(0x10e),'type':'array'});let _0x15bc06,_0x305bce;if(_0x146575 instanceof Uint8Array)_0x15bc06=_0x146575,_0x305bce=[_0x146575[_0x381fda(0x158)]];else{if(_0x146575 instanceof ArrayBuffer)_0x15bc06=new Uint8Array(_0x146575),_0x305bce=[_0x146575];else{const _0x1360c9=new Uint8Array(_0x146575);_0x15bc06=_0x1360c9,_0x305bce=[_0x1360c9['buffer']];}}postMessage({'type':_0x381fda(0x198),'payload':{'wbout':_0x15bc06,'count':_0x59ffdc[_0x381fda(0x108)]}},_0x305bce);}catch(_0x1db29c){postMessage({'type':_0x381fda(0x14e),'payload':_0x1db29c[_0x381fda(0x18d)]||String(_0x1db29c)});}return;}};