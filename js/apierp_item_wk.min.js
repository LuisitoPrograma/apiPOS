/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.1.6
*/

const _0x33414c=_0x4571;(function(_0x3277d7,_0x37750f){const _0x12b463=_0x4571,_0x5e7a04=_0x3277d7();while(!![]){try{const _0x5ef023=-parseInt(_0x12b463(0x121))/0x1*(parseInt(_0x12b463(0xa3))/0x2)+parseInt(_0x12b463(0x133))/0x3*(parseInt(_0x12b463(0x17a))/0x4)+parseInt(_0x12b463(0x113))/0x5*(-parseInt(_0x12b463(0x10d))/0x6)+-parseInt(_0x12b463(0x112))/0x7*(-parseInt(_0x12b463(0x93))/0x8)+parseInt(_0x12b463(0xf9))/0x9+-parseInt(_0x12b463(0xdc))/0xa*(parseInt(_0x12b463(0x176))/0xb)+parseInt(_0x12b463(0x102))/0xc*(parseInt(_0x12b463(0x90))/0xd);if(_0x5ef023===_0x37750f)break;else _0x5e7a04['push'](_0x5e7a04['shift']());}catch(_0x35614a){_0x5e7a04['push'](_0x5e7a04['shift']());}}}(_0x5cdf,0x6ba3b));const _0x197b2a=(function(){let _0x2e1e7e=!![];return function(_0x208f8e,_0xc7d9fa){const _0x281ab7=_0x2e1e7e?function(){if(_0xc7d9fa){const _0x898ee2=_0xc7d9fa['apply'](_0x208f8e,arguments);return _0xc7d9fa=null,_0x898ee2;}}:function(){};return _0x2e1e7e=![],_0x281ab7;};}()),_0x4338c2=_0x197b2a(this,function(){const _0x274cc0=_0x4571;return _0x4338c2[_0x274cc0(0x170)]()['search'](_0x274cc0(0xa4))[_0x274cc0(0x170)]()[_0x274cc0(0x12b)](_0x4338c2)[_0x274cc0(0x12c)](_0x274cc0(0xa4));});function _0x4571(_0x1c7394,_0x2db781){const _0x23bbf6=_0x5cdf();return _0x4571=function(_0x564d76,_0x351879){_0x564d76=_0x564d76-0x7f;let _0x3a9b5a=_0x23bbf6[_0x564d76];return _0x3a9b5a;},_0x4571(_0x1c7394,_0x2db781);}function _0x5cdf(){const _0xba2784=['LTN','USD_setMtoPrecioUnitario2','Unidad\x20de\x20Medida*','Precio\x20Venta\x20Soles','JUEGO','Precio\x20Costo\x20Dólares\x202','PEN_setMtoPrecioCostoUnitario','PIES\x20CUADRADOS','toString','done','Precio\x20Costo\x20Dólares\x203','Equivalencia\x203','GRAMO','FOT','58883VODJTM','setTaxId','setItemUnitAlias','setUnidadCodigo3','40ZUcqSO','Precio\x20Venta\x20Soles\x203','info','PAR','MWH','SACO','TAMBOR','setWarehouseStockMin','CMK','setItemBarCode2','Ubicación','setItemType','import','apply','some','trace','sheet_add_json','toLowerCase','USD_setMtoPrecioUnitario','setUnitId2','Comisión\x20Venta\x202\x20(%)','UNIDAD\x20(NIU)','Género','setBatchExpirationDate','51675RPHBHn','MILIMETRO\x20CUBICO','PIES\x20CUBICOS','570352oTKQId','MILIMETRO','DZP','Stock\x20Actual','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','CARTONES','PEN_setMtoPrecioCostoUnitario2','TNE','PEN_setMtoPrecioCostoUnitario3','exportItems:\x20products\x20no\x20es\x20Array.','Precio\x20Costo\x20Soles','number','getMonth','CAJA','BOTELLAS','Se\x20Vende','2WAiSNc','(((.+)+)+)+$','message','CENTIMETRO\x20CUADRADO','YARDA\x20CUADRADA','push','Equivalencia\x202','exportDone','{}.constructor(\x22return\x20this\x22)(\x20)','Artículo','YARDA','buffer','write','LBR','CONOS','RESMA','GRUESA','El\x20archivo\x20tiene\x20','LITRO','CENTIMETRO\x20CUBICO','PULGADAS','parse_date_code','MILLARES','MGM','getFullYear','TONELADA\x20CORTA','Precio\x20Costo\x20Soles\x203','FARDO','DOCENA\x20POR\x2010**6','MMQ','MILLON\x20DE\x20UNIDADES','UNIDAD\x20(ZZ)','setUnitId3','US\x20GALON\x20(3,7843\x20L)','METRO','CENTIMETRO\x20LINEAL','Marca','array','HECTOLITRO','PLACAS','Precio\x20Venta\x20Dólares\x202','__proto__','ONZAS','Lote','PALETAS','QUINTAL','Precio\x20Costo\x20Dólares','Nombre*','getDate','CMQ','ONZ','Servicio','MTR','TONELADAS','MMK','Alias\x202','MILIMETRO\x20CUADRADO','1140gVFUaj','prototype','USD_setMtoPrecioCostoUnitario','CILINDRO','ID\x20UNIT\x203','Se\x20Compra','Exportando\x20filas\x20','MILILITRO','KTM','KWH','INH','KILOMETRO','warn','MTQ','utils','Código\x20de\x20Barras\x202','METRO\x20CUADRADO','GRM','FTQ','KILOGRAMO','Stock\x20Mínimo','table','Impuesto*','find','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','KILOVATIO\x20HORA','Unidad\x20de\x20Medida\x203','UND\x20(NIU)','setCategoria','7636437LJCVqB','!ref','LIBRAS','decode_range','setItemUnitAlias3','setItemIsSold','MILIGRAMOS','ID\x20UNIT\x202','PEN_setMtoPrecioUnitario3','276hfnJwF','GLL','progress','setUnidadEquivalencia2','round','SheetNames','Sheets','trim','C62','DOCENA','YRD','24VOenGc','USD_setMtoPrecioCostoUnitario2','Precio\x20Venta\x20Soles\x202','Categoría','GLI','84dlgFGG','1084180BqQSNt','Código\x20de\x20Barras','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','LEF','USD_setMtoPrecioUnitario3','Modelo\x20de\x20Cuello','Código\x20de\x20Barras\x203','Tipo*','KGM','setUnidadCodigo','Comisión\x20Venta\x203\x20(%)','Fecha\x20de\x20Vencimiento','setDescripcion','BARRILES','212869OTcytp','Gravado\x20(18%)','Inafecto\x20(0%)','LATAS','MTK','SET','Iniciando\x20parseo…','MEGAWATT\x20HORA','log','setUnidadEquivalencia3','constructor','search','isArray','Gravado\x20(10%)','Gravado\x20Gratuito\x20(18%)','NIU','Gravado\x20Gratuito\x20(10%)','padStart','100770YYCzwv','HOJA','BOLSA','YDK','value','BALDE','LTR','bind','setItemBarCode','Alias\x203','setItemVariantValues','forEach','console','KIT','Código\x20SKU*','STN','setUnitId','reduce','Comisión\x20Venta\x20(%)','Precio\x20Costo\x20Soles\x202','Alias','Exonerado\x20Gratuito\x20(0%)','ID\x20UNIT','Procesadas\x20filas\x20','Precio\x20Venta\x20Dólares\x203','read','SSF','length','PIEZAS','setItemIsBought','Rastrear\x20Inventario','Precio\x20Venta\x20Dólares','exportItems','PIES','MIL','Modelo\x20de\x20Manga','DZN','Combo','PLIEGO','setItemDescription','error','map','TONELADA\x20LARGA','sheet_to_json','TUBOS','slice','METRO\x20CUBICO','setInventariable','filter','Material','setItemCommissionPercentage','PAQUETE','setMarca'];_0x5cdf=function(){return _0xba2784;};return _0x5cdf();}_0x4338c2();const _0x351879=(function(){let _0x582f6e=!![];return function(_0x5b63c1,_0x333235){const _0x47f5e1=_0x582f6e?function(){const _0x46bf0a=_0x4571;if(_0x333235){const _0x1cebce=_0x333235[_0x46bf0a(0x85)](_0x5b63c1,arguments);return _0x333235=null,_0x1cebce;}}:function(){};return _0x582f6e=![],_0x47f5e1;};}()),_0x564d76=_0x351879(this,function(){const _0x3396ba=_0x4571,_0xa8644d=function(){const _0x26435c=_0x4571;let _0x3eec10;try{_0x3eec10=Function('return\x20(function()\x20'+_0x26435c(0xab)+');')();}catch(_0x5e2fb4){_0x3eec10=window;}return _0x3eec10;},_0x4362f4=_0xa8644d(),_0x2b7145=_0x4362f4[_0x3396ba(0x13f)]=_0x4362f4['console']||{},_0x3dd227=[_0x3396ba(0x129),_0x3396ba(0xe8),_0x3396ba(0x17c),_0x3396ba(0x15b),'exception',_0x3396ba(0xf1),_0x3396ba(0x87)];for(let _0x5b49be=0x0;_0x5b49be<_0x3dd227[_0x3396ba(0x14e)];_0x5b49be++){const _0x3fe9e3=_0x351879[_0x3396ba(0x12b)][_0x3396ba(0xdd)][_0x3396ba(0x13a)](_0x351879),_0x4a7f84=_0x3dd227[_0x5b49be],_0x1aa440=_0x2b7145[_0x4a7f84]||_0x3fe9e3;_0x3fe9e3[_0x3396ba(0xcc)]=_0x351879[_0x3396ba(0x13a)](_0x351879),_0x3fe9e3[_0x3396ba(0x170)]=_0x1aa440[_0x3396ba(0x170)]['bind'](_0x1aa440),_0x2b7145[_0x4a7f84]=_0x3fe9e3;}});_0x564d76(),importScripts(_0x33414c(0xf4)),onmessage=({data:_0x3edb7d})=>{const _0x11d23d=_0x33414c,{action:_0x3c4932}=_0x3edb7d;if(_0x3c4932===_0x11d23d(0x84)){const {buf:_0x45632d,maxRows:_0x2ffab4}=_0x3edb7d;try{postMessage({'type':'progress','payload':{'percent':0x5,'message':_0x11d23d(0x127)}});const _0x46118b=XLSX[_0x11d23d(0x14c)](_0x45632d,{'type':_0x11d23d(0xc8),'cellDates':!![]}),_0x2d5a95=_0x46118b[_0x11d23d(0x108)][_0x46118b[_0x11d23d(0x107)][0x0]],_0x6c1835=XLSX[_0x11d23d(0xea)][_0x11d23d(0x15e)](_0x2d5a95,{'defval':'','range':0x1,'cellDates':!![]}),_0x550c92=_0x6c1835['findIndex'](_0x295940=>(!_0x295940['Tipo*']||String(_0x295940[_0x11d23d(0x11a)])[_0x11d23d(0x109)]()==='')&&(!_0x295940[_0x11d23d(0x141)]||String(_0x295940['Código\x20SKU*'])['trim']()==='')&&(!_0x295940[_0x11d23d(0xd2)]||String(_0x295940[_0x11d23d(0xd2)])[_0x11d23d(0x109)]()==='')&&(!_0x295940['Unidad\x20de\x20Medida*']||String(_0x295940[_0x11d23d(0x16a)])[_0x11d23d(0x109)]()==='')),_0x1121a6=_0x550c92>=0x0?_0x6c1835[_0x11d23d(0x160)](0x0,_0x550c92):_0x6c1835,_0x2a3b6d=_0x1121a6[_0x11d23d(0x163)](_0x4daa7c=>_0x4daa7c['Tipo*']&&String(_0x4daa7c[_0x11d23d(0x11a)])['trim']()!==''&&_0x4daa7c[_0x11d23d(0x141)]&&String(_0x4daa7c[_0x11d23d(0x141)])[_0x11d23d(0x109)]()!==''&&_0x4daa7c[_0x11d23d(0xd2)]&&String(_0x4daa7c['Nombre*'])['trim']()!==''&&_0x4daa7c[_0x11d23d(0x16a)]&&String(_0x4daa7c['Unidad\x20de\x20Medida*'])[_0x11d23d(0x109)]()!==''),_0x4925d1=_0x2a3b6d['length'];if(_0x4925d1===0x0){postMessage({'type':'error','payload':'No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).'});return;}if(_0x4925d1>_0x2ffab4)throw _0x11d23d(0xb4)+_0x4925d1+_0x11d23d(0x97)+_0x2ffab4+'.';const _0x4a28ec=0x1f4,_0x2f39b0=[],_0x3dcb25=[{'codigo':'4A','nombre':'BOBINAS'},{'codigo':'BJ','nombre':_0x11d23d(0x138)},{'codigo':'BLL','nombre':_0x11d23d(0x120)},{'codigo':'BG','nombre':'BOLSA'},{'codigo':'BO','nombre':_0x11d23d(0xa1)},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':'CARTONES'},{'codigo':_0x11d23d(0x80),'nombre':_0x11d23d(0xa6)},{'codigo':_0x11d23d(0xd4),'nombre':_0x11d23d(0xb6)},{'codigo':'CMT','nombre':_0x11d23d(0xc6)},{'codigo':'CEN','nombre':'CIENTO\x20DE\x20UNIDADES'},{'codigo':'CY','nombre':'CILINDRO'},{'codigo':'CJ','nombre':_0x11d23d(0xb1)},{'codigo':_0x11d23d(0x157),'nombre':_0x11d23d(0x10b)},{'codigo':_0x11d23d(0x95),'nombre':_0x11d23d(0xbf)},{'codigo':'BE','nombre':_0x11d23d(0xbe)},{'codigo':_0x11d23d(0x111),'nombre':'GALON\x20INGLES\x20(4,545956L)'},{'codigo':_0x11d23d(0xed),'nombre':_0x11d23d(0x174)},{'codigo':'GRO','nombre':_0x11d23d(0xb3)},{'codigo':'HLT','nombre':'HECTOLITRO'},{'codigo':_0x11d23d(0x116),'nombre':_0x11d23d(0x134)},{'codigo':_0x11d23d(0x126),'nombre':'JUEGO'},{'codigo':_0x11d23d(0x11b),'nombre':_0x11d23d(0xef)},{'codigo':_0x11d23d(0xe4),'nombre':_0x11d23d(0xe7)},{'codigo':_0x11d23d(0xe5),'nombre':_0x11d23d(0xf5)},{'codigo':'KT','nombre':'KIT'},{'codigo':'CA','nombre':'LATAS'},{'codigo':_0x11d23d(0xb0),'nombre':'LIBRAS'},{'codigo':_0x11d23d(0x139),'nombre':_0x11d23d(0xb5)},{'codigo':_0x11d23d(0x17e),'nombre':_0x11d23d(0x128)},{'codigo':_0x11d23d(0xd7),'nombre':'METRO'},{'codigo':_0x11d23d(0x125),'nombre':'METRO\x20CUADRADO'},{'codigo':_0x11d23d(0xe9),'nombre':_0x11d23d(0x161)},{'codigo':_0x11d23d(0xba),'nombre':_0x11d23d(0xff)},{'codigo':'MLT','nombre':'MILILITRO'},{'codigo':'MMT','nombre':_0x11d23d(0x94)},{'codigo':_0x11d23d(0xd9),'nombre':_0x11d23d(0xdb)},{'codigo':_0x11d23d(0xc0),'nombre':_0x11d23d(0x91)},{'codigo':_0x11d23d(0x155),'nombre':_0x11d23d(0xb9)},{'codigo':'UM','nombre':_0x11d23d(0xc1)},{'codigo':_0x11d23d(0xd5),'nombre':_0x11d23d(0xcd)},{'codigo':'PF','nombre':_0x11d23d(0xcf)},{'codigo':'PK','nombre':_0x11d23d(0x166)},{'codigo':'PR','nombre':_0x11d23d(0x17d)},{'codigo':_0x11d23d(0x175),'nombre':_0x11d23d(0x154)},{'codigo':'FTK','nombre':'PIES\x20CUADRADOS'},{'codigo':_0x11d23d(0xee),'nombre':_0x11d23d(0x92)},{'codigo':_0x11d23d(0x10a),'nombre':_0x11d23d(0x14f)},{'codigo':'PG','nombre':_0x11d23d(0xca)},{'codigo':'ST','nombre':_0x11d23d(0x159)},{'codigo':_0x11d23d(0xe6),'nombre':'PULGADAS'},{'codigo':'RM','nombre':_0x11d23d(0xb2)},{'codigo':'SA','nombre':'SACO'},{'codigo':'DR','nombre':_0x11d23d(0x180)},{'codigo':_0x11d23d(0x142),'nombre':_0x11d23d(0xbc)},{'codigo':_0x11d23d(0x168),'nombre':_0x11d23d(0x15d)},{'codigo':_0x11d23d(0x9a),'nombre':'TONELADAS'},{'codigo':'TU','nombre':_0x11d23d(0x15f)},{'codigo':_0x11d23d(0x130),'nombre':_0x11d23d(0x8d)},{'codigo':'ZZ','nombre':_0x11d23d(0xc2)},{'codigo':_0x11d23d(0x103),'nombre':_0x11d23d(0xc4)},{'codigo':_0x11d23d(0x10c),'nombre':_0x11d23d(0xad)},{'codigo':_0x11d23d(0x136),'nombre':_0x11d23d(0xa7)},{'codigo':'QQM','nombre':_0x11d23d(0xd0)}],_0x31243a=_0x3dcb25[_0x11d23d(0x144)]((_0x328f3d,{nombre:_0x46b1f4,codigo:_0x4b0ce6})=>{const _0x240f98=_0x11d23d;return _0x328f3d[_0x46b1f4['trim']()]=_0x4b0ce6[_0x240f98(0x109)](),_0x328f3d;},{});for(let _0x58869c=0x0;_0x58869c<_0x4925d1;_0x58869c+=_0x4a28ec){const _0x3888bd=_0x2a3b6d[_0x11d23d(0x160)](_0x58869c,_0x58869c+_0x4a28ec)[_0x11d23d(0x15c)]((_0x180086,_0x870f83)=>{const _0x5d33e1=_0x11d23d;let _0x21dac9={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x180086[_0x5d33e1(0x11a)]]||'1';const _0x23e89f=String(_0x180086[_0x5d33e1(0xf2)])[_0x5d33e1(0x109)](),_0x2e2051={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x4bc06f=_0x2e2051[_0x23e89f]||'1',_0x5dfe79={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x4bc06f]||{'code':'10','value':0x12},_0x2a0db5={};let _0x5de1a5=String(_0x180086[_0x5d33e1(0xd2)])[_0x5d33e1(0x109)]();const _0x5767ae=[_0x5d33e1(0xce),'Talla','Color',_0x5d33e1(0x8e),'Modelo','Serie',_0x5d33e1(0x164),_0x5d33e1(0x118),_0x5d33e1(0x156)];_0x5767ae['forEach'](_0x160fe8=>{const _0x2154d5=_0x5d33e1,_0x316415=String(_0x180086[_0x160fe8]||'')[_0x2154d5(0x109)]();_0x316415&&(_0x2a0db5[_0x160fe8]=_0x316415,_0x5de1a5+='\x20'+_0x160fe8+'\x20'+_0x316415);});const _0x28459d=[],_0x481077=String(_0x180086[_0x5d33e1(0x16a)]||_0x5d33e1(0x8d))[_0x5d33e1(0x109)](),_0x3b9580=_0x31243a[_0x481077]||_0x5d33e1(0x130),_0x5ed26e=String(_0x180086[_0x5d33e1(0x147)])[_0x5d33e1(0x109)]();_0x28459d[_0x5d33e1(0xa8)]({'setItemUnitId':String(_0x180086[_0x5d33e1(0x149)])[_0x5d33e1(0x109)]()||'','setItemBarCode':String(_0x180086[_0x5d33e1(0x114)])[_0x5d33e1(0x109)]()||'','setAlias':_0x5ed26e,'setUnitCode':_0x3b9580,'setPrice':parseFloat(_0x180086[_0x5d33e1(0x16b)]),'setCost':parseFloat(_0x180086[_0x5d33e1(0x9d)]),'setPriceUSD':parseFloat(_0x180086['Precio\x20Venta\x20Dólares']),'setCostUSD':parseFloat(_0x180086[_0x5d33e1(0xd1)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x180086[_0x5d33e1(0x145)])});const _0x324982=['ID\x20UNIT\x202',_0x5d33e1(0xda),_0x5d33e1(0xeb),_0x5d33e1(0xa9),'Precio\x20Venta\x20Soles\x202',_0x5d33e1(0x146),_0x5d33e1(0xcb),_0x5d33e1(0x16d)][_0x5d33e1(0x86)](_0x4d4a33=>{const _0x136498=_0x180086[_0x4d4a33];return _0x136498!=null&&String(_0x136498)['trim']()!=='';});if(_0x324982){const _0x527094=String(_0x180086['Unidad\x20de\x20Medida\x202']||_0x5d33e1(0xf7))[_0x5d33e1(0x109)](),_0x40085e=_0x31243a[_0x527094]||'NIU';_0x28459d['push']({'setItemUnitId':String(_0x180086[_0x5d33e1(0x100)])[_0x5d33e1(0x109)]()||'','setItemBarCode':String(_0x180086[_0x5d33e1(0xeb)])[_0x5d33e1(0x109)]()||'','setAlias':String(_0x180086['Alias\x202'])[_0x5d33e1(0x109)](),'setUnitCode':_0x40085e,'setPrice':parseFloat(_0x180086[_0x5d33e1(0x10f)]),'setCost':parseFloat(_0x180086[_0x5d33e1(0x146)]),'setPriceUSD':parseFloat(_0x180086['Precio\x20Venta\x20Dólares\x202']),'setCostUSD':parseFloat(_0x180086[_0x5d33e1(0x16d)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x180086['Equivalencia\x202'])||0x1,'setFactor':parseFloat(_0x180086[_0x5d33e1(0xa9)])||0x1,'setItemCommissionPercentage':parseFloat(_0x180086[_0x5d33e1(0x8c)])});}const _0x263d91=[_0x5d33e1(0xe0),_0x5d33e1(0x13c),_0x5d33e1(0x119),_0x5d33e1(0x173),_0x5d33e1(0x17b),_0x5d33e1(0xbd),_0x5d33e1(0x14b),_0x5d33e1(0x172)][_0x5d33e1(0x86)](_0x4ca3ec=>{const _0x15cd88=_0x5d33e1,_0x14c4c2=_0x180086[_0x4ca3ec];return _0x14c4c2!=null&&String(_0x14c4c2)[_0x15cd88(0x109)]()!=='';});if(_0x263d91){const _0x981623=String(_0x180086[_0x5d33e1(0xf6)]||_0x5d33e1(0xf7))[_0x5d33e1(0x109)](),_0x208c4c=_0x31243a[_0x981623]||_0x5d33e1(0x130);_0x28459d[_0x5d33e1(0xa8)]({'setItemUnitId':String(_0x180086['ID\x20UNIT\x203'])['trim']()||'','setItemBarCode':String(_0x180086[_0x5d33e1(0x119)])[_0x5d33e1(0x109)]()||'','setAlias':String(_0x180086[_0x5d33e1(0x13c)])['trim'](),'setUnitCode':_0x208c4c,'setPrice':parseFloat(_0x180086[_0x5d33e1(0x17b)]),'setCost':parseFloat(_0x180086[_0x5d33e1(0xbd)]),'setPriceUSD':parseFloat(_0x180086[_0x5d33e1(0x14b)]),'setCostUSD':parseFloat(_0x180086[_0x5d33e1(0x172)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x180086[_0x5d33e1(0x173)])||0x1,'setFactor':parseFloat(_0x180086[_0x5d33e1(0x173)])||0x1,'setItemCommissionPercentage':parseFloat(_0x180086[_0x5d33e1(0x11d)])});}let _0x418bed=_0x180086[_0x5d33e1(0x11e)],_0x4d5185='';if(_0x418bed instanceof Date){const _0x2da09e=_0x418bed[_0x5d33e1(0xbb)](),_0x310bd0=String(_0x418bed[_0x5d33e1(0x9f)]()+0x1)[_0x5d33e1(0x132)](0x2,'0'),_0x423741=String(_0x418bed[_0x5d33e1(0xd3)]())[_0x5d33e1(0x132)](0x2,'0');_0x4d5185=_0x2da09e+'-'+_0x310bd0+'-'+_0x423741;}else{if(typeof _0x418bed===_0x5d33e1(0x9e)){const _0x5830dd=XLSX[_0x5d33e1(0x14d)][_0x5d33e1(0xb8)](_0x418bed);if(_0x5830dd){const _0x5563c4=_0x5830dd['y'],_0x477049=String(_0x5830dd['m'])['padStart'](0x2,'0'),_0x2637f2=String(_0x5830dd['d'])[_0x5d33e1(0x132)](0x2,'0');_0x4d5185=_0x5563c4+'-'+_0x477049+'-'+_0x2637f2;}}else _0x4d5185=String(_0x418bed||'')[_0x5d33e1(0x109)]();}return{'setItemId':String(_0x180086['ID'])[_0x5d33e1(0x109)](),'setItemType':_0x21dac9,'setItemCode':String(_0x180086[_0x5d33e1(0x141)])['trim'](),'setItemName':String(_0x180086[_0x5d33e1(0xd2)])[_0x5d33e1(0x109)](),'setItemDescription':String(_0x180086['Descripción'])[_0x5d33e1(0x109)]()||'','setItemIsSold':_0x180086[_0x5d33e1(0xa2)]=='SI'?0x1:0x0,'setItemIsBought':_0x180086['Se\x20Compra']=='SI'?0x1:0x0,'setItemCategories':_0x180086['Categoría']?[String(_0x180086[_0x5d33e1(0x110)])['trim']()]:[],'setItemBrands':_0x180086[_0x5d33e1(0xc7)]?[String(_0x180086['Marca'])[_0x5d33e1(0x109)]()]:[],'setItemTaxId':_0x4bc06f,'setItemTaxCode':_0x5dfe79['code'],'setItemTaxValue':_0x5dfe79[_0x5d33e1(0x137)],'setItemUnits':_0x28459d,'setItemInventoriable':_0x180086[_0x5d33e1(0x151)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x180086[_0x5d33e1(0x96)])||0x0,'setStockMinimum':parseFloat(_0x180086[_0x5d33e1(0xf0)])||0x0,'setItemLocation':String(_0x180086[_0x5d33e1(0x82)])[_0x5d33e1(0x109)]()||'','setBatchName':String(_0x180086[_0x5d33e1(0xce)])[_0x5d33e1(0x109)]()||'','setItemDateExpiry':_0x4d5185,'setItemVariantName':_0x5de1a5,'setItemVariantValues':_0x2a0db5,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x2f39b0[_0x11d23d(0xa8)](..._0x3888bd),postMessage({'type':'progress','payload':{'percent':Math['round']((_0x58869c+_0x3888bd['length'])/_0x4925d1*0x64),'message':_0x11d23d(0x14a)+(_0x58869c+0x1)+'–'+(_0x58869c+_0x3888bd[_0x11d23d(0x14e)])+'/'+_0x4925d1}});}postMessage({'type':_0x11d23d(0x171),'payload':{'items':_0x2f39b0}});}catch(_0x3fc4db){postMessage({'type':'error','payload':_0x3fc4db[_0x11d23d(0xa5)]||_0x3fc4db});}}if(_0x3c4932===_0x11d23d(0x153)){const {products:_0x250102,plantillaBuf:_0x4d04f3}=_0x3edb7d;if(!(_0x4d04f3 instanceof ArrayBuffer)){postMessage({'type':_0x11d23d(0x15b),'payload':_0x11d23d(0x115)});return;}if(!Array[_0x11d23d(0x12d)](_0x250102)){postMessage({'type':'error','payload':_0x11d23d(0x9c)});return;}try{structuredClone(_0x250102);}catch(_0x2109d6){postMessage({'type':_0x11d23d(0x15b),'payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x2109d6[_0x11d23d(0xa5)]});return;}try{const _0x2b3dfe={'1':_0x11d23d(0xac),'2':_0x11d23d(0xd6),'3':'Materia\x20Prima','4':_0x11d23d(0x158),'5':'Fabricado'};function _0x532f27(_0x10d0b3){const _0x4a1868=_0x11d23d;return _0x2b3dfe[String(_0x10d0b3)]||_0x4a1868(0xac);}const _0x143051={'1':_0x11d23d(0x122),'2':'Exonerado\x20(0%)','3':_0x11d23d(0x123),'4':_0x11d23d(0x12f),'5':'Inafecto\x20Gratuito\x20(0%)','6':_0x11d23d(0x12e),'7':_0x11d23d(0x148),'8':'Exportación\x20(0%)','9':_0x11d23d(0x131)};function _0x38edd6(_0x59b34a){return _0x143051[String(_0x59b34a)]||'Gravado\x20(18%)';}const _0x453a1c={'4A':'BOBINAS','BJ':_0x11d23d(0x138),'BLL':_0x11d23d(0x120),'BG':_0x11d23d(0x135),'BO':_0x11d23d(0xa1),'BX':_0x11d23d(0xa0),'CT':_0x11d23d(0x98),'CMK':'CENTIMETRO\x20CUADRADO','CMQ':_0x11d23d(0xb6),'CMT':_0x11d23d(0xc6),'CEN':'CIENTO\x20DE\x20UNIDADES','CY':_0x11d23d(0xdf),'CJ':_0x11d23d(0xb1),'DZN':_0x11d23d(0x10b),'DZP':_0x11d23d(0xbf),'BE':_0x11d23d(0xbe),'GLI':'GALON\x20INGLES\x20(4,545956L)','GRM':_0x11d23d(0x174),'GRO':_0x11d23d(0xb3),'HLT':_0x11d23d(0xc9),'LEF':_0x11d23d(0x134),'SET':_0x11d23d(0x16c),'KGM':_0x11d23d(0xef),'KTM':_0x11d23d(0xe7),'KWH':_0x11d23d(0xf5),'KT':_0x11d23d(0x140),'CA':_0x11d23d(0x124),'LBR':_0x11d23d(0xfb),'LTR':_0x11d23d(0xb5),'MWH':_0x11d23d(0x128),'MTR':_0x11d23d(0xc5),'MTK':_0x11d23d(0xec),'MTQ':_0x11d23d(0x161),'MGM':'MILIGRAMOS','MLT':_0x11d23d(0xe3),'MMT':_0x11d23d(0x94),'MMK':_0x11d23d(0xdb),'MMQ':_0x11d23d(0x91),'MIL':_0x11d23d(0xb9),'UM':_0x11d23d(0xc1),'ONZ':_0x11d23d(0xcd),'PF':_0x11d23d(0xcf),'PK':'PAQUETE','PR':_0x11d23d(0x17d),'FOT':'PIES','FTK':_0x11d23d(0x16f),'FTQ':_0x11d23d(0x92),'C62':_0x11d23d(0x14f),'PG':_0x11d23d(0xca),'ST':_0x11d23d(0x159),'INH':_0x11d23d(0xb7),'RM':_0x11d23d(0xb2),'SA':_0x11d23d(0x17f),'DR':_0x11d23d(0x180),'STN':'TONELADA\x20CORTA','LTN':'TONELADA\x20LARGA','TNE':_0x11d23d(0xd8),'TU':'TUBOS','NIU':_0x11d23d(0x8d),'ZZ':_0x11d23d(0xc2),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':_0x11d23d(0xad),'YDK':_0x11d23d(0xa7),'QQM':_0x11d23d(0xd0)};function _0x5a83f1(_0x2801b3){return _0x453a1c[String(_0x2801b3)]||'';}const _0x52a98d=XLSX[_0x11d23d(0x14c)](_0x4d04f3,{'type':_0x11d23d(0xc8),'cellDates':!![]}),_0xb95ef1=_0x52a98d[_0x11d23d(0x107)][0x0],_0x50d03e=_0x52a98d[_0x11d23d(0x108)][_0xb95ef1],_0x5b5e8a=XLSX[_0x11d23d(0xea)]['sheet_to_json'](_0x50d03e,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x718b2e=XLSX[_0x11d23d(0xea)][_0x11d23d(0xfc)](_0x50d03e[_0x11d23d(0xfa)]||'');for(let _0x49a69c=0x2;_0x49a69c<=_0x718b2e['e']['r'];++_0x49a69c){for(let _0x127143=_0x718b2e['s']['c'];_0x127143<=_0x718b2e['e']['c'];++_0x127143){const _0x14cf43=XLSX[_0x11d23d(0xea)]['encode_cell']({'r':_0x49a69c,'c':_0x127143});if(_0x50d03e[_0x14cf43])delete _0x50d03e[_0x14cf43];}}const _0x2735e2=_0x250102[_0x11d23d(0x15c)](_0x3665bf=>{const _0x51a3dc=_0x11d23d;_0x3665bf[_0x51a3dc(0x13d)]=_0x3665bf[_0x51a3dc(0x13d)]||{};const _0xbc0376={};return _0x5b5e8a[_0x51a3dc(0x13e)](_0x5f3407=>{const _0x3570d3=_0x51a3dc,_0xbcc542=String(_0x5f3407)[_0x3570d3(0x109)](),_0x2fe837=_0xbcc542[_0x3570d3(0x89)](),_0xcd95e=Object['keys'](_0x3665bf)[_0x3570d3(0xf3)](_0x58af32=>_0x58af32[_0x3570d3(0x109)]()['toLowerCase']()===_0x2fe837);if(_0xcd95e){_0xbc0376[_0xbcc542]=_0x3665bf[_0xcd95e]??'';return;}switch(_0xbcc542){case'ID':_0xbc0376[_0xbcc542]=_0x3665bf['id']??'';break;case _0x3570d3(0x11a):_0xbc0376[_0xbcc542]=_0x532f27(_0x3665bf[_0x3570d3(0x83)]);break;case _0x3570d3(0x141):_0xbc0376[_0xbcc542]=_0x3665bf['setCodProducto']??'';break;case _0x3570d3(0xd2):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x11f)]??'';break;case'Descripción':_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x15a)]??'';break;case'Se\x20Vende':_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0xfe)]==0x1?'SI':'NO';break;case _0x3570d3(0xe1):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x150)]==0x1?'SI':'NO';break;case _0x3570d3(0x110):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0xf8)]??'';break;case _0x3570d3(0xc7):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x167)]??'';break;case'Impuesto*':_0xbc0376[_0xbcc542]=_0x38edd6(_0x3665bf[_0x3570d3(0x177)]);break;case _0x3570d3(0x149):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x143)]??'';break;case'Alias':_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x178)]??'';break;case _0x3570d3(0x114):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x13b)]??'';break;case _0x3570d3(0x16a):_0xbc0376[_0xbcc542]=_0x5a83f1(_0x3665bf[_0x3570d3(0x11c)]);break;case'Precio\x20Venta\x20Soles':_0xbc0376[_0xbcc542]=_0x3665bf['PEN_setMtoPrecioUnitario']??'';break;case _0x3570d3(0x9d):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x16e)]??'';break;case _0x3570d3(0x152):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x8a)]??'';break;case _0x3570d3(0xd1):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0xde)]??'';break;case _0x3570d3(0x145):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x165)];break;case'ID\x20UNIT\x202':_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x8b)]??'';break;case _0x3570d3(0xda):_0xbc0376[_0xbcc542]=_0x3665bf['setItemUnitAlias2']??'';break;case _0x3570d3(0xeb):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x81)]??'';break;case'Unidad\x20de\x20Medida\x202':_0xbc0376[_0xbcc542]=_0x5a83f1(_0x3665bf['setUnidadCodigo2']);break;case _0x3570d3(0xa9):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x105)]??'1';break;case'Precio\x20Venta\x20Soles\x202':_0xbc0376[_0xbcc542]=_0x3665bf['PEN_setMtoPrecioUnitario2']??'';break;case _0x3570d3(0x146):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x99)]??'';break;case _0x3570d3(0xcb):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x169)]??'';break;case _0x3570d3(0x16d):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x10e)]??'';break;case _0x3570d3(0x8c):_0xbc0376[_0xbcc542]=_0x3665bf['setItemCommissionPercentage2'];break;case _0x3570d3(0xe0):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0xc3)]??'';break;case _0x3570d3(0x13c):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0xfd)]??'';break;case _0x3570d3(0x119):_0xbc0376[_0xbcc542]=_0x3665bf['setItemBarCode3']??'';break;case _0x3570d3(0xf6):_0xbc0376[_0xbcc542]=_0x5a83f1(_0x3665bf[_0x3570d3(0x179)]);break;case _0x3570d3(0x173):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x12a)]??'1';break;case _0x3570d3(0x17b):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x101)]??'';break;case _0x3570d3(0xbd):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x9b)]??'';break;case _0x3570d3(0x14b):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x117)]??'';break;case _0x3570d3(0x172):_0xbc0376[_0xbcc542]=_0x3665bf['USD_setMtoPrecioCostoUnitario3']??'';break;case _0x3570d3(0x11d):_0xbc0376[_0xbcc542]=_0x3665bf['setItemCommissionPercentage3'];break;case'Rastrear\x20Inventario':_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x162)]==0x1?'SI':'NO';break;case _0x3570d3(0x96):_0xbc0376[_0xbcc542]=_0x3665bf['setSucursalStock']??'';break;case _0x3570d3(0xf0):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x7f)]??'';break;case _0x3570d3(0x11e):_0xbc0376[_0xbcc542]=_0x3665bf[_0x3570d3(0x8f)]??'';break;default:_0xbc0376[_0xbcc542]='';}}),_0xbc0376;}),_0x252297=0x3e8,_0x292fd7=_0x2735e2[_0x11d23d(0x14e)];for(let _0x9d53=0x0;_0x9d53<_0x292fd7;_0x9d53+=_0x252297){const _0x52bfbd=_0x2735e2[_0x11d23d(0x160)](_0x9d53,_0x9d53+_0x252297);XLSX[_0x11d23d(0xea)][_0x11d23d(0x88)](_0x50d03e,_0x52bfbd,{'origin':{'r':_0x9d53+0x2,'c':0x0},'skipHeader':!![],'header':_0x5b5e8a}),postMessage({'type':_0x11d23d(0x104),'payload':{'percent':Math[_0x11d23d(0x106)]((_0x9d53+_0x52bfbd[_0x11d23d(0x14e)])/_0x292fd7*0x64),'message':_0x11d23d(0xe2)+(_0x9d53+0x1)+'–'+(_0x9d53+_0x52bfbd['length'])+'\x20de\x20'+_0x292fd7}});}const _0x2ea6f4={'s':{'r':0x0,'c':0x0},'e':{'r':_0x292fd7+0x1,'c':_0x5b5e8a['length']-0x1}};_0x50d03e[_0x11d23d(0xfa)]=XLSX['utils']['encode_range'](_0x2ea6f4);const _0x1e50ce=XLSX[_0x11d23d(0xaf)](_0x52a98d,{'bookType':'xlsx','type':_0x11d23d(0xc8)});let _0x3caf82,_0x2842c1;if(_0x1e50ce instanceof Uint8Array)_0x3caf82=_0x1e50ce,_0x2842c1=[_0x1e50ce[_0x11d23d(0xae)]];else{if(_0x1e50ce instanceof ArrayBuffer)_0x3caf82=new Uint8Array(_0x1e50ce),_0x2842c1=[_0x1e50ce];else{const _0xad7c1a=new Uint8Array(_0x1e50ce);_0x3caf82=_0xad7c1a,_0x2842c1=[_0xad7c1a[_0x11d23d(0xae)]];}}postMessage({'type':_0x11d23d(0xaa),'payload':{'wbout':_0x3caf82,'count':_0x2735e2['length']}},_0x2842c1);}catch(_0x4671){postMessage({'type':_0x11d23d(0x15b),'payload':_0x4671[_0x11d23d(0xa5)]||String(_0x4671)});}return;}};