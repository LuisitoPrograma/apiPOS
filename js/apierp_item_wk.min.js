/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.0.0
*/

const _0x324673=_0x2fac;(function(_0x4d79a7,_0x5bb474){const _0x546a03=_0x2fac,_0x7cf779=_0x4d79a7();while(!![]){try{const _0x654691=-parseInt(_0x546a03(0x119))/0x1*(-parseInt(_0x546a03(0xa1))/0x2)+parseInt(_0x546a03(0x15b))/0x3*(-parseInt(_0x546a03(0x121))/0x4)+-parseInt(_0x546a03(0xf4))/0x5+parseInt(_0x546a03(0xd5))/0x6*(parseInt(_0x546a03(0x15f))/0x7)+-parseInt(_0x546a03(0x120))/0x8+-parseInt(_0x546a03(0x156))/0x9+parseInt(_0x546a03(0x114))/0xa;if(_0x654691===_0x5bb474)break;else _0x7cf779['push'](_0x7cf779['shift']());}catch(_0x1bf10d){_0x7cf779['push'](_0x7cf779['shift']());}}}(_0x2efb,0x6cb2c));const _0x267c91=(function(){let _0x506c12=!![];return function(_0x4329f3,_0x569e57){const _0x4acc51=_0x506c12?function(){const _0x1a4c59=_0x2fac;if(_0x569e57){const _0x5bb3d2=_0x569e57[_0x1a4c59(0xb8)](_0x4329f3,arguments);return _0x569e57=null,_0x5bb3d2;}}:function(){};return _0x506c12=![],_0x4acc51;};}()),_0x722948=_0x267c91(this,function(){const _0x4c7510=_0x2fac;return _0x722948[_0x4c7510(0x11d)]()[_0x4c7510(0x100)](_0x4c7510(0x8d))['toString']()[_0x4c7510(0x126)](_0x722948)[_0x4c7510(0x100)](_0x4c7510(0x8d));});_0x722948();const _0x867425=(function(){let _0x339024=!![];return function(_0x2dd698,_0x24e3c3){const _0x5fff18=_0x339024?function(){if(_0x24e3c3){const _0x170d8f=_0x24e3c3['apply'](_0x2dd698,arguments);return _0x24e3c3=null,_0x170d8f;}}:function(){};return _0x339024=![],_0x5fff18;};}()),_0x813ea5=_0x867425(this,function(){const _0x32ecc2=_0x2fac,_0x48db14=function(){const _0x3bfe7d=_0x2fac;let _0x4b1328;try{_0x4b1328=Function(_0x3bfe7d(0xaa)+_0x3bfe7d(0x14a)+');')();}catch(_0x1ee52a){_0x4b1328=window;}return _0x4b1328;},_0x24c3f3=_0x48db14(),_0x15c8ed=_0x24c3f3['console']=_0x24c3f3[_0x32ecc2(0x12c)]||{},_0x3138b3=[_0x32ecc2(0x177),_0x32ecc2(0xdb),'info',_0x32ecc2(0xf5),_0x32ecc2(0x89),'table',_0x32ecc2(0xe5)];for(let _0x274594=0x0;_0x274594<_0x3138b3[_0x32ecc2(0xb5)];_0x274594++){const _0x4ab93a=_0x867425[_0x32ecc2(0x126)][_0x32ecc2(0x123)]['bind'](_0x867425),_0x1742dd=_0x3138b3[_0x274594],_0x1851eb=_0x15c8ed[_0x1742dd]||_0x4ab93a;_0x4ab93a[_0x32ecc2(0x178)]=_0x867425[_0x32ecc2(0xee)](_0x867425),_0x4ab93a[_0x32ecc2(0x11d)]=_0x1851eb['toString']['bind'](_0x1851eb),_0x15c8ed[_0x1742dd]=_0x4ab93a;}});function _0x2efb(){const _0x22def0=['LITRO','padStart','{}.constructor(\x22return\x20this\x22)(\x20)','MILILITRO','BALDE','Unidad\x20de\x20Medida\x202','CEN','TONELADAS','isArray','Rastrear\x20Inventario','CONOS','code','ID\x20UNIT\x202','USD_setMtoPrecioUnitario','6530814VfmFvj','MMQ','Alias\x202','Precio\x20Costo\x20Soles','LTN','15069ixicOw','UNIDAD\x20(ZZ)','TONELADA\x20LARGA','Material','7XWAVvH','Equivalencia\x202','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','METRO','progress','!ref','MILIGRAMOS','DOCENA\x20POR\x2010**6','message','MWH','DZP','import','RESMA','PIES\x20CUADRADOS','Gravado\x20Gratuito\x20(18%)','map','KIT','KGM','KWH','getDate','PEN_setMtoPrecioCostoUnitario','PEN_setMtoPrecioCostoUnitario3','HOJA','MIL','log','__proto__','trim','CENTIMETRO\x20CUBICO','UNIDAD\x20(NIU)','value','MILLARES','Nombre*','Marca','some','PLACAS','setItemUnitAlias3','setUnidadCodigo','Se\x20Vende','US\x20GALON\x20(3,7843\x20L)','array','setItemCommissionPercentage2','exception','Unidad\x20de\x20Medida*','Precio\x20Venta\x20Dólares\x203','METRO\x20CUADRADO','(((.+)+)+)+$','KTM','Color','keys','write','round','TUBOS','PAQUETE','setItemBarCode3','PEN_setMtoPrecioUnitario','Precio\x20Venta\x20Soles\x203','Fabricado','push','setItemUnitAlias2','Código\x20de\x20Barras\x202','Exonerado\x20Gratuito\x20(0%)','Gravado\x20(18%)','Tipo*','Comisión\x20Venta\x202\x20(%)','Alias','146IFtGQY','setMarca','BOLSA','Iniciando\x20parseo…','MMK','GLI','filter','setCodProducto','ONZAS','return\x20(function()\x20','JUEGO','TAMBOR','TONELADA\x20CORTA','setItemVariantValues','Comisión\x20Venta\x20(%)','Precio\x20Venta\x20Dólares\x202','GALON\x20INGLES\x20(4,545956L)','Se\x20Compra','NIU','Género','length','exportDone','getFullYear','apply','ID\x20UNIT\x203','Lote','Categoría','Stock\x20Mínimo','decode_range','Exportando\x20filas\x20','GRUESA','PEN_setMtoPrecioUnitario2','getMonth','Modelo','setUnitId3','setTaxId','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','Unidad\x20de\x20Medida\x203','CMT','STN','GRAMO','PIES','setDescripcion','Gravado\x20(10%)','setItemCommissionPercentage','USD_setMtoPrecioCostoUnitario','PEN_setMtoPrecioUnitario3','CENTIMETRO\x20LINEAL','read','CMK','YRD','METRO\x20CUBICO','4489788lqBiqj','toLowerCase','Sheets','PALETAS','number','sheet_to_json','warn','Precio\x20Costo\x20Soles\x202','CAJA','C62','Artículo','setWarehouseStockMin','findIndex','BOBINAS','MILIMETRO\x20CUBICO','MEGAWATT\x20HORA','trace','Precio\x20Venta\x20Soles\x202','YDK','Descripción','Gravado\x20Gratuito\x20(10%)','forEach','FTK','Código\x20de\x20Barras','Precio\x20Costo\x20Dólares\x203','bind','Alias\x203','Ubicación','sheet_add_json','USD_setMtoPrecioUnitario2','LIBRAS','3337220wSlIrR','error','setUnitId2','find','setUnidadCodigo2','exportItems','HLT','DOCENA','YARDA','setUnidadEquivalencia3','Stock\x20Actual','SheetNames','search','CENTIMETRO\x20CUADRADO','Código\x20de\x20Barras\x203','USD_setMtoPrecioCostoUnitario3','setItemCommissionPercentage3','Equivalencia\x203','MTR','PLIEGO','setItemDescription','setInventariable','QUINTAL','INH','CARTONES','SACO','Modelo\x20de\x20Cuello','Precio\x20Costo\x20Soles\x203','MGM','MMT','Precio\x20Costo\x20Dólares\x202','LTR','15771780YkHpUf','GLL','Modelo\x20de\x20Manga','Exonerado\x20(0%)','MILLON\x20DE\x20UNIDADES','7337cqBMBt','setSucursalStock','exportItems:\x20productos\x20no\x20clonables:\x20','TNE','toString','setItemIsSold','setUnitId','1230240oWSyoq','692wbzEJg','MTQ','prototype','LATAS','SSF','constructor','UND\x20(NIU)','HECTOLITRO','ONZ','setBatchExpirationDate','MLT','console','Código\x20SKU*','Procesadas\x20filas\x20','KILOVATIO\x20HORA','buffer','Precio\x20Costo\x20Dólares','FARDO','DZN','MILIMETRO','KILOMETRO','PEN_setMtoPrecioCostoUnitario2','ID\x20UNIT','setCategoria','CIENTO\x20DE\x20UNIDADES','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','PAR','xlsx','slice','Precio\x20Venta\x20Soles','Comisión\x20Venta\x203\x20(%)','BOTELLAS','encode_cell','PIES\x20CUBICOS','YARDA\x20CUADRADA','FOT','MILIMETRO\x20CUADRADO','utils','PIEZAS'];_0x2efb=function(){return _0x22def0;};return _0x2efb();}function _0x2fac(_0x4cfb11,_0x529023){const _0xb22085=_0x2efb();return _0x2fac=function(_0x813ea5,_0x867425){_0x813ea5=_0x813ea5-0x7e;let _0x519310=_0xb22085[_0x813ea5];return _0x519310;},_0x2fac(_0x4cfb11,_0x529023);}_0x813ea5(),importScripts(_0x324673(0x161)),onmessage=({data:_0x35dad8})=>{const _0x253a32=_0x324673,{action:_0x36541a}=_0x35dad8;if(_0x36541a===_0x253a32(0x16a)){const {buf:_0x3d3610,maxRows:_0xe64e7c}=_0x35dad8;try{postMessage({'type':_0x253a32(0x163),'payload':{'percent':0x5,'message':_0x253a32(0xa4)}});const _0x4cd9e7=XLSX[_0x253a32(0xd1)](_0x3d3610,{'type':'array','cellDates':!![]}),_0x42a013=_0x4cd9e7[_0x253a32(0xd7)][_0x4cd9e7[_0x253a32(0xff)][0x0]],_0x50441b=XLSX[_0x253a32(0x146)]['sheet_to_json'](_0x42a013,{'defval':'','range':0x1,'cellDates':!![]}),_0x2b7668=_0x50441b[_0x253a32(0xe1)](_0x2bc492=>(!_0x2bc492[_0x253a32(0x9e)]||String(_0x2bc492[_0x253a32(0x9e)])[_0x253a32(0x179)]()==='')&&(!_0x2bc492['Código\x20SKU*']||String(_0x2bc492[_0x253a32(0x12d)])[_0x253a32(0x179)]()==='')&&(!_0x2bc492['Nombre*']||String(_0x2bc492['Nombre*'])[_0x253a32(0x179)]()==='')&&(!_0x2bc492[_0x253a32(0x8a)]||String(_0x2bc492[_0x253a32(0x8a)])[_0x253a32(0x179)]()==='')),_0x35a292=_0x2b7668>=0x0?_0x50441b[_0x253a32(0x13d)](0x0,_0x2b7668):_0x50441b,_0x38d53d=_0x35a292[_0x253a32(0xa7)](_0x25d5c3=>_0x25d5c3[_0x253a32(0x9e)]&&String(_0x25d5c3[_0x253a32(0x9e)])[_0x253a32(0x179)]()!==''&&_0x25d5c3['Código\x20SKU*']&&String(_0x25d5c3['Código\x20SKU*'])[_0x253a32(0x179)]()!==''&&_0x25d5c3['Nombre*']&&String(_0x25d5c3[_0x253a32(0x7f)])[_0x253a32(0x179)]()!==''&&_0x25d5c3[_0x253a32(0x8a)]&&String(_0x25d5c3[_0x253a32(0x8a)])[_0x253a32(0x179)]()!==''),_0x262b68=_0x38d53d['length'];if(_0x262b68===0x0){postMessage({'type':'error','payload':'No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).'});return;}if(_0x262b68>_0xe64e7c)throw'El\x20archivo\x20tiene\x20'+_0x262b68+_0x253a32(0x13a)+_0xe64e7c+'.';const _0x3bd5fd=0x1f4,_0x383792=[],_0x2a395a=[{'codigo':'4A','nombre':_0x253a32(0xe2)},{'codigo':'BJ','nombre':_0x253a32(0x14c)},{'codigo':'BLL','nombre':'BARRILES'},{'codigo':'BG','nombre':_0x253a32(0xa3)},{'codigo':'BO','nombre':_0x253a32(0x140)},{'codigo':'BX','nombre':_0x253a32(0xdd)},{'codigo':'CT','nombre':_0x253a32(0x10c)},{'codigo':_0x253a32(0xd2),'nombre':_0x253a32(0x101)},{'codigo':'CMQ','nombre':_0x253a32(0x17a)},{'codigo':_0x253a32(0xc7),'nombre':_0x253a32(0xd0)},{'codigo':_0x253a32(0x14e),'nombre':_0x253a32(0x139)},{'codigo':'CY','nombre':'CILINDRO'},{'codigo':'CJ','nombre':_0x253a32(0x152)},{'codigo':_0x253a32(0x133),'nombre':_0x253a32(0xfb)},{'codigo':_0x253a32(0x169),'nombre':_0x253a32(0x166)},{'codigo':'BE','nombre':_0x253a32(0x132)},{'codigo':_0x253a32(0xa6),'nombre':_0x253a32(0xb1)},{'codigo':'GRM','nombre':_0x253a32(0xc9)},{'codigo':'GRO','nombre':_0x253a32(0xbf)},{'codigo':_0x253a32(0xfa),'nombre':_0x253a32(0x128)},{'codigo':'LEF','nombre':_0x253a32(0x175)},{'codigo':'SET','nombre':_0x253a32(0xab)},{'codigo':_0x253a32(0x170),'nombre':'KILOGRAMO'},{'codigo':_0x253a32(0x8e),'nombre':_0x253a32(0x135)},{'codigo':_0x253a32(0x171),'nombre':'KILOVATIO\x20HORA'},{'codigo':'KT','nombre':'KIT'},{'codigo':'CA','nombre':_0x253a32(0x124)},{'codigo':'LBR','nombre':'LIBRAS'},{'codigo':_0x253a32(0x113),'nombre':_0x253a32(0x148)},{'codigo':_0x253a32(0x168),'nombre':_0x253a32(0xe4)},{'codigo':_0x253a32(0x106),'nombre':_0x253a32(0x162)},{'codigo':'MTK','nombre':_0x253a32(0x8c)},{'codigo':_0x253a32(0x122),'nombre':'METRO\x20CUBICO'},{'codigo':_0x253a32(0x110),'nombre':_0x253a32(0x165)},{'codigo':_0x253a32(0x12b),'nombre':_0x253a32(0x14b)},{'codigo':_0x253a32(0x111),'nombre':'MILIMETRO'},{'codigo':_0x253a32(0xa5),'nombre':_0x253a32(0x145)},{'codigo':_0x253a32(0x157),'nombre':_0x253a32(0xe3)},{'codigo':_0x253a32(0x176),'nombre':_0x253a32(0x7e)},{'codigo':'UM','nombre':_0x253a32(0x118)},{'codigo':_0x253a32(0x129),'nombre':_0x253a32(0xa9)},{'codigo':'PF','nombre':_0x253a32(0xd8)},{'codigo':'PK','nombre':_0x253a32(0x94)},{'codigo':'PR','nombre':_0x253a32(0x13b)},{'codigo':_0x253a32(0x144),'nombre':_0x253a32(0xca)},{'codigo':_0x253a32(0xeb),'nombre':_0x253a32(0x16c)},{'codigo':'FTQ','nombre':'PIES\x20CUBICOS'},{'codigo':_0x253a32(0xde),'nombre':_0x253a32(0x147)},{'codigo':'PG','nombre':_0x253a32(0x82)},{'codigo':'ST','nombre':_0x253a32(0x107)},{'codigo':_0x253a32(0x10b),'nombre':'PULGADAS'},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':'SACO'},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':_0x253a32(0xc8),'nombre':'TONELADA\x20CORTA'},{'codigo':_0x253a32(0x15a),'nombre':'TONELADA\x20LARGA'},{'codigo':_0x253a32(0x11c),'nombre':'TONELADAS'},{'codigo':'TU','nombre':_0x253a32(0x93)},{'codigo':_0x253a32(0xb3),'nombre':_0x253a32(0x17b)},{'codigo':'ZZ','nombre':_0x253a32(0x15c)},{'codigo':_0x253a32(0x115),'nombre':'US\x20GALON\x20(3,7843\x20L)'},{'codigo':_0x253a32(0xd3),'nombre':_0x253a32(0xfc)},{'codigo':_0x253a32(0xe7),'nombre':_0x253a32(0x143)},{'codigo':'QQM','nombre':_0x253a32(0x10a)}],_0x2e62bb=_0x2a395a['reduce']((_0x5de815,{nombre:_0x57a7ce,codigo:_0xe23591})=>{const _0x35b392=_0x253a32;return _0x5de815[_0x57a7ce[_0x35b392(0x179)]()]=_0xe23591[_0x35b392(0x179)](),_0x5de815;},{});for(let _0x41a951=0x0;_0x41a951<_0x262b68;_0x41a951+=_0x3bd5fd){const _0x4c1119=_0x38d53d['slice'](_0x41a951,_0x41a951+_0x3bd5fd)[_0x253a32(0x16e)]((_0x3960eb,_0x15925c)=>{const _0x2ee5f2=_0x253a32;let _0x339ff6={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x3960eb[_0x2ee5f2(0x9e)]]||'1';const _0x56804a=String(_0x3960eb['Impuesto*'])[_0x2ee5f2(0x179)](),_0x513273={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x3f3159=_0x513273[_0x56804a]||'1',_0x24101f={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x3f3159]||{'code':'10','value':0x12},_0x20d2a7={};let _0x345771=String(_0x3960eb[_0x2ee5f2(0x7f)])['trim']();const _0x275f47=[_0x2ee5f2(0xba),'Talla',_0x2ee5f2(0x8f),_0x2ee5f2(0xb4),_0x2ee5f2(0xc2),'Serie',_0x2ee5f2(0x15e),_0x2ee5f2(0x10e),_0x2ee5f2(0x116)];_0x275f47[_0x2ee5f2(0xea)](_0x176781=>{const _0x5973ae=String(_0x3960eb[_0x176781]||'')['trim']();_0x5973ae&&(_0x20d2a7[_0x176781]=_0x5973ae,_0x345771+='\x20'+_0x176781+'\x20'+_0x5973ae);});const _0x110727=[],_0x547764=String(_0x3960eb[_0x2ee5f2(0x8a)]||_0x2ee5f2(0x17b))[_0x2ee5f2(0x179)](),_0x50cb45=_0x2e62bb[_0x547764]||_0x2ee5f2(0xb3),_0x3dfab6=String(_0x3960eb[_0x2ee5f2(0xa0)])['trim']();_0x110727[_0x2ee5f2(0x99)]({'setItemUnitId':String(_0x3960eb[_0x2ee5f2(0x137)])[_0x2ee5f2(0x179)]()||'','setItemBarCode':String(_0x3960eb['Código\x20de\x20Barras'])[_0x2ee5f2(0x179)]()||'','setAlias':_0x3dfab6,'setUnitCode':_0x50cb45,'setPrice':parseFloat(_0x3960eb[_0x2ee5f2(0x13e)]),'setCost':parseFloat(_0x3960eb[_0x2ee5f2(0x159)]),'setPriceUSD':parseFloat(_0x3960eb['Precio\x20Venta\x20Dólares']),'setCostUSD':parseFloat(_0x3960eb['Precio\x20Costo\x20Dólares']),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x3960eb[_0x2ee5f2(0xaf)])});const _0x23b4e1=[_0x2ee5f2(0x154),_0x2ee5f2(0x158),_0x2ee5f2(0x9b),_0x2ee5f2(0x160),_0x2ee5f2(0xe6),'Precio\x20Costo\x20Soles\x202','Precio\x20Venta\x20Dólares\x202',_0x2ee5f2(0x112)]['some'](_0x47fe55=>{const _0x8fc2cd=_0x3960eb[_0x47fe55];return _0x8fc2cd!=null&&String(_0x8fc2cd)['trim']()!=='';});if(_0x23b4e1){const _0x143906=String(_0x3960eb[_0x2ee5f2(0x14d)]||_0x2ee5f2(0x127))[_0x2ee5f2(0x179)](),_0x4d408b=_0x2e62bb[_0x143906]||'NIU';_0x110727['push']({'setItemUnitId':String(_0x3960eb[_0x2ee5f2(0x154)])[_0x2ee5f2(0x179)]()||'','setItemBarCode':String(_0x3960eb[_0x2ee5f2(0x9b)])[_0x2ee5f2(0x179)]()||'','setAlias':String(_0x3960eb[_0x2ee5f2(0x158)])[_0x2ee5f2(0x179)](),'setUnitCode':_0x4d408b,'setPrice':parseFloat(_0x3960eb[_0x2ee5f2(0xe6)]),'setCost':parseFloat(_0x3960eb[_0x2ee5f2(0xdc)]),'setPriceUSD':parseFloat(_0x3960eb[_0x2ee5f2(0xb0)]),'setCostUSD':parseFloat(_0x3960eb[_0x2ee5f2(0x112)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x3960eb[_0x2ee5f2(0x160)])||0x1,'setFactor':parseFloat(_0x3960eb[_0x2ee5f2(0x160)])||0x1,'setItemCommissionPercentage':parseFloat(_0x3960eb['Comisión\x20Venta\x202\x20(%)'])});}const _0x3998fd=[_0x2ee5f2(0xb9),_0x2ee5f2(0xef),'Código\x20de\x20Barras\x203','Equivalencia\x203','Precio\x20Venta\x20Soles\x203','Precio\x20Costo\x20Soles\x203','Precio\x20Venta\x20Dólares\x203',_0x2ee5f2(0xed)][_0x2ee5f2(0x81)](_0x4ad625=>{const _0x2e47d4=_0x2ee5f2,_0x23813b=_0x3960eb[_0x4ad625];return _0x23813b!=null&&String(_0x23813b)[_0x2e47d4(0x179)]()!=='';});if(_0x3998fd){const _0x2d1faa=String(_0x3960eb[_0x2ee5f2(0xc6)]||_0x2ee5f2(0x127))['trim'](),_0x5a5802=_0x2e62bb[_0x2d1faa]||'NIU';_0x110727[_0x2ee5f2(0x99)]({'setItemUnitId':String(_0x3960eb[_0x2ee5f2(0xb9)])[_0x2ee5f2(0x179)]()||'','setItemBarCode':String(_0x3960eb[_0x2ee5f2(0x102)])[_0x2ee5f2(0x179)]()||'','setAlias':String(_0x3960eb[_0x2ee5f2(0xef)])[_0x2ee5f2(0x179)](),'setUnitCode':_0x5a5802,'setPrice':parseFloat(_0x3960eb[_0x2ee5f2(0x97)]),'setCost':parseFloat(_0x3960eb['Precio\x20Costo\x20Soles\x203']),'setPriceUSD':parseFloat(_0x3960eb[_0x2ee5f2(0x8b)]),'setCostUSD':parseFloat(_0x3960eb[_0x2ee5f2(0xed)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x3960eb[_0x2ee5f2(0x105)])||0x1,'setFactor':parseFloat(_0x3960eb[_0x2ee5f2(0x105)])||0x1,'setItemCommissionPercentage':parseFloat(_0x3960eb[_0x2ee5f2(0x13f)])});}let _0x451396=_0x3960eb['Fecha\x20de\x20Vencimiento'],_0x36ef16='';if(_0x451396 instanceof Date){const _0x4f2167=_0x451396[_0x2ee5f2(0xb7)](),_0x3eb81a=String(_0x451396[_0x2ee5f2(0xc1)]()+0x1)['padStart'](0x2,'0'),_0x3016f3=String(_0x451396[_0x2ee5f2(0x172)]())[_0x2ee5f2(0x149)](0x2,'0');_0x36ef16=_0x4f2167+'-'+_0x3eb81a+'-'+_0x3016f3;}else{if(typeof _0x451396===_0x2ee5f2(0xd9)){const _0x3e5c54=XLSX[_0x2ee5f2(0x125)]['parse_date_code'](_0x451396);if(_0x3e5c54){const _0x285d60=_0x3e5c54['y'],_0x4c5fcd=String(_0x3e5c54['m'])[_0x2ee5f2(0x149)](0x2,'0'),_0x456584=String(_0x3e5c54['d'])[_0x2ee5f2(0x149)](0x2,'0');_0x36ef16=_0x285d60+'-'+_0x4c5fcd+'-'+_0x456584;}}else _0x36ef16=String(_0x451396||'')[_0x2ee5f2(0x179)]();}return{'setItemId':String(_0x3960eb['ID'])[_0x2ee5f2(0x179)](),'setItemType':_0x339ff6,'setItemCode':String(_0x3960eb['Código\x20SKU*'])[_0x2ee5f2(0x179)](),'setItemName':String(_0x3960eb[_0x2ee5f2(0x7f)])[_0x2ee5f2(0x179)](),'setItemDescription':String(_0x3960eb[_0x2ee5f2(0xe8)])[_0x2ee5f2(0x179)]()||'','setItemIsSold':_0x3960eb[_0x2ee5f2(0x85)]=='SI'?0x1:0x0,'setItemIsBought':_0x3960eb[_0x2ee5f2(0xb2)]=='SI'?0x1:0x0,'setItemCategories':_0x3960eb[_0x2ee5f2(0xbb)]?[String(_0x3960eb[_0x2ee5f2(0xbb)])[_0x2ee5f2(0x179)]()]:[],'setItemBrands':_0x3960eb[_0x2ee5f2(0x80)]?[String(_0x3960eb[_0x2ee5f2(0x80)])[_0x2ee5f2(0x179)]()]:[],'setItemTaxId':_0x3f3159,'setItemTaxCode':_0x24101f[_0x2ee5f2(0x153)],'setItemTaxValue':_0x24101f[_0x2ee5f2(0x17c)],'setItemUnits':_0x110727,'setItemInventoriable':_0x3960eb[_0x2ee5f2(0x151)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x3960eb[_0x2ee5f2(0xfe)])||0x0,'setStockMinimum':parseFloat(_0x3960eb[_0x2ee5f2(0xbc)])||0x0,'setItemLocation':String(_0x3960eb[_0x2ee5f2(0xf0)])['trim']()||'','setBatchName':String(_0x3960eb['Lote'])[_0x2ee5f2(0x179)]()||'','setItemDateExpiry':_0x36ef16,'setItemVariantName':_0x345771,'setItemVariantValues':_0x20d2a7,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x383792['push'](..._0x4c1119),postMessage({'type':_0x253a32(0x163),'payload':{'percent':Math[_0x253a32(0x92)]((_0x41a951+_0x4c1119[_0x253a32(0xb5)])/_0x262b68*0x64),'message':_0x253a32(0x12e)+(_0x41a951+0x1)+'–'+(_0x41a951+_0x4c1119[_0x253a32(0xb5)])+'/'+_0x262b68}});}postMessage({'type':'done','payload':{'items':_0x383792}});}catch(_0x36fe5d){postMessage({'type':'error','payload':_0x36fe5d[_0x253a32(0x167)]||_0x36fe5d});}}if(_0x36541a===_0x253a32(0xf9)){const {products:_0x2a70ec,plantillaBuf:_0x4ea34e}=_0x35dad8;if(!(_0x4ea34e instanceof ArrayBuffer)){postMessage({'type':'error','payload':_0x253a32(0xc5)});return;}if(!Array[_0x253a32(0x150)](_0x2a70ec)){postMessage({'type':_0x253a32(0xf5),'payload':'exportItems:\x20products\x20no\x20es\x20Array.'});return;}try{structuredClone(_0x2a70ec);}catch(_0x290ff3){postMessage({'type':_0x253a32(0xf5),'payload':_0x253a32(0x11b)+_0x290ff3[_0x253a32(0x167)]});return;}try{const _0x2f45f4={'1':_0x253a32(0xdf),'2':'Servicio','3':'Materia\x20Prima','4':'Combo','5':_0x253a32(0x98)};function _0x3038a6(_0x86a442){const _0x264076=_0x253a32;return _0x2f45f4[String(_0x86a442)]||_0x264076(0xdf);}const _0x186733={'1':_0x253a32(0x9d),'2':_0x253a32(0x117),'3':'Inafecto\x20(0%)','4':_0x253a32(0x16d),'5':'Inafecto\x20Gratuito\x20(0%)','6':_0x253a32(0xcc),'7':_0x253a32(0x9c),'8':'Exportación\x20(0%)','9':_0x253a32(0xe9)};function _0x4a0607(_0xd8a7dc){return _0x186733[String(_0xd8a7dc)]||'Gravado\x20(18%)';}const _0x5c71ef={'4A':'BOBINAS','BJ':_0x253a32(0x14c),'BLL':'BARRILES','BG':_0x253a32(0xa3),'BO':_0x253a32(0x140),'BX':_0x253a32(0xdd),'CT':'CARTONES','CMK':_0x253a32(0x101),'CMQ':_0x253a32(0x17a),'CMT':_0x253a32(0xd0),'CEN':_0x253a32(0x139),'CY':'CILINDRO','CJ':_0x253a32(0x152),'DZN':_0x253a32(0xfb),'DZP':'DOCENA\x20POR\x2010**6','BE':_0x253a32(0x132),'GLI':_0x253a32(0xb1),'GRM':_0x253a32(0xc9),'GRO':_0x253a32(0xbf),'HLT':'HECTOLITRO','LEF':_0x253a32(0x175),'SET':'JUEGO','KGM':'KILOGRAMO','KTM':_0x253a32(0x135),'KWH':_0x253a32(0x12f),'KT':_0x253a32(0x16f),'CA':_0x253a32(0x124),'LBR':_0x253a32(0xf3),'LTR':_0x253a32(0x148),'MWH':_0x253a32(0xe4),'MTR':_0x253a32(0x162),'MTK':_0x253a32(0x8c),'MTQ':_0x253a32(0xd4),'MGM':_0x253a32(0x165),'MLT':_0x253a32(0x14b),'MMT':_0x253a32(0x134),'MMK':'MILIMETRO\x20CUADRADO','MMQ':'MILIMETRO\x20CUBICO','MIL':_0x253a32(0x7e),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0x253a32(0xa9),'PF':_0x253a32(0xd8),'PK':_0x253a32(0x94),'PR':_0x253a32(0x13b),'FOT':_0x253a32(0xca),'FTK':_0x253a32(0x16c),'FTQ':_0x253a32(0x142),'C62':'PIEZAS','PG':_0x253a32(0x82),'ST':_0x253a32(0x107),'INH':'PULGADAS','RM':_0x253a32(0x16b),'SA':_0x253a32(0x10d),'DR':_0x253a32(0xac),'STN':_0x253a32(0xad),'LTN':_0x253a32(0x15d),'TNE':_0x253a32(0x14f),'TU':_0x253a32(0x93),'NIU':_0x253a32(0x17b),'ZZ':_0x253a32(0x15c),'GLL':_0x253a32(0x86),'YRD':_0x253a32(0xfc),'YDK':_0x253a32(0x143),'QQM':_0x253a32(0x10a)};function _0x3baa30(_0x546d33){return _0x5c71ef[String(_0x546d33)]||'';}const _0x1cddb4=XLSX[_0x253a32(0xd1)](_0x4ea34e,{'type':_0x253a32(0x87),'cellDates':!![]}),_0x1baaa3=_0x1cddb4['SheetNames'][0x0],_0x1e0044=_0x1cddb4['Sheets'][_0x1baaa3],_0x4840f1=XLSX['utils'][_0x253a32(0xda)](_0x1e0044,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x4c3553=XLSX[_0x253a32(0x146)][_0x253a32(0xbd)](_0x1e0044[_0x253a32(0x164)]||'');for(let _0x55a091=0x2;_0x55a091<=_0x4c3553['e']['r'];++_0x55a091){for(let _0x408a00=_0x4c3553['s']['c'];_0x408a00<=_0x4c3553['e']['c'];++_0x408a00){const _0x40985d=XLSX[_0x253a32(0x146)][_0x253a32(0x141)]({'r':_0x55a091,'c':_0x408a00});if(_0x1e0044[_0x40985d])delete _0x1e0044[_0x40985d];}}const _0xdb0d74=_0x2a70ec[_0x253a32(0x16e)](_0x23f27b=>{const _0x31fd60=_0x253a32;_0x23f27b['setItemVariantValues']=_0x23f27b[_0x31fd60(0xae)]||{};const _0x3bd012={};return _0x4840f1['forEach'](_0x4f6559=>{const _0x1d96f8=_0x31fd60,_0x27d08f=String(_0x4f6559)[_0x1d96f8(0x179)](),_0x37a9cb=_0x27d08f['toLowerCase'](),_0x1e55f1=Object[_0x1d96f8(0x90)](_0x23f27b)[_0x1d96f8(0xf7)](_0x208ebf=>_0x208ebf[_0x1d96f8(0x179)]()[_0x1d96f8(0xd6)]()===_0x37a9cb);if(_0x1e55f1){_0x3bd012[_0x27d08f]=_0x23f27b[_0x1e55f1]??'';return;}switch(_0x27d08f){case'ID':_0x3bd012[_0x27d08f]=_0x23f27b['id']??'';break;case _0x1d96f8(0x9e):_0x3bd012[_0x27d08f]=_0x3038a6(_0x23f27b['setItemType']);break;case'Código\x20SKU*':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xa8)]??'';break;case _0x1d96f8(0x7f):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xcb)]??'';break;case'Descripción':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x108)]??'';break;case _0x1d96f8(0x85):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x11e)]==0x1?'SI':'NO';break;case _0x1d96f8(0xb2):_0x3bd012[_0x27d08f]=_0x23f27b['setItemIsBought']==0x1?'SI':'NO';break;case'Categoría':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x138)]??'';break;case _0x1d96f8(0x80):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xa2)]??'';break;case'Impuesto*':_0x3bd012[_0x27d08f]=_0x4a0607(_0x23f27b[_0x1d96f8(0xc4)]);break;case _0x1d96f8(0x137):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x11f)]??'';break;case _0x1d96f8(0xa0):_0x3bd012[_0x27d08f]=_0x23f27b['setItemUnitAlias']??'';break;case _0x1d96f8(0xec):_0x3bd012[_0x27d08f]=_0x23f27b['setItemBarCode']??'';break;case'Unidad\x20de\x20Medida*':_0x3bd012[_0x27d08f]=_0x3baa30(_0x23f27b[_0x1d96f8(0x84)]);break;case _0x1d96f8(0x13e):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x96)]??'';break;case'Precio\x20Costo\x20Soles':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x173)]??'';break;case'Precio\x20Venta\x20Dólares':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x155)]??'';break;case _0x1d96f8(0x131):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xce)]??'';break;case _0x1d96f8(0xaf):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xcd)];break;case'ID\x20UNIT\x202':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xf6)]??'';break;case _0x1d96f8(0x158):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x9a)]??'';break;case'Código\x20de\x20Barras\x202':_0x3bd012[_0x27d08f]=_0x23f27b['setItemBarCode2']??'';break;case'Unidad\x20de\x20Medida\x202':_0x3bd012[_0x27d08f]=_0x3baa30(_0x23f27b[_0x1d96f8(0xf8)]);break;case'Equivalencia\x202':_0x3bd012[_0x27d08f]=_0x23f27b['setUnidadEquivalencia2']??'1';break;case'Precio\x20Venta\x20Soles\x202':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xc0)]??'';break;case _0x1d96f8(0xdc):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x136)]??'';break;case _0x1d96f8(0xb0):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xf2)]??'';break;case _0x1d96f8(0x112):_0x3bd012[_0x27d08f]=_0x23f27b['USD_setMtoPrecioCostoUnitario2']??'';break;case _0x1d96f8(0x9f):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x88)];break;case'ID\x20UNIT\x203':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xc3)]??'';break;case _0x1d96f8(0xef):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x83)]??'';break;case'Código\x20de\x20Barras\x203':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x95)]??'';break;case'Unidad\x20de\x20Medida\x203':_0x3bd012[_0x27d08f]=_0x3baa30(_0x23f27b['setUnidadCodigo3']);break;case'Equivalencia\x203':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xfd)]??'1';break;case _0x1d96f8(0x97):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xcf)]??'';break;case _0x1d96f8(0x10f):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x174)]??'';break;case _0x1d96f8(0x8b):_0x3bd012[_0x27d08f]=_0x23f27b['USD_setMtoPrecioUnitario3']??'';break;case _0x1d96f8(0xed):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x103)]??'';break;case _0x1d96f8(0x13f):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x104)];break;case _0x1d96f8(0x151):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x109)]==0x1?'SI':'NO';break;case _0x1d96f8(0xfe):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x11a)]??'';break;case _0x1d96f8(0xbc):_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0xe0)]??'';break;case'Fecha\x20de\x20Vencimiento':_0x3bd012[_0x27d08f]=_0x23f27b[_0x1d96f8(0x12a)]??'';break;default:_0x3bd012[_0x27d08f]='';}}),_0x3bd012;}),_0x344466=0x3e8,_0x14d734=_0xdb0d74['length'];for(let _0x4db241=0x0;_0x4db241<_0x14d734;_0x4db241+=_0x344466){const _0x568084=_0xdb0d74[_0x253a32(0x13d)](_0x4db241,_0x4db241+_0x344466);XLSX[_0x253a32(0x146)][_0x253a32(0xf1)](_0x1e0044,_0x568084,{'origin':{'r':_0x4db241+0x2,'c':0x0},'skipHeader':!![],'header':_0x4840f1}),postMessage({'type':'progress','payload':{'percent':Math['round']((_0x4db241+_0x568084[_0x253a32(0xb5)])/_0x14d734*0x64),'message':_0x253a32(0xbe)+(_0x4db241+0x1)+'–'+(_0x4db241+_0x568084[_0x253a32(0xb5)])+'\x20de\x20'+_0x14d734}});}const _0x37e663={'s':{'r':0x0,'c':0x0},'e':{'r':_0x14d734+0x1,'c':_0x4840f1[_0x253a32(0xb5)]-0x1}};_0x1e0044[_0x253a32(0x164)]=XLSX[_0x253a32(0x146)]['encode_range'](_0x37e663);const _0x22b8d6=XLSX[_0x253a32(0x91)](_0x1cddb4,{'bookType':_0x253a32(0x13c),'type':_0x253a32(0x87)});let _0x42ee1a,_0x3be0a6;if(_0x22b8d6 instanceof Uint8Array)_0x42ee1a=_0x22b8d6,_0x3be0a6=[_0x22b8d6[_0x253a32(0x130)]];else{if(_0x22b8d6 instanceof ArrayBuffer)_0x42ee1a=new Uint8Array(_0x22b8d6),_0x3be0a6=[_0x22b8d6];else{const _0x1db563=new Uint8Array(_0x22b8d6);_0x42ee1a=_0x1db563,_0x3be0a6=[_0x1db563[_0x253a32(0x130)]];}}postMessage({'type':_0x253a32(0xb6),'payload':{'wbout':_0x42ee1a,'count':_0xdb0d74['length']}},_0x3be0a6);}catch(_0x316a15){postMessage({'type':'error','payload':_0x316a15[_0x253a32(0x167)]||String(_0x316a15)});}return;}};