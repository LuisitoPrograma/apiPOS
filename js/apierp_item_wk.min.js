/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.0.1
*/

const _0x869330=_0x1fa0;(function(_0x3ee22d,_0x3eb7a3){const _0x47d7ca=_0x1fa0,_0x2108dc=_0x3ee22d();while(!![]){try{const _0x32ac87=parseInt(_0x47d7ca(0x2d6))/0x1*(parseInt(_0x47d7ca(0x2ca))/0x2)+-parseInt(_0x47d7ca(0x281))/0x3*(parseInt(_0x47d7ca(0x256))/0x4)+parseInt(_0x47d7ca(0x223))/0x5+parseInt(_0x47d7ca(0x283))/0x6+-parseInt(_0x47d7ca(0x2a1))/0x7+parseInt(_0x47d7ca(0x2c7))/0x8+-parseInt(_0x47d7ca(0x21c))/0x9*(parseInt(_0x47d7ca(0x1f8))/0xa);if(_0x32ac87===_0x3eb7a3)break;else _0x2108dc['push'](_0x2108dc['shift']());}catch(_0x2c5b1c){_0x2108dc['push'](_0x2108dc['shift']());}}}(_0x963c,0xd15cb));function _0x963c(){const _0x2e97de=['Comisión\x20Venta\x20(%)','encode_range','KILOMETRO','ONZ','Equivalencia\x202','CMQ','Se\x20Vende','Precio\x20Venta\x20Dólares\x202','JUEGO','BOBINAS','setWarehouseStockMin','CEN','GRAMO','Descripción','2091qitsSC','KILOGRAMO','3940518YThkkS','ONZAS','__proto__','Gravado\x20(10%)','LITRO','FTK','TUBOS','sheet_add_json','MTK','setTaxId','console','FOT','PIES\x20CUBICOS','setItemUnitAlias2','length','PIES','Comisión\x20Venta\x202\x20(%)','KILOVATIO\x20HORA','GRO','PEN_setMtoPrecioCostoUnitario3','Alias','MMT','setUnidadEquivalencia2','code','Fabricado','log','LIBRAS','MILIMETRO\x20CUBICO','exportItems','SACO','1212540dXpRTu','setItemCommissionPercentage2','UND\x20(NIU)','GLL','MMK','Gravado\x20(18%)','Iniciando\x20parseo…','parse_date_code','Código\x20de\x20Barras\x203','forEach','MTR','buffer','GALON\x20INGLES\x20(4,545956L)','CIENTO\x20DE\x20UNIDADES','USD_setMtoPrecioUnitario','LBR','DOCENA\x20POR\x2010**6','FARDO','!ref','CAJA','Precio\x20Costo\x20Dólares\x203','MGM','BARRILES','YDK','PEN_setMtoPrecioCostoUnitario','Unidad\x20de\x20Medida\x203','setSucursalStock','YARDA\x20CUADRADA','Modelo','DOCENA','PEN_setMtoPrecioUnitario3','Stock\x20Mínimo','USD_setMtoPrecioCostoUnitario2','keys','Categoría','Alias\x202','xlsx','array','13375304NvqLEu','Marca','Tipo*','4WNaXOO','Modelo\x20de\x20Manga','MMQ','ID\x20UNIT\x202','MILIGRAMOS','USD_setMtoPrecioUnitario2','Impuesto*','Precio\x20Costo\x20Soles\x203','FTQ','setItemType','Materia\x20Prima','Ubicación','571811cPYdvD','DZN','Inafecto\x20(0%)','warn','MILIMETRO\x20CUADRADO','PIEZAS','exception','setItemCommissionPercentage','PALETAS','ID\x20UNIT','filter','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','(((.+)+)+)+$','Exportando\x20filas\x20','constructor','MILLON\x20DE\x20UNIDADES','CENTIMETRO\x20CUBICO','BOTELLAS','PLACAS','USD_setMtoPrecioCostoUnitario3','CILINDRO','toLowerCase','setItemUnitAlias3','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','MTQ','Precio\x20Venta\x20Soles\x202','Precio\x20Venta\x20Soles\x203','return\x20(function()\x20','Precio\x20Venta\x20Soles','Exonerado\x20(0%)','Sheets','trace','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','setItemBarCode3','prototype','\x20de\x20','430uCXafn','MWH','Nombre*','METRO','Exportación\x20(0%)','HECTOLITRO','Talla','number','LEF','setUnidadCodigo','round','value','bind','CENTIMETRO\x20LINEAL','setBatchExpirationDate','toString','UNIDAD\x20(NIU)','YARDA','MIL','Artículo','TNE','Unidad\x20de\x20Medida\x202','setMarca','BALDE','setItemCommissionPercentage3','STN','KIT','sheet_to_json','Fecha\x20de\x20Vencimiento','write','Alias\x203','table','setInventariable','Rastrear\x20Inventario','setItemBarCode2','findIndex','559026wKLFGx','TAMBOR','LATAS','setUnitId','Comisión\x20Venta\x203\x20(%)','Precio\x20Costo\x20Soles\x202','USD_setMtoPrecioUnitario3','7360660SSmRNV','Unidad\x20de\x20Medida*','PAR','KGM','Se\x20Compra','TONELADAS','MILILITRO','Equivalencia\x203','Precio\x20Costo\x20Dólares','QUINTAL','Lote','TONELADA\x20CORTA','MILIMETRO','PAQUETE','padStart','CONOS','utils','setItemVariantValues','KWH','read','getDate','ID\x20UNIT\x203','progress','Stock\x20Actual','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','Precio\x20Venta\x20Dólares','Precio\x20Costo\x20Soles','Gravado\x20Gratuito\x20(18%)','exportItems:\x20productos\x20no\x20clonables:\x20','decode_range','UNIDAD\x20(ZZ)','apply','some','NIU','exportDone','PEN_setMtoPrecioCostoUnitario2','import','METRO\x20CUBICO','El\x20archivo\x20tiene\x20','YRD','message','Código\x20de\x20Barras\x202','CENTIMETRO\x20CUADRADO','setItemIsSold','setDescripcion','Precio\x20Costo\x20Dólares\x202','GRUESA','push','CARTONES','BOLSA','slice','7132ctugst','DZP','setCategoria','Código\x20de\x20Barras','setItemBarCode','PULGADAS','isArray','setUnidadCodigo3','SheetNames','getFullYear','PLIEGO','RESMA','error','search','trim','Modelo\x20de\x20Cuello','PEN_setMtoPrecioUnitario2','Código\x20SKU*','MLT','map','TONELADA\x20LARGA','PIES\x20CUADRADOS','done','MILLARES','SET','GRM','HOJA','HLT','Precio\x20Venta\x20Dólares\x203'];_0x963c=function(){return _0x2e97de;};return _0x963c();}function _0x1fa0(_0xa04e08,_0x2f0e24){const _0x587439=_0x963c();return _0x1fa0=function(_0x2bacf3,_0xb6bb4b){_0x2bacf3=_0x2bacf3-0x1e5;let _0x3575ed=_0x587439[_0x2bacf3];return _0x3575ed;},_0x1fa0(_0xa04e08,_0x2f0e24);}const _0x27d61e=(function(){let _0x1f5405=!![];return function(_0xb51de,_0x4dd797){const _0xd26fa1=_0x1f5405?function(){const _0x273848=_0x1fa0;if(_0x4dd797){const _0xd78a9f=_0x4dd797[_0x273848(0x242)](_0xb51de,arguments);return _0x4dd797=null,_0xd78a9f;}}:function(){};return _0x1f5405=![],_0xd26fa1;};}()),_0x25d48c=_0x27d61e(this,function(){const _0x53d230=_0x1fa0;return _0x25d48c[_0x53d230(0x207)]()['search'](_0x53d230(0x2e2))['toString']()[_0x53d230(0x2e4)](_0x25d48c)[_0x53d230(0x263)](_0x53d230(0x2e2));});_0x25d48c();const _0xb6bb4b=(function(){let _0x21652b=!![];return function(_0x3f3fbd,_0x247cc5){const _0x24e5a9=_0x21652b?function(){if(_0x247cc5){const _0x29dd64=_0x247cc5['apply'](_0x3f3fbd,arguments);return _0x247cc5=null,_0x29dd64;}}:function(){};return _0x21652b=![],_0x24e5a9;};}()),_0x2bacf3=_0xb6bb4b(this,function(){const _0x13552a=_0x1fa0,_0x2248ed=function(){const _0x40269c=_0x1fa0;let _0x3878bf;try{_0x3878bf=Function(_0x40269c(0x1ef)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x28f437){_0x3878bf=window;}return _0x3878bf;},_0x2fa923=_0x2248ed(),_0x454a65=_0x2fa923[_0x13552a(0x28d)]=_0x2fa923['console']||{},_0x54e16d=[_0x13552a(0x29c),_0x13552a(0x2d9),'info',_0x13552a(0x262),_0x13552a(0x2dc),_0x13552a(0x217),_0x13552a(0x1f3)];for(let _0x55dda6=0x0;_0x55dda6<_0x54e16d['length'];_0x55dda6++){const _0xc4a42d=_0xb6bb4b[_0x13552a(0x2e4)][_0x13552a(0x1f6)][_0x13552a(0x204)](_0xb6bb4b),_0x3d545c=_0x54e16d[_0x55dda6],_0x46af82=_0x454a65[_0x3d545c]||_0xc4a42d;_0xc4a42d[_0x13552a(0x285)]=_0xb6bb4b['bind'](_0xb6bb4b),_0xc4a42d[_0x13552a(0x207)]=_0x46af82[_0x13552a(0x207)][_0x13552a(0x204)](_0x46af82),_0x454a65[_0x3d545c]=_0xc4a42d;}});_0x2bacf3(),importScripts(_0x869330(0x1eb)),onmessage=({data:_0x5ee14d})=>{const _0x4346c2=_0x869330,{action:_0x5b951d}=_0x5ee14d;if(_0x5b951d===_0x4346c2(0x247)){const {buf:_0x69e012,maxRows:_0x4608eb}=_0x5ee14d;try{postMessage({'type':_0x4346c2(0x239),'payload':{'percent':0x5,'message':_0x4346c2(0x2a7)}});const _0x43e66b=XLSX[_0x4346c2(0x236)](_0x69e012,{'type':_0x4346c2(0x2c6),'cellDates':!![]}),_0xd6a312=_0x43e66b[_0x4346c2(0x1f2)][_0x43e66b[_0x4346c2(0x25e)][0x0]],_0x4d7f1c=XLSX['utils']['sheet_to_json'](_0xd6a312,{'defval':'','range':0x1,'cellDates':!![]}),_0x415654=_0x4d7f1c[_0x4346c2(0x21b)](_0x569af6=>(!_0x569af6[_0x4346c2(0x2c9)]||String(_0x569af6['Tipo*'])[_0x4346c2(0x264)]()==='')&&(!_0x569af6['Código\x20SKU*']||String(_0x569af6[_0x4346c2(0x267)])[_0x4346c2(0x264)]()==='')&&(!_0x569af6['Nombre*']||String(_0x569af6[_0x4346c2(0x1fa)])[_0x4346c2(0x264)]()==='')&&(!_0x569af6[_0x4346c2(0x224)]||String(_0x569af6[_0x4346c2(0x224)])[_0x4346c2(0x264)]()==='')),_0x2a0318=_0x415654>=0x0?_0x4d7f1c['slice'](0x0,_0x415654):_0x4d7f1c,_0x164268=_0x2a0318[_0x4346c2(0x2e0)](_0x163d14=>_0x163d14['Tipo*']&&String(_0x163d14[_0x4346c2(0x2c9)])[_0x4346c2(0x264)]()!==''&&_0x163d14[_0x4346c2(0x267)]&&String(_0x163d14['Código\x20SKU*'])['trim']()!==''&&_0x163d14[_0x4346c2(0x1fa)]&&String(_0x163d14['Nombre*'])[_0x4346c2(0x264)]()!==''&&_0x163d14[_0x4346c2(0x224)]&&String(_0x163d14[_0x4346c2(0x224)])[_0x4346c2(0x264)]()!==''),_0x494a52=_0x164268[_0x4346c2(0x291)];if(_0x494a52===0x0){postMessage({'type':_0x4346c2(0x262),'payload':_0x4346c2(0x23b)});return;}if(_0x494a52>_0x4608eb)throw _0x4346c2(0x249)+_0x494a52+_0x4346c2(0x2e1)+_0x4608eb+'.';const _0x7803ea=0x1f4,_0x5c7f0e=[],_0x5e8922=[{'codigo':'4A','nombre':_0x4346c2(0x27c)},{'codigo':'BJ','nombre':'BALDE'},{'codigo':'BLL','nombre':_0x4346c2(0x2b7)},{'codigo':'BG','nombre':_0x4346c2(0x254)},{'codigo':'BO','nombre':_0x4346c2(0x1e5)},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':_0x4346c2(0x253)},{'codigo':'CMK','nombre':'CENTIMETRO\x20CUADRADO'},{'codigo':_0x4346c2(0x278),'nombre':_0x4346c2(0x2e6)},{'codigo':'CMT','nombre':_0x4346c2(0x205)},{'codigo':_0x4346c2(0x27e),'nombre':_0x4346c2(0x2ae)},{'codigo':'CY','nombre':_0x4346c2(0x1e8)},{'codigo':'CJ','nombre':'CONOS'},{'codigo':_0x4346c2(0x2d7),'nombre':_0x4346c2(0x2be)},{'codigo':_0x4346c2(0x257),'nombre':_0x4346c2(0x2b1)},{'codigo':'BE','nombre':_0x4346c2(0x2b2)},{'codigo':'GLI','nombre':_0x4346c2(0x2ad)},{'codigo':_0x4346c2(0x26f),'nombre':'GRAMO'},{'codigo':_0x4346c2(0x295),'nombre':_0x4346c2(0x251)},{'codigo':_0x4346c2(0x271),'nombre':_0x4346c2(0x1fd)},{'codigo':_0x4346c2(0x200),'nombre':'HOJA'},{'codigo':_0x4346c2(0x26e),'nombre':_0x4346c2(0x27b)},{'codigo':_0x4346c2(0x226),'nombre':_0x4346c2(0x282)},{'codigo':'KTM','nombre':_0x4346c2(0x275)},{'codigo':_0x4346c2(0x235),'nombre':_0x4346c2(0x294)},{'codigo':'KT','nombre':'KIT'},{'codigo':'CA','nombre':_0x4346c2(0x21e)},{'codigo':_0x4346c2(0x2b0),'nombre':'LIBRAS'},{'codigo':'LTR','nombre':'LITRO'},{'codigo':_0x4346c2(0x1f9),'nombre':'MEGAWATT\x20HORA'},{'codigo':_0x4346c2(0x2ab),'nombre':'METRO'},{'codigo':_0x4346c2(0x28b),'nombre':'METRO\x20CUADRADO'},{'codigo':_0x4346c2(0x1ec),'nombre':_0x4346c2(0x248)},{'codigo':_0x4346c2(0x2b6),'nombre':'MILIGRAMOS'},{'codigo':_0x4346c2(0x268),'nombre':'MILILITRO'},{'codigo':_0x4346c2(0x298),'nombre':'MILIMETRO'},{'codigo':_0x4346c2(0x2a5),'nombre':_0x4346c2(0x2da)},{'codigo':_0x4346c2(0x2cc),'nombre':'MILIMETRO\x20CUBICO'},{'codigo':_0x4346c2(0x20a),'nombre':_0x4346c2(0x26d)},{'codigo':'UM','nombre':_0x4346c2(0x2e5)},{'codigo':_0x4346c2(0x276),'nombre':'ONZAS'},{'codigo':'PF','nombre':_0x4346c2(0x2de)},{'codigo':'PK','nombre':_0x4346c2(0x230)},{'codigo':'PR','nombre':'PAR'},{'codigo':_0x4346c2(0x28e),'nombre':_0x4346c2(0x292)},{'codigo':_0x4346c2(0x288),'nombre':_0x4346c2(0x26b)},{'codigo':_0x4346c2(0x2d2),'nombre':'PIES\x20CUBICOS'},{'codigo':'C62','nombre':_0x4346c2(0x2db)},{'codigo':'PG','nombre':_0x4346c2(0x1e6)},{'codigo':'ST','nombre':_0x4346c2(0x260)},{'codigo':'INH','nombre':_0x4346c2(0x25b)},{'codigo':'RM','nombre':_0x4346c2(0x261)},{'codigo':'SA','nombre':_0x4346c2(0x2a0)},{'codigo':'DR','nombre':_0x4346c2(0x21d)},{'codigo':_0x4346c2(0x211),'nombre':_0x4346c2(0x22e)},{'codigo':'LTN','nombre':_0x4346c2(0x26a)},{'codigo':_0x4346c2(0x20c),'nombre':_0x4346c2(0x228)},{'codigo':'TU','nombre':_0x4346c2(0x289)},{'codigo':_0x4346c2(0x244),'nombre':_0x4346c2(0x208)},{'codigo':'ZZ','nombre':_0x4346c2(0x241)},{'codigo':_0x4346c2(0x2a4),'nombre':'US\x20GALON\x20(3,7843\x20L)'},{'codigo':_0x4346c2(0x24a),'nombre':_0x4346c2(0x209)},{'codigo':_0x4346c2(0x2b8),'nombre':_0x4346c2(0x2bc)},{'codigo':'QQM','nombre':'QUINTAL'}],_0x151050=_0x5e8922['reduce']((_0xaf4b1d,{nombre:_0x4b1c4e,codigo:_0x29bb8d})=>{const _0x4efd8a=_0x4346c2;return _0xaf4b1d[_0x4b1c4e['trim']()]=_0x29bb8d[_0x4efd8a(0x264)](),_0xaf4b1d;},{});for(let _0x1b9d2f=0x0;_0x1b9d2f<_0x494a52;_0x1b9d2f+=_0x7803ea){const _0x2d28e7=_0x164268[_0x4346c2(0x255)](_0x1b9d2f,_0x1b9d2f+_0x7803ea)[_0x4346c2(0x269)]((_0x5a3295,_0xdf60c1)=>{const _0x4da170=_0x4346c2;let _0x3e63b2={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x5a3295['Tipo*']]||'1';const _0x489b9f=String(_0x5a3295[_0x4da170(0x2d0)])[_0x4da170(0x264)](),_0x31eb1f={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x1f2c1f=_0x31eb1f[_0x489b9f]||'1',_0x5ab7a8={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x1f2c1f]||{'code':'10','value':0x12},_0x4db510={};let _0x4a875a=String(_0x5a3295[_0x4da170(0x1fa)])[_0x4da170(0x264)]();const _0x1cbc39=[_0x4da170(0x22d),_0x4da170(0x1fe),'Color','Género',_0x4da170(0x2bd),'Serie','Material',_0x4da170(0x265),_0x4da170(0x2cb)];_0x1cbc39['forEach'](_0x52b1ad=>{const _0x147462=String(_0x5a3295[_0x52b1ad]||'')['trim']();_0x147462&&(_0x4db510[_0x52b1ad]=_0x147462,_0x4a875a+='\x20'+_0x52b1ad+'\x20'+_0x147462);});const _0x19cdda=[],_0x324134=String(_0x5a3295[_0x4da170(0x224)]||_0x4da170(0x208))['trim'](),_0x238c4b=_0x151050[_0x324134]||_0x4da170(0x244),_0x4374e1=String(_0x5a3295[_0x4da170(0x297)])[_0x4da170(0x264)]();_0x19cdda['push']({'setItemUnitId':String(_0x5a3295[_0x4da170(0x2df)])['trim']()||'','setItemBarCode':String(_0x5a3295[_0x4da170(0x259)])[_0x4da170(0x264)]()||'','setAlias':_0x4374e1,'setUnitCode':_0x238c4b,'setPrice':parseFloat(_0x5a3295[_0x4da170(0x1f0)]),'setCost':parseFloat(_0x5a3295[_0x4da170(0x23d)]),'setPriceUSD':parseFloat(_0x5a3295[_0x4da170(0x23c)]),'setCostUSD':parseFloat(_0x5a3295[_0x4da170(0x22b)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x5a3295[_0x4da170(0x273)])});const _0x3a048f=['ID\x20UNIT\x202',_0x4da170(0x2c4),'Código\x20de\x20Barras\x202','Equivalencia\x202',_0x4da170(0x1ed),_0x4da170(0x221),_0x4da170(0x27a),_0x4da170(0x250)][_0x4da170(0x243)](_0x39bd9a=>{const _0x39eea7=_0x4da170,_0x1fade2=_0x5a3295[_0x39bd9a];return _0x1fade2!=null&&String(_0x1fade2)[_0x39eea7(0x264)]()!=='';});if(_0x3a048f){const _0x1db647=String(_0x5a3295['Unidad\x20de\x20Medida\x202']||_0x4da170(0x2a3))[_0x4da170(0x264)](),_0x3392c1=_0x151050[_0x1db647]||_0x4da170(0x244);_0x19cdda[_0x4da170(0x252)]({'setItemUnitId':String(_0x5a3295[_0x4da170(0x2cd)])[_0x4da170(0x264)]()||'','setItemBarCode':String(_0x5a3295[_0x4da170(0x24c)])[_0x4da170(0x264)]()||'','setAlias':String(_0x5a3295['Alias\x202'])[_0x4da170(0x264)](),'setUnitCode':_0x3392c1,'setPrice':parseFloat(_0x5a3295[_0x4da170(0x1ed)]),'setCost':parseFloat(_0x5a3295[_0x4da170(0x221)]),'setPriceUSD':parseFloat(_0x5a3295[_0x4da170(0x27a)]),'setCostUSD':parseFloat(_0x5a3295[_0x4da170(0x250)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x5a3295[_0x4da170(0x277)])||0x1,'setFactor':parseFloat(_0x5a3295[_0x4da170(0x277)])||0x1,'setItemCommissionPercentage':parseFloat(_0x5a3295[_0x4da170(0x293)])});}const _0x5150b1=[_0x4da170(0x238),_0x4da170(0x216),_0x4da170(0x2a9),'Equivalencia\x203',_0x4da170(0x1ee),_0x4da170(0x2d1),_0x4da170(0x272),_0x4da170(0x2b5)][_0x4da170(0x243)](_0xb92be9=>{const _0x52e45=_0x4da170,_0x295736=_0x5a3295[_0xb92be9];return _0x295736!=null&&String(_0x295736)[_0x52e45(0x264)]()!=='';});if(_0x5150b1){const _0x2913db=String(_0x5a3295[_0x4da170(0x2ba)]||_0x4da170(0x2a3))[_0x4da170(0x264)](),_0x514bf9=_0x151050[_0x2913db]||'NIU';_0x19cdda[_0x4da170(0x252)]({'setItemUnitId':String(_0x5a3295['ID\x20UNIT\x203'])[_0x4da170(0x264)]()||'','setItemBarCode':String(_0x5a3295[_0x4da170(0x2a9)])[_0x4da170(0x264)]()||'','setAlias':String(_0x5a3295[_0x4da170(0x216)])[_0x4da170(0x264)](),'setUnitCode':_0x514bf9,'setPrice':parseFloat(_0x5a3295['Precio\x20Venta\x20Soles\x203']),'setCost':parseFloat(_0x5a3295['Precio\x20Costo\x20Soles\x203']),'setPriceUSD':parseFloat(_0x5a3295[_0x4da170(0x272)]),'setCostUSD':parseFloat(_0x5a3295[_0x4da170(0x2b5)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x5a3295['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0x5a3295[_0x4da170(0x22a)])||0x1,'setItemCommissionPercentage':parseFloat(_0x5a3295[_0x4da170(0x220)])});}let _0x2f97fa=_0x5a3295[_0x4da170(0x214)],_0x540ee4='';if(_0x2f97fa instanceof Date){const _0x4a59d4=_0x2f97fa[_0x4da170(0x25f)](),_0x2d0961=String(_0x2f97fa['getMonth']()+0x1)[_0x4da170(0x231)](0x2,'0'),_0x45bdd6=String(_0x2f97fa[_0x4da170(0x237)]())[_0x4da170(0x231)](0x2,'0');_0x540ee4=_0x4a59d4+'-'+_0x2d0961+'-'+_0x45bdd6;}else{if(typeof _0x2f97fa===_0x4da170(0x1ff)){const _0x26681e=XLSX['SSF'][_0x4da170(0x2a8)](_0x2f97fa);if(_0x26681e){const _0xa86cb2=_0x26681e['y'],_0x3328fd=String(_0x26681e['m'])[_0x4da170(0x231)](0x2,'0'),_0x10ece5=String(_0x26681e['d'])[_0x4da170(0x231)](0x2,'0');_0x540ee4=_0xa86cb2+'-'+_0x3328fd+'-'+_0x10ece5;}}else _0x540ee4=String(_0x2f97fa||'')[_0x4da170(0x264)]();}return{'setItemId':String(_0x5a3295['ID'])[_0x4da170(0x264)](),'setItemType':_0x3e63b2,'setItemCode':String(_0x5a3295[_0x4da170(0x267)])[_0x4da170(0x264)](),'setItemName':String(_0x5a3295[_0x4da170(0x1fa)])[_0x4da170(0x264)](),'setItemDescription':String(_0x5a3295[_0x4da170(0x280)])[_0x4da170(0x264)]()||'','setItemIsSold':_0x5a3295['Se\x20Vende']=='SI'?0x1:0x0,'setItemIsBought':_0x5a3295[_0x4da170(0x227)]=='SI'?0x1:0x0,'setItemCategories':_0x5a3295[_0x4da170(0x2c3)]?[String(_0x5a3295[_0x4da170(0x2c3)])['trim']()]:[],'setItemBrands':_0x5a3295[_0x4da170(0x2c8)]?[String(_0x5a3295[_0x4da170(0x2c8)])[_0x4da170(0x264)]()]:[],'setItemTaxId':_0x1f2c1f,'setItemTaxCode':_0x5ab7a8[_0x4da170(0x29a)],'setItemTaxValue':_0x5ab7a8[_0x4da170(0x203)],'setItemUnits':_0x19cdda,'setItemInventoriable':_0x5a3295[_0x4da170(0x219)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x5a3295[_0x4da170(0x23a)])||0x0,'setStockMinimum':parseFloat(_0x5a3295[_0x4da170(0x2c0)])||0x0,'setItemLocation':String(_0x5a3295[_0x4da170(0x2d5)])['trim']()||'','setBatchName':String(_0x5a3295[_0x4da170(0x22d)])[_0x4da170(0x264)]()||'','setItemDateExpiry':_0x540ee4,'setItemVariantName':_0x4a875a,'setItemVariantValues':_0x4db510,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x5c7f0e['push'](..._0x2d28e7),postMessage({'type':'progress','payload':{'percent':Math[_0x4346c2(0x202)]((_0x1b9d2f+_0x2d28e7['length'])/_0x494a52*0x64),'message':'Procesadas\x20filas\x20'+(_0x1b9d2f+0x1)+'–'+(_0x1b9d2f+_0x2d28e7[_0x4346c2(0x291)])+'/'+_0x494a52}});}postMessage({'type':_0x4346c2(0x26c),'payload':{'items':_0x5c7f0e}});}catch(_0x57fcaa){postMessage({'type':_0x4346c2(0x262),'payload':_0x57fcaa[_0x4346c2(0x24b)]||_0x57fcaa});}}if(_0x5b951d===_0x4346c2(0x29f)){const {products:_0x1233fd,plantillaBuf:_0x5c6023}=_0x5ee14d;if(!(_0x5c6023 instanceof ArrayBuffer)){postMessage({'type':'error','payload':_0x4346c2(0x1f4)});return;}if(!Array[_0x4346c2(0x25c)](_0x1233fd)){postMessage({'type':'error','payload':'exportItems:\x20products\x20no\x20es\x20Array.'});return;}try{structuredClone(_0x1233fd);}catch(_0x406fd8){postMessage({'type':_0x4346c2(0x262),'payload':_0x4346c2(0x23f)+_0x406fd8['message']});return;}try{const _0x110a2b={'1':'Artículo','2':'Servicio','3':_0x4346c2(0x2d4),'4':'Combo','5':_0x4346c2(0x29b)};function _0x5de389(_0x2511de){const _0x1d0e22=_0x4346c2;return _0x110a2b[String(_0x2511de)]||_0x1d0e22(0x20b);}const _0xbe37={'1':_0x4346c2(0x2a6),'2':_0x4346c2(0x1f1),'3':_0x4346c2(0x2d8),'4':_0x4346c2(0x23e),'5':'Inafecto\x20Gratuito\x20(0%)','6':_0x4346c2(0x286),'7':'Exonerado\x20Gratuito\x20(0%)','8':_0x4346c2(0x1fc),'9':'Gravado\x20Gratuito\x20(10%)'};function _0x29ce0f(_0x3a6d49){const _0x59821f=_0x4346c2;return _0xbe37[String(_0x3a6d49)]||_0x59821f(0x2a6);}const _0x597f9b={'4A':_0x4346c2(0x27c),'BJ':_0x4346c2(0x20f),'BLL':'BARRILES','BG':_0x4346c2(0x254),'BO':_0x4346c2(0x1e5),'BX':_0x4346c2(0x2b4),'CT':'CARTONES','CMK':_0x4346c2(0x24d),'CMQ':_0x4346c2(0x2e6),'CMT':'CENTIMETRO\x20LINEAL','CEN':_0x4346c2(0x2ae),'CY':'CILINDRO','CJ':_0x4346c2(0x232),'DZN':_0x4346c2(0x2be),'DZP':'DOCENA\x20POR\x2010**6','BE':_0x4346c2(0x2b2),'GLI':_0x4346c2(0x2ad),'GRM':_0x4346c2(0x27f),'GRO':_0x4346c2(0x251),'HLT':_0x4346c2(0x1fd),'LEF':_0x4346c2(0x270),'SET':_0x4346c2(0x27b),'KGM':_0x4346c2(0x282),'KTM':_0x4346c2(0x275),'KWH':_0x4346c2(0x294),'KT':_0x4346c2(0x212),'CA':_0x4346c2(0x21e),'LBR':_0x4346c2(0x29d),'LTR':_0x4346c2(0x287),'MWH':'MEGAWATT\x20HORA','MTR':_0x4346c2(0x1fb),'MTK':'METRO\x20CUADRADO','MTQ':_0x4346c2(0x248),'MGM':_0x4346c2(0x2ce),'MLT':_0x4346c2(0x229),'MMT':_0x4346c2(0x22f),'MMK':_0x4346c2(0x2da),'MMQ':_0x4346c2(0x29e),'MIL':_0x4346c2(0x26d),'UM':_0x4346c2(0x2e5),'ONZ':_0x4346c2(0x284),'PF':'PALETAS','PK':_0x4346c2(0x230),'PR':_0x4346c2(0x225),'FOT':'PIES','FTK':_0x4346c2(0x26b),'FTQ':_0x4346c2(0x28f),'C62':_0x4346c2(0x2db),'PG':_0x4346c2(0x1e6),'ST':_0x4346c2(0x260),'INH':_0x4346c2(0x25b),'RM':'RESMA','SA':_0x4346c2(0x2a0),'DR':_0x4346c2(0x21d),'STN':_0x4346c2(0x22e),'LTN':_0x4346c2(0x26a),'TNE':_0x4346c2(0x228),'TU':_0x4346c2(0x289),'NIU':'UNIDAD\x20(NIU)','ZZ':_0x4346c2(0x241),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':_0x4346c2(0x209),'YDK':'YARDA\x20CUADRADA','QQM':_0x4346c2(0x22c)};function _0x377aa9(_0x102bd1){return _0x597f9b[String(_0x102bd1)]||'';}const _0x2ab5d1=XLSX[_0x4346c2(0x236)](_0x5c6023,{'type':_0x4346c2(0x2c6),'cellDates':!![]}),_0xfde726=_0x2ab5d1['SheetNames'][0x0],_0x43c48e=_0x2ab5d1[_0x4346c2(0x1f2)][_0xfde726],_0x5b9e42=XLSX[_0x4346c2(0x233)][_0x4346c2(0x213)](_0x43c48e,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x477633=XLSX[_0x4346c2(0x233)][_0x4346c2(0x240)](_0x43c48e[_0x4346c2(0x2b3)]||'');for(let _0x44cb38=0x2;_0x44cb38<=_0x477633['e']['r'];++_0x44cb38){for(let _0x3e27f0=_0x477633['s']['c'];_0x3e27f0<=_0x477633['e']['c'];++_0x3e27f0){const _0x324043=XLSX[_0x4346c2(0x233)]['encode_cell']({'r':_0x44cb38,'c':_0x3e27f0});if(_0x43c48e[_0x324043])delete _0x43c48e[_0x324043];}}const _0x50f66b=_0x1233fd[_0x4346c2(0x269)](_0x5ab707=>{const _0x51b13c=_0x4346c2;_0x5ab707[_0x51b13c(0x234)]=_0x5ab707['setItemVariantValues']||{};const _0x38c234={};return _0x5b9e42[_0x51b13c(0x2aa)](_0x260643=>{const _0x416783=_0x51b13c,_0x1167bd=String(_0x260643)[_0x416783(0x264)](),_0x569979=_0x1167bd[_0x416783(0x1e9)](),_0x1a7b8c=Object[_0x416783(0x2c2)](_0x5ab707)['find'](_0x555b22=>_0x555b22[_0x416783(0x264)]()[_0x416783(0x1e9)]()===_0x569979);if(_0x1a7b8c){_0x38c234[_0x1167bd]=_0x5ab707[_0x1a7b8c]??'';return;}switch(_0x1167bd){case'ID':_0x38c234[_0x1167bd]=_0x5ab707['id']??'';break;case _0x416783(0x2c9):_0x38c234[_0x1167bd]=_0x5de389(_0x5ab707[_0x416783(0x2d3)]);break;case _0x416783(0x267):_0x38c234[_0x1167bd]=_0x5ab707['setCodProducto']??'';break;case'Nombre*':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x24f)]??'';break;case _0x416783(0x280):_0x38c234[_0x1167bd]=_0x5ab707['setItemDescription']??'';break;case _0x416783(0x279):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x24e)]==0x1?'SI':'NO';break;case _0x416783(0x227):_0x38c234[_0x1167bd]=_0x5ab707['setItemIsBought']==0x1?'SI':'NO';break;case _0x416783(0x2c3):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x258)]??'';break;case _0x416783(0x2c8):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x20e)]??'';break;case _0x416783(0x2d0):_0x38c234[_0x1167bd]=_0x29ce0f(_0x5ab707[_0x416783(0x28c)]);break;case'ID\x20UNIT':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x21f)]??'';break;case _0x416783(0x297):_0x38c234[_0x1167bd]=_0x5ab707['setItemUnitAlias']??'';break;case _0x416783(0x259):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x25a)]??'';break;case _0x416783(0x224):_0x38c234[_0x1167bd]=_0x377aa9(_0x5ab707[_0x416783(0x201)]);break;case'Precio\x20Venta\x20Soles':_0x38c234[_0x1167bd]=_0x5ab707['PEN_setMtoPrecioUnitario']??'';break;case'Precio\x20Costo\x20Soles':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x2b9)]??'';break;case _0x416783(0x23c):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x2af)]??'';break;case'Precio\x20Costo\x20Dólares':_0x38c234[_0x1167bd]=_0x5ab707['USD_setMtoPrecioCostoUnitario']??'';break;case _0x416783(0x273):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x2dd)];break;case _0x416783(0x2cd):_0x38c234[_0x1167bd]=_0x5ab707['setUnitId2']??'';break;case'Alias\x202':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x290)]??'';break;case _0x416783(0x24c):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x21a)]??'';break;case _0x416783(0x20d):_0x38c234[_0x1167bd]=_0x377aa9(_0x5ab707['setUnidadCodigo2']);break;case _0x416783(0x277):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x299)]??'1';break;case'Precio\x20Venta\x20Soles\x202':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x266)]??'';break;case'Precio\x20Costo\x20Soles\x202':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x246)]??'';break;case _0x416783(0x27a):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x2cf)]??'';break;case _0x416783(0x250):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x2c1)]??'';break;case'Comisión\x20Venta\x202\x20(%)':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x2a2)];break;case _0x416783(0x238):_0x38c234[_0x1167bd]=_0x5ab707['setUnitId3']??'';break;case _0x416783(0x216):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x1ea)]??'';break;case'Código\x20de\x20Barras\x203':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x1f5)]??'';break;case _0x416783(0x2ba):_0x38c234[_0x1167bd]=_0x377aa9(_0x5ab707[_0x416783(0x25d)]);break;case _0x416783(0x22a):_0x38c234[_0x1167bd]=_0x5ab707['setUnidadEquivalencia3']??'1';break;case _0x416783(0x1ee):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x2bf)]??'';break;case _0x416783(0x2d1):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x296)]??'';break;case _0x416783(0x272):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x222)]??'';break;case _0x416783(0x2b5):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x1e7)]??'';break;case _0x416783(0x220):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x210)];break;case'Rastrear\x20Inventario':_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x218)]==0x1?'SI':'NO';break;case _0x416783(0x23a):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x2bb)]??'';break;case _0x416783(0x2c0):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x27d)]??'';break;case _0x416783(0x214):_0x38c234[_0x1167bd]=_0x5ab707[_0x416783(0x206)]??'';break;default:_0x38c234[_0x1167bd]='';}}),_0x38c234;}),_0x26f461=0x3e8,_0x50afea=_0x50f66b[_0x4346c2(0x291)];for(let _0x322028=0x0;_0x322028<_0x50afea;_0x322028+=_0x26f461){const _0xcdea7e=_0x50f66b['slice'](_0x322028,_0x322028+_0x26f461);XLSX['utils'][_0x4346c2(0x28a)](_0x43c48e,_0xcdea7e,{'origin':{'r':_0x322028+0x2,'c':0x0},'skipHeader':!![],'header':_0x5b9e42}),postMessage({'type':'progress','payload':{'percent':Math[_0x4346c2(0x202)]((_0x322028+_0xcdea7e[_0x4346c2(0x291)])/_0x50afea*0x64),'message':_0x4346c2(0x2e3)+(_0x322028+0x1)+'–'+(_0x322028+_0xcdea7e[_0x4346c2(0x291)])+_0x4346c2(0x1f7)+_0x50afea}});}const _0x492883={'s':{'r':0x0,'c':0x0},'e':{'r':_0x50afea+0x1,'c':_0x5b9e42[_0x4346c2(0x291)]-0x1}};_0x43c48e['!ref']=XLSX[_0x4346c2(0x233)][_0x4346c2(0x274)](_0x492883);const _0x11f294=XLSX[_0x4346c2(0x215)](_0x2ab5d1,{'bookType':_0x4346c2(0x2c5),'type':_0x4346c2(0x2c6)});let _0x2a312b,_0x5063bc;if(_0x11f294 instanceof Uint8Array)_0x2a312b=_0x11f294,_0x5063bc=[_0x11f294[_0x4346c2(0x2ac)]];else{if(_0x11f294 instanceof ArrayBuffer)_0x2a312b=new Uint8Array(_0x11f294),_0x5063bc=[_0x11f294];else{const _0x4cf182=new Uint8Array(_0x11f294);_0x2a312b=_0x4cf182,_0x5063bc=[_0x4cf182['buffer']];}}postMessage({'type':_0x4346c2(0x245),'payload':{'wbout':_0x2a312b,'count':_0x50f66b['length']}},_0x5063bc);}catch(_0x4e6f22){postMessage({'type':'error','payload':_0x4e6f22[_0x4346c2(0x24b)]||String(_0x4e6f22)});}return;}};