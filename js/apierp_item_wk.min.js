/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.1.9
*/

const _0x56c225=_0x5f44;(function(_0x329cf2,_0x3a5198){const _0xde6e8a=_0x5f44,_0x4dc0eb=_0x329cf2();while(!![]){try{const _0x4a8921=-parseInt(_0xde6e8a(0x16f))/0x1+parseInt(_0xde6e8a(0x172))/0x2*(parseInt(_0xde6e8a(0x1ff))/0x3)+parseInt(_0xde6e8a(0x185))/0x4+-parseInt(_0xde6e8a(0x1d8))/0x5+-parseInt(_0xde6e8a(0x12f))/0x6*(-parseInt(_0xde6e8a(0x209))/0x7)+-parseInt(_0xde6e8a(0x18f))/0x8*(parseInt(_0xde6e8a(0x137))/0x9)+parseInt(_0xde6e8a(0x1c6))/0xa;if(_0x4a8921===_0x3a5198)break;else _0x4dc0eb['push'](_0x4dc0eb['shift']());}catch(_0x5820be){_0x4dc0eb['push'](_0x4dc0eb['shift']());}}}(_0x3206,0x26df3));const _0x3ffa0b=(function(){let _0x43d919=!![];return function(_0x2c8b97,_0x21a64b){const _0x5d9a41=_0x43d919?function(){if(_0x21a64b){const _0x8e201c=_0x21a64b['apply'](_0x2c8b97,arguments);return _0x21a64b=null,_0x8e201c;}}:function(){};return _0x43d919=![],_0x5d9a41;};}()),_0x1d0df1=_0x3ffa0b(this,function(){const _0x1bb6cb=_0x5f44;return _0x1d0df1[_0x1bb6cb(0x16b)]()[_0x1bb6cb(0x1c3)](_0x1bb6cb(0x1fe))[_0x1bb6cb(0x16b)]()['constructor'](_0x1d0df1)[_0x1bb6cb(0x1c3)](_0x1bb6cb(0x1fe));});function _0x5f44(_0x54eaa0,_0xf8e3c1){const _0x2dec7f=_0x3206();return _0x5f44=function(_0x54807e,_0x524201){_0x54807e=_0x54807e-0x12c;let _0x3df2ed=_0x2dec7f[_0x54807e];return _0x3df2ed;},_0x5f44(_0x54eaa0,_0xf8e3c1);}_0x1d0df1();const _0x524201=(function(){let _0x5d65f3=!![];return function(_0x2eecc0,_0x22cb34){const _0x1772e1=_0x5d65f3?function(){const _0x14d2ef=_0x5f44;if(_0x22cb34){const _0x4b578d=_0x22cb34[_0x14d2ef(0x1f5)](_0x2eecc0,arguments);return _0x22cb34=null,_0x4b578d;}}:function(){};return _0x5d65f3=![],_0x1772e1;};}()),_0x54807e=_0x524201(this,function(){const _0x46c2b8=_0x5f44,_0x40ffc6=function(){const _0x1767f6=_0x5f44;let _0x3f5364;try{_0x3f5364=Function(_0x1767f6(0x16c)+_0x1767f6(0x213)+');')();}catch(_0x5b8c3f){_0x3f5364=window;}return _0x3f5364;},_0x16f61d=_0x40ffc6(),_0x207db0=_0x16f61d['console']=_0x16f61d[_0x46c2b8(0x14b)]||{},_0x30d617=[_0x46c2b8(0x1c8),_0x46c2b8(0x205),_0x46c2b8(0x227),_0x46c2b8(0x17e),_0x46c2b8(0x13f),'table','trace'];for(let _0x5e63e9=0x0;_0x5e63e9<_0x30d617[_0x46c2b8(0x1d2)];_0x5e63e9++){const _0x270254=_0x524201[_0x46c2b8(0x170)][_0x46c2b8(0x195)]['bind'](_0x524201),_0x4780a6=_0x30d617[_0x5e63e9],_0x1bc4fb=_0x207db0[_0x4780a6]||_0x270254;_0x270254['__proto__']=_0x524201[_0x46c2b8(0x217)](_0x524201),_0x270254[_0x46c2b8(0x16b)]=_0x1bc4fb[_0x46c2b8(0x16b)][_0x46c2b8(0x217)](_0x1bc4fb),_0x207db0[_0x4780a6]=_0x270254;}});function _0x3206(){const _0x245b36=['Precio\x20Venta\x20Dólares\x203','ID\x20UNIT\x203','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','YARDA','push','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','BOLSA','SSF','Alias\x203','Precio\x20Costo\x20Dólares\x203','some','GRM','FTK','MIL','PEN_setMtoPrecioUnitario3','GALON\x20INGLES\x20(4,545956L)','KILOVATIO\x20HORA','exportItems:\x20products\x20no\x20es\x20Array.','TNE','Rastrear\x20Inventario','Unidad\x20de\x20Medida*','setMarca','LIBRAS','setItemCommissionPercentage2','Gravado\x20Gratuito\x20(10%)','PIES\x20CUADRADOS','LTN','toString','return\x20(function()\x20','Código\x20de\x20Barras\x202','setUnidadEquivalencia3','189902ofxExJ','constructor','Precio\x20Venta\x20Dólares','408hlWuXF','setItemCommissionPercentage','TAMBOR','CMT','MILIMETRO\x20CUBICO','Servicio','toLowerCase','Lote','SheetNames','setCategoria','Categoría','MMQ','error','PIES','xlsx','YDK','STN','message','PLIEGO','437944ruTday','Precio\x20Venta\x20Soles\x203','setCodProducto','HOJA','Descripción','parse_date_code','Nombre*','USD_setMtoPrecioUnitario2','reduce','code','73624DbdGEd','Iniciando\x20parseo…','QUINTAL','CAJA','BOBINAS','SACO','prototype','PULGADAS','CMQ','BOTELLAS','FOT','setUnidadEquivalencia2','DZP','Comisión\x20Venta\x20(%)','MMK','PAR','import','DOCENA\x20POR\x2010**6','CIENTO\x20DE\x20UNIDADES','Se\x20Vende','CONOS','METRO\x20CUBICO','CENTIMETRO\x20LINEAL','YARDA\x20CUADRADA','MMT','RESMA','ID\x20UNIT\x202','setUnitId2','Ubicación','Precio\x20Venta\x20Soles','UNIDAD\x20(ZZ)','MILIMETRO','setItemType','HECTOLITRO','Código\x20SKU*','USD_setMtoPrecioCostoUnitario2','CARTONES','TONELADAS','getDate','setItemUnitAlias','Código\x20de\x20Barras','!ref','Gravado\x20(18%)','Precio\x20Costo\x20Soles\x203','Procesadas\x20filas\x20','setItemUnitAlias2','filter','setInventariable','sheet_to_json','KILOMETRO','GRAMO','Materia\x20Prima','search','exportItems','array','4456110HMdoyi','Impuesto*','log','CENTIMETRO\x20CUBICO','setItemVariantValues','Unidad\x20de\x20Medida\x203','Marca','encode_range','LTR','Stock\x20Actual','Comisión\x20Venta\x203\x20(%)','Equivalencia\x203','length','setItemBarCode3','MILIGRAMOS','BALDE','QQM','progress','1579615hsUiJz','setItemBarCode2','KTM','write','METRO','CENTIMETRO\x20CUADRADO','Gravado\x20Gratuito\x20(18%)','CILINDRO','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','Exonerado\x20Gratuito\x20(0%)','MILLON\x20DE\x20UNIDADES','MLT','LATAS','Precio\x20Venta\x20Soles\x202','PIES\x20CUBICOS','setItemDescription','Stock\x20Mínimo','METRO\x20CUADRADO','Alias\x202','MWH','Precio\x20Venta\x20Dólares\x202','setBatchExpirationDate','KILOGRAMO','Artículo','PEN_setMtoPrecioCostoUnitario3','INH','UNIDAD\x20(NIU)','Sheets','exportItems:\x20productos\x20no\x20clonables:\x20','apply','trim','LITRO','UND\x20(NIU)','Precio\x20Costo\x20Soles\x202','El\x20archivo\x20tiene\x20','Se\x20Compra','Unidad\x20de\x20Medida\x202','ONZAS','(((.+)+)+)+$','1818VaRhjz','LBR','TONELADA\x20CORTA','sheet_add_json','getMonth','MEGAWATT\x20HORA','warn','Material','SET','ID\x20UNIT','177247LNZCKo','setUnidadCodigo2','findIndex','Tipo*','BARRILES','USD_setMtoPrecioUnitario3','setUnitId3','YRD','PEN_setMtoPrecioUnitario2','GRO','{}.constructor(\x22return\x20this\x22)(\x20)','setWarehouseStockMin','MILLARES','setItemIsBought','bind','done','KIT','isArray','keys','USD_setMtoPrecioCostoUnitario3','Serie','PLACAS','decode_range','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','GLL','Alias','Modelo\x20de\x20Manga','Género','PEN_setMtoPrecioCostoUnitario','PALETAS','info','GRUESA','setUnitId','JUEGO','NIU','DOCENA','60HotwAF','encode_cell','US\x20GALON\x20(3,7843\x20L)','Inafecto\x20Gratuito\x20(0%)','Equivalencia\x202','Exportando\x20filas\x20','MTQ','Código\x20de\x20Barras\x203','261xrvSJf','TONELADA\x20LARGA','Modelo\x20de\x20Cuello','PIEZAS','C62','Precio\x20Costo\x20Dólares','utils','forEach','exception','TUBOS','CMK','number','setItemCommissionPercentage3','value','setItemUnitAlias3','PAQUETE','MILIMETRO\x20CUADRADO','setDescripcion','setUnidadCodigo','HLT','console','MGM','padStart','slice','GLI'];_0x3206=function(){return _0x245b36;};return _0x3206();}_0x54807e(),importScripts(_0x56c225(0x220)),onmessage=({data:_0x68b02d})=>{const _0x38d9e3=_0x56c225,{action:_0x52ff6d}=_0x68b02d;if(_0x52ff6d===_0x38d9e3(0x19f)){const {buf:_0xc6860c,maxRows:_0x10eeb3}=_0x68b02d;try{postMessage({'type':_0x38d9e3(0x1d7),'payload':{'percent':0x5,'message':_0x38d9e3(0x190)}});const _0x4029e4=XLSX['read'](_0xc6860c,{'type':_0x38d9e3(0x1c5),'cellDates':!![]}),_0x37b9c2=_0x4029e4['Sheets'][_0x4029e4[_0x38d9e3(0x17a)][0x0]],_0x3b8bb9=XLSX[_0x38d9e3(0x13d)][_0x38d9e3(0x1bf)](_0x37b9c2,{'defval':'','range':0x1,'cellDates':!![]}),_0x291ebf=_0x3b8bb9[_0x38d9e3(0x20b)](_0x28874a=>(!_0x28874a[_0x38d9e3(0x20c)]||String(_0x28874a['Tipo*'])[_0x38d9e3(0x1f6)]()==='')&&(!_0x28874a[_0x38d9e3(0x1b1)]||String(_0x28874a[_0x38d9e3(0x1b1)])[_0x38d9e3(0x1f6)]()==='')&&(!_0x28874a[_0x38d9e3(0x18b)]||String(_0x28874a['Nombre*'])['trim']()==='')&&(!_0x28874a['Unidad\x20de\x20Medida*']||String(_0x28874a[_0x38d9e3(0x164)])[_0x38d9e3(0x1f6)]()==='')),_0x51f904=_0x291ebf>=0x0?_0x3b8bb9[_0x38d9e3(0x14e)](0x0,_0x291ebf):_0x3b8bb9,_0x3e1aa4=_0x51f904[_0x38d9e3(0x1bd)](_0x289f1a=>_0x289f1a[_0x38d9e3(0x20c)]&&String(_0x289f1a['Tipo*'])['trim']()!==''&&_0x289f1a[_0x38d9e3(0x1b1)]&&String(_0x289f1a[_0x38d9e3(0x1b1)])[_0x38d9e3(0x1f6)]()!==''&&_0x289f1a[_0x38d9e3(0x18b)]&&String(_0x289f1a[_0x38d9e3(0x18b)])[_0x38d9e3(0x1f6)]()!==''&&_0x289f1a[_0x38d9e3(0x164)]&&String(_0x289f1a[_0x38d9e3(0x164)])[_0x38d9e3(0x1f6)]()!==''),_0x3923e5=_0x3e1aa4[_0x38d9e3(0x1d2)];if(_0x3923e5===0x0){postMessage({'type':_0x38d9e3(0x17e),'payload':_0x38d9e3(0x152)});return;}if(_0x3923e5>_0x10eeb3)throw _0x38d9e3(0x1fa)+_0x3923e5+_0x38d9e3(0x155)+_0x10eeb3+'.';const _0x49b914=0x1f4,_0x189416=[],_0x301765=[{'codigo':'4A','nombre':_0x38d9e3(0x193)},{'codigo':'BJ','nombre':'BALDE'},{'codigo':'BLL','nombre':'BARRILES'},{'codigo':'BG','nombre':_0x38d9e3(0x156)},{'codigo':'BO','nombre':_0x38d9e3(0x198)},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':_0x38d9e3(0x1b3)},{'codigo':_0x38d9e3(0x141),'nombre':_0x38d9e3(0x1dd)},{'codigo':_0x38d9e3(0x197),'nombre':_0x38d9e3(0x1c9)},{'codigo':_0x38d9e3(0x175),'nombre':_0x38d9e3(0x1a5)},{'codigo':'CEN','nombre':'CIENTO\x20DE\x20UNIDADES'},{'codigo':'CY','nombre':_0x38d9e3(0x1df)},{'codigo':'CJ','nombre':_0x38d9e3(0x1a3)},{'codigo':'DZN','nombre':_0x38d9e3(0x12e)},{'codigo':_0x38d9e3(0x19b),'nombre':_0x38d9e3(0x1a0)},{'codigo':'BE','nombre':'FARDO'},{'codigo':_0x38d9e3(0x14f),'nombre':_0x38d9e3(0x15f)},{'codigo':_0x38d9e3(0x15b),'nombre':_0x38d9e3(0x1c1)},{'codigo':_0x38d9e3(0x212),'nombre':_0x38d9e3(0x228)},{'codigo':_0x38d9e3(0x14a),'nombre':_0x38d9e3(0x1b0)},{'codigo':'LEF','nombre':'HOJA'},{'codigo':_0x38d9e3(0x207),'nombre':_0x38d9e3(0x12c)},{'codigo':'KGM','nombre':'KILOGRAMO'},{'codigo':_0x38d9e3(0x1da),'nombre':_0x38d9e3(0x1c0)},{'codigo':'KWH','nombre':_0x38d9e3(0x160)},{'codigo':'KT','nombre':_0x38d9e3(0x219)},{'codigo':'CA','nombre':_0x38d9e3(0x1e4)},{'codigo':_0x38d9e3(0x200),'nombre':_0x38d9e3(0x166)},{'codigo':_0x38d9e3(0x1ce),'nombre':'LITRO'},{'codigo':_0x38d9e3(0x1eb),'nombre':'MEGAWATT\x20HORA'},{'codigo':'MTR','nombre':_0x38d9e3(0x1dc)},{'codigo':'MTK','nombre':'METRO\x20CUADRADO'},{'codigo':_0x38d9e3(0x135),'nombre':_0x38d9e3(0x1a4)},{'codigo':_0x38d9e3(0x14c),'nombre':'MILIGRAMOS'},{'codigo':_0x38d9e3(0x1e3),'nombre':'MILILITRO'},{'codigo':_0x38d9e3(0x1a7),'nombre':_0x38d9e3(0x1ae)},{'codigo':_0x38d9e3(0x19d),'nombre':_0x38d9e3(0x147)},{'codigo':_0x38d9e3(0x17d),'nombre':_0x38d9e3(0x176)},{'codigo':_0x38d9e3(0x15d),'nombre':_0x38d9e3(0x215)},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':'ONZ','nombre':_0x38d9e3(0x1fd)},{'codigo':'PF','nombre':_0x38d9e3(0x226)},{'codigo':'PK','nombre':_0x38d9e3(0x146)},{'codigo':'PR','nombre':'PAR'},{'codigo':_0x38d9e3(0x199),'nombre':'PIES'},{'codigo':_0x38d9e3(0x15c),'nombre':_0x38d9e3(0x169)},{'codigo':'FTQ','nombre':_0x38d9e3(0x1e6)},{'codigo':_0x38d9e3(0x13b),'nombre':_0x38d9e3(0x13a)},{'codigo':'PG','nombre':_0x38d9e3(0x21e)},{'codigo':'ST','nombre':_0x38d9e3(0x184)},{'codigo':_0x38d9e3(0x1f1),'nombre':_0x38d9e3(0x196)},{'codigo':'RM','nombre':_0x38d9e3(0x1a8)},{'codigo':'SA','nombre':_0x38d9e3(0x194)},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':_0x38d9e3(0x182),'nombre':_0x38d9e3(0x201)},{'codigo':_0x38d9e3(0x16a),'nombre':_0x38d9e3(0x138)},{'codigo':_0x38d9e3(0x162),'nombre':_0x38d9e3(0x1b4)},{'codigo':'TU','nombre':_0x38d9e3(0x140)},{'codigo':_0x38d9e3(0x12d),'nombre':'UNIDAD\x20(NIU)'},{'codigo':'ZZ','nombre':'UNIDAD\x20(ZZ)'},{'codigo':_0x38d9e3(0x221),'nombre':_0x38d9e3(0x131)},{'codigo':_0x38d9e3(0x210),'nombre':_0x38d9e3(0x153)},{'codigo':_0x38d9e3(0x181),'nombre':_0x38d9e3(0x1a6)},{'codigo':_0x38d9e3(0x1d6),'nombre':_0x38d9e3(0x191)}],_0x567c87=_0x301765[_0x38d9e3(0x18d)]((_0x4852c6,{nombre:_0x4567b3,codigo:_0x9a1978})=>{const _0x26d055=_0x38d9e3;return _0x4852c6[_0x4567b3['trim']()]=_0x9a1978[_0x26d055(0x1f6)](),_0x4852c6;},{});for(let _0x5e321d=0x0;_0x5e321d<_0x3923e5;_0x5e321d+=_0x49b914){const _0x49839d=_0x3e1aa4['slice'](_0x5e321d,_0x5e321d+_0x49b914)['map']((_0x5c561c,_0x2b39a2)=>{const _0x51a2b1=_0x38d9e3;let _0x248284={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x5c561c[_0x51a2b1(0x20c)]]||'1';const _0x4fa1b2=String(_0x5c561c[_0x51a2b1(0x1c7)])[_0x51a2b1(0x1f6)](),_0x4da41c={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x5c0760=_0x4da41c[_0x4fa1b2]||'1',_0x1b3153={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x5c0760]||{'code':'10','value':0x12},_0x2e2a00={};let _0x7fd1bf=String(_0x5c561c['Nombre*'])[_0x51a2b1(0x1f6)]();const _0x5efb9f=[_0x51a2b1(0x179),'Talla','Color',_0x51a2b1(0x224),'Modelo',_0x51a2b1(0x21d),_0x51a2b1(0x206),_0x51a2b1(0x139),_0x51a2b1(0x223)];_0x5efb9f[_0x51a2b1(0x13e)](_0x55ff93=>{const _0x4a60e8=_0x51a2b1,_0x15298e=String(_0x5c561c[_0x55ff93]||'')[_0x4a60e8(0x1f6)]();_0x15298e&&(_0x2e2a00[_0x55ff93]=_0x15298e,_0x7fd1bf+='\x20'+_0x55ff93+'\x20'+_0x15298e);});const _0x181056=[],_0xddbecb=String(_0x5c561c['Unidad\x20de\x20Medida*']||_0x51a2b1(0x1f2))[_0x51a2b1(0x1f6)](),_0x1476bc=_0x567c87[_0xddbecb]||_0x51a2b1(0x12d),_0x1003b2=String(_0x5c561c[_0x51a2b1(0x222)])[_0x51a2b1(0x1f6)]();_0x181056[_0x51a2b1(0x154)]({'setItemUnitId':String(_0x5c561c[_0x51a2b1(0x208)])[_0x51a2b1(0x1f6)]()||'','setItemBarCode':String(_0x5c561c[_0x51a2b1(0x1b7)])[_0x51a2b1(0x1f6)]()||'','setAlias':_0x1003b2,'setUnitCode':_0x1476bc,'setPrice':parseFloat(_0x5c561c[_0x51a2b1(0x1ac)]),'setCost':parseFloat(_0x5c561c['Precio\x20Costo\x20Soles']),'setPriceUSD':parseFloat(_0x5c561c[_0x51a2b1(0x171)]),'setCostUSD':parseFloat(_0x5c561c[_0x51a2b1(0x13c)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x5c561c['Comisión\x20Venta\x20(%)'])});const _0x4428f8=[_0x51a2b1(0x1a9),_0x51a2b1(0x1ea),_0x51a2b1(0x16d),'Equivalencia\x202','Precio\x20Venta\x20Soles\x202',_0x51a2b1(0x1f9),_0x51a2b1(0x1ec),'Precio\x20Costo\x20Dólares\x202'][_0x51a2b1(0x15a)](_0x86eaaa=>{const _0x3abc69=_0x51a2b1,_0x5d2ca1=_0x5c561c[_0x86eaaa];return _0x5d2ca1!=null&&String(_0x5d2ca1)[_0x3abc69(0x1f6)]()!=='';});if(_0x4428f8){const _0x4dcf79=String(_0x5c561c[_0x51a2b1(0x1fc)]||_0x51a2b1(0x1f8))[_0x51a2b1(0x1f6)](),_0x4551a8=_0x567c87[_0x4dcf79]||_0x51a2b1(0x12d);_0x181056[_0x51a2b1(0x154)]({'setItemUnitId':String(_0x5c561c[_0x51a2b1(0x1a9)])[_0x51a2b1(0x1f6)]()||'','setItemBarCode':String(_0x5c561c['Código\x20de\x20Barras\x202'])[_0x51a2b1(0x1f6)]()||'','setAlias':String(_0x5c561c[_0x51a2b1(0x1ea)])['trim'](),'setUnitCode':_0x4551a8,'setPrice':parseFloat(_0x5c561c[_0x51a2b1(0x1e5)]),'setCost':parseFloat(_0x5c561c[_0x51a2b1(0x1f9)]),'setPriceUSD':parseFloat(_0x5c561c[_0x51a2b1(0x1ec)]),'setCostUSD':parseFloat(_0x5c561c['Precio\x20Costo\x20Dólares\x202']),'setDefault':0x0,'setEquivalence':parseFloat(_0x5c561c[_0x51a2b1(0x133)])||0x1,'setFactor':parseFloat(_0x5c561c[_0x51a2b1(0x133)])||0x1,'setItemCommissionPercentage':parseFloat(_0x5c561c['Comisión\x20Venta\x202\x20(%)'])});}const _0x1a078e=['ID\x20UNIT\x203',_0x51a2b1(0x158),_0x51a2b1(0x136),_0x51a2b1(0x1d1),'Precio\x20Venta\x20Soles\x203','Precio\x20Costo\x20Soles\x203',_0x51a2b1(0x150),_0x51a2b1(0x159)]['some'](_0x2d0b6a=>{const _0x115500=_0x51a2b1,_0x588b9b=_0x5c561c[_0x2d0b6a];return _0x588b9b!=null&&String(_0x588b9b)[_0x115500(0x1f6)]()!=='';});if(_0x1a078e){const _0xdf396=String(_0x5c561c[_0x51a2b1(0x1cb)]||_0x51a2b1(0x1f8))['trim'](),_0x1da139=_0x567c87[_0xdf396]||_0x51a2b1(0x12d);_0x181056[_0x51a2b1(0x154)]({'setItemUnitId':String(_0x5c561c[_0x51a2b1(0x151)])[_0x51a2b1(0x1f6)]()||'','setItemBarCode':String(_0x5c561c[_0x51a2b1(0x136)])[_0x51a2b1(0x1f6)]()||'','setAlias':String(_0x5c561c[_0x51a2b1(0x158)])[_0x51a2b1(0x1f6)](),'setUnitCode':_0x1da139,'setPrice':parseFloat(_0x5c561c[_0x51a2b1(0x186)]),'setCost':parseFloat(_0x5c561c[_0x51a2b1(0x1ba)]),'setPriceUSD':parseFloat(_0x5c561c['Precio\x20Venta\x20Dólares\x203']),'setCostUSD':parseFloat(_0x5c561c[_0x51a2b1(0x159)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x5c561c['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0x5c561c[_0x51a2b1(0x1d1)])||0x1,'setItemCommissionPercentage':parseFloat(_0x5c561c['Comisión\x20Venta\x203\x20(%)'])});}let _0x33aa09=_0x5c561c['Fecha\x20de\x20Vencimiento'],_0x403e9f='';if(_0x33aa09 instanceof Date){const _0x33fb20=_0x33aa09['getFullYear'](),_0x2e1c4f=String(_0x33aa09[_0x51a2b1(0x203)]()+0x1)[_0x51a2b1(0x14d)](0x2,'0'),_0x37aa60=String(_0x33aa09[_0x51a2b1(0x1b5)]())[_0x51a2b1(0x14d)](0x2,'0');_0x403e9f=_0x33fb20+'-'+_0x2e1c4f+'-'+_0x37aa60;}else{if(typeof _0x33aa09===_0x51a2b1(0x142)){const _0x4abe6b=XLSX[_0x51a2b1(0x157)][_0x51a2b1(0x18a)](_0x33aa09);if(_0x4abe6b){const _0x1880a9=_0x4abe6b['y'],_0x260ecb=String(_0x4abe6b['m'])[_0x51a2b1(0x14d)](0x2,'0'),_0x13df9b=String(_0x4abe6b['d'])[_0x51a2b1(0x14d)](0x2,'0');_0x403e9f=_0x1880a9+'-'+_0x260ecb+'-'+_0x13df9b;}}else _0x403e9f=String(_0x33aa09||'')[_0x51a2b1(0x1f6)]();}return{'setItemId':String(_0x5c561c['ID'])[_0x51a2b1(0x1f6)](),'setItemType':_0x248284,'setItemCode':String(_0x5c561c[_0x51a2b1(0x1b1)])[_0x51a2b1(0x1f6)](),'setItemName':String(_0x5c561c[_0x51a2b1(0x18b)])['trim'](),'setItemDescription':String(_0x5c561c[_0x51a2b1(0x189)])[_0x51a2b1(0x1f6)]()||'','setItemIsSold':_0x5c561c[_0x51a2b1(0x1a2)]=='SI'?0x1:0x0,'setItemIsBought':_0x5c561c[_0x51a2b1(0x1fb)]=='SI'?0x1:0x0,'setItemCategories':_0x5c561c[_0x51a2b1(0x17c)]?[String(_0x5c561c[_0x51a2b1(0x17c)])[_0x51a2b1(0x1f6)]()]:[],'setItemBrands':_0x5c561c[_0x51a2b1(0x1cc)]?[String(_0x5c561c[_0x51a2b1(0x1cc)])[_0x51a2b1(0x1f6)]()]:[],'setItemTaxId':_0x5c0760,'setItemTaxCode':_0x1b3153[_0x51a2b1(0x18e)],'setItemTaxValue':_0x1b3153[_0x51a2b1(0x144)],'setItemUnits':_0x181056,'setItemInventoriable':_0x5c561c['Rastrear\x20Inventario']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x5c561c[_0x51a2b1(0x1cf)])||0x0,'setStockMinimum':parseFloat(_0x5c561c[_0x51a2b1(0x1e8)])||0x0,'setItemLocation':String(_0x5c561c[_0x51a2b1(0x1ab)])[_0x51a2b1(0x1f6)]()||'','setBatchName':String(_0x5c561c[_0x51a2b1(0x179)])['trim']()||'','setItemDateExpiry':_0x403e9f,'setItemVariantName':_0x7fd1bf,'setItemVariantValues':_0x2e2a00,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x189416[_0x38d9e3(0x154)](..._0x49839d),postMessage({'type':'progress','payload':{'percent':Math['round']((_0x5e321d+_0x49839d[_0x38d9e3(0x1d2)])/_0x3923e5*0x64),'message':_0x38d9e3(0x1bb)+(_0x5e321d+0x1)+'–'+(_0x5e321d+_0x49839d[_0x38d9e3(0x1d2)])+'/'+_0x3923e5}});}postMessage({'type':_0x38d9e3(0x218),'payload':{'items':_0x189416}});}catch(_0x435480){postMessage({'type':'error','payload':_0x435480[_0x38d9e3(0x183)]||_0x435480});}}if(_0x52ff6d===_0x38d9e3(0x1c4)){const {products:_0x4313ba,plantillaBuf:_0x4a19ad}=_0x68b02d;if(!(_0x4a19ad instanceof ArrayBuffer)){postMessage({'type':'error','payload':_0x38d9e3(0x1e0)});return;}if(!Array[_0x38d9e3(0x21a)](_0x4313ba)){postMessage({'type':_0x38d9e3(0x17e),'payload':_0x38d9e3(0x161)});return;}try{structuredClone(_0x4313ba);}catch(_0x20c3a2){postMessage({'type':_0x38d9e3(0x17e),'payload':_0x38d9e3(0x1f4)+_0x20c3a2[_0x38d9e3(0x183)]});return;}try{const _0x35a893={'1':_0x38d9e3(0x1ef),'2':_0x38d9e3(0x177),'3':_0x38d9e3(0x1c2),'4':'Combo','5':'Fabricado'};function _0x58803b(_0x48d050){return _0x35a893[String(_0x48d050)]||'Artículo';}const _0x208da2={'1':'Gravado\x20(18%)','2':'Exonerado\x20(0%)','3':'Inafecto\x20(0%)','4':_0x38d9e3(0x1de),'5':_0x38d9e3(0x132),'6':'Gravado\x20(10%)','7':_0x38d9e3(0x1e1),'8':'Exportación\x20(0%)','9':_0x38d9e3(0x168)};function _0x55a2f2(_0x46b4f5){const _0x359adf=_0x38d9e3;return _0x208da2[String(_0x46b4f5)]||_0x359adf(0x1b9);}const _0x42cbd3={'4A':_0x38d9e3(0x193),'BJ':_0x38d9e3(0x1d5),'BLL':_0x38d9e3(0x20d),'BG':_0x38d9e3(0x156),'BO':_0x38d9e3(0x198),'BX':_0x38d9e3(0x192),'CT':_0x38d9e3(0x1b3),'CMK':_0x38d9e3(0x1dd),'CMQ':_0x38d9e3(0x1c9),'CMT':_0x38d9e3(0x1a5),'CEN':_0x38d9e3(0x1a1),'CY':'CILINDRO','CJ':'CONOS','DZN':_0x38d9e3(0x12e),'DZP':'DOCENA\x20POR\x2010**6','BE':'FARDO','GLI':_0x38d9e3(0x15f),'GRM':_0x38d9e3(0x1c1),'GRO':_0x38d9e3(0x228),'HLT':'HECTOLITRO','LEF':_0x38d9e3(0x188),'SET':'JUEGO','KGM':_0x38d9e3(0x1ee),'KTM':_0x38d9e3(0x1c0),'KWH':'KILOVATIO\x20HORA','KT':_0x38d9e3(0x219),'CA':'LATAS','LBR':_0x38d9e3(0x166),'LTR':_0x38d9e3(0x1f7),'MWH':_0x38d9e3(0x204),'MTR':_0x38d9e3(0x1dc),'MTK':_0x38d9e3(0x1e9),'MTQ':_0x38d9e3(0x1a4),'MGM':_0x38d9e3(0x1d4),'MLT':'MILILITRO','MMT':_0x38d9e3(0x1ae),'MMK':_0x38d9e3(0x147),'MMQ':_0x38d9e3(0x176),'MIL':_0x38d9e3(0x215),'UM':_0x38d9e3(0x1e2),'ONZ':'ONZAS','PF':'PALETAS','PK':_0x38d9e3(0x146),'PR':_0x38d9e3(0x19e),'FOT':_0x38d9e3(0x17f),'FTK':_0x38d9e3(0x169),'FTQ':'PIES\x20CUBICOS','C62':_0x38d9e3(0x13a),'PG':'PLACAS','ST':_0x38d9e3(0x184),'INH':_0x38d9e3(0x196),'RM':_0x38d9e3(0x1a8),'SA':_0x38d9e3(0x194),'DR':_0x38d9e3(0x174),'STN':'TONELADA\x20CORTA','LTN':_0x38d9e3(0x138),'TNE':_0x38d9e3(0x1b4),'TU':_0x38d9e3(0x140),'NIU':_0x38d9e3(0x1f2),'ZZ':_0x38d9e3(0x1ad),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':'YARDA','YDK':_0x38d9e3(0x1a6),'QQM':'QUINTAL'};function _0xf54daf(_0x31dca6){return _0x42cbd3[String(_0x31dca6)]||'';}const _0x34f1c0=XLSX['read'](_0x4a19ad,{'type':_0x38d9e3(0x1c5),'cellDates':!![]}),_0xf006e5=_0x34f1c0[_0x38d9e3(0x17a)][0x0],_0x1fba51=_0x34f1c0[_0x38d9e3(0x1f3)][_0xf006e5],_0x44531e=XLSX[_0x38d9e3(0x13d)][_0x38d9e3(0x1bf)](_0x1fba51,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x29baf3=XLSX['utils'][_0x38d9e3(0x21f)](_0x1fba51[_0x38d9e3(0x1b8)]||'');for(let _0x45066e=0x2;_0x45066e<=_0x29baf3['e']['r'];++_0x45066e){for(let _0x3eb479=_0x29baf3['s']['c'];_0x3eb479<=_0x29baf3['e']['c'];++_0x3eb479){const _0x3ed1cb=XLSX['utils'][_0x38d9e3(0x130)]({'r':_0x45066e,'c':_0x3eb479});if(_0x1fba51[_0x3ed1cb])delete _0x1fba51[_0x3ed1cb];}}const _0x7161b9=_0x4313ba['map'](_0x165fb8=>{const _0x2bf41c=_0x38d9e3;_0x165fb8[_0x2bf41c(0x1ca)]=_0x165fb8[_0x2bf41c(0x1ca)]||{};const _0x2c4f0d={};return _0x44531e[_0x2bf41c(0x13e)](_0x1a4210=>{const _0x3cc3f7=_0x2bf41c,_0x45d965=String(_0x1a4210)['trim'](),_0x4f6701=_0x45d965[_0x3cc3f7(0x178)](),_0x48d64d=Object[_0x3cc3f7(0x21b)](_0x165fb8)['find'](_0x45f1b3=>_0x45f1b3['trim']()['toLowerCase']()===_0x4f6701);if(_0x48d64d){_0x2c4f0d[_0x45d965]=_0x165fb8[_0x48d64d]??'';return;}switch(_0x45d965){case'ID':_0x2c4f0d[_0x45d965]=_0x165fb8['id']??'';break;case _0x3cc3f7(0x20c):_0x2c4f0d[_0x45d965]=_0x58803b(_0x165fb8[_0x3cc3f7(0x1af)]);break;case _0x3cc3f7(0x1b1):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x187)]??'';break;case _0x3cc3f7(0x18b):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x148)]??'';break;case'Descripción':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1e7)]??'';break;case _0x3cc3f7(0x1a2):_0x2c4f0d[_0x45d965]=_0x165fb8['setItemIsSold']==0x1?'SI':'NO';break;case _0x3cc3f7(0x1fb):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x216)]==0x1?'SI':'NO';break;case _0x3cc3f7(0x17c):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x17b)]??'';break;case'Marca':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x165)]??'';break;case _0x3cc3f7(0x1c7):_0x2c4f0d[_0x45d965]=_0x55a2f2(_0x165fb8['setTaxId']);break;case _0x3cc3f7(0x208):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x229)]??'';break;case _0x3cc3f7(0x222):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1b6)]??'';break;case'Código\x20de\x20Barras':_0x2c4f0d[_0x45d965]=_0x165fb8['setItemBarCode']??'';break;case _0x3cc3f7(0x164):_0x2c4f0d[_0x45d965]=_0xf54daf(_0x165fb8[_0x3cc3f7(0x149)]);break;case _0x3cc3f7(0x1ac):_0x2c4f0d[_0x45d965]=_0x165fb8['PEN_setMtoPrecioUnitario']??'';break;case'Precio\x20Costo\x20Soles':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x225)]??'';break;case'Precio\x20Venta\x20Dólares':_0x2c4f0d[_0x45d965]=_0x165fb8['USD_setMtoPrecioUnitario']??'';break;case'Precio\x20Costo\x20Dólares':_0x2c4f0d[_0x45d965]=_0x165fb8['USD_setMtoPrecioCostoUnitario']??'';break;case _0x3cc3f7(0x19c):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x173)];break;case'ID\x20UNIT\x202':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1aa)]??'';break;case'Alias\x202':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1bc)]??'';break;case _0x3cc3f7(0x16d):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1d9)]??'';break;case _0x3cc3f7(0x1fc):_0x2c4f0d[_0x45d965]=_0xf54daf(_0x165fb8[_0x3cc3f7(0x20a)]);break;case'Equivalencia\x202':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x19a)]??'1';break;case _0x3cc3f7(0x1e5):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x211)]??'';break;case'Precio\x20Costo\x20Soles\x202':_0x2c4f0d[_0x45d965]=_0x165fb8['PEN_setMtoPrecioCostoUnitario2']??'';break;case _0x3cc3f7(0x1ec):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x18c)]??'';break;case'Precio\x20Costo\x20Dólares\x202':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1b2)]??'';break;case'Comisión\x20Venta\x202\x20(%)':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x167)];break;case _0x3cc3f7(0x151):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x20f)]??'';break;case _0x3cc3f7(0x158):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x145)]??'';break;case'Código\x20de\x20Barras\x203':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1d3)]??'';break;case'Unidad\x20de\x20Medida\x203':_0x2c4f0d[_0x45d965]=_0xf54daf(_0x165fb8['setUnidadCodigo3']);break;case _0x3cc3f7(0x1d1):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x16e)]??'1';break;case'Precio\x20Venta\x20Soles\x203':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x15e)]??'';break;case'Precio\x20Costo\x20Soles\x203':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1f0)]??'';break;case _0x3cc3f7(0x150):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x20e)]??'';break;case _0x3cc3f7(0x159):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x21c)]??'';break;case _0x3cc3f7(0x1d0):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x143)];break;case _0x3cc3f7(0x163):_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1be)]==0x1?'SI':'NO';break;case _0x3cc3f7(0x1cf):_0x2c4f0d[_0x45d965]=_0x165fb8['setSucursalStock']??'';break;case'Stock\x20Mínimo':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x214)]??'';break;case'Fecha\x20de\x20Vencimiento':_0x2c4f0d[_0x45d965]=_0x165fb8[_0x3cc3f7(0x1ed)]??'';break;default:_0x2c4f0d[_0x45d965]='';}}),_0x2c4f0d;}),_0x5b71b3=0x3e8,_0x6b6f61=_0x7161b9['length'];for(let _0x29082f=0x0;_0x29082f<_0x6b6f61;_0x29082f+=_0x5b71b3){const _0x236d9a=_0x7161b9['slice'](_0x29082f,_0x29082f+_0x5b71b3);XLSX[_0x38d9e3(0x13d)][_0x38d9e3(0x202)](_0x1fba51,_0x236d9a,{'origin':{'r':_0x29082f+0x2,'c':0x0},'skipHeader':!![],'header':_0x44531e}),postMessage({'type':'progress','payload':{'percent':Math['round']((_0x29082f+_0x236d9a[_0x38d9e3(0x1d2)])/_0x6b6f61*0x64),'message':_0x38d9e3(0x134)+(_0x29082f+0x1)+'–'+(_0x29082f+_0x236d9a[_0x38d9e3(0x1d2)])+'\x20de\x20'+_0x6b6f61}});}const _0x4a0784={'s':{'r':0x0,'c':0x0},'e':{'r':_0x6b6f61+0x1,'c':_0x44531e[_0x38d9e3(0x1d2)]-0x1}};_0x1fba51[_0x38d9e3(0x1b8)]=XLSX[_0x38d9e3(0x13d)][_0x38d9e3(0x1cd)](_0x4a0784);const _0x2aa914=XLSX[_0x38d9e3(0x1db)](_0x34f1c0,{'bookType':_0x38d9e3(0x180),'type':'array'});let _0x3dcd2d,_0xd9f333;if(_0x2aa914 instanceof Uint8Array)_0x3dcd2d=_0x2aa914,_0xd9f333=[_0x2aa914['buffer']];else{if(_0x2aa914 instanceof ArrayBuffer)_0x3dcd2d=new Uint8Array(_0x2aa914),_0xd9f333=[_0x2aa914];else{const _0x10cd77=new Uint8Array(_0x2aa914);_0x3dcd2d=_0x10cd77,_0xd9f333=[_0x10cd77['buffer']];}}postMessage({'type':'exportDone','payload':{'wbout':_0x3dcd2d,'count':_0x7161b9['length']}},_0xd9f333);}catch(_0x47d650){postMessage({'type':_0x38d9e3(0x17e),'payload':_0x47d650[_0x38d9e3(0x183)]||String(_0x47d650)});}return;}};