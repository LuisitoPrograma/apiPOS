/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.3.3
*/

const _0x58dbf0=_0xd12d;function _0x7fe8(){const _0x51fec3=['utils','METRO','round','buffer','GLL','HLT','DZN','FTQ','ONZAS','SET','DOCENA\x20POR\x2010**6','Nombre*','HECTOLITRO','BARRILES','YDK','setItemBarCode','C62','getFullYear','MILIMETRO\x20CUBICO','padStart','USD_setMtoPrecioCostoUnitario','filter','TONELADAS','Servicio','KILOGRAMO','Precio\x20Venta\x20Dólares','GRO','setSucursalStock','ID\x20UNIT','setDescripcion','Artículo','CMQ','UNIDAD\x20(NIU)','ONZ','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','bind','setUnitId','1990701JCdmhm','UNIDAD\x20(ZZ)','Precio\x20Costo\x20Dólares','¿Rastrear\x20Inventario?','PLACAS','UND\x20(NIU)','setTaxId','PAQUETE','parse_date_code','Unidad\x20de\x20Medida\x202','(((.+)+)+)+$','MMQ','Tipo*','PAR','KWH','trace','setBatchName','PIES\x20CUADRADOS','decode_range','BOLSA','setUnidadCodigo','Inafecto\x20Gratuito\x20(0%)','USD_setMtoPrecioUnitario2','PIEZAS','TUBOS','Exonerado\x20Gratuito\x20(0%)','HOJA','Gravado\x20Gratuito\x20(18%)','MEGAWATT\x20HORA','Stock\x20Mínimo','setUnidadCodigo2','MMT','MILLON\x20DE\x20UNIDADES','progress','CIENTO\x20DE\x20UNIDADES','El\x20archivo\x20tiene\x20','BALDE','PLIEGO','PULGADAS','Categoría','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','CMK','RESMA','YARDA\x20CUADRADA','setInventariable','exception','MILIMETRO\x20CUADRADO','setUnitId2','CEN','CARTONES','Impuesto*','Talla','MGM','Marca','GLI','log','CENTIMETRO\x20CUBICO','setItemVariantValues','83639OmWySZ','forEach','8241824tmkEnL','PEN_setMtoPrecioCostoUnitario','PEN_setMtoPrecioUnitario2','KILOVATIO\x20HORA','CENTIMETRO\x20CUADRADO','Precio\x20Venta\x20Soles\x202','LITRO','Código\x20de\x20Barras\x202','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','12306567JUnZCw','Material','push','GRM','BOBINAS','USD_setMtoPrecioCostoUnitario2','import','Equivalencia\x202','MILIGRAMOS','reduce','6849200BogNNs','46tCJynQ','Precio\x20Venta\x20Dólares\x202','MTQ','Género','sheet_to_json','Fecha\x20de\x20Vencimiento','!ref','KIT','MLT','Inafecto\x20(0%)','ID\x20UNIT\x202','SACO','YARDA','setItemBarCode2','Precio\x20Costo\x20Soles','CONOS','Sheets','Modelo\x20de\x20Cuello','setItemType','TAMBOR','SheetNames','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','Precio\x20Costo\x20Dólares\x202','Precio\x20Venta\x20Soles','GALON\x20INGLES\x20(4,545956L)','Unidad\x20de\x20Medida*','Descripción','MMK','done','setCategoria','array','Ubicación','Modelo\x20de\x20Manga','exportItems:\x20products\x20no\x20es\x20Array.','Nombre\x20del\x20Lote','search','{}.constructor(\x22return\x20this\x22)(\x20)','INH','message','PEN_setMtoPrecioCostoUnitario2','66aBlbsE','PIES','BOTELLAS','310320utILVL','TONELADA\x20CORTA','QQM','LATAS','exportItems','setUnidadEquivalencia2','METRO\x20CUBICO','4457574nFZEdl','exportDone','Código\x20SKU*','METRO\x20CUADRADO','PEN_setMtoPrecioUnitario','MILILITRO','QUINTAL','LBR','warn','value','toLowerCase','Fabricado','MILIMETRO','return\x20(function()\x20','code','FTK','Código\x20de\x20Barras','apply','MIL','__proto__','constructor','STN','TNE','exportItems:\x20productos\x20no\x20clonables:\x20','prototype','GRUESA','GRAMO','CMT','MWH','Serie','KTM','sheet_add_json','FOT','console','keys','MTR','trim','error','setMarca','write','DOCENA','encode_range','CAJA','MILLARES','length','CENTIMETRO\x20LINEAL','toString','LTR','JUEGO','map','Gravado\x20(18%)','Stock\x20Actual','setWarehouseStockMin','Color','LIBRAS','NIU','slice','USD_setMtoPrecioUnitario','read','MTK'];_0x7fe8=function(){return _0x51fec3;};return _0x7fe8();}function _0xd12d(_0x533d3f,_0x5cb7fb){const _0x436d29=_0x7fe8();return _0xd12d=function(_0x40af5f,_0x167de0){_0x40af5f=_0x40af5f-0x157;let _0x28e99e=_0x436d29[_0x40af5f];return _0x28e99e;},_0xd12d(_0x533d3f,_0x5cb7fb);}(function(_0x33fd2e,_0x238add){const _0x2653ff=_0xd12d,_0x573302=_0x33fd2e();while(!![]){try{const _0x11e0b8=parseInt(_0x2653ff(0x1fd))/0x1*(-parseInt(_0x2653ff(0x213))/0x2)+parseInt(_0x2653ff(0x1c3))/0x3+-parseInt(_0x2653ff(0x212))/0x4+parseInt(_0x2653ff(0x15b))/0x5*(parseInt(_0x2653ff(0x158))/0x6)+parseInt(_0x2653ff(0x208))/0x7+parseInt(_0x2653ff(0x1ff))/0x8+parseInt(_0x2653ff(0x162))/0x9;if(_0x11e0b8===_0x238add)break;else _0x573302['push'](_0x573302['shift']());}catch(_0x31a189){_0x573302['push'](_0x573302['shift']());}}}(_0x7fe8,0xf2a4d));const _0x444db8=(function(){let _0x4dbe15=!![];return function(_0x12c7d2,_0x5a56fb){const _0x43600a=_0x4dbe15?function(){const _0x55f9c1=_0xd12d;if(_0x5a56fb){const _0x448a7a=_0x5a56fb[_0x55f9c1(0x173)](_0x12c7d2,arguments);return _0x5a56fb=null,_0x448a7a;}}:function(){};return _0x4dbe15=![],_0x43600a;};}()),_0x3d298a=_0x444db8(this,function(){const _0xf0e528=_0xd12d;return _0x3d298a[_0xf0e528(0x190)]()[_0xf0e528(0x236)](_0xf0e528(0x1cd))[_0xf0e528(0x190)]()[_0xf0e528(0x176)](_0x3d298a)[_0xf0e528(0x236)](_0xf0e528(0x1cd));});_0x3d298a();const _0x167de0=(function(){let _0x545cb0=!![];return function(_0x2644db,_0x1b96b3){const _0x473e76=_0x545cb0?function(){if(_0x1b96b3){const _0x9035c1=_0x1b96b3['apply'](_0x2644db,arguments);return _0x1b96b3=null,_0x9035c1;}}:function(){};return _0x545cb0=![],_0x473e76;};}()),_0x40af5f=_0x167de0(this,function(){const _0xb67cb3=_0xd12d;let _0x5c7cfe;try{const _0x5496d0=Function(_0xb67cb3(0x16f)+_0xb67cb3(0x237)+');');_0x5c7cfe=_0x5496d0();}catch(_0x232945){_0x5c7cfe=window;}const _0x5c0710=_0x5c7cfe[_0xb67cb3(0x183)]=_0x5c7cfe[_0xb67cb3(0x183)]||{},_0x1f050e=[_0xb67cb3(0x1fa),_0xb67cb3(0x16a),'info',_0xb67cb3(0x187),_0xb67cb3(0x1f0),'table',_0xb67cb3(0x1d2)];for(let _0x23e197=0x0;_0x23e197<_0x1f050e[_0xb67cb3(0x18e)];_0x23e197++){const _0x2cde8f=_0x167de0[_0xb67cb3(0x176)][_0xb67cb3(0x17a)][_0xb67cb3(0x1c1)](_0x167de0),_0x24deb6=_0x1f050e[_0x23e197],_0x12a8c3=_0x5c0710[_0x24deb6]||_0x2cde8f;_0x2cde8f[_0xb67cb3(0x175)]=_0x167de0['bind'](_0x167de0),_0x2cde8f['toString']=_0x12a8c3[_0xb67cb3(0x190)][_0xb67cb3(0x1c1)](_0x12a8c3),_0x5c0710[_0x24deb6]=_0x2cde8f;}});_0x40af5f(),importScripts(_0x58dbf0(0x1eb)),onmessage=({data:_0x567e7c})=>{const _0x2f2d5f=_0x58dbf0,{action:_0x480473}=_0x567e7c;if(_0x480473===_0x2f2d5f(0x20e)){const {buf:_0xd54971,maxRows:_0xcce5e5}=_0x567e7c;try{postMessage({'type':_0x2f2d5f(0x1e4),'payload':{'percent':0x5,'message':'Iniciando\x20parseo…'}});const _0x54938b=XLSX[_0x2f2d5f(0x19c)](_0xd54971,{'type':_0x2f2d5f(0x231),'cellDates':!![]}),_0x5707cf=_0x54938b[_0x2f2d5f(0x223)][_0x54938b[_0x2f2d5f(0x227)][0x0]],_0xefd420=XLSX[_0x2f2d5f(0x19e)][_0x2f2d5f(0x217)](_0x5707cf,{'defval':'','range':0x1,'cellDates':!![]}),_0x382648=_0xefd420['findIndex'](_0xe56a0c=>(!_0xe56a0c[_0x2f2d5f(0x1cf)]||String(_0xe56a0c[_0x2f2d5f(0x1cf)])[_0x2f2d5f(0x186)]()==='')&&(!_0xe56a0c[_0x2f2d5f(0x164)]||String(_0xe56a0c['Código\x20SKU*'])[_0x2f2d5f(0x186)]()==='')&&(!_0xe56a0c[_0x2f2d5f(0x1a9)]||String(_0xe56a0c['Nombre*'])[_0x2f2d5f(0x186)]()==='')&&(!_0xe56a0c[_0x2f2d5f(0x22c)]||String(_0xe56a0c['Unidad\x20de\x20Medida*'])[_0x2f2d5f(0x186)]()==='')),_0x59b32f=_0x382648>=0x0?_0xefd420[_0x2f2d5f(0x19a)](0x0,_0x382648):_0xefd420,_0x585b60=_0x59b32f[_0x2f2d5f(0x1b3)](_0x621dcc=>_0x621dcc['Tipo*']&&String(_0x621dcc[_0x2f2d5f(0x1cf)])[_0x2f2d5f(0x186)]()!==''&&_0x621dcc[_0x2f2d5f(0x164)]&&String(_0x621dcc[_0x2f2d5f(0x164)])['trim']()!==''&&_0x621dcc[_0x2f2d5f(0x1a9)]&&String(_0x621dcc['Nombre*'])['trim']()!==''&&_0x621dcc['Unidad\x20de\x20Medida*']&&String(_0x621dcc[_0x2f2d5f(0x22c)])[_0x2f2d5f(0x186)]()!==''),_0x580d8c=_0x585b60['length'];if(_0x580d8c===0x0){postMessage({'type':'error','payload':_0x2f2d5f(0x1c0)});return;}if(_0x580d8c>_0xcce5e5)throw _0x2f2d5f(0x1e6)+_0x580d8c+_0x2f2d5f(0x207)+_0xcce5e5+'.';const _0x96f2c0=0x1f4,_0x3a411c=[],_0x3de50e=[{'codigo':'4A','nombre':_0x2f2d5f(0x20c)},{'codigo':'BJ','nombre':_0x2f2d5f(0x1e7)},{'codigo':'BLL','nombre':_0x2f2d5f(0x1ab)},{'codigo':'BG','nombre':_0x2f2d5f(0x1d6)},{'codigo':'BO','nombre':_0x2f2d5f(0x15a)},{'codigo':'BX','nombre':_0x2f2d5f(0x18c)},{'codigo':'CT','nombre':'CARTONES'},{'codigo':_0x2f2d5f(0x1ec),'nombre':_0x2f2d5f(0x203)},{'codigo':_0x2f2d5f(0x1bd),'nombre':_0x2f2d5f(0x1fb)},{'codigo':_0x2f2d5f(0x17d),'nombre':_0x2f2d5f(0x18f)},{'codigo':_0x2f2d5f(0x1f3),'nombre':'CIENTO\x20DE\x20UNIDADES'},{'codigo':'CY','nombre':'CILINDRO'},{'codigo':'CJ','nombre':_0x2f2d5f(0x222)},{'codigo':_0x2f2d5f(0x1a4),'nombre':_0x2f2d5f(0x18a)},{'codigo':'DZP','nombre':_0x2f2d5f(0x1a8)},{'codigo':'BE','nombre':'FARDO'},{'codigo':_0x2f2d5f(0x1f9),'nombre':_0x2f2d5f(0x22b)},{'codigo':_0x2f2d5f(0x20b),'nombre':_0x2f2d5f(0x17c)},{'codigo':_0x2f2d5f(0x1b8),'nombre':_0x2f2d5f(0x17b)},{'codigo':_0x2f2d5f(0x1a3),'nombre':_0x2f2d5f(0x1aa)},{'codigo':'LEF','nombre':_0x2f2d5f(0x1dd)},{'codigo':_0x2f2d5f(0x1a7),'nombre':'JUEGO'},{'codigo':'KGM','nombre':'KILOGRAMO'},{'codigo':_0x2f2d5f(0x180),'nombre':'KILOMETRO'},{'codigo':_0x2f2d5f(0x1d1),'nombre':_0x2f2d5f(0x202)},{'codigo':'KT','nombre':_0x2f2d5f(0x21a)},{'codigo':'CA','nombre':_0x2f2d5f(0x15e)},{'codigo':_0x2f2d5f(0x169),'nombre':_0x2f2d5f(0x198)},{'codigo':_0x2f2d5f(0x191),'nombre':_0x2f2d5f(0x205)},{'codigo':_0x2f2d5f(0x17e),'nombre':_0x2f2d5f(0x1df)},{'codigo':_0x2f2d5f(0x185),'nombre':_0x2f2d5f(0x19f)},{'codigo':_0x2f2d5f(0x19d),'nombre':_0x2f2d5f(0x165)},{'codigo':_0x2f2d5f(0x215),'nombre':_0x2f2d5f(0x161)},{'codigo':_0x2f2d5f(0x1f7),'nombre':_0x2f2d5f(0x210)},{'codigo':_0x2f2d5f(0x21b),'nombre':_0x2f2d5f(0x167)},{'codigo':_0x2f2d5f(0x1e2),'nombre':_0x2f2d5f(0x16e)},{'codigo':_0x2f2d5f(0x22e),'nombre':'MILIMETRO\x20CUADRADO'},{'codigo':_0x2f2d5f(0x1ce),'nombre':_0x2f2d5f(0x1b0)},{'codigo':_0x2f2d5f(0x174),'nombre':_0x2f2d5f(0x18d)},{'codigo':'UM','nombre':_0x2f2d5f(0x1e3)},{'codigo':_0x2f2d5f(0x1bf),'nombre':_0x2f2d5f(0x1a6)},{'codigo':'PF','nombre':'PALETAS'},{'codigo':'PK','nombre':_0x2f2d5f(0x1ca)},{'codigo':'PR','nombre':_0x2f2d5f(0x1d0)},{'codigo':_0x2f2d5f(0x182),'nombre':'PIES'},{'codigo':_0x2f2d5f(0x171),'nombre':_0x2f2d5f(0x1d4)},{'codigo':_0x2f2d5f(0x1a5),'nombre':'PIES\x20CUBICOS'},{'codigo':_0x2f2d5f(0x1ae),'nombre':_0x2f2d5f(0x1da)},{'codigo':'PG','nombre':_0x2f2d5f(0x1c7)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':_0x2f2d5f(0x238),'nombre':_0x2f2d5f(0x1e9)},{'codigo':'RM','nombre':_0x2f2d5f(0x1ed)},{'codigo':'SA','nombre':'SACO'},{'codigo':'DR','nombre':_0x2f2d5f(0x226)},{'codigo':_0x2f2d5f(0x177),'nombre':_0x2f2d5f(0x15c)},{'codigo':'LTN','nombre':'TONELADA\x20LARGA'},{'codigo':_0x2f2d5f(0x178),'nombre':_0x2f2d5f(0x1b4)},{'codigo':'TU','nombre':_0x2f2d5f(0x1db)},{'codigo':_0x2f2d5f(0x199),'nombre':'UNIDAD\x20(NIU)'},{'codigo':'ZZ','nombre':'UNIDAD\x20(ZZ)'},{'codigo':_0x2f2d5f(0x1a2),'nombre':'US\x20GALON\x20(3,7843\x20L)'},{'codigo':'YRD','nombre':_0x2f2d5f(0x21f)},{'codigo':_0x2f2d5f(0x1ac),'nombre':'YARDA\x20CUADRADA'},{'codigo':_0x2f2d5f(0x15d),'nombre':_0x2f2d5f(0x168)}],_0x3d8587=_0x3de50e[_0x2f2d5f(0x211)]((_0x46fd3c,{nombre:_0xa58cd0,codigo:_0x48db73})=>{const _0x558f96=_0x2f2d5f;return _0x46fd3c[_0xa58cd0['trim']()]=_0x48db73[_0x558f96(0x186)](),_0x46fd3c;},{});for(let _0x2018e0=0x0;_0x2018e0<_0x580d8c;_0x2018e0+=_0x96f2c0){const _0x187673=_0x585b60[_0x2f2d5f(0x19a)](_0x2018e0,_0x2018e0+_0x96f2c0)[_0x2f2d5f(0x193)]((_0x5d53f9,_0xfda422)=>{const _0x41aaa6=_0x2f2d5f;let _0xb2cecf={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x5d53f9[_0x41aaa6(0x1cf)]]||'1';const _0x118646=String(_0x5d53f9[_0x41aaa6(0x1f5)])[_0x41aaa6(0x186)](),_0x1a9670={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x2e9871=_0x1a9670[_0x118646]||'1',_0x5b89cc={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x2e9871]||{'code':'10','value':0x12},_0x519abd={};let _0x363996=String(_0x5d53f9[_0x41aaa6(0x1a9)])['trim']();const _0x2832a9=[_0x41aaa6(0x1f6),_0x41aaa6(0x197),_0x41aaa6(0x216),'Modelo',_0x41aaa6(0x17f),_0x41aaa6(0x209),_0x41aaa6(0x224),_0x41aaa6(0x233)];_0x2832a9['forEach'](_0x269afe=>{const _0xbc3e7a=_0x41aaa6,_0x72a540=String(_0x5d53f9[_0x269afe]||'')[_0xbc3e7a(0x186)]();_0x72a540&&(_0x519abd[_0x269afe]=_0x72a540,_0x363996+='\x20'+_0x269afe+'\x20'+_0x72a540);});const _0x5b8c3d=[],_0x5922fc=String(_0x5d53f9[_0x41aaa6(0x22c)]||_0x41aaa6(0x1be))[_0x41aaa6(0x186)](),_0x319cf6=_0x3d8587[_0x5922fc]||_0x41aaa6(0x199);_0x5b8c3d[_0x41aaa6(0x20a)]({'setItemUnitId':String(_0x5d53f9[_0x41aaa6(0x1ba)])['trim']()||'','setItemBarCode':String(_0x5d53f9[_0x41aaa6(0x172)])[_0x41aaa6(0x186)]()||'','setAlias':_0x5922fc,'setUnitCode':_0x319cf6,'setPrice':parseFloat(_0x5d53f9[_0x41aaa6(0x22a)])||0x0,'setCost':parseFloat(_0x5d53f9[_0x41aaa6(0x221)])||0x0,'setPriceUSD':parseFloat(_0x5d53f9[_0x41aaa6(0x1b7)])||0x0,'setCostUSD':parseFloat(_0x5d53f9['Precio\x20Costo\x20Dólares'])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x3f7efb=['ID\x20UNIT\x202',_0x41aaa6(0x206),'Equivalencia\x202',_0x41aaa6(0x204),'Precio\x20Costo\x20Soles\x202','Precio\x20Venta\x20Dólares\x202',_0x41aaa6(0x229)]['some'](_0x144c94=>{const _0x2556e=_0x41aaa6,_0x568e09=_0x5d53f9[_0x144c94];return _0x568e09!=null&&String(_0x568e09)[_0x2556e(0x186)]()!=='';});if(_0x3f7efb){const _0x46bc64=String(_0x5d53f9['Unidad\x20de\x20Medida\x202']||_0x41aaa6(0x1c8))[_0x41aaa6(0x186)](),_0x2624c0=_0x3d8587[_0x46bc64]||'NIU',_0xbcbcff=parseFloat(_0x5d53f9[_0x41aaa6(0x204)])||0x0,_0x4adc20=parseFloat(_0x5d53f9['Precio\x20Costo\x20Soles\x202'])||0x0,_0x2a1c6e=parseFloat(_0x5d53f9['Precio\x20Venta\x20Dólares\x202'])||0x0,_0x9d3e26=parseFloat(_0x5d53f9[_0x41aaa6(0x229)])||0x0,_0x1e4b0c=parseFloat(_0x5d53f9[_0x41aaa6(0x20f)])||0x1;_0x5b8c3d['push']({'setItemUnitId':String(_0x5d53f9[_0x41aaa6(0x21d)])[_0x41aaa6(0x186)]()||'','setItemBarCode':String(_0x5d53f9['Código\x20de\x20Barras\x202'])[_0x41aaa6(0x186)]()||'','setAlias':_0x46bc64,'setUnitCode':_0x2624c0,'setPrice':_0xbcbcff,'setCost':_0x4adc20,'setPriceUSD':_0x2a1c6e,'setCostUSD':_0x9d3e26,'setDefault':0x0,'setEquivalence':_0x1e4b0c,'setFactor':_0x1e4b0c});}let _0x3956b5=_0x5d53f9[_0x41aaa6(0x218)],_0x57e3cb='';if(_0x3956b5 instanceof Date){const _0x151690=_0x3956b5[_0x41aaa6(0x1af)](),_0x8221f4=String(_0x3956b5['getMonth']()+0x1)[_0x41aaa6(0x1b1)](0x2,'0'),_0xd21fc2=String(_0x3956b5['getDate']())['padStart'](0x2,'0');_0x57e3cb=_0x151690+'-'+_0x8221f4+'-'+_0xd21fc2;}else{if(typeof _0x3956b5==='number'){const _0xf0e436=XLSX['SSF'][_0x41aaa6(0x1cb)](_0x3956b5);if(_0xf0e436){const _0x26f24d=_0xf0e436['y'],_0x298428=String(_0xf0e436['m'])['padStart'](0x2,'0'),_0x42b29e=String(_0xf0e436['d'])[_0x41aaa6(0x1b1)](0x2,'0');_0x57e3cb=_0x26f24d+'-'+_0x298428+'-'+_0x42b29e;}}else _0x57e3cb=String(_0x3956b5||'')[_0x41aaa6(0x186)]();}return{'setItemId':String(_0x5d53f9['ID'])[_0x41aaa6(0x186)](),'setItemType':_0xb2cecf,'setItemCode':String(_0x5d53f9['Código\x20SKU*'])[_0x41aaa6(0x186)](),'setItemName':String(_0x5d53f9[_0x41aaa6(0x1a9)])['trim'](),'setItemDescription':String(_0x5d53f9[_0x41aaa6(0x22d)])[_0x41aaa6(0x186)]()||'','setItemCategories':_0x5d53f9[_0x41aaa6(0x1ea)]?[String(_0x5d53f9[_0x41aaa6(0x1ea)])[_0x41aaa6(0x186)]()]:[],'setItemBrands':_0x5d53f9[_0x41aaa6(0x1f8)]?[String(_0x5d53f9[_0x41aaa6(0x1f8)])[_0x41aaa6(0x186)]()]:[],'setItemTaxId':_0x2e9871,'setItemTaxCode':_0x5b89cc[_0x41aaa6(0x170)],'setItemTaxValue':_0x5b89cc[_0x41aaa6(0x16b)],'setItemUnits':_0x5b8c3d,'setItemInventoriable':_0x5d53f9[_0x41aaa6(0x1c6)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x5d53f9[_0x41aaa6(0x195)])||0x0,'setStockMinimum':parseFloat(_0x5d53f9[_0x41aaa6(0x1e0)])||0x0,'setItemLocation':String(_0x5d53f9[_0x41aaa6(0x232)])[_0x41aaa6(0x186)]()||'','setBatchName':String(_0x5d53f9[_0x41aaa6(0x235)])[_0x41aaa6(0x186)]()||'','setItemDateExpiry':_0x57e3cb,'setItemVariantName':_0x363996,'setItemVariantValues':_0x519abd,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x3a411c[_0x2f2d5f(0x20a)](..._0x187673),postMessage({'type':_0x2f2d5f(0x1e4),'payload':{'percent':Math[_0x2f2d5f(0x1a0)]((_0x2018e0+_0x187673[_0x2f2d5f(0x18e)])/_0x580d8c*0x64),'message':'Procesadas\x20filas\x20'+(_0x2018e0+0x1)+'–'+(_0x2018e0+_0x187673[_0x2f2d5f(0x18e)])+'/'+_0x580d8c}});}postMessage({'type':_0x2f2d5f(0x22f),'payload':{'items':_0x3a411c}});}catch(_0x2ef021){postMessage({'type':_0x2f2d5f(0x187),'payload':_0x2ef021[_0x2f2d5f(0x239)]||_0x2ef021});}}if(_0x480473===_0x2f2d5f(0x15f)){const {products:_0x59d74f,plantillaBuf:_0x1295b5}=_0x567e7c;if(!(_0x1295b5 instanceof ArrayBuffer)){postMessage({'type':_0x2f2d5f(0x187),'payload':_0x2f2d5f(0x228)});return;}if(!Array['isArray'](_0x59d74f)){postMessage({'type':_0x2f2d5f(0x187),'payload':_0x2f2d5f(0x234)});return;}try{structuredClone(_0x59d74f);}catch(_0x2499da){postMessage({'type':_0x2f2d5f(0x187),'payload':_0x2f2d5f(0x179)+_0x2499da[_0x2f2d5f(0x239)]});return;}try{const _0x3f6ec3={'1':_0x2f2d5f(0x1bc),'2':_0x2f2d5f(0x1b5),'3':'Materia\x20Prima','4':'Combo','5':_0x2f2d5f(0x16d)};function _0x53afdb(_0x18bee1){const _0x5ea6bc=_0x2f2d5f;return _0x3f6ec3[String(_0x18bee1)]||_0x5ea6bc(0x1bc);}const _0x592978={'1':_0x2f2d5f(0x194),'2':'Exonerado\x20(0%)','3':_0x2f2d5f(0x21c),'4':_0x2f2d5f(0x1de),'5':_0x2f2d5f(0x1d8),'6':'Gravado\x20(10%)','7':_0x2f2d5f(0x1dc),'8':'Exportación\x20(0%)','9':'Gravado\x20Gratuito\x20(10%)'};function _0x1fcc1a(_0x1f5a76){const _0x2f77f7=_0x2f2d5f;return _0x592978[String(_0x1f5a76)]||_0x2f77f7(0x194);}const _0x268c75={'4A':'BOBINAS','BJ':_0x2f2d5f(0x1e7),'BLL':'BARRILES','BG':_0x2f2d5f(0x1d6),'BO':_0x2f2d5f(0x15a),'BX':'CAJA','CT':_0x2f2d5f(0x1f4),'CMK':_0x2f2d5f(0x203),'CMQ':_0x2f2d5f(0x1fb),'CMT':_0x2f2d5f(0x18f),'CEN':_0x2f2d5f(0x1e5),'CY':'CILINDRO','CJ':_0x2f2d5f(0x222),'DZN':'DOCENA','DZP':_0x2f2d5f(0x1a8),'BE':'FARDO','GLI':_0x2f2d5f(0x22b),'GRM':_0x2f2d5f(0x17c),'GRO':_0x2f2d5f(0x17b),'HLT':_0x2f2d5f(0x1aa),'LEF':_0x2f2d5f(0x1dd),'SET':_0x2f2d5f(0x192),'KGM':_0x2f2d5f(0x1b6),'KTM':'KILOMETRO','KWH':_0x2f2d5f(0x202),'KT':'KIT','CA':'LATAS','LBR':_0x2f2d5f(0x198),'LTR':_0x2f2d5f(0x205),'MWH':_0x2f2d5f(0x1df),'MTR':_0x2f2d5f(0x19f),'MTK':'METRO\x20CUADRADO','MTQ':_0x2f2d5f(0x161),'MGM':'MILIGRAMOS','MLT':_0x2f2d5f(0x167),'MMT':_0x2f2d5f(0x16e),'MMK':_0x2f2d5f(0x1f1),'MMQ':'MILIMETRO\x20CUBICO','MIL':_0x2f2d5f(0x18d),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0x2f2d5f(0x1a6),'PF':'PALETAS','PK':_0x2f2d5f(0x1ca),'PR':_0x2f2d5f(0x1d0),'FOT':_0x2f2d5f(0x159),'FTK':'PIES\x20CUADRADOS','FTQ':'PIES\x20CUBICOS','C62':_0x2f2d5f(0x1da),'PG':_0x2f2d5f(0x1c7),'ST':_0x2f2d5f(0x1e8),'INH':_0x2f2d5f(0x1e9),'RM':_0x2f2d5f(0x1ed),'SA':_0x2f2d5f(0x21e),'DR':_0x2f2d5f(0x226),'STN':_0x2f2d5f(0x15c),'LTN':'TONELADA\x20LARGA','TNE':_0x2f2d5f(0x1b4),'TU':'TUBOS','NIU':_0x2f2d5f(0x1be),'ZZ':_0x2f2d5f(0x1c4),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':'YARDA','YDK':_0x2f2d5f(0x1ee),'QQM':_0x2f2d5f(0x168)};function _0x4f1f0b(_0x38be48){return _0x268c75[String(_0x38be48)]||'';}const _0x215ebf=XLSX[_0x2f2d5f(0x19c)](_0x1295b5,{'type':_0x2f2d5f(0x231),'cellDates':!![]}),_0x3ce722=_0x215ebf[_0x2f2d5f(0x227)][0x0],_0x439bc5=_0x215ebf[_0x2f2d5f(0x223)][_0x3ce722],_0x35a726=XLSX['utils'][_0x2f2d5f(0x217)](_0x439bc5,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x5edb29=XLSX[_0x2f2d5f(0x19e)][_0x2f2d5f(0x1d5)](_0x439bc5[_0x2f2d5f(0x219)]||'');for(let _0x47c736=0x2;_0x47c736<=_0x5edb29['e']['r'];++_0x47c736){for(let _0x36c5fd=_0x5edb29['s']['c'];_0x36c5fd<=_0x5edb29['e']['c'];++_0x36c5fd){const _0x57a36a=XLSX[_0x2f2d5f(0x19e)]['encode_cell']({'r':_0x47c736,'c':_0x36c5fd});if(_0x439bc5[_0x57a36a])delete _0x439bc5[_0x57a36a];}}const _0x557c25=_0x59d74f[_0x2f2d5f(0x193)](_0x38a2a8=>{const _0x4e10b9=_0x2f2d5f;_0x38a2a8[_0x4e10b9(0x1fc)]=_0x38a2a8[_0x4e10b9(0x1fc)]||{};const _0x45fdd3={};return _0x35a726[_0x4e10b9(0x1fe)](_0xf3981d=>{const _0x526fc8=_0x4e10b9,_0x4c7f50=String(_0xf3981d)[_0x526fc8(0x186)](),_0x335c92=_0x4c7f50[_0x526fc8(0x16c)](),_0xbceb4e=Object[_0x526fc8(0x184)](_0x38a2a8)['find'](_0x12682f=>_0x12682f['trim']()[_0x526fc8(0x16c)]()===_0x335c92);if(_0xbceb4e){_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0xbceb4e]??'';return;}switch(_0x4c7f50){case'ID':_0x45fdd3[_0x4c7f50]=_0x38a2a8['id']??'';break;case _0x526fc8(0x1cf):_0x45fdd3[_0x4c7f50]=_0x53afdb(_0x38a2a8[_0x526fc8(0x225)]);break;case _0x526fc8(0x164):_0x45fdd3[_0x4c7f50]=_0x38a2a8['setCodProducto']??'';break;case _0x526fc8(0x1a9):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1bb)]??'';break;case'Descripción':_0x45fdd3[_0x4c7f50]=_0x38a2a8['setItemDescription']??'';break;case _0x526fc8(0x1ea):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x230)]??'';break;case'Marca':_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x188)]??'';break;case _0x526fc8(0x1f5):_0x45fdd3[_0x4c7f50]=_0x1fcc1a(_0x38a2a8[_0x526fc8(0x1c9)]);break;case'ID\x20UNIT':_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1c2)]??'';break;case _0x526fc8(0x172):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1ad)]??'';break;case'Unidad\x20de\x20Medida*':_0x45fdd3[_0x4c7f50]=_0x4f1f0b(_0x38a2a8[_0x526fc8(0x1d7)]);break;case _0x526fc8(0x22a):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x166)]??'';break;case _0x526fc8(0x221):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x200)]??'';break;case _0x526fc8(0x1b7):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x19b)]??'';break;case _0x526fc8(0x1c5):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1b2)]??'';break;case _0x526fc8(0x21d):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1f2)]??'';break;case _0x526fc8(0x206):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x220)]??'';break;case _0x526fc8(0x1cc):_0x45fdd3[_0x4c7f50]=_0x4f1f0b(_0x38a2a8[_0x526fc8(0x1e1)]);break;case _0x526fc8(0x20f):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x160)]??'1';break;case'Precio\x20Venta\x20Soles\x202':_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x201)]??'';break;case'Precio\x20Costo\x20Soles\x202':_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x157)]??'';break;case _0x526fc8(0x214):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1d9)]??'';break;case _0x526fc8(0x229):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x20d)]??'';break;case _0x526fc8(0x1c6):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1ef)]==0x1?'SI':'NO';break;case _0x526fc8(0x195):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1b9)]??'';break;case _0x526fc8(0x1e0):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x196)]??'';break;case _0x526fc8(0x235):_0x45fdd3[_0x4c7f50]=_0x38a2a8[_0x526fc8(0x1d3)]??'';break;case _0x526fc8(0x218):_0x45fdd3[_0x4c7f50]=_0x38a2a8['setBatchExpirationDate']??'';break;default:_0x45fdd3[_0x4c7f50]='';}}),_0x45fdd3;});XLSX[_0x2f2d5f(0x19e)][_0x2f2d5f(0x181)](_0x439bc5,_0x557c25,{'origin':'A3','skipHeader':!![],'header':_0x35a726});const _0x351928={'s':{'r':0x0,'c':0x0},'e':{'r':_0x557c25['length']+0x1,'c':_0x35a726[_0x2f2d5f(0x18e)]-0x1}};_0x439bc5[_0x2f2d5f(0x219)]=XLSX[_0x2f2d5f(0x19e)][_0x2f2d5f(0x18b)](_0x351928);const _0x278527=XLSX[_0x2f2d5f(0x189)](_0x215ebf,{'bookType':'xlsx','type':_0x2f2d5f(0x231)});let _0x5864ec,_0xafc5b1;if(_0x278527 instanceof Uint8Array)_0x5864ec=_0x278527,_0xafc5b1=[_0x278527[_0x2f2d5f(0x1a1)]];else{if(_0x278527 instanceof ArrayBuffer)_0x5864ec=new Uint8Array(_0x278527),_0xafc5b1=[_0x278527];else{const _0x27553f=new Uint8Array(_0x278527);_0x5864ec=_0x27553f,_0xafc5b1=[_0x27553f['buffer']];}}postMessage({'type':_0x2f2d5f(0x163),'payload':{'wbout':_0x5864ec,'count':_0x557c25[_0x2f2d5f(0x18e)]}},_0xafc5b1);}catch(_0x2fe2fb){postMessage({'type':_0x2f2d5f(0x187),'payload':_0x2fe2fb['message']||String(_0x2fe2fb)});}return;}};