/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.3.5
*/

const _0x4b5f66=_0x23ec;(function(_0x22178c,_0xfd2188){const _0x526380=_0x23ec,_0x53edb3=_0x22178c();while(!![]){try{const _0x2e57b6=parseInt(_0x526380(0x132))/0x1*(-parseInt(_0x526380(0x1ba))/0x2)+-parseInt(_0x526380(0x185))/0x3+-parseInt(_0x526380(0x172))/0x4+parseInt(_0x526380(0x15f))/0x5+-parseInt(_0x526380(0x175))/0x6*(parseInt(_0x526380(0x1a3))/0x7)+parseInt(_0x526380(0x165))/0x8*(parseInt(_0x526380(0x168))/0x9)+parseInt(_0x526380(0x10e))/0xa*(-parseInt(_0x526380(0x160))/0xb);if(_0x2e57b6===_0xfd2188)break;else _0x53edb3['push'](_0x53edb3['shift']());}catch(_0x54625c){_0x53edb3['push'](_0x53edb3['shift']());}}}(_0x2b61,0x8aed6));function _0x23ec(_0x10531b,_0x1ee2d9){const _0x2fc015=_0x2b61();return _0x23ec=function(_0x29bd63,_0x19c14f){_0x29bd63=_0x29bd63-0x101;let _0x5330fb=_0x2fc015[_0x29bd63];return _0x5330fb;},_0x23ec(_0x10531b,_0x1ee2d9);}const _0x589a37=(function(){let _0x14df4a=!![];return function(_0x186981,_0xda0af7){const _0x34851f=_0x14df4a?function(){const _0x485cf6=_0x23ec;if(_0xda0af7){const _0x84dc2e=_0xda0af7[_0x485cf6(0x155)](_0x186981,arguments);return _0xda0af7=null,_0x84dc2e;}}:function(){};return _0x14df4a=![],_0x34851f;};}()),_0x5ab53d=_0x589a37(this,function(){const _0x2e4d1e=_0x23ec;return _0x5ab53d['toString']()[_0x2e4d1e(0x123)]('(((.+)+)+)+$')[_0x2e4d1e(0x1cf)]()[_0x2e4d1e(0x1b2)](_0x5ab53d)[_0x2e4d1e(0x123)]('(((.+)+)+)+$');});_0x5ab53d();const _0x19c14f=(function(){let _0x5224ea=!![];return function(_0x2f1128,_0xd19ccb){const _0x29a33c=_0x5224ea?function(){const _0x22379d=_0x23ec;if(_0xd19ccb){const _0x37047b=_0xd19ccb[_0x22379d(0x155)](_0x2f1128,arguments);return _0xd19ccb=null,_0x37047b;}}:function(){};return _0x5224ea=![],_0x29a33c;};}()),_0x29bd63=_0x19c14f(this,function(){const _0x211811=_0x23ec,_0x404d24=function(){const _0x5129b5=_0x23ec;let _0xc85097;try{_0xc85097=Function(_0x5129b5(0x11a)+_0x5129b5(0x1a0)+');')();}catch(_0x4624c5){_0xc85097=window;}return _0xc85097;},_0x5e7f90=_0x404d24(),_0x27d0e2=_0x5e7f90['console']=_0x5e7f90[_0x211811(0x183)]||{},_0x1438cc=[_0x211811(0x181),'warn',_0x211811(0x1d2),_0x211811(0x13a),_0x211811(0x1ad),_0x211811(0x17c),'trace'];for(let _0x4aa82c=0x0;_0x4aa82c<_0x1438cc['length'];_0x4aa82c++){const _0xb03493=_0x19c14f[_0x211811(0x1b2)]['prototype'][_0x211811(0x1cb)](_0x19c14f),_0x4986b5=_0x1438cc[_0x4aa82c],_0x393939=_0x27d0e2[_0x4986b5]||_0xb03493;_0xb03493[_0x211811(0x111)]=_0x19c14f[_0x211811(0x1cb)](_0x19c14f),_0xb03493[_0x211811(0x1cf)]=_0x393939[_0x211811(0x1cf)][_0x211811(0x1cb)](_0x393939),_0x27d0e2[_0x4986b5]=_0xb03493;}});function _0x2b61(){const _0x2f9520=['round','Precio\x20Venta\x20Dólares','Impuesto*','TONELADAS','setWarehouseStockMin','MWH','return\x20(function()\x20','YARDA\x20CUADRADA','encode_range','Modelo','UND\x20(NIU)','Gravado\x20(10%)','Procesadas\x20filas\x20','setCodProducto','write','search','Fabricado','LTN','buffer','padStart','PIES','BOLSA','GRO','PEN_setMtoPrecioUnitario2','MILIMETRO','PALETAS','trim','USD_setMtoPrecioCostoUnitario','UNIDAD\x20(NIU)','PLACAS','4WmIsux','¿Rastrear\x20Inventario?','Precio\x20Venta\x20Soles','setUnidadEquivalencia2','Gravado\x20Gratuito\x20(18%)','DOCENA\x20POR\x2010**6','push','METRO','error','Código\x20de\x20Barras\x202','Precio\x20Venta\x20Soles\x202','CIENTO\x20DE\x20UNIDADES','MMK','MLT','TNE','read','Unidad\x20de\x20Medida*','SheetNames','USD_setMtoPrecioCostoUnitario2','SACO','Descripción','setItemType','LATAS','setBatchName','DOCENA','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','ONZAS','forEach','MILLON\x20DE\x20UNIDADES','message','GRUESA','Precio\x20Venta\x20Dólares\x202','HLT','HECTOLITRO','CMK','apply','MTK','CMT','setMarca','Precio\x20Costo\x20Dólares','Precio\x20Costo\x20Soles\x202','HOJA','Código\x20de\x20Barras','TAMBOR','MGM','4477395SVcOqu','11wYpAQw','CONOS','PEN_setMtoPrecioCostoUnitario2','KTM','setInventariable','136IFXRwa','LBR','exportItems','564831jEywTn','PAR','GALON\x20INGLES\x20(4,545956L)','Stock\x20Actual','setBatchExpirationDate','MILIGRAMOS','value','Código\x20SKU*','PLIEGO','DZN','1698068BRiRyY','setUnidadCodigo2','KILOGRAMO','12QRWpRE','QUINTAL','number','Servicio','PIES\x20CUBICOS','array','getDate','table','METRO\x20CUADRADO','Exonerado\x20Gratuito\x20(0%)','Talla','CMQ','log','BALDE','console','PIES\x20CUADRADOS','167112tbmXgR','CARTONES','toLowerCase','JUEGO','setTaxId','Tipo*','YARDA','Gravado\x20Gratuito\x20(10%)','CENTIMETRO\x20CUADRADO','PULGADAS','setUnitId2','MIL','GLL','KIT','LITRO','BLL','Serie','length','getFullYear','Iniciando\x20parseo…','PEN_setMtoPrecioUnitario','Exportando\x20filas\x20','Artículo','MILIMETRO\x20CUBICO','Marca','Modelo\x20de\x20Manga','find','{}.constructor(\x22return\x20this\x22)(\x20)','setCategoria','\x20de\x20','186886favikI','LIBRAS','USD_setMtoPrecioUnitario','BOBINAS','findIndex','RESMA','filter','METRO\x20CUBICO','setItemVariantValues','MTR','exception','UNIDAD\x20(ZZ)','NIU','progress','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','constructor','Ubicación','Fecha\x20de\x20Vencimiento','Gravado\x20(18%)','SET','Modelo\x20de\x20Cuello','Exonerado\x20(0%)','CEN','30760XZeUuA','sheet_to_json','Precio\x20Costo\x20Soles','FOT','xlsx','KILOMETRO','FTK','Categoría','isArray','KILOVATIO\x20HORA','Nombre\x20del\x20Lote','TUBOS','MILLARES','utils','CAJA','MEGAWATT\x20HORA','Color','bind','Género','Exportación\x20(0%)','setItemBarCode2','toString','ID\x20UNIT','Stock\x20Mínimo','info','TONELADA\x20CORTA','Unidad\x20de\x20Medida\x202','setItemBarCode','Inafecto\x20(0%)','DZP','YDK','PAQUETE','Nombre*','!ref','ID\x20UNIT\x202','TONELADA\x20LARGA','exportItems:\x20products\x20no\x20es\x20Array.','sheet_add_json','Precio\x20Costo\x20Dólares\x202','CENTIMETRO\x20LINEAL','Equivalencia\x202','MILIMETRO\x20CUADRADO','CENTIMETRO\x20CUBICO','MMT','YRD','slice','Sheets','STN','PIEZAS','7981990wbARxB','MILILITRO','FARDO','__proto__','US\x20GALON\x20(3,7843\x20L)','CILINDRO'];_0x2b61=function(){return _0x2f9520;};return _0x2b61();}_0x29bd63(),importScripts(_0x4b5f66(0x14b)),onmessage=({data:_0x1f3b3e})=>{const _0x2d7fb0=_0x4b5f66,{action:_0x5ee994}=_0x1f3b3e;if(_0x5ee994==='import'){const {buf:_0x21d17a,maxRows:_0x20ba21}=_0x1f3b3e;try{postMessage({'type':_0x2d7fb0(0x1b0),'payload':{'percent':0x5,'message':_0x2d7fb0(0x198)}});const _0x3f89d5=XLSX[_0x2d7fb0(0x141)](_0x21d17a,{'type':_0x2d7fb0(0x17a),'cellDates':!![]}),_0x515591=_0x3f89d5[_0x2d7fb0(0x10b)][_0x3f89d5[_0x2d7fb0(0x143)][0x0]],_0x4f6ada=XLSX['utils'][_0x2d7fb0(0x1bb)](_0x515591,{'defval':'','range':0x1,'cellDates':!![]}),_0x5c288f=_0x4f6ada[_0x2d7fb0(0x1a7)](_0xd8a772=>(!_0xd8a772[_0x2d7fb0(0x18a)]||String(_0xd8a772['Tipo*'])['trim']()==='')&&(!_0xd8a772['Código\x20SKU*']||String(_0xd8a772[_0x2d7fb0(0x16f)])[_0x2d7fb0(0x12e)]()==='')&&(!_0xd8a772[_0x2d7fb0(0x1da)]||String(_0xd8a772[_0x2d7fb0(0x1da)])[_0x2d7fb0(0x12e)]()==='')&&(!_0xd8a772[_0x2d7fb0(0x142)]||String(_0xd8a772[_0x2d7fb0(0x142)])[_0x2d7fb0(0x12e)]()==='')),_0x5e1c2b=_0x5c288f>=0x0?_0x4f6ada[_0x2d7fb0(0x10a)](0x0,_0x5c288f):_0x4f6ada,_0x257833=_0x5e1c2b[_0x2d7fb0(0x1a9)](_0x26fd01=>_0x26fd01[_0x2d7fb0(0x18a)]&&String(_0x26fd01[_0x2d7fb0(0x18a)])['trim']()!==''&&_0x26fd01[_0x2d7fb0(0x16f)]&&String(_0x26fd01['Código\x20SKU*'])[_0x2d7fb0(0x12e)]()!==''&&_0x26fd01[_0x2d7fb0(0x1da)]&&String(_0x26fd01[_0x2d7fb0(0x1da)])[_0x2d7fb0(0x12e)]()!==''&&_0x26fd01['Unidad\x20de\x20Medida*']&&String(_0x26fd01[_0x2d7fb0(0x142)])[_0x2d7fb0(0x12e)]()!==''),_0x3755d6=_0x257833[_0x2d7fb0(0x196)];if(_0x3755d6===0x0){postMessage({'type':_0x2d7fb0(0x13a),'payload':'No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).'});return;}if(_0x3755d6>_0x20ba21)throw'El\x20archivo\x20tiene\x20'+_0x3755d6+_0x2d7fb0(0x1b1)+_0x20ba21+'.';const _0x11079d=0x1f4,_0x356a05=[],_0x19d263=[{'codigo':'4A','nombre':_0x2d7fb0(0x1a6)},{'codigo':'BJ','nombre':_0x2d7fb0(0x182)},{'codigo':_0x2d7fb0(0x194),'nombre':'BARRILES'},{'codigo':'BG','nombre':_0x2d7fb0(0x129)},{'codigo':'BO','nombre':'BOTELLAS'},{'codigo':'BX','nombre':_0x2d7fb0(0x1c8)},{'codigo':'CT','nombre':_0x2d7fb0(0x186)},{'codigo':_0x2d7fb0(0x154),'nombre':_0x2d7fb0(0x18d)},{'codigo':_0x2d7fb0(0x180),'nombre':'CENTIMETRO\x20CUBICO'},{'codigo':_0x2d7fb0(0x157),'nombre':_0x2d7fb0(0x104)},{'codigo':_0x2d7fb0(0x1b9),'nombre':_0x2d7fb0(0x13d)},{'codigo':'CY','nombre':_0x2d7fb0(0x113)},{'codigo':'CJ','nombre':_0x2d7fb0(0x161)},{'codigo':_0x2d7fb0(0x171),'nombre':_0x2d7fb0(0x14a)},{'codigo':_0x2d7fb0(0x1d7),'nombre':_0x2d7fb0(0x137)},{'codigo':'BE','nombre':'FARDO'},{'codigo':'GLI','nombre':'GALON\x20INGLES\x20(4,545956L)'},{'codigo':'GRM','nombre':'GRAMO'},{'codigo':_0x2d7fb0(0x12a),'nombre':_0x2d7fb0(0x150)},{'codigo':_0x2d7fb0(0x152),'nombre':_0x2d7fb0(0x153)},{'codigo':'LEF','nombre':_0x2d7fb0(0x15b)},{'codigo':_0x2d7fb0(0x1b6),'nombre':_0x2d7fb0(0x188)},{'codigo':'KGM','nombre':_0x2d7fb0(0x174)},{'codigo':_0x2d7fb0(0x163),'nombre':'KILOMETRO'},{'codigo':'KWH','nombre':_0x2d7fb0(0x1c3)},{'codigo':'KT','nombre':_0x2d7fb0(0x192)},{'codigo':'CA','nombre':_0x2d7fb0(0x148)},{'codigo':_0x2d7fb0(0x166),'nombre':_0x2d7fb0(0x1a4)},{'codigo':'LTR','nombre':_0x2d7fb0(0x193)},{'codigo':_0x2d7fb0(0x119),'nombre':'MEGAWATT\x20HORA'},{'codigo':_0x2d7fb0(0x1ac),'nombre':_0x2d7fb0(0x139)},{'codigo':_0x2d7fb0(0x156),'nombre':_0x2d7fb0(0x17d)},{'codigo':'MTQ','nombre':'METRO\x20CUBICO'},{'codigo':_0x2d7fb0(0x15e),'nombre':'MILIGRAMOS'},{'codigo':_0x2d7fb0(0x13f),'nombre':'MILILITRO'},{'codigo':_0x2d7fb0(0x108),'nombre':_0x2d7fb0(0x12c)},{'codigo':_0x2d7fb0(0x13e),'nombre':'MILIMETRO\x20CUADRADO'},{'codigo':'MMQ','nombre':_0x2d7fb0(0x19c)},{'codigo':_0x2d7fb0(0x190),'nombre':_0x2d7fb0(0x1c6)},{'codigo':'UM','nombre':_0x2d7fb0(0x14e)},{'codigo':'ONZ','nombre':_0x2d7fb0(0x14c)},{'codigo':'PF','nombre':_0x2d7fb0(0x12d)},{'codigo':'PK','nombre':_0x2d7fb0(0x1d9)},{'codigo':'PR','nombre':_0x2d7fb0(0x169)},{'codigo':_0x2d7fb0(0x1bd),'nombre':_0x2d7fb0(0x128)},{'codigo':_0x2d7fb0(0x1c0),'nombre':_0x2d7fb0(0x184)},{'codigo':'FTQ','nombre':_0x2d7fb0(0x179)},{'codigo':'C62','nombre':_0x2d7fb0(0x10d)},{'codigo':'PG','nombre':_0x2d7fb0(0x131)},{'codigo':'ST','nombre':_0x2d7fb0(0x170)},{'codigo':'INH','nombre':_0x2d7fb0(0x18e)},{'codigo':'RM','nombre':_0x2d7fb0(0x1a8)},{'codigo':'SA','nombre':_0x2d7fb0(0x145)},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':_0x2d7fb0(0x10c),'nombre':_0x2d7fb0(0x1d3)},{'codigo':_0x2d7fb0(0x125),'nombre':'TONELADA\x20LARGA'},{'codigo':_0x2d7fb0(0x140),'nombre':_0x2d7fb0(0x117)},{'codigo':'TU','nombre':'TUBOS'},{'codigo':_0x2d7fb0(0x1af),'nombre':_0x2d7fb0(0x130)},{'codigo':'ZZ','nombre':_0x2d7fb0(0x1ae)},{'codigo':_0x2d7fb0(0x191),'nombre':_0x2d7fb0(0x112)},{'codigo':_0x2d7fb0(0x109),'nombre':_0x2d7fb0(0x18b)},{'codigo':_0x2d7fb0(0x1d8),'nombre':_0x2d7fb0(0x11b)},{'codigo':'QQM','nombre':_0x2d7fb0(0x176)}],_0x24ab00=_0x19d263['reduce']((_0xf3bcbf,{nombre:_0x132db1,codigo:_0x276983})=>{const _0x31e581=_0x2d7fb0;return _0xf3bcbf[_0x132db1[_0x31e581(0x12e)]()]=_0x276983[_0x31e581(0x12e)](),_0xf3bcbf;},{});for(let _0x5981f9=0x0;_0x5981f9<_0x3755d6;_0x5981f9+=_0x11079d){const _0x3a3e55=_0x257833[_0x2d7fb0(0x10a)](_0x5981f9,_0x5981f9+_0x11079d)['map']((_0x1dcc8f,_0x534a5b)=>{const _0x147016=_0x2d7fb0;let _0x5ec028={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x1dcc8f[_0x147016(0x18a)]]||'1';const _0x4e3c86=String(_0x1dcc8f[_0x147016(0x116)])[_0x147016(0x12e)](),_0x16725b={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x33715a=_0x16725b[_0x4e3c86]||'1',_0x2f7208={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x33715a]||{'code':'10','value':0x12},_0x1c051f={};let _0x3e686e=String(_0x1dcc8f[_0x147016(0x1da)])[_0x147016(0x12e)]();const _0x4d382d=[_0x147016(0x17f),_0x147016(0x1ca),_0x147016(0x1cc),_0x147016(0x11d),_0x147016(0x195),'Material',_0x147016(0x1b7),_0x147016(0x19e)];_0x4d382d[_0x147016(0x14d)](_0x76b109=>{const _0x24d6a3=String(_0x1dcc8f[_0x76b109]||'')['trim']();_0x24d6a3&&(_0x1c051f[_0x76b109]=_0x24d6a3,_0x3e686e+='\x20'+_0x76b109+'\x20'+_0x24d6a3);});const _0x5d8527=[],_0x50cbcb=String(_0x1dcc8f[_0x147016(0x142)]||_0x147016(0x130))['trim'](),_0x12d32e=_0x24ab00[_0x50cbcb]||_0x147016(0x1af);_0x5d8527['push']({'setItemUnitId':String(_0x1dcc8f[_0x147016(0x1d0)])[_0x147016(0x12e)]()||'','setItemBarCode':String(_0x1dcc8f['Código\x20de\x20Barras'])[_0x147016(0x12e)]()||'','setAlias':_0x50cbcb,'setUnitCode':_0x12d32e,'setPrice':parseFloat(_0x1dcc8f[_0x147016(0x134)])||0x0,'setCost':parseFloat(_0x1dcc8f[_0x147016(0x1bc)])||0x0,'setPriceUSD':parseFloat(_0x1dcc8f[_0x147016(0x115)])||0x0,'setCostUSD':parseFloat(_0x1dcc8f[_0x147016(0x159)])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0xf18e6a=['ID\x20UNIT\x202',_0x147016(0x13b),_0x147016(0x105),'Precio\x20Venta\x20Soles\x202',_0x147016(0x15a),_0x147016(0x151),'Precio\x20Costo\x20Dólares\x202']['some'](_0x1677cc=>{const _0x50e1d0=_0x1dcc8f[_0x1677cc];return _0x50e1d0!=null&&String(_0x50e1d0)['trim']()!=='';});if(_0xf18e6a){const _0xdcc96c=String(_0x1dcc8f[_0x147016(0x1d4)]||_0x147016(0x11e))['trim'](),_0x41bffa=_0x24ab00[_0xdcc96c]||_0x147016(0x1af),_0x472c5e=parseFloat(_0x1dcc8f[_0x147016(0x13c)])||0x0,_0x3d08a5=parseFloat(_0x1dcc8f[_0x147016(0x15a)])||0x0,_0xb9b500=parseFloat(_0x1dcc8f['Precio\x20Venta\x20Dólares\x202'])||0x0,_0x7d5048=parseFloat(_0x1dcc8f[_0x147016(0x103)])||0x0,_0x24e2d2=parseFloat(_0x1dcc8f[_0x147016(0x105)])||0x1;_0x5d8527[_0x147016(0x138)]({'setItemUnitId':String(_0x1dcc8f[_0x147016(0x1dc)])['trim']()||'','setItemBarCode':String(_0x1dcc8f[_0x147016(0x13b)])['trim']()||'','setAlias':_0xdcc96c,'setUnitCode':_0x41bffa,'setPrice':_0x472c5e,'setCost':_0x3d08a5,'setPriceUSD':_0xb9b500,'setCostUSD':_0x7d5048,'setDefault':0x0,'setEquivalence':_0x24e2d2,'setFactor':_0x24e2d2});}let _0x111caa=_0x1dcc8f['Fecha\x20de\x20Vencimiento'],_0x542d46='';if(_0x111caa instanceof Date){const _0xd5fe11=_0x111caa[_0x147016(0x197)](),_0x58da21=String(_0x111caa['getMonth']()+0x1)[_0x147016(0x127)](0x2,'0'),_0x214d4b=String(_0x111caa[_0x147016(0x17b)]())[_0x147016(0x127)](0x2,'0');_0x542d46=_0xd5fe11+'-'+_0x58da21+'-'+_0x214d4b;}else{if(typeof _0x111caa===_0x147016(0x177)){const _0x1a10b8=XLSX['SSF']['parse_date_code'](_0x111caa);if(_0x1a10b8){const _0x123844=_0x1a10b8['y'],_0x50abee=String(_0x1a10b8['m'])['padStart'](0x2,'0'),_0x37ac23=String(_0x1a10b8['d'])[_0x147016(0x127)](0x2,'0');_0x542d46=_0x123844+'-'+_0x50abee+'-'+_0x37ac23;}}else _0x542d46=String(_0x111caa||'')[_0x147016(0x12e)]();}return{'setItemId':String(_0x1dcc8f['ID'])[_0x147016(0x12e)](),'setItemType':_0x5ec028,'setItemCode':String(_0x1dcc8f[_0x147016(0x16f)])['trim'](),'setItemName':String(_0x1dcc8f[_0x147016(0x1da)])[_0x147016(0x12e)](),'setItemDescription':String(_0x1dcc8f[_0x147016(0x146)])[_0x147016(0x12e)]()||'','setItemCategories':_0x1dcc8f['Categoría']?[String(_0x1dcc8f[_0x147016(0x1c1)])[_0x147016(0x12e)]()]:[],'setItemBrands':_0x1dcc8f[_0x147016(0x19d)]?[String(_0x1dcc8f[_0x147016(0x19d)])[_0x147016(0x12e)]()]:[],'setItemTaxId':_0x33715a,'setItemTaxCode':_0x2f7208['code'],'setItemTaxValue':_0x2f7208[_0x147016(0x16e)],'setItemUnits':_0x5d8527,'setItemInventoriable':_0x1dcc8f[_0x147016(0x133)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x1dcc8f[_0x147016(0x16b)])||0x0,'setStockMinimum':parseFloat(_0x1dcc8f[_0x147016(0x1d1)])||0x0,'setItemLocation':String(_0x1dcc8f[_0x147016(0x1b3)])['trim']()||'','setBatchName':String(_0x1dcc8f[_0x147016(0x1c4)])['trim']()||'','setItemDateExpiry':_0x542d46,'setItemVariantName':_0x3e686e,'setItemVariantValues':_0x1c051f,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x356a05['push'](..._0x3a3e55),postMessage({'type':_0x2d7fb0(0x1b0),'payload':{'percent':Math[_0x2d7fb0(0x114)]((_0x5981f9+_0x3a3e55[_0x2d7fb0(0x196)])/_0x3755d6*0x64),'message':_0x2d7fb0(0x120)+(_0x5981f9+0x1)+'–'+(_0x5981f9+_0x3a3e55[_0x2d7fb0(0x196)])+'/'+_0x3755d6}});}postMessage({'type':'done','payload':{'items':_0x356a05}});}catch(_0x201989){postMessage({'type':_0x2d7fb0(0x13a),'payload':_0x201989[_0x2d7fb0(0x14f)]||_0x201989});}}if(_0x5ee994===_0x2d7fb0(0x167)){const {products:_0x5df0d8,plantillaBuf:_0x4d4721}=_0x1f3b3e;if(!(_0x4d4721 instanceof ArrayBuffer)){postMessage({'type':_0x2d7fb0(0x13a),'payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array[_0x2d7fb0(0x1c2)](_0x5df0d8)){postMessage({'type':'error','payload':_0x2d7fb0(0x101)});return;}try{structuredClone(_0x5df0d8);}catch(_0x565c63){postMessage({'type':_0x2d7fb0(0x13a),'payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x565c63[_0x2d7fb0(0x14f)]});return;}try{const _0x392ed8={'1':_0x2d7fb0(0x19b),'2':_0x2d7fb0(0x178),'3':'Materia\x20Prima','4':'Combo','5':_0x2d7fb0(0x124)};function _0x556430(_0x3bd586){const _0x23b935=_0x2d7fb0;return _0x392ed8[String(_0x3bd586)]||_0x23b935(0x19b);}const _0x2bf7e5={'1':_0x2d7fb0(0x1b5),'2':_0x2d7fb0(0x1b8),'3':_0x2d7fb0(0x1d6),'4':_0x2d7fb0(0x136),'5':'Inafecto\x20Gratuito\x20(0%)','6':_0x2d7fb0(0x11f),'7':_0x2d7fb0(0x17e),'8':_0x2d7fb0(0x1cd),'9':_0x2d7fb0(0x18c)};function _0x19803e(_0x351e0c){const _0x33aaea=_0x2d7fb0;return _0x2bf7e5[String(_0x351e0c)]||_0x33aaea(0x1b5);}const _0x18ffcf={'4A':_0x2d7fb0(0x1a6),'BJ':_0x2d7fb0(0x182),'BLL':'BARRILES','BG':_0x2d7fb0(0x129),'BO':'BOTELLAS','BX':'CAJA','CT':'CARTONES','CMK':_0x2d7fb0(0x18d),'CMQ':_0x2d7fb0(0x107),'CMT':_0x2d7fb0(0x104),'CEN':'CIENTO\x20DE\x20UNIDADES','CY':'CILINDRO','CJ':_0x2d7fb0(0x161),'DZN':_0x2d7fb0(0x14a),'DZP':_0x2d7fb0(0x137),'BE':_0x2d7fb0(0x110),'GLI':_0x2d7fb0(0x16a),'GRM':'GRAMO','GRO':'GRUESA','HLT':_0x2d7fb0(0x153),'LEF':_0x2d7fb0(0x15b),'SET':_0x2d7fb0(0x188),'KGM':_0x2d7fb0(0x174),'KTM':_0x2d7fb0(0x1bf),'KWH':_0x2d7fb0(0x1c3),'KT':_0x2d7fb0(0x192),'CA':_0x2d7fb0(0x148),'LBR':'LIBRAS','LTR':_0x2d7fb0(0x193),'MWH':_0x2d7fb0(0x1c9),'MTR':_0x2d7fb0(0x139),'MTK':_0x2d7fb0(0x17d),'MTQ':_0x2d7fb0(0x1aa),'MGM':_0x2d7fb0(0x16d),'MLT':_0x2d7fb0(0x10f),'MMT':'MILIMETRO','MMK':_0x2d7fb0(0x106),'MMQ':_0x2d7fb0(0x19c),'MIL':_0x2d7fb0(0x1c6),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0x2d7fb0(0x14c),'PF':_0x2d7fb0(0x12d),'PK':_0x2d7fb0(0x1d9),'PR':'PAR','FOT':_0x2d7fb0(0x128),'FTK':_0x2d7fb0(0x184),'FTQ':_0x2d7fb0(0x179),'C62':'PIEZAS','PG':_0x2d7fb0(0x131),'ST':_0x2d7fb0(0x170),'INH':'PULGADAS','RM':_0x2d7fb0(0x1a8),'SA':_0x2d7fb0(0x145),'DR':_0x2d7fb0(0x15d),'STN':_0x2d7fb0(0x1d3),'LTN':_0x2d7fb0(0x1dd),'TNE':_0x2d7fb0(0x117),'TU':_0x2d7fb0(0x1c5),'NIU':'UNIDAD\x20(NIU)','ZZ':_0x2d7fb0(0x1ae),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':'YARDA','YDK':'YARDA\x20CUADRADA','QQM':'QUINTAL'};function _0x379154(_0x5ac996){return _0x18ffcf[String(_0x5ac996)]||'';}const _0x450f17=XLSX[_0x2d7fb0(0x141)](_0x4d4721,{'type':_0x2d7fb0(0x17a),'cellDates':!![]}),_0x268e94=_0x450f17['SheetNames'][0x0],_0x415e1a=_0x450f17[_0x2d7fb0(0x10b)][_0x268e94],_0x3ce1b7=XLSX['utils']['sheet_to_json'](_0x415e1a,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x503a71=XLSX[_0x2d7fb0(0x1c7)]['decode_range'](_0x415e1a['!ref']||'');for(let _0x46be3c=0x2;_0x46be3c<=_0x503a71['e']['r'];++_0x46be3c){for(let _0x5701f3=_0x503a71['s']['c'];_0x5701f3<=_0x503a71['e']['c'];++_0x5701f3){const _0x40ccdc=XLSX[_0x2d7fb0(0x1c7)]['encode_cell']({'r':_0x46be3c,'c':_0x5701f3});if(_0x415e1a[_0x40ccdc])delete _0x415e1a[_0x40ccdc];}}const _0x13e69d=_0x5df0d8['map'](_0x243089=>{const _0x481be6=_0x2d7fb0;_0x243089[_0x481be6(0x1ab)]=_0x243089[_0x481be6(0x1ab)]||{};const _0x177a50={};return _0x3ce1b7[_0x481be6(0x14d)](_0x11b611=>{const _0x79c957=_0x481be6,_0x4e0eff=String(_0x11b611)['trim'](),_0x1ffba4=_0x4e0eff[_0x79c957(0x187)](),_0x5ce67f=Object['keys'](_0x243089)[_0x79c957(0x19f)](_0x197530=>_0x197530[_0x79c957(0x12e)]()[_0x79c957(0x187)]()===_0x1ffba4);if(_0x5ce67f){_0x177a50[_0x4e0eff]=_0x243089[_0x5ce67f]??'';return;}switch(_0x4e0eff){case'ID':_0x177a50[_0x4e0eff]=_0x243089['id']??'';break;case'Tipo*':_0x177a50[_0x4e0eff]=_0x556430(_0x243089[_0x79c957(0x147)]);break;case'Código\x20SKU*':_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x121)]??'';break;case _0x79c957(0x1da):_0x177a50[_0x4e0eff]=_0x243089['setDescripcion']??'';break;case _0x79c957(0x146):_0x177a50[_0x4e0eff]=_0x243089['setItemDescription']??'';break;case _0x79c957(0x1c1):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x1a1)]??'';break;case _0x79c957(0x19d):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x158)]??'';break;case _0x79c957(0x116):_0x177a50[_0x4e0eff]=_0x19803e(_0x243089[_0x79c957(0x189)]);break;case _0x79c957(0x1d0):_0x177a50[_0x4e0eff]=_0x243089['setUnitId']??'';break;case _0x79c957(0x15c):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x1d5)]??'';break;case _0x79c957(0x142):_0x177a50[_0x4e0eff]=_0x379154(_0x243089['setUnidadCodigo']);break;case'Precio\x20Venta\x20Soles':_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x199)]??'';break;case _0x79c957(0x1bc):_0x177a50[_0x4e0eff]=_0x243089['PEN_setMtoPrecioCostoUnitario']??'';break;case'Precio\x20Venta\x20Dólares':_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x1a5)]??'';break;case _0x79c957(0x159):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x12f)]??'';break;case _0x79c957(0x1dc):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x18f)]??'';break;case _0x79c957(0x13b):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x1ce)]??'';break;case _0x79c957(0x1d4):_0x177a50[_0x4e0eff]=_0x379154(_0x243089[_0x79c957(0x173)]);break;case _0x79c957(0x105):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x135)]??'1';break;case _0x79c957(0x13c):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x12b)]??'';break;case _0x79c957(0x15a):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x162)]??'';break;case'Precio\x20Venta\x20Dólares\x202':_0x177a50[_0x4e0eff]=_0x243089['USD_setMtoPrecioUnitario2']??'';break;case'Precio\x20Costo\x20Dólares\x202':_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x144)]??'';break;case _0x79c957(0x133):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x164)]==0x1?'SI':'NO';break;case _0x79c957(0x16b):_0x177a50[_0x4e0eff]=_0x243089['setSucursalStock']??'';break;case'Stock\x20Mínimo':_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x118)]??'';break;case _0x79c957(0x1c4):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x149)]??'';break;case _0x79c957(0x1b4):_0x177a50[_0x4e0eff]=_0x243089[_0x79c957(0x16c)]??'';break;default:_0x177a50[_0x4e0eff]='';}}),_0x177a50;}),_0x392606=0x3e8,_0xd7bd56=_0x13e69d[_0x2d7fb0(0x196)];for(let _0x22b065=0x0;_0x22b065<_0xd7bd56;_0x22b065+=_0x392606){const _0x301849=_0x13e69d[_0x2d7fb0(0x10a)](_0x22b065,_0x22b065+_0x392606);XLSX[_0x2d7fb0(0x1c7)][_0x2d7fb0(0x102)](_0x415e1a,_0x301849,{'origin':{'r':_0x22b065+0x2,'c':0x0},'skipHeader':!![],'header':_0x3ce1b7}),postMessage({'type':_0x2d7fb0(0x1b0),'payload':{'percent':Math[_0x2d7fb0(0x114)]((_0x22b065+_0x301849[_0x2d7fb0(0x196)])/_0xd7bd56*0x64),'message':_0x2d7fb0(0x19a)+(_0x22b065+0x1)+'–'+(_0x22b065+_0x301849[_0x2d7fb0(0x196)])+_0x2d7fb0(0x1a2)+_0xd7bd56}});}const _0xc1fc45={'s':{'r':0x0,'c':0x0},'e':{'r':_0xd7bd56+0x1,'c':_0x3ce1b7[_0x2d7fb0(0x196)]-0x1}};_0x415e1a[_0x2d7fb0(0x1db)]=XLSX[_0x2d7fb0(0x1c7)][_0x2d7fb0(0x11c)](_0xc1fc45);const _0x4a2969=XLSX[_0x2d7fb0(0x122)](_0x450f17,{'bookType':_0x2d7fb0(0x1be),'type':'array'});let _0x57d578,_0x4869dc;if(_0x4a2969 instanceof Uint8Array)_0x57d578=_0x4a2969,_0x4869dc=[_0x4a2969[_0x2d7fb0(0x126)]];else{if(_0x4a2969 instanceof ArrayBuffer)_0x57d578=new Uint8Array(_0x4a2969),_0x4869dc=[_0x4a2969];else{const _0x22e587=new Uint8Array(_0x4a2969);_0x57d578=_0x22e587,_0x4869dc=[_0x22e587['buffer']];}}postMessage({'type':'exportDone','payload':{'wbout':_0x57d578,'count':_0x13e69d[_0x2d7fb0(0x196)]}},_0x4869dc);}catch(_0x4e877c){postMessage({'type':_0x2d7fb0(0x13a),'payload':_0x4e877c[_0x2d7fb0(0x14f)]||String(_0x4e877c)});}return;}};