/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.4.1
*/

const _0x42e0e4=_0x344c;(function(_0x3e9047,_0x1cfde7){const _0x35af7c=_0x344c,_0x2ee329=_0x3e9047();while(!![]){try{const _0x51c477=-parseInt(_0x35af7c(0x203))/0x1+parseInt(_0x35af7c(0x1d7))/0x2*(-parseInt(_0x35af7c(0x2b6))/0x3)+-parseInt(_0x35af7c(0x2b9))/0x4*(parseInt(_0x35af7c(0x2a4))/0x5)+parseInt(_0x35af7c(0x226))/0x6*(parseInt(_0x35af7c(0x23e))/0x7)+-parseInt(_0x35af7c(0x2b0))/0x8+parseInt(_0x35af7c(0x284))/0x9*(parseInt(_0x35af7c(0x1da))/0xa)+-parseInt(_0x35af7c(0x2af))/0xb*(-parseInt(_0x35af7c(0x2a8))/0xc);if(_0x51c477===_0x1cfde7)break;else _0x2ee329['push'](_0x2ee329['shift']());}catch(_0x3cec72){_0x2ee329['push'](_0x2ee329['shift']());}}}(_0x2b8c,0x485c5));const _0x39bace=(function(){let _0x4548ac=!![];return function(_0x3cdbb5,_0x1e6452){const _0x5e3746=_0x4548ac?function(){const _0x3d07e5=_0x344c;if(_0x1e6452){const _0x474d11=_0x1e6452[_0x3d07e5(0x219)](_0x3cdbb5,arguments);return _0x1e6452=null,_0x474d11;}}:function(){};return _0x4548ac=![],_0x5e3746;};}()),_0x532e1d=_0x39bace(this,function(){const _0x4ccd77=_0x344c;return _0x532e1d['toString']()[_0x4ccd77(0x251)](_0x4ccd77(0x1e1))[_0x4ccd77(0x2a7)]()[_0x4ccd77(0x21d)](_0x532e1d)[_0x4ccd77(0x251)](_0x4ccd77(0x1e1));});function _0x344c(_0x3b5ffb,_0x58207f){const _0x49037e=_0x2b8c();return _0x344c=function(_0x25cb19,_0xb213d5){_0x25cb19=_0x25cb19-0x1c1;let _0x3335e4=_0x49037e[_0x25cb19];return _0x3335e4;},_0x344c(_0x3b5ffb,_0x58207f);}function _0x2b8c(){const _0x43029c=['Stock\x20Mínimo','getMonth','3MFYQDm','setCategoria','buffer','4184CdIEnL','setSucursalStock','CENTIMETRO\x20CUBICO','Categoría','LTN','LITRO','return\x20(function()\x20','KILOMETRO','MTK','Nombre*','Exonerado\x20(0%)','array','UNIDAD\x20(NIU)','PIEZAS','code','\x20de\x20','LTR','Modelo\x20de\x20Cuello','round','write','Gravado\x20Gratuito\x20(10%)','Precio\x20Venta\x20Soles\x203','FARDO','255722lRAAJE','DOCENA\x20POR\x2010**6','HOJA','280YndPnm','table','GRO','Procesadas\x20filas\x20','GLI','sheet_to_json','GLL','(((.+)+)+)+$','setItemBarCode3','DOCENA','KGM','JUEGO','YARDA','LIBRAS','Precio\x20Costo\x20Dólares\x202','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','PIES\x20CUADRADOS','Precio\x20Venta\x20Soles','import','trim','exception','MTQ','setItemBarCode2','USD_setMtoPrecioUnitario','setItemBarCode','reduce','Descripción','toLowerCase','setItemUnitAlias2','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','push','error','Marca','MILLARES','exportItems:\x20products\x20no\x20es\x20Array.','Gravado\x20Gratuito\x20(18%)','Precio\x20Costo\x20Dólares','GALON\x20INGLES\x20(4,545956L)','CONOS','NIU','setWarehouseStockMin','521742NKOWlX','CENTIMETRO\x20LINEAL','findIndex','PAR','Material','Gravado\x20(10%)','setItemUnitAlias','PLACAS','Alias\x202','setUnidadEquivalencia3','xlsx','parse_date_code','SSF','PEN_setMtoPrecioCostoUnitario3','El\x20archivo\x20tiene\x20','KWH','TONELADA\x20LARGA','setUnidadCodigo','prototype','keys','Código\x20de\x20Barras\x202','TAMBOR','apply','Precio\x20Costo\x20Soles\x202','value','PEN_setMtoPrecioUnitario3','constructor','Equivalencia\x203','FOT','length','setUnidadCodigo3','setItemVariantValues','slice','encode_cell','map','2802102qmUogh','US\x20GALON\x20(3,7843\x20L)','ID\x20UNIT','BALDE','MEGAWATT\x20HORA','METRO\x20CUBICO','Talla','MMQ','SACO','MTR','BOTELLAS','setMarca','setDescripcion','padStart','USD_setMtoPrecioCostoUnitario','CMK','setItemDescription','Impuesto*','DZP','Artículo','forEach','KIT','CAJA','LBR','7ilHIfq','MMK','Precio\x20Costo\x20Soles','Inafecto\x20Gratuito\x20(0%)','Servicio','Precio\x20Costo\x20Soles\x203','Tipo*','setBatchExpirationDate','Código\x20de\x20Barras\x203','CMT','USD_setMtoPrecioUnitario2','Alias\x203','MILILITRO','PIES','sheet_add_json','Precio\x20Venta\x20Dólares\x203','setUnitId2','PAQUETE','bind','search','progress','TONELADAS','CEN','CIENTO\x20DE\x20UNIDADES','utils','MILIGRAMOS','HECTOLITRO','BARRILES','encode_range','ID\x20UNIT\x202','ONZ','Gravado\x20(18%)','ID\x20UNIT\x203','Precio\x20Venta\x20Dólares','info','BLL','GRAMO','PULGADAS','setItemUnitAlias3','Precio\x20Costo\x20Dólares\x203','Stock\x20Actual','Unidad\x20de\x20Medida\x203','console','message','DZN','ONZAS','SheetNames','setUnitId3','PIES\x20CUBICOS','QQM','CENTIMETRO\x20CUADRADO','read','getDate','Código\x20SKU*','HLT','Fecha\x20de\x20Vencimiento','Precio\x20Venta\x20Dólares\x202','CARTONES','Precio\x20Venta\x20Soles\x202','setCodProducto','¿Rastrear\x20Inventario?','Inafecto\x20(0%)','warn','setUnidadEquivalencia2','YDK','Materia\x20Prima','exportDone','TUBOS','METRO\x20CUADRADO','QUINTAL','142506sNmZvS','GRM','LATAS','Código\x20de\x20Barras','PALETAS','LEF','MILIMETRO\x20CUBICO','Ubicación','KILOGRAMO','Modelo\x20de\x20Manga','MILIMETRO\x20CUADRADO','Equivalencia\x202','MILIMETRO','Unidad\x20de\x20Medida\x202','Combo','setTaxId','getFullYear','METRO','Alias','PLIEGO','Color','KTM','Exonerado\x20Gratuito\x20(0%)','USD_setMtoPrecioCostoUnitario3','UNIDAD\x20(ZZ)','some','log','MGM','Unidad\x20de\x20Medida*','KILOVATIO\x20HORA','TONELADA\x20CORTA','BOBINAS','715LCsIOm','YARDA\x20CUADRADA','Sheets','toString','728628Lmpfiz','MILLON\x20DE\x20UNIDADES','CILINDRO','PEN_setMtoPrecioCostoUnitario','Lote','done','MWH','121MIUGee','3861664UqtGXS','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','MMT','BOLSA'];_0x2b8c=function(){return _0x43029c;};return _0x2b8c();}_0x532e1d();const _0xb213d5=(function(){let _0x50b4b0=!![];return function(_0x40b71d,_0x39c2a3){const _0x2cad15=_0x50b4b0?function(){if(_0x39c2a3){const _0x507676=_0x39c2a3['apply'](_0x40b71d,arguments);return _0x39c2a3=null,_0x507676;}}:function(){};return _0x50b4b0=![],_0x2cad15;};}()),_0x25cb19=_0xb213d5(this,function(){const _0x15a8ad=_0x344c,_0x1e205a=function(){const _0x5ca079=_0x344c;let _0x317a00;try{_0x317a00=Function(_0x5ca079(0x1c6)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3aff9f){_0x317a00=window;}return _0x317a00;},_0x587a8b=_0x1e205a(),_0x3fec02=_0x587a8b[_0x15a8ad(0x268)]=_0x587a8b[_0x15a8ad(0x268)]||{},_0x50ca01=[_0x15a8ad(0x29e),_0x15a8ad(0x27c),_0x15a8ad(0x260),_0x15a8ad(0x1f9),_0x15a8ad(0x1ee),_0x15a8ad(0x1db),'trace'];for(let _0x1d7090=0x0;_0x1d7090<_0x50ca01[_0x15a8ad(0x220)];_0x1d7090++){const _0x10e069=_0xb213d5['constructor'][_0x15a8ad(0x215)][_0x15a8ad(0x250)](_0xb213d5),_0x1aacd5=_0x50ca01[_0x1d7090],_0x3186bf=_0x3fec02[_0x1aacd5]||_0x10e069;_0x10e069['__proto__']=_0xb213d5['bind'](_0xb213d5),_0x10e069[_0x15a8ad(0x2a7)]=_0x3186bf['toString'][_0x15a8ad(0x250)](_0x3186bf),_0x3fec02[_0x1aacd5]=_0x10e069;}});_0x25cb19(),importScripts(_0x42e0e4(0x2b1)),onmessage=({data:_0x5598cd})=>{const _0x517d86=_0x42e0e4,{action:_0x3d16f1}=_0x5598cd;if(_0x3d16f1===_0x517d86(0x1ec)){const {buf:_0x294535,maxRows:_0x8979e}=_0x5598cd;try{postMessage({'type':_0x517d86(0x252),'payload':{'percent':0x5,'message':'Iniciando\x20parseo…'}});const _0x2ff8c5=XLSX[_0x517d86(0x271)](_0x294535,{'type':_0x517d86(0x1cb),'cellDates':!![]}),_0x48ed4e=_0x2ff8c5[_0x517d86(0x2a6)][_0x2ff8c5[_0x517d86(0x26c)][0x0]],_0xcabdbd=XLSX[_0x517d86(0x256)]['sheet_to_json'](_0x48ed4e,{'defval':'','range':0x1,'cellDates':!![]}),_0x24c865=_0xcabdbd[_0x517d86(0x205)](_0xb28a6f=>(!_0xb28a6f['Tipo*']||String(_0xb28a6f['Tipo*'])[_0x517d86(0x1ed)]()==='')&&(!_0xb28a6f[_0x517d86(0x273)]||String(_0xb28a6f[_0x517d86(0x273)])[_0x517d86(0x1ed)]()==='')&&(!_0xb28a6f['Nombre*']||String(_0xb28a6f[_0x517d86(0x1c9)])[_0x517d86(0x1ed)]()==='')&&(!_0xb28a6f[_0x517d86(0x2a0)]||String(_0xb28a6f[_0x517d86(0x2a0)])[_0x517d86(0x1ed)]()==='')),_0x1b3832=_0x24c865>=0x0?_0xcabdbd[_0x517d86(0x223)](0x0,_0x24c865):_0xcabdbd,_0x526532=_0x1b3832['filter'](_0x1dd25b=>_0x1dd25b[_0x517d86(0x244)]&&String(_0x1dd25b[_0x517d86(0x244)])[_0x517d86(0x1ed)]()!==''&&_0x1dd25b['Código\x20SKU*']&&String(_0x1dd25b[_0x517d86(0x273)])[_0x517d86(0x1ed)]()!==''&&_0x1dd25b['Nombre*']&&String(_0x1dd25b[_0x517d86(0x1c9)])['trim']()!==''&&_0x1dd25b[_0x517d86(0x2a0)]&&String(_0x1dd25b['Unidad\x20de\x20Medida*'])[_0x517d86(0x1ed)]()!==''),_0x460bd8=_0x526532[_0x517d86(0x220)];if(_0x460bd8===0x0){postMessage({'type':_0x517d86(0x1f9),'payload':_0x517d86(0x1e9)});return;}if(_0x460bd8>_0x8979e)throw _0x517d86(0x211)+_0x460bd8+_0x517d86(0x1f7)+_0x8979e+'.';const _0x3a8953=0x1f4,_0x2f45a1=[],_0x4ea321=[{'codigo':'4A','nombre':'BOBINAS'},{'codigo':'BJ','nombre':'BALDE'},{'codigo':_0x517d86(0x261),'nombre':_0x517d86(0x259)},{'codigo':'BG','nombre':_0x517d86(0x2b3)},{'codigo':'BO','nombre':_0x517d86(0x230)},{'codigo':'BX','nombre':_0x517d86(0x23c)},{'codigo':'CT','nombre':'CARTONES'},{'codigo':_0x517d86(0x235),'nombre':'CENTIMETRO\x20CUADRADO'},{'codigo':'CMQ','nombre':_0x517d86(0x1c2)},{'codigo':_0x517d86(0x247),'nombre':'CENTIMETRO\x20LINEAL'},{'codigo':_0x517d86(0x254),'nombre':_0x517d86(0x255)},{'codigo':'CY','nombre':_0x517d86(0x2aa)},{'codigo':'CJ','nombre':_0x517d86(0x200)},{'codigo':_0x517d86(0x26a),'nombre':_0x517d86(0x1e3)},{'codigo':_0x517d86(0x238),'nombre':_0x517d86(0x1d8)},{'codigo':'BE','nombre':_0x517d86(0x1d6)},{'codigo':_0x517d86(0x1de),'nombre':_0x517d86(0x1ff)},{'codigo':_0x517d86(0x285),'nombre':'GRAMO'},{'codigo':_0x517d86(0x1dc),'nombre':'GRUESA'},{'codigo':_0x517d86(0x274),'nombre':_0x517d86(0x258)},{'codigo':_0x517d86(0x289),'nombre':_0x517d86(0x1d9)},{'codigo':'SET','nombre':_0x517d86(0x1e5)},{'codigo':_0x517d86(0x1e4),'nombre':'KILOGRAMO'},{'codigo':_0x517d86(0x299),'nombre':_0x517d86(0x1c7)},{'codigo':_0x517d86(0x212),'nombre':_0x517d86(0x2a1)},{'codigo':'KT','nombre':_0x517d86(0x23b)},{'codigo':'CA','nombre':_0x517d86(0x286)},{'codigo':_0x517d86(0x23d),'nombre':_0x517d86(0x1e7)},{'codigo':_0x517d86(0x1d0),'nombre':_0x517d86(0x1c5)},{'codigo':_0x517d86(0x2ae),'nombre':_0x517d86(0x22a)},{'codigo':_0x517d86(0x22f),'nombre':_0x517d86(0x295)},{'codigo':_0x517d86(0x1c8),'nombre':'METRO\x20CUADRADO'},{'codigo':_0x517d86(0x1ef),'nombre':_0x517d86(0x22b)},{'codigo':_0x517d86(0x29f),'nombre':_0x517d86(0x257)},{'codigo':'MLT','nombre':'MILILITRO'},{'codigo':_0x517d86(0x2b2),'nombre':_0x517d86(0x290)},{'codigo':_0x517d86(0x23f),'nombre':_0x517d86(0x28e)},{'codigo':_0x517d86(0x22d),'nombre':'MILIMETRO\x20CUBICO'},{'codigo':'MIL','nombre':_0x517d86(0x1fb)},{'codigo':'UM','nombre':_0x517d86(0x2a9)},{'codigo':_0x517d86(0x25c),'nombre':_0x517d86(0x26b)},{'codigo':'PF','nombre':_0x517d86(0x288)},{'codigo':'PK','nombre':_0x517d86(0x24f)},{'codigo':'PR','nombre':_0x517d86(0x206)},{'codigo':_0x517d86(0x21f),'nombre':_0x517d86(0x24b)},{'codigo':'FTK','nombre':'PIES\x20CUADRADOS'},{'codigo':'FTQ','nombre':_0x517d86(0x26e)},{'codigo':'C62','nombre':_0x517d86(0x1cd)},{'codigo':'PG','nombre':_0x517d86(0x20a)},{'codigo':'ST','nombre':_0x517d86(0x297)},{'codigo':'INH','nombre':_0x517d86(0x263)},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':_0x517d86(0x22e)},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':'STN','nombre':_0x517d86(0x2a2)},{'codigo':_0x517d86(0x1c4),'nombre':_0x517d86(0x213)},{'codigo':'TNE','nombre':_0x517d86(0x253)},{'codigo':'TU','nombre':_0x517d86(0x281)},{'codigo':_0x517d86(0x201),'nombre':_0x517d86(0x1cc)},{'codigo':'ZZ','nombre':'UNIDAD\x20(ZZ)'},{'codigo':_0x517d86(0x1e0),'nombre':_0x517d86(0x227)},{'codigo':'YRD','nombre':_0x517d86(0x1e6)},{'codigo':_0x517d86(0x27e),'nombre':_0x517d86(0x2a5)},{'codigo':_0x517d86(0x26f),'nombre':_0x517d86(0x283)}],_0x3ded90=_0x4ea321[_0x517d86(0x1f3)]((_0x5273eb,{nombre:_0x2365b3,codigo:_0x5c1fed})=>{const _0x2a472c=_0x517d86;return _0x5273eb[_0x2365b3[_0x2a472c(0x1ed)]()]=_0x5c1fed[_0x2a472c(0x1ed)](),_0x5273eb;},{});for(let _0x2119a0=0x0;_0x2119a0<_0x460bd8;_0x2119a0+=_0x3a8953){const _0x421211=_0x526532['slice'](_0x2119a0,_0x2119a0+_0x3a8953)[_0x517d86(0x225)]((_0x31e1cd,_0x37dbdc)=>{const _0x5118a2=_0x517d86;let _0x22eeda={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x31e1cd[_0x5118a2(0x244)]]||'1';const _0x20deae=String(_0x31e1cd[_0x5118a2(0x237)])[_0x5118a2(0x1ed)](),_0x141f15={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x3e6423=_0x141f15[_0x20deae]||'1',_0xfab846={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x3e6423]||{'code':'10','value':0x12},_0x338eb5={};let _0x22de7c=String(_0x31e1cd['Nombre*'])[_0x5118a2(0x1ed)]();const _0x127a69=['Lote',_0x5118a2(0x22c),_0x5118a2(0x298),'Género','Modelo','Serie',_0x5118a2(0x207),_0x5118a2(0x1d1),_0x5118a2(0x28d)];_0x127a69[_0x5118a2(0x23a)](_0x20c065=>{const _0xcced3d=_0x5118a2,_0x4e4c24=String(_0x31e1cd[_0x20c065]||'')[_0xcced3d(0x1ed)]();_0x4e4c24&&(_0x338eb5[_0x20c065]=_0x4e4c24,_0x22de7c+='\x20'+_0x20c065+'\x20'+_0x4e4c24);});const _0x250515=[],_0x4fe3d8=String(_0x31e1cd[_0x5118a2(0x2a0)]||_0x5118a2(0x1cc))[_0x5118a2(0x1ed)](),_0xb6f30f=_0x3ded90[_0x4fe3d8]||'NIU',_0xf65922=String(_0x31e1cd[_0x5118a2(0x296)])['trim']();_0x250515[_0x5118a2(0x1f8)]({'setItemUnitId':String(_0x31e1cd[_0x5118a2(0x228)])[_0x5118a2(0x1ed)]()||'','setItemBarCode':String(_0x31e1cd[_0x5118a2(0x287)])[_0x5118a2(0x1ed)]()||'','setAlias':_0xf65922,'setUnitCode':_0xb6f30f,'setPrice':parseFloat(_0x31e1cd[_0x5118a2(0x1eb)])||0x0,'setCost':parseFloat(_0x31e1cd[_0x5118a2(0x240)])||0x0,'setPriceUSD':parseFloat(_0x31e1cd[_0x5118a2(0x25f)])||0x0,'setCostUSD':parseFloat(_0x31e1cd[_0x5118a2(0x1fe)])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x75ec77=[_0x5118a2(0x25b),_0x5118a2(0x20b),_0x5118a2(0x217),_0x5118a2(0x28f),_0x5118a2(0x278),_0x5118a2(0x21a),_0x5118a2(0x276),'Precio\x20Costo\x20Dólares\x202'][_0x5118a2(0x29d)](_0x1b1ce4=>{const _0x3bb826=_0x5118a2,_0x44ecfb=_0x31e1cd[_0x1b1ce4];return _0x44ecfb!=null&&String(_0x44ecfb)[_0x3bb826(0x1ed)]()!=='';});if(_0x75ec77){const _0x4fa6bd=String(_0x31e1cd[_0x5118a2(0x291)]||'UND\x20(NIU)')[_0x5118a2(0x1ed)](),_0x1e50e6=_0x3ded90[_0x4fa6bd]||_0x5118a2(0x201),_0x1340db=String(_0x31e1cd['Alias\x202'])['trim'](),_0x3b2135=parseFloat(_0x31e1cd[_0x5118a2(0x278)])||0x0,_0xb27833=parseFloat(_0x31e1cd['Precio\x20Costo\x20Soles\x202'])||0x0,_0x55d325=parseFloat(_0x31e1cd[_0x5118a2(0x276)])||0x0,_0x476ecd=parseFloat(_0x31e1cd[_0x5118a2(0x1e8)])||0x0,_0x556c14=parseFloat(_0x31e1cd[_0x5118a2(0x28f)])||0x1;_0x250515[_0x5118a2(0x1f8)]({'setItemUnitId':String(_0x31e1cd[_0x5118a2(0x25b)])[_0x5118a2(0x1ed)]()||'','setItemBarCode':String(_0x31e1cd[_0x5118a2(0x217)])[_0x5118a2(0x1ed)]()||'','setAlias':_0x1340db,'setUnitCode':_0x1e50e6,'setPrice':_0x3b2135,'setCost':_0xb27833,'setPriceUSD':_0x55d325,'setCostUSD':_0x476ecd,'setDefault':0x0,'setEquivalence':_0x556c14,'setFactor':_0x556c14});}const _0x7e989a=[_0x5118a2(0x25e),'Alias\x203','Código\x20de\x20Barras\x203',_0x5118a2(0x21e),'Precio\x20Venta\x20Soles\x203',_0x5118a2(0x243),_0x5118a2(0x24d),'Precio\x20Costo\x20Dólares\x203']['some'](_0x4942d4=>{const _0x1a63e4=_0x5118a2,_0x1f479a=_0x31e1cd[_0x4942d4];return _0x1f479a!=null&&String(_0x1f479a)[_0x1a63e4(0x1ed)]()!=='';});if(_0x7e989a){const _0x161104=String(_0x31e1cd[_0x5118a2(0x267)]||'UND\x20(NIU)')['trim'](),_0x33310d=_0x3ded90[_0x161104]||_0x5118a2(0x201),_0x27a5b6=String(_0x31e1cd[_0x5118a2(0x249)])[_0x5118a2(0x1ed)](),_0x263ebc=parseFloat(_0x31e1cd[_0x5118a2(0x1d5)])||0x0,_0x4d43c8=parseFloat(_0x31e1cd[_0x5118a2(0x243)])||0x0,_0x20e616=parseFloat(_0x31e1cd['Precio\x20Venta\x20Dólares\x203'])||0x0,_0x40691a=parseFloat(_0x31e1cd[_0x5118a2(0x265)])||0x0,_0x3ae252=parseFloat(_0x31e1cd['Equivalencia\x203'])||0x1;_0x250515[_0x5118a2(0x1f8)]({'setItemUnitId':String(_0x31e1cd[_0x5118a2(0x25e)])[_0x5118a2(0x1ed)]()||'','setItemBarCode':String(_0x31e1cd[_0x5118a2(0x246)])['trim']()||'','setAlias':_0x27a5b6,'setUnitCode':_0x33310d,'setPrice':_0x263ebc,'setCost':_0x4d43c8,'setPriceUSD':_0x20e616,'setCostUSD':_0x40691a,'setDefault':0x0,'setEquivalence':_0x3ae252,'setFactor':_0x3ae252});}let _0x4133b8=_0x31e1cd['Fecha\x20de\x20Vencimiento'],_0xed5e='';if(_0x4133b8 instanceof Date){const _0x13b132=_0x4133b8[_0x5118a2(0x294)](),_0x2384d8=String(_0x4133b8[_0x5118a2(0x2b5)]()+0x1)[_0x5118a2(0x233)](0x2,'0'),_0x2a3eea=String(_0x4133b8[_0x5118a2(0x272)]())[_0x5118a2(0x233)](0x2,'0');_0xed5e=_0x13b132+'-'+_0x2384d8+'-'+_0x2a3eea;}else{if(typeof _0x4133b8==='number'){const _0xfd9e31=XLSX[_0x5118a2(0x20f)][_0x5118a2(0x20e)](_0x4133b8);if(_0xfd9e31){const _0x25d896=_0xfd9e31['y'],_0x1c4cb=String(_0xfd9e31['m'])[_0x5118a2(0x233)](0x2,'0'),_0x3deb7a=String(_0xfd9e31['d'])[_0x5118a2(0x233)](0x2,'0');_0xed5e=_0x25d896+'-'+_0x1c4cb+'-'+_0x3deb7a;}}else _0xed5e=String(_0x4133b8||'')[_0x5118a2(0x1ed)]();}return{'setItemId':String(_0x31e1cd['ID'])['trim'](),'setItemType':_0x22eeda,'setItemCode':String(_0x31e1cd['Código\x20SKU*'])['trim'](),'setItemName':String(_0x31e1cd['Nombre*'])[_0x5118a2(0x1ed)](),'setItemDescription':String(_0x31e1cd[_0x5118a2(0x1f4)])[_0x5118a2(0x1ed)]()||'','setItemCategories':_0x31e1cd[_0x5118a2(0x1c3)]?[String(_0x31e1cd['Categoría'])[_0x5118a2(0x1ed)]()]:[],'setItemBrands':_0x31e1cd[_0x5118a2(0x1fa)]?[String(_0x31e1cd[_0x5118a2(0x1fa)])[_0x5118a2(0x1ed)]()]:[],'setItemTaxId':_0x3e6423,'setItemTaxCode':_0xfab846[_0x5118a2(0x1ce)],'setItemTaxValue':_0xfab846[_0x5118a2(0x21b)],'setItemUnits':_0x250515,'setItemInventoriable':_0x31e1cd['¿Rastrear\x20Inventario?']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x31e1cd[_0x5118a2(0x266)])||0x0,'setStockMinimum':parseFloat(_0x31e1cd[_0x5118a2(0x2b4)])||0x0,'setItemLocation':String(_0x31e1cd[_0x5118a2(0x28b)])[_0x5118a2(0x1ed)]()||'','setBatchName':String(_0x31e1cd[_0x5118a2(0x2ac)])['trim']()||'','setItemDateExpiry':_0xed5e,'setItemVariantName':_0x22de7c,'setItemVariantValues':_0x338eb5,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x2f45a1[_0x517d86(0x1f8)](..._0x421211),postMessage({'type':_0x517d86(0x252),'payload':{'percent':Math[_0x517d86(0x1d2)]((_0x2119a0+_0x421211[_0x517d86(0x220)])/_0x460bd8*0x64),'message':_0x517d86(0x1dd)+(_0x2119a0+0x1)+'–'+(_0x2119a0+_0x421211[_0x517d86(0x220)])+'/'+_0x460bd8}});}postMessage({'type':_0x517d86(0x2ad),'payload':{'items':_0x2f45a1}});}catch(_0xa55e05){postMessage({'type':'error','payload':_0xa55e05[_0x517d86(0x269)]||_0xa55e05});}}if(_0x3d16f1==='exportItems'){const {products:_0x539e31,plantillaBuf:_0x395d09}=_0x5598cd;if(!(_0x395d09 instanceof ArrayBuffer)){postMessage({'type':_0x517d86(0x1f9),'payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array['isArray'](_0x539e31)){postMessage({'type':_0x517d86(0x1f9),'payload':_0x517d86(0x1fc)});return;}try{structuredClone(_0x539e31);}catch(_0x5d052d){postMessage({'type':_0x517d86(0x1f9),'payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x5d052d['message']});return;}try{const _0x3cdbbb={'1':_0x517d86(0x239),'2':_0x517d86(0x242),'3':_0x517d86(0x27f),'4':_0x517d86(0x292),'5':'Fabricado'};function _0x1b8130(_0x491a2e){const _0x10e3fe=_0x517d86;return _0x3cdbbb[String(_0x491a2e)]||_0x10e3fe(0x239);}const _0x3c43c6={'1':_0x517d86(0x25d),'2':_0x517d86(0x1ca),'3':_0x517d86(0x27b),'4':_0x517d86(0x1fd),'5':_0x517d86(0x241),'6':_0x517d86(0x208),'7':_0x517d86(0x29a),'8':'Exportación\x20(0%)','9':_0x517d86(0x1d4)};function _0x7d5c19(_0xc28f1f){const _0x5e0497=_0x517d86;return _0x3c43c6[String(_0xc28f1f)]||_0x5e0497(0x25d);}const _0x672524={'4A':_0x517d86(0x2a3),'BJ':_0x517d86(0x229),'BLL':'BARRILES','BG':_0x517d86(0x2b3),'BO':_0x517d86(0x230),'BX':'CAJA','CT':_0x517d86(0x277),'CMK':_0x517d86(0x270),'CMQ':_0x517d86(0x1c2),'CMT':_0x517d86(0x204),'CEN':_0x517d86(0x255),'CY':_0x517d86(0x2aa),'CJ':_0x517d86(0x200),'DZN':'DOCENA','DZP':_0x517d86(0x1d8),'BE':_0x517d86(0x1d6),'GLI':'GALON\x20INGLES\x20(4,545956L)','GRM':_0x517d86(0x262),'GRO':'GRUESA','HLT':_0x517d86(0x258),'LEF':'HOJA','SET':_0x517d86(0x1e5),'KGM':_0x517d86(0x28c),'KTM':_0x517d86(0x1c7),'KWH':_0x517d86(0x2a1),'KT':_0x517d86(0x23b),'CA':'LATAS','LBR':_0x517d86(0x1e7),'LTR':'LITRO','MWH':'MEGAWATT\x20HORA','MTR':_0x517d86(0x295),'MTK':_0x517d86(0x282),'MTQ':_0x517d86(0x22b),'MGM':_0x517d86(0x257),'MLT':_0x517d86(0x24a),'MMT':'MILIMETRO','MMK':'MILIMETRO\x20CUADRADO','MMQ':_0x517d86(0x28a),'MIL':_0x517d86(0x1fb),'UM':_0x517d86(0x2a9),'ONZ':_0x517d86(0x26b),'PF':_0x517d86(0x288),'PK':_0x517d86(0x24f),'PR':_0x517d86(0x206),'FOT':_0x517d86(0x24b),'FTK':_0x517d86(0x1ea),'FTQ':_0x517d86(0x26e),'C62':_0x517d86(0x1cd),'PG':_0x517d86(0x20a),'ST':_0x517d86(0x297),'INH':'PULGADAS','RM':'RESMA','SA':_0x517d86(0x22e),'DR':_0x517d86(0x218),'STN':_0x517d86(0x2a2),'LTN':'TONELADA\x20LARGA','TNE':_0x517d86(0x253),'TU':'TUBOS','NIU':_0x517d86(0x1cc),'ZZ':_0x517d86(0x29c),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':'YARDA','YDK':'YARDA\x20CUADRADA','QQM':_0x517d86(0x283)};function _0x24e711(_0x48e031){return _0x672524[String(_0x48e031)]||'';}const _0x51b0bc=XLSX[_0x517d86(0x271)](_0x395d09,{'type':_0x517d86(0x1cb),'cellDates':!![]}),_0x84bde4=_0x51b0bc[_0x517d86(0x26c)][0x0],_0x5951b5=_0x51b0bc[_0x517d86(0x2a6)][_0x84bde4],_0x467ac3=XLSX['utils'][_0x517d86(0x1df)](_0x5951b5,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x540d00=XLSX[_0x517d86(0x256)]['decode_range'](_0x5951b5['!ref']||'');for(let _0x2cc13b=0x2;_0x2cc13b<=_0x540d00['e']['r'];++_0x2cc13b){for(let _0x5996a7=_0x540d00['s']['c'];_0x5996a7<=_0x540d00['e']['c'];++_0x5996a7){const _0x50025b=XLSX['utils'][_0x517d86(0x224)]({'r':_0x2cc13b,'c':_0x5996a7});if(_0x5951b5[_0x50025b])delete _0x5951b5[_0x50025b];}}const _0x1fc559=_0x539e31[_0x517d86(0x225)](_0x72de17=>{const _0x3ca295=_0x517d86;_0x72de17[_0x3ca295(0x222)]=_0x72de17['setItemVariantValues']||{};const _0x5ba33e={};return _0x467ac3['forEach'](_0x5812cd=>{const _0x1cf15c=_0x3ca295,_0x5a184c=String(_0x5812cd)[_0x1cf15c(0x1ed)](),_0x54fefb=_0x5a184c[_0x1cf15c(0x1f5)](),_0x5c0982=Object[_0x1cf15c(0x216)](_0x72de17)['find'](_0x38a5a8=>_0x38a5a8[_0x1cf15c(0x1ed)]()[_0x1cf15c(0x1f5)]()===_0x54fefb);if(_0x5c0982){_0x5ba33e[_0x5a184c]=_0x72de17[_0x5c0982]??'';return;}switch(_0x5a184c){case'ID':_0x5ba33e[_0x5a184c]=_0x72de17['id']??'';break;case _0x1cf15c(0x244):_0x5ba33e[_0x5a184c]=_0x1b8130(_0x72de17['setItemType']);break;case _0x1cf15c(0x273):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x279)]??'';break;case'Nombre*':_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x232)]??'';break;case _0x1cf15c(0x1f4):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x236)]??'';break;case _0x1cf15c(0x1c3):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x2b7)]??'';break;case _0x1cf15c(0x1fa):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x231)]??'';break;case'Impuesto*':_0x5ba33e[_0x5a184c]=_0x7d5c19(_0x72de17[_0x1cf15c(0x293)]);break;case'ID\x20UNIT':_0x5ba33e[_0x5a184c]=_0x72de17['setUnitId']??'';break;case'Alias':_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x209)]??'';break;case _0x1cf15c(0x287):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x1f2)]??'';break;case'Unidad\x20de\x20Medida*':_0x5ba33e[_0x5a184c]=_0x24e711(_0x72de17[_0x1cf15c(0x214)]);break;case _0x1cf15c(0x1eb):_0x5ba33e[_0x5a184c]=_0x72de17['PEN_setMtoPrecioUnitario']??'';break;case _0x1cf15c(0x240):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x2ab)]??'';break;case'Precio\x20Venta\x20Dólares':_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x1f1)]??'';break;case _0x1cf15c(0x1fe):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x234)]??'';break;case _0x1cf15c(0x25b):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x24e)]??'';break;case'Alias\x202':_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x1f6)]??'';break;case _0x1cf15c(0x217):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x1f0)]??'';break;case _0x1cf15c(0x291):_0x5ba33e[_0x5a184c]=_0x24e711(_0x72de17['setUnidadCodigo2']);break;case _0x1cf15c(0x28f):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x27d)]??'1';break;case _0x1cf15c(0x278):_0x5ba33e[_0x5a184c]=_0x72de17['PEN_setMtoPrecioUnitario2']??'';break;case _0x1cf15c(0x21a):_0x5ba33e[_0x5a184c]=_0x72de17['PEN_setMtoPrecioCostoUnitario2']??'';break;case _0x1cf15c(0x276):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x248)]??'';break;case _0x1cf15c(0x1e8):_0x5ba33e[_0x5a184c]=_0x72de17['USD_setMtoPrecioCostoUnitario2']??'';break;case _0x1cf15c(0x25e):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x26d)]??'';break;case _0x1cf15c(0x249):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x264)]??'';break;case _0x1cf15c(0x246):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x1e2)]??'';break;case _0x1cf15c(0x267):_0x5ba33e[_0x5a184c]=_0x24e711(_0x72de17[_0x1cf15c(0x221)]);break;case'Equivalencia\x203':_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x20c)]??'1';break;case'Precio\x20Venta\x20Soles\x203':_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x21c)]??'';break;case _0x1cf15c(0x243):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x210)]??'';break;case _0x1cf15c(0x24d):_0x5ba33e[_0x5a184c]=_0x72de17['USD_setMtoPrecioUnitario3']??'';break;case _0x1cf15c(0x265):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x29b)]??'';break;case _0x1cf15c(0x27a):_0x5ba33e[_0x5a184c]=_0x72de17['setInventariable']==0x1?'SI':'NO';break;case _0x1cf15c(0x266):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x1c1)]??'';break;case _0x1cf15c(0x2b4):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x202)]??'';break;case _0x1cf15c(0x275):_0x5ba33e[_0x5a184c]=_0x72de17[_0x1cf15c(0x245)]??'';break;default:_0x5ba33e[_0x5a184c]='';}}),_0x5ba33e;}),_0x2b3a9e=0x3e8,_0x5e8dab=_0x1fc559[_0x517d86(0x220)];for(let _0x1f11e2=0x0;_0x1f11e2<_0x5e8dab;_0x1f11e2+=_0x2b3a9e){const _0x501314=_0x1fc559[_0x517d86(0x223)](_0x1f11e2,_0x1f11e2+_0x2b3a9e);XLSX[_0x517d86(0x256)][_0x517d86(0x24c)](_0x5951b5,_0x501314,{'origin':{'r':_0x1f11e2+0x2,'c':0x0},'skipHeader':!![],'header':_0x467ac3}),postMessage({'type':'progress','payload':{'percent':Math['round']((_0x1f11e2+_0x501314[_0x517d86(0x220)])/_0x5e8dab*0x64),'message':'Exportando\x20filas\x20'+(_0x1f11e2+0x1)+'–'+(_0x1f11e2+_0x501314[_0x517d86(0x220)])+_0x517d86(0x1cf)+_0x5e8dab}});}const _0x2a031e={'s':{'r':0x0,'c':0x0},'e':{'r':_0x5e8dab+0x1,'c':_0x467ac3['length']-0x1}};_0x5951b5['!ref']=XLSX[_0x517d86(0x256)][_0x517d86(0x25a)](_0x2a031e);const _0x22d2d1=XLSX[_0x517d86(0x1d3)](_0x51b0bc,{'bookType':_0x517d86(0x20d),'type':'array'});let _0x562991,_0x2abb2e;if(_0x22d2d1 instanceof Uint8Array)_0x562991=_0x22d2d1,_0x2abb2e=[_0x22d2d1[_0x517d86(0x2b8)]];else{if(_0x22d2d1 instanceof ArrayBuffer)_0x562991=new Uint8Array(_0x22d2d1),_0x2abb2e=[_0x22d2d1];else{const _0x50c9a=new Uint8Array(_0x22d2d1);_0x562991=_0x50c9a,_0x2abb2e=[_0x50c9a['buffer']];}}postMessage({'type':_0x517d86(0x280),'payload':{'wbout':_0x562991,'count':_0x1fc559[_0x517d86(0x220)]}},_0x2abb2e);}catch(_0x2605f5){postMessage({'type':_0x517d86(0x1f9),'payload':_0x2605f5[_0x517d86(0x269)]||String(_0x2605f5)});}return;}};