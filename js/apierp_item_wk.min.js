/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.2.6
*/

(function(_0x2bd6a6,_0xe598fd){const _0x2ba3bb=_0x55bb,_0x170a84=_0x2bd6a6();while(!![]){try{const _0x552e15=parseInt(_0x2ba3bb(0x1b7))/0x1+parseInt(_0x2ba3bb(0x131))/0x2*(-parseInt(_0x2ba3bb(0x15d))/0x3)+parseInt(_0x2ba3bb(0x192))/0x4+parseInt(_0x2ba3bb(0x1a1))/0x5+parseInt(_0x2ba3bb(0x208))/0x6+parseInt(_0x2ba3bb(0x1ca))/0x7+-parseInt(_0x2ba3bb(0x149))/0x8;if(_0x552e15===_0xe598fd)break;else _0x170a84['push'](_0x170a84['shift']());}catch(_0x17d97a){_0x170a84['push'](_0x170a84['shift']());}}}(_0x1989,0x18c43));const _0x1abf4b=(function(){let _0x2ba954=!![];return function(_0x17fe77,_0x2a141c){const _0x5a7b9a=_0x2ba954?function(){const _0x4c1e32=_0x55bb;if(_0x2a141c){const _0x5ad4f9=_0x2a141c[_0x4c1e32(0x18b)](_0x17fe77,arguments);return _0x2a141c=null,_0x5ad4f9;}}:function(){};return _0x2ba954=![],_0x5a7b9a;};}()),_0x14cdae=_0x1abf4b(this,function(){const _0x9ab2b7=_0x55bb;return _0x14cdae[_0x9ab2b7(0x14b)]()[_0x9ab2b7(0x1c0)](_0x9ab2b7(0x1e4))[_0x9ab2b7(0x14b)]()[_0x9ab2b7(0x152)](_0x14cdae)[_0x9ab2b7(0x1c0)](_0x9ab2b7(0x1e4));});function _0x1989(){const _0x50ff1d=['BOTELLAS','CARTONES','Precio\x20Costo\x20Dólares','ID\x20UNIT','METRO\x20CUADRADO','MILIMETRO\x20CUBICO','setCategoria','sheet_to_json','Categoría','Precio\x20Venta\x20Dólares\x202','INH','Fabricado','Precio\x20Venta\x20Soles\x202','Género','setSucursalStock','JUEGO','forEach','BARRILES','PIEZAS','MILIMETRO','182632ogEWJV','MWH','Precio\x20Venta\x20Dólares','Código\x20de\x20Barras\x203','table','USD_setMtoPrecioCostoUnitario','Precio\x20Costo\x20Dólares\x203','MLT','SheetNames','setUnitId','done','SSF','Servicio','YDK','setUnidadCodigo','KGM','HECTOLITRO','PAQUETE','Rastrear\x20Inventario','xlsx','length','LTR','FTK','MILIMETRO\x20CUADRADO','3099968QTHLuI','Fecha\x20de\x20Vencimiento','toString','NIU','Modelo\x20de\x20Manga','import','CENTIMETRO\x20CUADRADO','trim','ID\x20UNIT\x202','constructor','__proto__','C62','Impuesto*','slice','USD_setMtoPrecioUnitario3','MILIGRAMOS','exportDone','MILLON\x20DE\x20UNIDADES','Precio\x20Venta\x20Dólares\x203','HLT','3OUCQyh','Material','El\x20archivo\x20tiene\x20','KILOVATIO\x20HORA','TUBOS','PAR','Alias','setItemDescription','QQM','KTM','LIBRAS','US\x20GALON\x20(3,7843\x20L)','LBR','setUnidadCodigo2','Exonerado\x20(0%)','padStart','Precio\x20Costo\x20Soles\x203','PALETAS','ONZAS','METRO','Alias\x203','setItemBarCode2','setItemType','decode_range','Stock\x20Actual','Materia\x20Prima','setInventariable','log','LATAS','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','FARDO','TONELADA\x20LARGA','setItemIsBought','Modelo\x20de\x20Cuello','setUnitId2','USD_setMtoPrecioUnitario2','error','TNE','Se\x20Compra','GRUESA','BOLSA','setUnidadEquivalencia2','Código\x20SKU*','Comisión\x20Venta\x203\x20(%)','Comisión\x20Venta\x20(%)','write','apply','FOT','info','Código\x20de\x20Barras','getFullYear','YRD','Serie','772292cTnDRq','USD_setMtoPrecioCostoUnitario2','setItemCommissionPercentage2','Tipo*','LITRO','keys','CONOS','Inafecto\x20(0%)','reduce','toLowerCase','CMK','Alias\x202','MGM','encode_cell','progress','249030SeNERi','BLL','Color','UND\x20(NIU)','push','Gravado\x20Gratuito\x20(18%)','Precio\x20Venta\x20Soles','setItemVariantValues','Equivalencia\x202','warn','KILOMETRO','CILINDRO','setDescripcion','PEN_setMtoPrecioCostoUnitario2','SET','setItemIsSold','Lote','UNIDAD\x20(NIU)','KILOGRAMO','setUnidadEquivalencia3','PLIEGO','PEN_setMtoPrecioUnitario2','149232qNPVKN','Código\x20de\x20Barras\x202','find','number','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','Precio\x20Venta\x20Soles\x203','CMQ','KIT','array','search','MEGAWATT\x20HORA','Sheets','Exportando\x20filas\x20','encode_range','GALON\x20INGLES\x20(4,545956L)','exportItems','Gravado\x20(10%)','return\x20(function()\x20','BOBINAS','876862nilLAu','MMT','CENTIMETRO\x20LINEAL','ONZ','TONELADAS','Combo','message','QUINTAL','METRO\x20CUBICO','LEF','buffer','Precio\x20Costo\x20Dólares\x202','RESMA','KWH','GLI','Inafecto\x20Gratuito\x20(0%)','utils','PIES\x20CUBICOS','ID\x20UNIT\x203','Se\x20Vende','PLACAS','PEN_setMtoPrecioUnitario3','Ubicación','Stock\x20Mínimo','setMarca','SACO','(((.+)+)+)+$','Unidad\x20de\x20Medida\x202','PEN_setMtoPrecioUnitario','TAMBOR','Unidad\x20de\x20Medida*','DZP','Marca','CENTIMETRO\x20CUBICO','HOJA','FTQ','YARDA','setItemUnitAlias','filter','MILILITRO','STN','DOCENA','setItemUnitAlias3','MILLARES','Nombre*','BALDE','some','setUnitId3','value','CIENTO\x20DE\x20UNIDADES','Precio\x20Costo\x20Soles\x202','TONELADA\x20CORTA','Gravado\x20(18%)','GRAMO','exception','parse_date_code','Unidad\x20de\x20Medida\x203','bind','Comisión\x20Venta\x202\x20(%)','CEN','YARDA\x20CUADRADA','GRM','377268ySMZOV','UNIDAD\x20(ZZ)','setBatchExpirationDate','PIES\x20CUADRADOS','setItemCommissionPercentage','console','prototype','setItemBarCode','Artículo','DOCENA\x20POR\x2010**6','Equivalencia\x203'];_0x1989=function(){return _0x50ff1d;};return _0x1989();}_0x14cdae();const _0x3dd00f=(function(){let _0x273b2d=!![];return function(_0xc6e678,_0x2b2d81){const _0x7179c7=_0x273b2d?function(){if(_0x2b2d81){const _0x344e92=_0x2b2d81['apply'](_0xc6e678,arguments);return _0x2b2d81=null,_0x344e92;}}:function(){};return _0x273b2d=![],_0x7179c7;};}()),_0x316bf7=_0x3dd00f(this,function(){const _0x49ce72=_0x55bb,_0x347a80=function(){const _0x824e1f=_0x55bb;let _0x22275d;try{_0x22275d=Function(_0x824e1f(0x1c8)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3eea1c){_0x22275d=window;}return _0x22275d;},_0x1e3471=_0x347a80(),_0x13d204=_0x1e3471[_0x49ce72(0x20d)]=_0x1e3471[_0x49ce72(0x20d)]||{},_0x18bcbb=[_0x49ce72(0x178),_0x49ce72(0x1aa),_0x49ce72(0x18d),_0x49ce72(0x181),_0x49ce72(0x200),_0x49ce72(0x135),'trace'];for(let _0xc60c76=0x0;_0xc60c76<_0x18bcbb[_0x49ce72(0x145)];_0xc60c76++){const _0x2ae901=_0x3dd00f['constructor'][_0x49ce72(0x20e)][_0x49ce72(0x203)](_0x3dd00f),_0x55bf02=_0x18bcbb[_0xc60c76],_0x4d926c=_0x13d204[_0x55bf02]||_0x2ae901;_0x2ae901[_0x49ce72(0x153)]=_0x3dd00f[_0x49ce72(0x203)](_0x3dd00f),_0x2ae901['toString']=_0x4d926c[_0x49ce72(0x14b)][_0x49ce72(0x203)](_0x4d926c),_0x13d204[_0x55bf02]=_0x2ae901;}});function _0x55bb(_0x506bec,_0x1da0a9){const _0x59eae8=_0x1989();return _0x55bb=function(_0x316bf7,_0x3dd00f){_0x316bf7=_0x316bf7-0x125;let _0x333e79=_0x59eae8[_0x316bf7];return _0x333e79;},_0x55bb(_0x506bec,_0x1da0a9);}_0x316bf7(),importScripts('https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js'),onmessage=({data:_0x1e8091})=>{const _0x5a68bd=_0x55bb,{action:_0x5d6ce0}=_0x1e8091;if(_0x5d6ce0===_0x5a68bd(0x14e)){const {buf:_0x15ee28,maxRows:_0x1a626c}=_0x1e8091;try{postMessage({'type':_0x5a68bd(0x1a0),'payload':{'percent':0x5,'message':'Iniciando\x20parseo…'}});const _0x12bdb3=XLSX['read'](_0x15ee28,{'type':'array','cellDates':!![]}),_0x364c93=_0x12bdb3['Sheets'][_0x12bdb3[_0x5a68bd(0x139)][0x0]],_0x19e8a2=XLSX[_0x5a68bd(0x1da)]['sheet_to_json'](_0x364c93,{'defval':'','range':0x1,'cellDates':!![]}),_0x446e95=_0x19e8a2['findIndex'](_0x90cb02=>(!_0x90cb02['Tipo*']||String(_0x90cb02['Tipo*'])[_0x5a68bd(0x150)]()==='')&&(!_0x90cb02['Código\x20SKU*']||String(_0x90cb02['Código\x20SKU*'])[_0x5a68bd(0x150)]()==='')&&(!_0x90cb02[_0x5a68bd(0x1f6)]||String(_0x90cb02[_0x5a68bd(0x1f6)])['trim']()==='')&&(!_0x90cb02['Unidad\x20de\x20Medida*']||String(_0x90cb02[_0x5a68bd(0x1e8)])[_0x5a68bd(0x150)]()==='')),_0x2b643f=_0x446e95>=0x0?_0x19e8a2['slice'](0x0,_0x446e95):_0x19e8a2,_0x214cc2=_0x2b643f[_0x5a68bd(0x1f0)](_0x401851=>_0x401851[_0x5a68bd(0x195)]&&String(_0x401851[_0x5a68bd(0x195)])[_0x5a68bd(0x150)]()!==''&&_0x401851[_0x5a68bd(0x187)]&&String(_0x401851['Código\x20SKU*'])['trim']()!==''&&_0x401851['Nombre*']&&String(_0x401851[_0x5a68bd(0x1f6)])[_0x5a68bd(0x150)]()!==''&&_0x401851['Unidad\x20de\x20Medida*']&&String(_0x401851[_0x5a68bd(0x1e8)])[_0x5a68bd(0x150)]()!==''),_0x132f5d=_0x214cc2['length'];if(_0x132f5d===0x0){postMessage({'type':_0x5a68bd(0x181),'payload':_0x5a68bd(0x17a)});return;}if(_0x132f5d>_0x1a626c)throw _0x5a68bd(0x15f)+_0x132f5d+_0x5a68bd(0x1bb)+_0x1a626c+'.';const _0x17becb=0x1f4,_0x1ba52d=[],_0x2899dd=[{'codigo':'4A','nombre':_0x5a68bd(0x1c9)},{'codigo':'BJ','nombre':_0x5a68bd(0x1f7)},{'codigo':_0x5a68bd(0x1a2),'nombre':_0x5a68bd(0x12e)},{'codigo':'BG','nombre':_0x5a68bd(0x185)},{'codigo':'BO','nombre':'BOTELLAS'},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':_0x5a68bd(0x214)},{'codigo':_0x5a68bd(0x19c),'nombre':_0x5a68bd(0x14f)},{'codigo':_0x5a68bd(0x1bd),'nombre':'CENTIMETRO\x20CUBICO'},{'codigo':'CMT','nombre':_0x5a68bd(0x1cc)},{'codigo':_0x5a68bd(0x205),'nombre':_0x5a68bd(0x1fb)},{'codigo':'CY','nombre':_0x5a68bd(0x1ac)},{'codigo':'CJ','nombre':_0x5a68bd(0x198)},{'codigo':'DZN','nombre':_0x5a68bd(0x1f3)},{'codigo':_0x5a68bd(0x1e9),'nombre':_0x5a68bd(0x211)},{'codigo':'BE','nombre':'FARDO'},{'codigo':_0x5a68bd(0x1d8),'nombre':_0x5a68bd(0x1c5)},{'codigo':_0x5a68bd(0x207),'nombre':_0x5a68bd(0x1ff)},{'codigo':'GRO','nombre':_0x5a68bd(0x184)},{'codigo':_0x5a68bd(0x15c),'nombre':_0x5a68bd(0x141)},{'codigo':_0x5a68bd(0x1d3),'nombre':_0x5a68bd(0x1ec)},{'codigo':_0x5a68bd(0x1af),'nombre':_0x5a68bd(0x12c)},{'codigo':_0x5a68bd(0x140),'nombre':_0x5a68bd(0x1b3)},{'codigo':_0x5a68bd(0x166),'nombre':_0x5a68bd(0x1ab)},{'codigo':_0x5a68bd(0x1d7),'nombre':_0x5a68bd(0x160)},{'codigo':'KT','nombre':_0x5a68bd(0x1be)},{'codigo':'CA','nombre':_0x5a68bd(0x179)},{'codigo':_0x5a68bd(0x169),'nombre':_0x5a68bd(0x167)},{'codigo':_0x5a68bd(0x146),'nombre':'LITRO'},{'codigo':_0x5a68bd(0x132),'nombre':_0x5a68bd(0x1c1)},{'codigo':'MTR','nombre':'METRO'},{'codigo':'MTK','nombre':_0x5a68bd(0x217)},{'codigo':'MTQ','nombre':_0x5a68bd(0x1d2)},{'codigo':_0x5a68bd(0x19e),'nombre':_0x5a68bd(0x158)},{'codigo':_0x5a68bd(0x138),'nombre':_0x5a68bd(0x1f1)},{'codigo':_0x5a68bd(0x1cb),'nombre':_0x5a68bd(0x130)},{'codigo':'MMK','nombre':_0x5a68bd(0x148)},{'codigo':'MMQ','nombre':_0x5a68bd(0x218)},{'codigo':'MIL','nombre':_0x5a68bd(0x1f5)},{'codigo':'UM','nombre':_0x5a68bd(0x15a)},{'codigo':_0x5a68bd(0x1cd),'nombre':_0x5a68bd(0x16f)},{'codigo':'PF','nombre':_0x5a68bd(0x16e)},{'codigo':'PK','nombre':_0x5a68bd(0x142)},{'codigo':'PR','nombre':_0x5a68bd(0x162)},{'codigo':_0x5a68bd(0x18c),'nombre':'PIES'},{'codigo':_0x5a68bd(0x147),'nombre':_0x5a68bd(0x20b)},{'codigo':_0x5a68bd(0x1ed),'nombre':_0x5a68bd(0x1db)},{'codigo':_0x5a68bd(0x154),'nombre':_0x5a68bd(0x12f)},{'codigo':'PG','nombre':'PLACAS'},{'codigo':'ST','nombre':_0x5a68bd(0x1b5)},{'codigo':_0x5a68bd(0x127),'nombre':'PULGADAS'},{'codigo':'RM','nombre':_0x5a68bd(0x1d6)},{'codigo':'SA','nombre':_0x5a68bd(0x1e3)},{'codigo':'DR','nombre':_0x5a68bd(0x1e7)},{'codigo':_0x5a68bd(0x1f2),'nombre':_0x5a68bd(0x1fd)},{'codigo':'LTN','nombre':_0x5a68bd(0x17c)},{'codigo':_0x5a68bd(0x182),'nombre':_0x5a68bd(0x1ce)},{'codigo':'TU','nombre':_0x5a68bd(0x161)},{'codigo':'NIU','nombre':_0x5a68bd(0x1b2)},{'codigo':'ZZ','nombre':_0x5a68bd(0x209)},{'codigo':'GLL','nombre':_0x5a68bd(0x168)},{'codigo':_0x5a68bd(0x190),'nombre':'YARDA'},{'codigo':_0x5a68bd(0x13e),'nombre':'YARDA\x20CUADRADA'},{'codigo':_0x5a68bd(0x165),'nombre':_0x5a68bd(0x1d1)}],_0x4585d1=_0x2899dd[_0x5a68bd(0x19a)]((_0xfbaf4,{nombre:_0x14f8f3,codigo:_0x1552f6})=>{const _0x220038=_0x5a68bd;return _0xfbaf4[_0x14f8f3[_0x220038(0x150)]()]=_0x1552f6[_0x220038(0x150)](),_0xfbaf4;},{});for(let _0x3c2a3a=0x0;_0x3c2a3a<_0x132f5d;_0x3c2a3a+=_0x17becb){const _0x116f11=_0x214cc2[_0x5a68bd(0x156)](_0x3c2a3a,_0x3c2a3a+_0x17becb)['map']((_0x10e03d,_0x2aa102)=>{const _0x59427c=_0x5a68bd;let _0xbaa401={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x10e03d[_0x59427c(0x195)]]||'1';const _0x156690=String(_0x10e03d[_0x59427c(0x155)])[_0x59427c(0x150)](),_0x3f7021={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x423146=_0x3f7021[_0x156690]||'1',_0x4742df={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x423146]||{'code':'10','value':0x12},_0x5614dc={};let _0x575802=String(_0x10e03d[_0x59427c(0x1f6)])[_0x59427c(0x150)]();const _0x3cbb70=[_0x59427c(0x1b1),'Talla',_0x59427c(0x1a3),_0x59427c(0x12a),'Modelo',_0x59427c(0x191),_0x59427c(0x15e),_0x59427c(0x17e),_0x59427c(0x14d)];_0x3cbb70[_0x59427c(0x12d)](_0x512271=>{const _0x395e6b=_0x59427c,_0x3d4e7e=String(_0x10e03d[_0x512271]||'')[_0x395e6b(0x150)]();_0x3d4e7e&&(_0x5614dc[_0x512271]=_0x3d4e7e,_0x575802+='\x20'+_0x512271+'\x20'+_0x3d4e7e);});const _0x85d59d=[],_0xe8c875=String(_0x10e03d['Unidad\x20de\x20Medida*']||'UNIDAD\x20(NIU)')[_0x59427c(0x150)](),_0x1154a1=_0x4585d1[_0xe8c875]||_0x59427c(0x14c),_0x35b1bf=String(_0x10e03d[_0x59427c(0x163)])[_0x59427c(0x150)]();_0x85d59d[_0x59427c(0x1a5)]({'setItemUnitId':String(_0x10e03d[_0x59427c(0x216)])[_0x59427c(0x150)]()||'','setItemBarCode':String(_0x10e03d[_0x59427c(0x18e)])['trim']()||'','setAlias':_0x35b1bf,'setUnitCode':_0x1154a1,'setPrice':parseFloat(_0x10e03d[_0x59427c(0x1a7)]),'setCost':parseFloat(_0x10e03d['Precio\x20Costo\x20Soles']),'setPriceUSD':parseFloat(_0x10e03d['Precio\x20Venta\x20Dólares']),'setCostUSD':parseFloat(_0x10e03d[_0x59427c(0x215)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x10e03d['Comisión\x20Venta\x20(%)'])});const _0x4edd16=[_0x59427c(0x151),'Alias\x202',_0x59427c(0x1b8),_0x59427c(0x1a9),_0x59427c(0x129),_0x59427c(0x1fc),'Precio\x20Venta\x20Dólares\x202',_0x59427c(0x1d5)][_0x59427c(0x1f8)](_0x2f4542=>{const _0x424b61=_0x59427c,_0x258cf3=_0x10e03d[_0x2f4542];return _0x258cf3!=null&&String(_0x258cf3)[_0x424b61(0x150)]()!=='';});if(_0x4edd16){const _0x467bd9=String(_0x10e03d[_0x59427c(0x1e5)]||_0x59427c(0x1a4))[_0x59427c(0x150)](),_0x92f8ee=_0x4585d1[_0x467bd9]||_0x59427c(0x14c);_0x85d59d[_0x59427c(0x1a5)]({'setItemUnitId':String(_0x10e03d[_0x59427c(0x151)])[_0x59427c(0x150)]()||'','setItemBarCode':String(_0x10e03d[_0x59427c(0x1b8)])['trim']()||'','setAlias':String(_0x10e03d[_0x59427c(0x19d)])[_0x59427c(0x150)](),'setUnitCode':_0x92f8ee,'setPrice':parseFloat(_0x10e03d[_0x59427c(0x129)]),'setCost':parseFloat(_0x10e03d['Precio\x20Costo\x20Soles\x202']),'setPriceUSD':parseFloat(_0x10e03d['Precio\x20Venta\x20Dólares\x202']),'setCostUSD':parseFloat(_0x10e03d[_0x59427c(0x1d5)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x10e03d[_0x59427c(0x1a9)])||0x1,'setFactor':parseFloat(_0x10e03d[_0x59427c(0x1a9)])||0x1,'setItemCommissionPercentage':parseFloat(_0x10e03d[_0x59427c(0x204)])});}const _0x16c26d=[_0x59427c(0x1dc),_0x59427c(0x171),'Código\x20de\x20Barras\x203',_0x59427c(0x212),_0x59427c(0x1bc),_0x59427c(0x16d),_0x59427c(0x15b),_0x59427c(0x137)][_0x59427c(0x1f8)](_0x263d91=>{const _0x48b1d9=_0x59427c,_0x5d7fd0=_0x10e03d[_0x263d91];return _0x5d7fd0!=null&&String(_0x5d7fd0)[_0x48b1d9(0x150)]()!=='';});if(_0x16c26d){const _0x4209c2=String(_0x10e03d[_0x59427c(0x202)]||'UND\x20(NIU)')[_0x59427c(0x150)](),_0xdeb562=_0x4585d1[_0x4209c2]||'NIU';_0x85d59d[_0x59427c(0x1a5)]({'setItemUnitId':String(_0x10e03d[_0x59427c(0x1dc)])[_0x59427c(0x150)]()||'','setItemBarCode':String(_0x10e03d[_0x59427c(0x134)])[_0x59427c(0x150)]()||'','setAlias':String(_0x10e03d['Alias\x203'])[_0x59427c(0x150)](),'setUnitCode':_0xdeb562,'setPrice':parseFloat(_0x10e03d[_0x59427c(0x1bc)]),'setCost':parseFloat(_0x10e03d[_0x59427c(0x16d)]),'setPriceUSD':parseFloat(_0x10e03d['Precio\x20Venta\x20Dólares\x203']),'setCostUSD':parseFloat(_0x10e03d[_0x59427c(0x137)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x10e03d[_0x59427c(0x212)])||0x1,'setFactor':parseFloat(_0x10e03d[_0x59427c(0x212)])||0x1,'setItemCommissionPercentage':parseFloat(_0x10e03d[_0x59427c(0x188)])});}let _0x5424ca=_0x10e03d['Fecha\x20de\x20Vencimiento'],_0x302ede='';if(_0x5424ca instanceof Date){const _0x9a9b2f=_0x5424ca[_0x59427c(0x18f)](),_0x10cfd3=String(_0x5424ca['getMonth']()+0x1)[_0x59427c(0x16c)](0x2,'0'),_0x481a45=String(_0x5424ca['getDate']())[_0x59427c(0x16c)](0x2,'0');_0x302ede=_0x9a9b2f+'-'+_0x10cfd3+'-'+_0x481a45;}else{if(typeof _0x5424ca===_0x59427c(0x1ba)){const _0x486a9c=XLSX[_0x59427c(0x13c)][_0x59427c(0x201)](_0x5424ca);if(_0x486a9c){const _0x257c2f=_0x486a9c['y'],_0x1deb49=String(_0x486a9c['m'])[_0x59427c(0x16c)](0x2,'0'),_0x371b08=String(_0x486a9c['d'])[_0x59427c(0x16c)](0x2,'0');_0x302ede=_0x257c2f+'-'+_0x1deb49+'-'+_0x371b08;}}else _0x302ede=String(_0x5424ca||'')[_0x59427c(0x150)]();}return{'setItemId':String(_0x10e03d['ID'])[_0x59427c(0x150)](),'setItemType':_0xbaa401,'setItemCode':String(_0x10e03d['Código\x20SKU*'])[_0x59427c(0x150)](),'setItemName':String(_0x10e03d[_0x59427c(0x1f6)])[_0x59427c(0x150)](),'setItemDescription':String(_0x10e03d['Descripción'])[_0x59427c(0x150)]()||'','setItemIsSold':_0x10e03d[_0x59427c(0x1dd)]=='SI'?0x1:0x0,'setItemIsBought':_0x10e03d[_0x59427c(0x183)]=='SI'?0x1:0x0,'setItemCategories':_0x10e03d[_0x59427c(0x125)]?[String(_0x10e03d['Categoría'])[_0x59427c(0x150)]()]:[],'setItemBrands':_0x10e03d[_0x59427c(0x1ea)]?[String(_0x10e03d['Marca'])[_0x59427c(0x150)]()]:[],'setItemTaxId':_0x423146,'setItemTaxCode':_0x4742df['code'],'setItemTaxValue':_0x4742df[_0x59427c(0x1fa)],'setItemUnits':_0x85d59d,'setItemInventoriable':_0x10e03d['Rastrear\x20Inventario']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x10e03d[_0x59427c(0x175)])||0x0,'setStockMinimum':parseFloat(_0x10e03d[_0x59427c(0x1e1)])||0x0,'setItemLocation':String(_0x10e03d[_0x59427c(0x1e0)])['trim']()||'','setBatchName':String(_0x10e03d['Lote'])[_0x59427c(0x150)]()||'','setItemDateExpiry':_0x302ede,'setItemVariantName':_0x575802,'setItemVariantValues':_0x5614dc,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x1ba52d[_0x5a68bd(0x1a5)](..._0x116f11),postMessage({'type':_0x5a68bd(0x1a0),'payload':{'percent':Math['round']((_0x3c2a3a+_0x116f11[_0x5a68bd(0x145)])/_0x132f5d*0x64),'message':'Procesadas\x20filas\x20'+(_0x3c2a3a+0x1)+'–'+(_0x3c2a3a+_0x116f11[_0x5a68bd(0x145)])+'/'+_0x132f5d}});}postMessage({'type':_0x5a68bd(0x13b),'payload':{'items':_0x1ba52d}});}catch(_0x503c79){postMessage({'type':_0x5a68bd(0x181),'payload':_0x503c79[_0x5a68bd(0x1d0)]||_0x503c79});}}if(_0x5d6ce0===_0x5a68bd(0x1c6)){const {products:_0x43762e,plantillaBuf:_0x2c8b17}=_0x1e8091;if(!(_0x2c8b17 instanceof ArrayBuffer)){postMessage({'type':'error','payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array['isArray'](_0x43762e)){postMessage({'type':'error','payload':'exportItems:\x20products\x20no\x20es\x20Array.'});return;}try{structuredClone(_0x43762e);}catch(_0x49e392){postMessage({'type':_0x5a68bd(0x181),'payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x49e392[_0x5a68bd(0x1d0)]});return;}try{const _0x1f2325={'1':_0x5a68bd(0x210),'2':_0x5a68bd(0x13d),'3':_0x5a68bd(0x176),'4':_0x5a68bd(0x1cf),'5':_0x5a68bd(0x128)};function _0x515aae(_0x124887){const _0xeaff71=_0x5a68bd;return _0x1f2325[String(_0x124887)]||_0xeaff71(0x210);}const _0x1ad69e={'1':_0x5a68bd(0x1fe),'2':_0x5a68bd(0x16b),'3':_0x5a68bd(0x199),'4':_0x5a68bd(0x1a6),'5':_0x5a68bd(0x1d9),'6':_0x5a68bd(0x1c7),'7':'Exonerado\x20Gratuito\x20(0%)','8':'Exportación\x20(0%)','9':'Gravado\x20Gratuito\x20(10%)'};function _0x4b48f4(_0x20c494){return _0x1ad69e[String(_0x20c494)]||'Gravado\x20(18%)';}const _0x152b9e={'4A':_0x5a68bd(0x1c9),'BJ':'BALDE','BLL':'BARRILES','BG':_0x5a68bd(0x185),'BO':_0x5a68bd(0x213),'BX':'CAJA','CT':_0x5a68bd(0x214),'CMK':_0x5a68bd(0x14f),'CMQ':_0x5a68bd(0x1eb),'CMT':_0x5a68bd(0x1cc),'CEN':_0x5a68bd(0x1fb),'CY':_0x5a68bd(0x1ac),'CJ':_0x5a68bd(0x198),'DZN':'DOCENA','DZP':_0x5a68bd(0x211),'BE':_0x5a68bd(0x17b),'GLI':_0x5a68bd(0x1c5),'GRM':_0x5a68bd(0x1ff),'GRO':_0x5a68bd(0x184),'HLT':_0x5a68bd(0x141),'LEF':'HOJA','SET':_0x5a68bd(0x12c),'KGM':_0x5a68bd(0x1b3),'KTM':_0x5a68bd(0x1ab),'KWH':'KILOVATIO\x20HORA','KT':_0x5a68bd(0x1be),'CA':_0x5a68bd(0x179),'LBR':'LIBRAS','LTR':_0x5a68bd(0x196),'MWH':_0x5a68bd(0x1c1),'MTR':_0x5a68bd(0x170),'MTK':'METRO\x20CUADRADO','MTQ':_0x5a68bd(0x1d2),'MGM':'MILIGRAMOS','MLT':_0x5a68bd(0x1f1),'MMT':_0x5a68bd(0x130),'MMK':_0x5a68bd(0x148),'MMQ':_0x5a68bd(0x218),'MIL':'MILLARES','UM':_0x5a68bd(0x15a),'ONZ':_0x5a68bd(0x16f),'PF':'PALETAS','PK':_0x5a68bd(0x142),'PR':_0x5a68bd(0x162),'FOT':'PIES','FTK':_0x5a68bd(0x20b),'FTQ':_0x5a68bd(0x1db),'C62':_0x5a68bd(0x12f),'PG':_0x5a68bd(0x1de),'ST':_0x5a68bd(0x1b5),'INH':'PULGADAS','RM':_0x5a68bd(0x1d6),'SA':_0x5a68bd(0x1e3),'DR':_0x5a68bd(0x1e7),'STN':'TONELADA\x20CORTA','LTN':_0x5a68bd(0x17c),'TNE':'TONELADAS','TU':'TUBOS','NIU':'UNIDAD\x20(NIU)','ZZ':_0x5a68bd(0x209),'GLL':_0x5a68bd(0x168),'YRD':_0x5a68bd(0x1ee),'YDK':_0x5a68bd(0x206),'QQM':_0x5a68bd(0x1d1)};function _0x265022(_0x107f99){return _0x152b9e[String(_0x107f99)]||'';}const _0x545378=XLSX['read'](_0x2c8b17,{'type':_0x5a68bd(0x1bf),'cellDates':!![]}),_0x27bafd=_0x545378[_0x5a68bd(0x139)][0x0],_0x198753=_0x545378[_0x5a68bd(0x1c2)][_0x27bafd],_0x32765e=XLSX[_0x5a68bd(0x1da)][_0x5a68bd(0x21a)](_0x198753,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0xc2ef92=XLSX[_0x5a68bd(0x1da)][_0x5a68bd(0x174)](_0x198753['!ref']||'');for(let _0x47f095=0x2;_0x47f095<=_0xc2ef92['e']['r'];++_0x47f095){for(let _0x3efc5b=_0xc2ef92['s']['c'];_0x3efc5b<=_0xc2ef92['e']['c'];++_0x3efc5b){const _0x42e752=XLSX[_0x5a68bd(0x1da)][_0x5a68bd(0x19f)]({'r':_0x47f095,'c':_0x3efc5b});if(_0x198753[_0x42e752])delete _0x198753[_0x42e752];}}const _0x27d74c=_0x43762e['map'](_0x3c67ab=>{const _0x5a3cf9=_0x5a68bd;_0x3c67ab[_0x5a3cf9(0x1a8)]=_0x3c67ab[_0x5a3cf9(0x1a8)]||{};const _0x4fac65={};return _0x32765e[_0x5a3cf9(0x12d)](_0x124d99=>{const _0x19b6d4=_0x5a3cf9,_0x5ddc16=String(_0x124d99)['trim'](),_0x41aecc=_0x5ddc16[_0x19b6d4(0x19b)](),_0x36c253=Object[_0x19b6d4(0x197)](_0x3c67ab)[_0x19b6d4(0x1b9)](_0x59037c=>_0x59037c[_0x19b6d4(0x150)]()[_0x19b6d4(0x19b)]()===_0x41aecc);if(_0x36c253){_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x36c253]??'';return;}switch(_0x5ddc16){case'ID':_0x4fac65[_0x5ddc16]=_0x3c67ab['id']??'';break;case'Tipo*':_0x4fac65[_0x5ddc16]=_0x515aae(_0x3c67ab[_0x19b6d4(0x173)]);break;case _0x19b6d4(0x187):_0x4fac65[_0x5ddc16]=_0x3c67ab['setCodProducto']??'';break;case _0x19b6d4(0x1f6):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1ad)]??'';break;case'Descripción':_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x164)]??'';break;case _0x19b6d4(0x1dd):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1b0)]==0x1?'SI':'NO';break;case _0x19b6d4(0x183):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x17d)]==0x1?'SI':'NO';break;case _0x19b6d4(0x125):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x219)]??'';break;case _0x19b6d4(0x1ea):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1e2)]??'';break;case _0x19b6d4(0x155):_0x4fac65[_0x5ddc16]=_0x4b48f4(_0x3c67ab['setTaxId']);break;case'ID\x20UNIT':_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x13a)]??'';break;case _0x19b6d4(0x163):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1ef)]??'';break;case _0x19b6d4(0x18e):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x20f)]??'';break;case'Unidad\x20de\x20Medida*':_0x4fac65[_0x5ddc16]=_0x265022(_0x3c67ab[_0x19b6d4(0x13f)]);break;case _0x19b6d4(0x1a7):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1e6)]??'';break;case'Precio\x20Costo\x20Soles':_0x4fac65[_0x5ddc16]=_0x3c67ab['PEN_setMtoPrecioCostoUnitario']??'';break;case _0x19b6d4(0x133):_0x4fac65[_0x5ddc16]=_0x3c67ab['USD_setMtoPrecioUnitario']??'';break;case'Precio\x20Costo\x20Dólares':_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x136)]??'';break;case _0x19b6d4(0x189):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x20c)];break;case'ID\x20UNIT\x202':_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x17f)]??'';break;case _0x19b6d4(0x19d):_0x4fac65[_0x5ddc16]=_0x3c67ab['setItemUnitAlias2']??'';break;case'Código\x20de\x20Barras\x202':_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x172)]??'';break;case _0x19b6d4(0x1e5):_0x4fac65[_0x5ddc16]=_0x265022(_0x3c67ab[_0x19b6d4(0x16a)]);break;case _0x19b6d4(0x1a9):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x186)]??'1';break;case _0x19b6d4(0x129):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1b6)]??'';break;case _0x19b6d4(0x1fc):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1ae)]??'';break;case _0x19b6d4(0x126):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x180)]??'';break;case _0x19b6d4(0x1d5):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x193)]??'';break;case _0x19b6d4(0x204):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x194)];break;case _0x19b6d4(0x1dc):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1f9)]??'';break;case _0x19b6d4(0x171):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1f4)]??'';break;case _0x19b6d4(0x134):_0x4fac65[_0x5ddc16]=_0x3c67ab['setItemBarCode3']??'';break;case'Unidad\x20de\x20Medida\x203':_0x4fac65[_0x5ddc16]=_0x265022(_0x3c67ab['setUnidadCodigo3']);break;case _0x19b6d4(0x212):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1b4)]??'1';break;case _0x19b6d4(0x1bc):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x1df)]??'';break;case'Precio\x20Costo\x20Soles\x203':_0x4fac65[_0x5ddc16]=_0x3c67ab['PEN_setMtoPrecioCostoUnitario3']??'';break;case _0x19b6d4(0x15b):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x157)]??'';break;case _0x19b6d4(0x137):_0x4fac65[_0x5ddc16]=_0x3c67ab['USD_setMtoPrecioCostoUnitario3']??'';break;case'Comisión\x20Venta\x203\x20(%)':_0x4fac65[_0x5ddc16]=_0x3c67ab['setItemCommissionPercentage3'];break;case _0x19b6d4(0x143):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x177)]==0x1?'SI':'NO';break;case _0x19b6d4(0x175):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x12b)]??'';break;case _0x19b6d4(0x1e1):_0x4fac65[_0x5ddc16]=_0x3c67ab['setWarehouseStockMin']??'';break;case _0x19b6d4(0x14a):_0x4fac65[_0x5ddc16]=_0x3c67ab[_0x19b6d4(0x20a)]??'';break;default:_0x4fac65[_0x5ddc16]='';}}),_0x4fac65;}),_0x345f11=0x3e8,_0x54499b=_0x27d74c[_0x5a68bd(0x145)];for(let _0x1aa04d=0x0;_0x1aa04d<_0x54499b;_0x1aa04d+=_0x345f11){const _0x551837=_0x27d74c[_0x5a68bd(0x156)](_0x1aa04d,_0x1aa04d+_0x345f11);XLSX[_0x5a68bd(0x1da)]['sheet_add_json'](_0x198753,_0x551837,{'origin':{'r':_0x1aa04d+0x2,'c':0x0},'skipHeader':!![],'header':_0x32765e}),postMessage({'type':'progress','payload':{'percent':Math['round']((_0x1aa04d+_0x551837[_0x5a68bd(0x145)])/_0x54499b*0x64),'message':_0x5a68bd(0x1c3)+(_0x1aa04d+0x1)+'–'+(_0x1aa04d+_0x551837[_0x5a68bd(0x145)])+'\x20de\x20'+_0x54499b}});}const _0x1da546={'s':{'r':0x0,'c':0x0},'e':{'r':_0x54499b+0x1,'c':_0x32765e[_0x5a68bd(0x145)]-0x1}};_0x198753['!ref']=XLSX[_0x5a68bd(0x1da)][_0x5a68bd(0x1c4)](_0x1da546);const _0x480270=XLSX[_0x5a68bd(0x18a)](_0x545378,{'bookType':_0x5a68bd(0x144),'type':_0x5a68bd(0x1bf)});let _0x73fcb1,_0x50d4c8;if(_0x480270 instanceof Uint8Array)_0x73fcb1=_0x480270,_0x50d4c8=[_0x480270[_0x5a68bd(0x1d4)]];else{if(_0x480270 instanceof ArrayBuffer)_0x73fcb1=new Uint8Array(_0x480270),_0x50d4c8=[_0x480270];else{const _0x80456f=new Uint8Array(_0x480270);_0x73fcb1=_0x80456f,_0x50d4c8=[_0x80456f[_0x5a68bd(0x1d4)]];}}postMessage({'type':_0x5a68bd(0x159),'payload':{'wbout':_0x73fcb1,'count':_0x27d74c['length']}},_0x50d4c8);}catch(_0x3a5409){postMessage({'type':_0x5a68bd(0x181),'payload':_0x3a5409[_0x5a68bd(0x1d0)]||String(_0x3a5409)});}return;}};