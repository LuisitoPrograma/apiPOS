/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.3.9
*/

const _0x441b60=_0xd83e;function _0xd83e(_0x1ae75b,_0x3c640d){const _0x3a2af5=_0x123d();return _0xd83e=function(_0xa5ae60,_0x34e2bb){_0xa5ae60=_0xa5ae60-0xba;let _0x505b49=_0x3a2af5[_0xa5ae60];return _0x505b49;},_0xd83e(_0x1ae75b,_0x3c640d);}(function(_0x30e48d,_0x2710d6){const _0x3fa05e=_0xd83e,_0x495bd7=_0x30e48d();while(!![]){try{const _0xc25ac0=parseInt(_0x3fa05e(0x175))/0x1+-parseInt(_0x3fa05e(0x12a))/0x2+-parseInt(_0x3fa05e(0xe2))/0x3+-parseInt(_0x3fa05e(0x180))/0x4+parseInt(_0x3fa05e(0x150))/0x5+-parseInt(_0x3fa05e(0x163))/0x6+parseInt(_0x3fa05e(0xe9))/0x7;if(_0xc25ac0===_0x2710d6)break;else _0x495bd7['push'](_0x495bd7['shift']());}catch(_0x4799b7){_0x495bd7['push'](_0x495bd7['shift']());}}}(_0x123d,0x4f07d));const _0x1a5947=(function(){let _0x5c50f1=!![];return function(_0xab53de,_0x497a96){const _0x1e107c=_0x5c50f1?function(){const _0x3176ce=_0xd83e;if(_0x497a96){const _0x40e3da=_0x497a96[_0x3176ce(0x12d)](_0xab53de,arguments);return _0x497a96=null,_0x40e3da;}}:function(){};return _0x5c50f1=![],_0x1e107c;};}()),_0x3a2022=_0x1a5947(this,function(){const _0x586f36=_0xd83e;return _0x3a2022['toString']()['search'](_0x586f36(0xce))[_0x586f36(0x184)]()['constructor'](_0x3a2022)[_0x586f36(0x149)](_0x586f36(0xce));});_0x3a2022();const _0x34e2bb=(function(){let _0x57a407=!![];return function(_0x59172f,_0x325ad6){const _0x2461db=_0x57a407?function(){const _0x114fe0=_0xd83e;if(_0x325ad6){const _0x5c9e5f=_0x325ad6[_0x114fe0(0x12d)](_0x59172f,arguments);return _0x325ad6=null,_0x5c9e5f;}}:function(){};return _0x57a407=![],_0x2461db;};}()),_0xa5ae60=_0x34e2bb(this,function(){const _0x26325b=_0xd83e,_0x4d4737=function(){const _0x4d13b4=_0xd83e;let _0x4c32e9;try{_0x4c32e9=Function(_0x4d13b4(0x104)+_0x4d13b4(0xd0)+');')();}catch(_0x17e2ff){_0x4c32e9=window;}return _0x4c32e9;},_0x417ad5=_0x4d4737(),_0xff4afb=_0x417ad5[_0x26325b(0x10c)]=_0x417ad5[_0x26325b(0x10c)]||{},_0x1c15e0=[_0x26325b(0x10b),_0x26325b(0x137),_0x26325b(0x110),_0x26325b(0x178),'exception',_0x26325b(0xbe),_0x26325b(0x15b)];for(let _0x2e16ad=0x0;_0x2e16ad<_0x1c15e0[_0x26325b(0x14d)];_0x2e16ad++){const _0x57000f=_0x34e2bb[_0x26325b(0x17a)][_0x26325b(0x15c)]['bind'](_0x34e2bb),_0x115324=_0x1c15e0[_0x2e16ad],_0x1ba434=_0xff4afb[_0x115324]||_0x57000f;_0x57000f['__proto__']=_0x34e2bb[_0x26325b(0xf8)](_0x34e2bb),_0x57000f[_0x26325b(0x184)]=_0x1ba434[_0x26325b(0x184)][_0x26325b(0xf8)](_0x1ba434),_0xff4afb[_0x115324]=_0x57000f;}});function _0x123d(){const _0x375ea1=['CONOS','getDate','El\x20archivo\x20tiene\x20','PAQUETE','Gravado\x20(10%)','Código\x20de\x20Barras\x202','return\x20(function()\x20','isArray','MMK','SSF','HLT','TONELADAS','Género','log','console','setItemBarCode2','JUEGO','UNIDAD\x20(NIU)','info','MMT','Precio\x20Costo\x20Dólares','GRO','Descripción','map','GLI','BOLSA','setTaxId','exportDone','Nombre*','push','Precio\x20Costo\x20Dólares\x202','DZN','Unidad\x20de\x20Medida\x202','RESMA','setItemType','ID\x20UNIT\x202','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','TONELADA\x20CORTA','Fabricado','¿Rastrear\x20Inventario?','keys','Tipo*','BOTELLAS','Servicio','1093126JGkEsR','GRM','CENTIMETRO\x20CUBICO','apply','trim','UND\x20(NIU)','ONZAS','MILILITRO','Color','YDK','setUnidadCodigo','array','US\x20GALON\x20(3,7843\x20L)','warn','USD_setMtoPrecioUnitario2','Exonerado\x20(0%)','exportItems','MTQ','MTK','MILIMETRO\x20CUADRADO','setCodProducto','progress','QQM','MILIMETRO','setItemBarCode','setSucursalStock','ID\x20UNIT','BOBINAS','MILLARES','sheet_add_json','DOCENA\x20POR\x2010**6','search','PLACAS','TNE','buffer','length','Ubicación','getMonth','1520010skYegV','Precio\x20Venta\x20Soles\x202','setUnidadEquivalencia2','Procesadas\x20filas\x20','GALON\x20INGLES\x20(4,545956L)','KILOVATIO\x20HORA','utils','Código\x20SKU*','USD_setMtoPrecioCostoUnitario','setCategoria','PIES\x20CUADRADOS','trace','prototype','findIndex','LEF','setMarca','round','done','METRO','1443228FvaMtZ','BALDE','FARDO','YARDA','KWH','find','import','LBR','Equivalencia\x202','PIES\x20CUBICOS','CIENTO\x20DE\x20UNIDADES','setItemVariantValues','padStart','Fecha\x20de\x20Vencimiento','setUnitId2','MWH','setDescripcion','FOT','417647waRSXv','Precio\x20Costo\x20Soles\x202','MILLON\x20DE\x20UNIDADES','error','PLIEGO','constructor','Artículo','FTK','QUINTAL','PEN_setMtoPrecioUnitario','MILIMETRO\x20CUBICO','297488ZZGQWY','Inafecto\x20(0%)','METRO\x20CUBICO','GLL','toString','PIEZAS','Precio\x20Venta\x20Soles','setInventariable','read','MEGAWATT\x20HORA','LITRO','Categoría','HECTOLITRO','PIES','Modelo','\x20de\x20','xlsx','Material','SheetNames','toLowerCase','TONELADA\x20LARGA','MILIGRAMOS','setUnidadCodigo2','slice','Precio\x20Venta\x20Dólares','GRAMO','CENTIMETRO\x20CUADRADO','Código\x20de\x20Barras','ONZ','BARRILES','some','table','exportItems:\x20products\x20no\x20es\x20Array.','getFullYear','message','Precio\x20Venta\x20Dólares\x202','UNIDAD\x20(ZZ)','C62','Stock\x20Mínimo','Gravado\x20Gratuito\x20(18%)','BLL','Gravado\x20Gratuito\x20(10%)','USD_setMtoPrecioUnitario','TAMBOR','INH','GRUESA','Modelo\x20de\x20Cuello','(((.+)+)+)+$','KIT','{}.constructor(\x22return\x20this\x22)(\x20)','LIBRAS','LATAS','Precio\x20Costo\x20Soles','HOJA','KTM','METRO\x20CUADRADO','Marca','PULGADAS','STN','Gravado\x20(18%)','Stock\x20Actual','Materia\x20Prima','NIU','Sheets','Exportación\x20(0%)','Exonerado\x20Gratuito\x20(0%)','PEN_setMtoPrecioCostoUnitario2','1271673IYJaKM','FTQ','Unidad\x20de\x20Medida*','CAJA','DZP','LTN','write','6211968TpEPTl','Nombre\x20del\x20Lote','Impuesto*','PEN_setMtoPrecioCostoUnitario','forEach','SACO','PALETAS','LTR','filter','CMK','exportItems:\x20productos\x20no\x20clonables:\x20','KILOMETRO','YARDA\x20CUADRADA','TUBOS','CEN','bind','!ref','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','MMQ','PEN_setMtoPrecioUnitario2','number'];_0x123d=function(){return _0x375ea1;};return _0x123d();}_0xa5ae60(),importScripts(_0x441b60(0xfa)),onmessage=({data:_0x5e67})=>{const _0x596cf2=_0x441b60,{action:_0x2deb8d}=_0x5e67;if(_0x2deb8d===_0x596cf2(0x169)){const {buf:_0x69bce1,maxRows:_0x3e0d9b}=_0x5e67;try{postMessage({'type':_0x596cf2(0x13f),'payload':{'percent':0x5,'message':'Iniciando\x20parseo…'}});const _0x3cf4c8=XLSX[_0x596cf2(0x188)](_0x69bce1,{'type':'array','cellDates':!![]}),_0xc44ca7=_0x3cf4c8[_0x596cf2(0xde)][_0x3cf4c8[_0x596cf2(0x192)][0x0]],_0x19c7d7=XLSX[_0x596cf2(0x156)]['sheet_to_json'](_0xc44ca7,{'defval':'','range':0x1,'cellDates':!![]}),_0x30ccfa=_0x19c7d7[_0x596cf2(0x15d)](_0x493335=>(!_0x493335['Tipo*']||String(_0x493335[_0x596cf2(0x127)])[_0x596cf2(0x12e)]()==='')&&(!_0x493335[_0x596cf2(0x157)]||String(_0x493335[_0x596cf2(0x157)])[_0x596cf2(0x12e)]()==='')&&(!_0x493335[_0x596cf2(0x11a)]||String(_0x493335[_0x596cf2(0x11a)])[_0x596cf2(0x12e)]()==='')&&(!_0x493335[_0x596cf2(0xe4)]||String(_0x493335[_0x596cf2(0xe4)])['trim']()==='')),_0x2a0210=_0x30ccfa>=0x0?_0x19c7d7[_0x596cf2(0x197)](0x0,_0x30ccfa):_0x19c7d7,_0x23c5a2=_0x2a0210[_0x596cf2(0xf1)](_0x5938ba=>_0x5938ba[_0x596cf2(0x127)]&&String(_0x5938ba[_0x596cf2(0x127)])[_0x596cf2(0x12e)]()!==''&&_0x5938ba[_0x596cf2(0x157)]&&String(_0x5938ba[_0x596cf2(0x157)])['trim']()!==''&&_0x5938ba['Nombre*']&&String(_0x5938ba[_0x596cf2(0x11a)])['trim']()!==''&&_0x5938ba[_0x596cf2(0xe4)]&&String(_0x5938ba[_0x596cf2(0xe4)])['trim']()!==''),_0xdb8f6f=_0x23c5a2[_0x596cf2(0x14d)];if(_0xdb8f6f===0x0){postMessage({'type':'error','payload':'No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).'});return;}if(_0xdb8f6f>_0x3e0d9b)throw _0x596cf2(0x100)+_0xdb8f6f+_0x596cf2(0x122)+_0x3e0d9b+'.';const _0x58404b=0x1f4,_0x15f23b=[],_0x4d4313=[{'codigo':'4A','nombre':'BOBINAS'},{'codigo':'BJ','nombre':_0x596cf2(0x164)},{'codigo':_0x596cf2(0xc7),'nombre':'BARRILES'},{'codigo':'BG','nombre':_0x596cf2(0x117)},{'codigo':'BO','nombre':_0x596cf2(0x128)},{'codigo':'BX','nombre':_0x596cf2(0xe5)},{'codigo':'CT','nombre':'CARTONES'},{'codigo':_0x596cf2(0xf2),'nombre':_0x596cf2(0x19a)},{'codigo':'CMQ','nombre':_0x596cf2(0x12c)},{'codigo':'CMT','nombre':'CENTIMETRO\x20LINEAL'},{'codigo':_0x596cf2(0xf7),'nombre':_0x596cf2(0x16d)},{'codigo':'CY','nombre':'CILINDRO'},{'codigo':'CJ','nombre':_0x596cf2(0xfe)},{'codigo':_0x596cf2(0x11d),'nombre':'DOCENA'},{'codigo':_0x596cf2(0xe6),'nombre':_0x596cf2(0x148)},{'codigo':'BE','nombre':_0x596cf2(0x165)},{'codigo':_0x596cf2(0x116),'nombre':_0x596cf2(0x154)},{'codigo':_0x596cf2(0x12b),'nombre':_0x596cf2(0x199)},{'codigo':_0x596cf2(0x113),'nombre':_0x596cf2(0xcc)},{'codigo':_0x596cf2(0x108),'nombre':'HECTOLITRO'},{'codigo':_0x596cf2(0x15e),'nombre':'HOJA'},{'codigo':'SET','nombre':'JUEGO'},{'codigo':'KGM','nombre':'KILOGRAMO'},{'codigo':_0x596cf2(0xd5),'nombre':_0x596cf2(0xf4)},{'codigo':_0x596cf2(0x167),'nombre':_0x596cf2(0x155)},{'codigo':'KT','nombre':_0x596cf2(0xcf)},{'codigo':'CA','nombre':_0x596cf2(0xd2)},{'codigo':_0x596cf2(0x16a),'nombre':'LIBRAS'},{'codigo':_0x596cf2(0xf0),'nombre':_0x596cf2(0x18a)},{'codigo':_0x596cf2(0x172),'nombre':_0x596cf2(0x189)},{'codigo':'MTR','nombre':_0x596cf2(0x162)},{'codigo':_0x596cf2(0x13c),'nombre':_0x596cf2(0xd6)},{'codigo':_0x596cf2(0x13b),'nombre':_0x596cf2(0x182)},{'codigo':'MGM','nombre':_0x596cf2(0x195)},{'codigo':'MLT','nombre':'MILILITRO'},{'codigo':_0x596cf2(0x111),'nombre':_0x596cf2(0x141)},{'codigo':_0x596cf2(0x106),'nombre':_0x596cf2(0x13d)},{'codigo':_0x596cf2(0xfb),'nombre':'MILIMETRO\x20CUBICO'},{'codigo':'MIL','nombre':_0x596cf2(0x146)},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':_0x596cf2(0xbb),'nombre':_0x596cf2(0x130)},{'codigo':'PF','nombre':_0x596cf2(0xef)},{'codigo':'PK','nombre':'PAQUETE'},{'codigo':'PR','nombre':'PAR'},{'codigo':_0x596cf2(0x174),'nombre':_0x596cf2(0x18d)},{'codigo':_0x596cf2(0x17c),'nombre':'PIES\x20CUADRADOS'},{'codigo':_0x596cf2(0xe3),'nombre':'PIES\x20CUBICOS'},{'codigo':_0x596cf2(0xc4),'nombre':_0x596cf2(0x185)},{'codigo':'PG','nombre':_0x596cf2(0x14a)},{'codigo':'ST','nombre':_0x596cf2(0x179)},{'codigo':_0x596cf2(0xcb),'nombre':_0x596cf2(0xd8)},{'codigo':'RM','nombre':_0x596cf2(0x11f)},{'codigo':'SA','nombre':_0x596cf2(0xee)},{'codigo':'DR','nombre':_0x596cf2(0xca)},{'codigo':_0x596cf2(0xd9),'nombre':_0x596cf2(0x123)},{'codigo':_0x596cf2(0xe7),'nombre':_0x596cf2(0x194)},{'codigo':_0x596cf2(0x14b),'nombre':_0x596cf2(0x109)},{'codigo':'TU','nombre':_0x596cf2(0xf6)},{'codigo':_0x596cf2(0xdd),'nombre':'UNIDAD\x20(NIU)'},{'codigo':'ZZ','nombre':_0x596cf2(0xc3)},{'codigo':_0x596cf2(0x183),'nombre':_0x596cf2(0x136)},{'codigo':'YRD','nombre':_0x596cf2(0x166)},{'codigo':_0x596cf2(0x133),'nombre':_0x596cf2(0xf5)},{'codigo':_0x596cf2(0x140),'nombre':_0x596cf2(0x17d)}],_0x4bb8da=_0x4d4313['reduce']((_0x5535ec,{nombre:_0x234942,codigo:_0x36b36e})=>{const _0x4644a1=_0x596cf2;return _0x5535ec[_0x234942['trim']()]=_0x36b36e[_0x4644a1(0x12e)](),_0x5535ec;},{});for(let _0x23731c=0x0;_0x23731c<_0xdb8f6f;_0x23731c+=_0x58404b){const _0x348fb0=_0x23c5a2[_0x596cf2(0x197)](_0x23731c,_0x23731c+_0x58404b)['map']((_0x356aad,_0x366cb8)=>{const _0x3237b4=_0x596cf2;let _0x36a71a={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x356aad[_0x3237b4(0x127)]]||'1';const _0x3c43c3=String(_0x356aad[_0x3237b4(0xeb)])['trim'](),_0x20aa4={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x4e87e7=_0x20aa4[_0x3c43c3]||'1',_0x447eb3={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x4e87e7]||{'code':'10','value':0x12},_0x24f4fc={};let _0x5455a2=String(_0x356aad['Nombre*'])['trim']();const _0x12e225=['Talla',_0x3237b4(0x132),_0x3237b4(0x10a),_0x3237b4(0x18e),'Serie',_0x3237b4(0x191),_0x3237b4(0xcd),'Modelo\x20de\x20Manga'];_0x12e225[_0x3237b4(0xed)](_0x81f849=>{const _0x480cec=_0x3237b4,_0xea11c7=String(_0x356aad[_0x81f849]||'')[_0x480cec(0x12e)]();_0xea11c7&&(_0x24f4fc[_0x81f849]=_0xea11c7,_0x5455a2+='\x20'+_0x81f849+'\x20'+_0xea11c7);});const _0x410027=[],_0x469028=String(_0x356aad[_0x3237b4(0xe4)]||_0x3237b4(0x10f))[_0x3237b4(0x12e)](),_0x55aa18=_0x4bb8da[_0x469028]||_0x3237b4(0xdd);_0x410027[_0x3237b4(0x11b)]({'setItemUnitId':String(_0x356aad[_0x3237b4(0x144)])[_0x3237b4(0x12e)]()||'','setItemBarCode':String(_0x356aad[_0x3237b4(0xba)])[_0x3237b4(0x12e)]()||'','setAlias':_0x469028,'setUnitCode':_0x55aa18,'setPrice':parseFloat(_0x356aad[_0x3237b4(0x186)])||0x0,'setCost':parseFloat(_0x356aad[_0x3237b4(0xd3)])||0x0,'setPriceUSD':parseFloat(_0x356aad[_0x3237b4(0x198)])||0x0,'setCostUSD':parseFloat(_0x356aad[_0x3237b4(0x112)])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x2c76ab=[_0x3237b4(0x121),_0x3237b4(0x103),_0x3237b4(0x16b),_0x3237b4(0x151),_0x3237b4(0x176),_0x3237b4(0xc2),_0x3237b4(0x11c)][_0x3237b4(0xbd)](_0x52a0e3=>{const _0x417ef2=_0x3237b4,_0x2af771=_0x356aad[_0x52a0e3];return _0x2af771!=null&&String(_0x2af771)[_0x417ef2(0x12e)]()!=='';});if(_0x2c76ab){const _0x3dccc6=String(_0x356aad[_0x3237b4(0x11e)]||_0x3237b4(0x12f))['trim'](),_0xd79403=_0x4bb8da[_0x3dccc6]||_0x3237b4(0xdd),_0x57e949=parseFloat(_0x356aad[_0x3237b4(0x151)])||0x0,_0x3a457b=parseFloat(_0x356aad[_0x3237b4(0x176)])||0x0,_0x4d9807=parseFloat(_0x356aad[_0x3237b4(0xc2)])||0x0,_0x246be3=parseFloat(_0x356aad[_0x3237b4(0x11c)])||0x0,_0x5c8059=parseFloat(_0x356aad['Equivalencia\x202'])||0x1;_0x410027['push']({'setItemUnitId':String(_0x356aad[_0x3237b4(0x121)])[_0x3237b4(0x12e)]()||'','setItemBarCode':String(_0x356aad[_0x3237b4(0x103)])[_0x3237b4(0x12e)]()||'','setAlias':_0x3dccc6,'setUnitCode':_0xd79403,'setPrice':_0x57e949,'setCost':_0x3a457b,'setPriceUSD':_0x4d9807,'setCostUSD':_0x246be3,'setDefault':0x0,'setEquivalence':_0x5c8059,'setFactor':_0x5c8059});}let _0x1d408f=_0x356aad['Fecha\x20de\x20Vencimiento'],_0x754136='';if(_0x1d408f instanceof Date){const _0x2c87be=_0x1d408f[_0x3237b4(0xc0)](),_0x330580=String(_0x1d408f[_0x3237b4(0x14f)]()+0x1)['padStart'](0x2,'0'),_0x1d6ee8=String(_0x1d408f[_0x3237b4(0xff)]())[_0x3237b4(0x16f)](0x2,'0');_0x754136=_0x2c87be+'-'+_0x330580+'-'+_0x1d6ee8;}else{if(typeof _0x1d408f===_0x3237b4(0xfd)){const _0x3d21a0=XLSX[_0x3237b4(0x107)]['parse_date_code'](_0x1d408f);if(_0x3d21a0){const _0x3b2409=_0x3d21a0['y'],_0x2ce7cb=String(_0x3d21a0['m'])['padStart'](0x2,'0'),_0x44aa5c=String(_0x3d21a0['d'])['padStart'](0x2,'0');_0x754136=_0x3b2409+'-'+_0x2ce7cb+'-'+_0x44aa5c;}}else _0x754136=String(_0x1d408f||'')[_0x3237b4(0x12e)]();}return{'setItemId':String(_0x356aad['ID'])[_0x3237b4(0x12e)](),'setItemType':_0x36a71a,'setItemCode':String(_0x356aad[_0x3237b4(0x157)])[_0x3237b4(0x12e)](),'setItemName':String(_0x356aad[_0x3237b4(0x11a)])[_0x3237b4(0x12e)](),'setItemDescription':String(_0x356aad['Descripción'])[_0x3237b4(0x12e)]()||'','setItemCategories':_0x356aad['Categoría']?[String(_0x356aad[_0x3237b4(0x18b)])[_0x3237b4(0x12e)]()]:[],'setItemBrands':_0x356aad['Marca']?[String(_0x356aad[_0x3237b4(0xd7)])[_0x3237b4(0x12e)]()]:[],'setItemTaxId':_0x4e87e7,'setItemTaxCode':_0x447eb3['code'],'setItemTaxValue':_0x447eb3['value'],'setItemUnits':_0x410027,'setItemInventoriable':_0x356aad[_0x3237b4(0x125)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x356aad[_0x3237b4(0xdb)])||0x0,'setStockMinimum':parseFloat(_0x356aad[_0x3237b4(0xc5)])||0x0,'setItemLocation':String(_0x356aad[_0x3237b4(0x14e)])[_0x3237b4(0x12e)]()||'','setBatchName':String(_0x356aad['Nombre\x20del\x20Lote'])[_0x3237b4(0x12e)]()||'','setItemDateExpiry':_0x754136,'setItemVariantName':_0x5455a2,'setItemVariantValues':_0x24f4fc,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x15f23b[_0x596cf2(0x11b)](..._0x348fb0),postMessage({'type':_0x596cf2(0x13f),'payload':{'percent':Math[_0x596cf2(0x160)]((_0x23731c+_0x348fb0[_0x596cf2(0x14d)])/_0xdb8f6f*0x64),'message':_0x596cf2(0x153)+(_0x23731c+0x1)+'–'+(_0x23731c+_0x348fb0[_0x596cf2(0x14d)])+'/'+_0xdb8f6f}});}postMessage({'type':_0x596cf2(0x161),'payload':{'items':_0x15f23b}});}catch(_0x30c9b7){postMessage({'type':_0x596cf2(0x178),'payload':_0x30c9b7[_0x596cf2(0xc1)]||_0x30c9b7});}}if(_0x2deb8d===_0x596cf2(0x13a)){const {products:_0x4544b3,plantillaBuf:_0x224662}=_0x5e67;if(!(_0x224662 instanceof ArrayBuffer)){postMessage({'type':_0x596cf2(0x178),'payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array[_0x596cf2(0x105)](_0x4544b3)){postMessage({'type':_0x596cf2(0x178),'payload':_0x596cf2(0xbf)});return;}try{structuredClone(_0x4544b3);}catch(_0x5f3696){postMessage({'type':_0x596cf2(0x178),'payload':_0x596cf2(0xf3)+_0x5f3696['message']});return;}try{const _0xa4f4f5={'1':_0x596cf2(0x17b),'2':_0x596cf2(0x129),'3':_0x596cf2(0xdc),'4':'Combo','5':_0x596cf2(0x124)};function _0x20f955(_0x516807){const _0x88837b=_0x596cf2;return _0xa4f4f5[String(_0x516807)]||_0x88837b(0x17b);}const _0x35ffce={'1':'Gravado\x20(18%)','2':_0x596cf2(0x139),'3':_0x596cf2(0x181),'4':_0x596cf2(0xc6),'5':'Inafecto\x20Gratuito\x20(0%)','6':_0x596cf2(0x102),'7':_0x596cf2(0xe0),'8':_0x596cf2(0xdf),'9':_0x596cf2(0xc8)};function _0x5d1728(_0x3b88fc){const _0x1fef2b=_0x596cf2;return _0x35ffce[String(_0x3b88fc)]||_0x1fef2b(0xda);}const _0x271dc1={'4A':_0x596cf2(0x145),'BJ':_0x596cf2(0x164),'BLL':_0x596cf2(0xbc),'BG':_0x596cf2(0x117),'BO':'BOTELLAS','BX':_0x596cf2(0xe5),'CT':'CARTONES','CMK':'CENTIMETRO\x20CUADRADO','CMQ':_0x596cf2(0x12c),'CMT':'CENTIMETRO\x20LINEAL','CEN':'CIENTO\x20DE\x20UNIDADES','CY':'CILINDRO','CJ':_0x596cf2(0xfe),'DZN':'DOCENA','DZP':_0x596cf2(0x148),'BE':_0x596cf2(0x165),'GLI':_0x596cf2(0x154),'GRM':'GRAMO','GRO':_0x596cf2(0xcc),'HLT':_0x596cf2(0x18c),'LEF':_0x596cf2(0xd4),'SET':_0x596cf2(0x10e),'KGM':'KILOGRAMO','KTM':_0x596cf2(0xf4),'KWH':_0x596cf2(0x155),'KT':_0x596cf2(0xcf),'CA':_0x596cf2(0xd2),'LBR':_0x596cf2(0xd1),'LTR':_0x596cf2(0x18a),'MWH':_0x596cf2(0x189),'MTR':_0x596cf2(0x162),'MTK':_0x596cf2(0xd6),'MTQ':'METRO\x20CUBICO','MGM':_0x596cf2(0x195),'MLT':_0x596cf2(0x131),'MMT':_0x596cf2(0x141),'MMK':'MILIMETRO\x20CUADRADO','MMQ':_0x596cf2(0x17f),'MIL':_0x596cf2(0x146),'UM':_0x596cf2(0x177),'ONZ':'ONZAS','PF':'PALETAS','PK':_0x596cf2(0x101),'PR':'PAR','FOT':_0x596cf2(0x18d),'FTK':_0x596cf2(0x15a),'FTQ':_0x596cf2(0x16c),'C62':'PIEZAS','PG':_0x596cf2(0x14a),'ST':_0x596cf2(0x179),'INH':_0x596cf2(0xd8),'RM':_0x596cf2(0x11f),'SA':_0x596cf2(0xee),'DR':_0x596cf2(0xca),'STN':_0x596cf2(0x123),'LTN':_0x596cf2(0x194),'TNE':_0x596cf2(0x109),'TU':'TUBOS','NIU':_0x596cf2(0x10f),'ZZ':_0x596cf2(0xc3),'GLL':_0x596cf2(0x136),'YRD':_0x596cf2(0x166),'YDK':_0x596cf2(0xf5),'QQM':_0x596cf2(0x17d)};function _0x135f26(_0x3bbf0e){return _0x271dc1[String(_0x3bbf0e)]||'';}const _0x5a1792=XLSX[_0x596cf2(0x188)](_0x224662,{'type':'array','cellDates':!![]}),_0x14d45a=_0x5a1792['SheetNames'][0x0],_0x140e8f=_0x5a1792['Sheets'][_0x14d45a],_0xa66805=XLSX[_0x596cf2(0x156)]['sheet_to_json'](_0x140e8f,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x17928a=XLSX[_0x596cf2(0x156)]['decode_range'](_0x140e8f[_0x596cf2(0xf9)]||'');for(let _0x4a5694=0x2;_0x4a5694<=_0x17928a['e']['r'];++_0x4a5694){for(let _0xca3a27=_0x17928a['s']['c'];_0xca3a27<=_0x17928a['e']['c'];++_0xca3a27){const _0x49172c=XLSX[_0x596cf2(0x156)]['encode_cell']({'r':_0x4a5694,'c':_0xca3a27});if(_0x140e8f[_0x49172c])delete _0x140e8f[_0x49172c];}}const _0x373eef=_0x4544b3[_0x596cf2(0x115)](_0x3d9df9=>{const _0x21dbd4=_0x596cf2;_0x3d9df9[_0x21dbd4(0x16e)]=_0x3d9df9[_0x21dbd4(0x16e)]||{};const _0xd87fde={};return _0xa66805[_0x21dbd4(0xed)](_0x68d445=>{const _0x1f490f=_0x21dbd4,_0x27469f=String(_0x68d445)[_0x1f490f(0x12e)](),_0x2eeebc=_0x27469f[_0x1f490f(0x193)](),_0x51004d=Object[_0x1f490f(0x126)](_0x3d9df9)[_0x1f490f(0x168)](_0x129673=>_0x129673[_0x1f490f(0x12e)]()['toLowerCase']()===_0x2eeebc);if(_0x51004d){_0xd87fde[_0x27469f]=_0x3d9df9[_0x51004d]??'';return;}switch(_0x27469f){case'ID':_0xd87fde[_0x27469f]=_0x3d9df9['id']??'';break;case _0x1f490f(0x127):_0xd87fde[_0x27469f]=_0x20f955(_0x3d9df9[_0x1f490f(0x120)]);break;case _0x1f490f(0x157):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x13e)]??'';break;case _0x1f490f(0x11a):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x173)]??'';break;case _0x1f490f(0x114):_0xd87fde[_0x27469f]=_0x3d9df9['setItemDescription']??'';break;case _0x1f490f(0x18b):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x159)]??'';break;case _0x1f490f(0xd7):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x15f)]??'';break;case _0x1f490f(0xeb):_0xd87fde[_0x27469f]=_0x5d1728(_0x3d9df9[_0x1f490f(0x118)]);break;case _0x1f490f(0x144):_0xd87fde[_0x27469f]=_0x3d9df9['setUnitId']??'';break;case _0x1f490f(0xba):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x142)]??'';break;case _0x1f490f(0xe4):_0xd87fde[_0x27469f]=_0x135f26(_0x3d9df9[_0x1f490f(0x134)]);break;case _0x1f490f(0x186):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x17e)]??'';break;case _0x1f490f(0xd3):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0xec)]??'';break;case _0x1f490f(0x198):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0xc9)]??'';break;case _0x1f490f(0x112):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x158)]??'';break;case _0x1f490f(0x121):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x171)]??'';break;case'Código\x20de\x20Barras\x202':_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x10d)]??'';break;case'Unidad\x20de\x20Medida\x202':_0xd87fde[_0x27469f]=_0x135f26(_0x3d9df9[_0x1f490f(0x196)]);break;case _0x1f490f(0x16b):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x152)]??'1';break;case _0x1f490f(0x151):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0xfc)]??'';break;case'Precio\x20Costo\x20Soles\x202':_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0xe1)]??'';break;case _0x1f490f(0xc2):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x138)]??'';break;case _0x1f490f(0x11c):_0xd87fde[_0x27469f]=_0x3d9df9['USD_setMtoPrecioCostoUnitario2']??'';break;case'¿Rastrear\x20Inventario?':_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x187)]==0x1?'SI':'NO';break;case _0x1f490f(0xdb):_0xd87fde[_0x27469f]=_0x3d9df9[_0x1f490f(0x143)]??'';break;case _0x1f490f(0xc5):_0xd87fde[_0x27469f]=_0x3d9df9['setWarehouseStockMin']??'';break;case _0x1f490f(0xea):_0xd87fde[_0x27469f]=_0x3d9df9['setBatchName']??'';break;case _0x1f490f(0x170):_0xd87fde[_0x27469f]=_0x3d9df9['setBatchExpirationDate']??'';break;default:_0xd87fde[_0x27469f]='';}}),_0xd87fde;}),_0x4364ad=0x3e8,_0x509397=_0x373eef[_0x596cf2(0x14d)];for(let _0x10e27c=0x0;_0x10e27c<_0x509397;_0x10e27c+=_0x4364ad){const _0x4dc8b2=_0x373eef['slice'](_0x10e27c,_0x10e27c+_0x4364ad);XLSX[_0x596cf2(0x156)][_0x596cf2(0x147)](_0x140e8f,_0x4dc8b2,{'origin':{'r':_0x10e27c+0x2,'c':0x0},'skipHeader':!![],'header':_0xa66805}),postMessage({'type':_0x596cf2(0x13f),'payload':{'percent':Math[_0x596cf2(0x160)]((_0x10e27c+_0x4dc8b2['length'])/_0x509397*0x64),'message':'Exportando\x20filas\x20'+(_0x10e27c+0x1)+'–'+(_0x10e27c+_0x4dc8b2['length'])+_0x596cf2(0x18f)+_0x509397}});}const _0x36bf45={'s':{'r':0x0,'c':0x0},'e':{'r':_0x509397+0x1,'c':_0xa66805[_0x596cf2(0x14d)]-0x1}};_0x140e8f[_0x596cf2(0xf9)]=XLSX[_0x596cf2(0x156)]['encode_range'](_0x36bf45);const _0x44434b=XLSX[_0x596cf2(0xe8)](_0x5a1792,{'bookType':_0x596cf2(0x190),'type':_0x596cf2(0x135)});let _0x2463bf,_0x261986;if(_0x44434b instanceof Uint8Array)_0x2463bf=_0x44434b,_0x261986=[_0x44434b['buffer']];else{if(_0x44434b instanceof ArrayBuffer)_0x2463bf=new Uint8Array(_0x44434b),_0x261986=[_0x44434b];else{const _0x3c289b=new Uint8Array(_0x44434b);_0x2463bf=_0x3c289b,_0x261986=[_0x3c289b[_0x596cf2(0x14c)]];}}postMessage({'type':_0x596cf2(0x119),'payload':{'wbout':_0x2463bf,'count':_0x373eef[_0x596cf2(0x14d)]}},_0x261986);}catch(_0x5eb85d){postMessage({'type':_0x596cf2(0x178),'payload':_0x5eb85d[_0x596cf2(0xc1)]||String(_0x5eb85d)});}return;}};