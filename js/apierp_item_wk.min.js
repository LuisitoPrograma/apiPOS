/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.0.4
*/

function _0x22e9(_0x362b42,_0x3bd10a){const _0x46812c=_0x5f43();return _0x22e9=function(_0x3995f3,_0x377e71){_0x3995f3=_0x3995f3-0x104;let _0x2c94e6=_0x46812c[_0x3995f3];return _0x2c94e6;},_0x22e9(_0x362b42,_0x3bd10a);}(function(_0x57b61d,_0x55e081){const _0x261df7=_0x22e9,_0x39f73f=_0x57b61d();while(!![]){try{const _0x304468=parseInt(_0x261df7(0x110))/0x1+parseInt(_0x261df7(0x13b))/0x2+-parseInt(_0x261df7(0x12c))/0x3*(-parseInt(_0x261df7(0x13d))/0x4)+parseInt(_0x261df7(0x120))/0x5*(parseInt(_0x261df7(0x10d))/0x6)+-parseInt(_0x261df7(0x112))/0x7+-parseInt(_0x261df7(0x13c))/0x8*(-parseInt(_0x261df7(0x126))/0x9)+parseInt(_0x261df7(0x133))/0xa*(-parseInt(_0x261df7(0x117))/0xb);if(_0x304468===_0x55e081)break;else _0x39f73f['push'](_0x39f73f['shift']());}catch(_0x49b68d){_0x39f73f['push'](_0x39f73f['shift']());}}}(_0x5f43,0xd87d8));const _0x842588=(function(){let _0x220217=!![];return function(_0xf202c3,_0x395979){const _0x4c8b41=_0x220217?function(){if(_0x395979){const _0x588439=_0x395979['apply'](_0xf202c3,arguments);return _0x395979=null,_0x588439;}}:function(){};return _0x220217=![],_0x4c8b41;};}()),_0x41951c=_0x842588(this,function(){const _0x1fd049=_0x22e9;return _0x41951c[_0x1fd049(0x13e)]()[_0x1fd049(0x12b)](_0x1fd049(0x13f))[_0x1fd049(0x13e)]()[_0x1fd049(0x107)](_0x41951c)[_0x1fd049(0x12b)](_0x1fd049(0x13f));});_0x41951c();function _0x5f43(){const _0x1f1251=['\x20filas;\x20máximo\x20permitido:\x20','info','log','9HNobTe','return\x20(function()\x20','warn','SheetNames','Procesadas\x20filas\x20','search','1040007cOCOJp','CODIGO(*)','TIPO\x20IGV(*)','prototype','read','sheet_to_json','Fila\x20','31221940JcLiQv','{}.constructor(\x22return\x20this\x22)(\x20)','Producto\x20Inventariable','IMPRESION','done','STOCK\x20INICIAL','COSTO\x20UNITARIO','table','672218MtbhHb','5060072KGRaua','20QUCzbm','toString','(((.+)+)+)+$','array','progress','trace','apply','utils','value','constructor','round','El\x20archivo\x20tiene\x20','bind','Iniciando\x20parseo…','console','5694nRYVfl','error',':\x20falta\x20TIPO,\x20CÓDIGO\x20o\x20NOMBRE.','1268343psjohG','MARCA','11109035QQUHXW','PRECIO\x20VENTA','CATEGORIA','NOMBRE(*)','__proto__','11gkIjwE','exception','trim','PRODUCTO\x20INVENTARIABLE','Sheets','push','length','code','DESCRIPCION','8565edwPON','map','TIPO(*)'];_0x5f43=function(){return _0x1f1251;};return _0x5f43();}const _0x377e71=(function(){let _0xc7c4a9=!![];return function(_0x2f59e1,_0x1e17b7){const _0x2873e9=_0xc7c4a9?function(){const _0x84e242=_0x22e9;if(_0x1e17b7){const _0x2b0a39=_0x1e17b7[_0x84e242(0x104)](_0x2f59e1,arguments);return _0x1e17b7=null,_0x2b0a39;}}:function(){};return _0xc7c4a9=![],_0x2873e9;};}()),_0x3995f3=_0x377e71(this,function(){const _0x897d4d=_0x22e9;let _0x1197f3;try{const _0x109c3b=Function(_0x897d4d(0x127)+_0x897d4d(0x134)+');');_0x1197f3=_0x109c3b();}catch(_0x3ef592){_0x1197f3=window;}const _0x4d93ba=_0x1197f3[_0x897d4d(0x10c)]=_0x1197f3[_0x897d4d(0x10c)]||{},_0x137206=[_0x897d4d(0x125),_0x897d4d(0x128),_0x897d4d(0x124),_0x897d4d(0x10e),_0x897d4d(0x118),_0x897d4d(0x13a),_0x897d4d(0x142)];for(let _0x4d4ec9=0x0;_0x4d4ec9<_0x137206[_0x897d4d(0x11d)];_0x4d4ec9++){const _0x24c3a0=_0x377e71[_0x897d4d(0x107)][_0x897d4d(0x12f)][_0x897d4d(0x10a)](_0x377e71),_0x163476=_0x137206[_0x4d4ec9],_0x37818b=_0x4d93ba[_0x163476]||_0x24c3a0;_0x24c3a0[_0x897d4d(0x116)]=_0x377e71[_0x897d4d(0x10a)](_0x377e71),_0x24c3a0['toString']=_0x37818b['toString']['bind'](_0x37818b),_0x4d93ba[_0x163476]=_0x24c3a0;}});_0x3995f3(),importScripts('https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js'),onmessage=({data:_0x419375})=>{const _0x2d7d14=_0x22e9,{buf:_0x4469b2,maxRows:_0x3a94a0}=_0x419375;try{postMessage({'type':_0x2d7d14(0x141),'payload':{'percent':0x5,'message':_0x2d7d14(0x10b)}});const _0xbafd94=XLSX[_0x2d7d14(0x130)](_0x4469b2,{'type':_0x2d7d14(0x140)}),_0x8c7f64=_0xbafd94[_0x2d7d14(0x11b)][_0xbafd94[_0x2d7d14(0x129)][0x0]],_0x1c6dc1=XLSX[_0x2d7d14(0x105)][_0x2d7d14(0x131)](_0x8c7f64,{'defval':'','range':0x1});if(_0x1c6dc1[_0x2d7d14(0x11d)]>_0x3a94a0)throw _0x2d7d14(0x109)+_0x1c6dc1[_0x2d7d14(0x11d)]+_0x2d7d14(0x123)+_0x3a94a0+'.';const _0x451742=_0x1c6dc1[_0x2d7d14(0x11d)],_0x3b359d=0x1f4,_0x26cdab=[];for(let _0x2b106b=0x0;_0x2b106b<_0x451742;_0x2b106b+=_0x3b359d){const _0x3653d9=_0x1c6dc1['slice'](_0x2b106b,_0x2b106b+_0x3b359d)[_0x2d7d14(0x121)]((_0x3be8a8,_0x308589)=>{const _0x46cbe2=_0x2d7d14;if(!_0x3be8a8[_0x46cbe2(0x122)]||!_0x3be8a8[_0x46cbe2(0x12d)]||!_0x3be8a8['NOMBRE(*)'])throw _0x46cbe2(0x132)+(_0x2b106b+_0x308589+0x2)+_0x46cbe2(0x10f);let _0x4d1eea={'Producto\x20Estandar':'1','Servicio':'2','Insumo':'3','Kit':'4','Producto\x20Terminado':'5'}[_0x3be8a8[_0x46cbe2(0x122)]]||'1';const _0x4ec1ef=String(_0x3be8a8[_0x46cbe2(0x12e)])['trim'](),_0x3ff397={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x3f4f9b=_0x3ff397[_0x4ec1ef]||'1',_0x4fd388={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x3f4f9b]||{'code':'10','value':0x12};return{'setItemType':_0x4d1eea,'setItemCode':String(_0x3be8a8[_0x46cbe2(0x12d)])[_0x46cbe2(0x119)](),'setItemBarCode':String(_0x3be8a8[_0x46cbe2(0x136)])[_0x46cbe2(0x119)]()||'','setItemName':String(_0x3be8a8[_0x46cbe2(0x115)])['trim'](),'setItemDescription':String(_0x3be8a8[_0x46cbe2(0x11f)])['trim']()||'','setItemTaxId':_0x3f4f9b,'setItemTaxCode':_0x4fd388[_0x46cbe2(0x11e)],'setItemTaxValue':_0x4fd388[_0x46cbe2(0x106)],'setItemSunatCode':'','setItemInventoriable':_0x3be8a8[_0x46cbe2(0x11a)]===_0x46cbe2(0x135)?0x1:0x0,'setItemUnits':[{'setAlias':String(_0x3be8a8['UNIDAD\x20DE\x20MEDIDA(*)'])[_0x46cbe2(0x119)](),'setUnitCode':String(_0x3be8a8['UNIDAD\x20DE\x20MEDIDA(*)'])['trim'](),'setPrice':parseFloat(_0x3be8a8[_0x46cbe2(0x113)])||0x0,'setCost':parseFloat(_0x3be8a8[_0x46cbe2(0x139)])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1}],'setStockInitial':parseFloat(_0x3be8a8[_0x46cbe2(0x138)])||0x0,'setStockMinimum':parseFloat(_0x3be8a8['STOCK\x20MINIMO'])||0x0,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':!![],'setItemIsSold':!![],'setItemDateExpiry':'','setItemBrands':_0x3be8a8['MARCA']?[String(_0x3be8a8[_0x46cbe2(0x111)])[_0x46cbe2(0x119)]()]:[],'setItemCategories':_0x3be8a8[_0x46cbe2(0x114)]?[String(_0x3be8a8[_0x46cbe2(0x114)])[_0x46cbe2(0x119)]()]:[]};});_0x26cdab[_0x2d7d14(0x11c)](..._0x3653d9),postMessage({'type':_0x2d7d14(0x141),'payload':{'percent':Math[_0x2d7d14(0x108)]((_0x2b106b+_0x3653d9['length'])/_0x451742*0x64),'message':_0x2d7d14(0x12a)+(_0x2b106b+0x1)+'–'+(_0x2b106b+_0x3653d9[_0x2d7d14(0x11d)])+'/'+_0x451742}});}postMessage({'type':_0x2d7d14(0x137),'payload':{'items':_0x26cdab}});}catch(_0xe50f0f){postMessage({'type':_0x2d7d14(0x10e),'payload':_0xe50f0f['message']||_0xe50f0f});}};