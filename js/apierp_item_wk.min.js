/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.0.6
*/

function _0x2d8d(_0x12bfa7,_0x1d9286){const _0x1eefc1=_0x479c();return _0x2d8d=function(_0x203c58,_0xd8d983){_0x203c58=_0x203c58-0xfa;let _0x3adb2a=_0x1eefc1[_0x203c58];return _0x3adb2a;},_0x2d8d(_0x12bfa7,_0x1d9286);}(function(_0x226f50,_0x1ca9e6){const _0x282b7b=_0x2d8d,_0x1f8fc0=_0x226f50();while(!![]){try{const _0x444f77=parseInt(_0x282b7b(0x1bc))/0x1+parseInt(_0x282b7b(0x101))/0x2*(parseInt(_0x282b7b(0x147))/0x3)+-parseInt(_0x282b7b(0x17b))/0x4*(parseInt(_0x282b7b(0x1ec))/0x5)+-parseInt(_0x282b7b(0x1ab))/0x6*(parseInt(_0x282b7b(0x142))/0x7)+parseInt(_0x282b7b(0x170))/0x8*(-parseInt(_0x282b7b(0x172))/0x9)+-parseInt(_0x282b7b(0x108))/0xa+parseInt(_0x282b7b(0x1b5))/0xb;if(_0x444f77===_0x1ca9e6)break;else _0x1f8fc0['push'](_0x1f8fc0['shift']());}catch(_0x460864){_0x1f8fc0['push'](_0x1f8fc0['shift']());}}}(_0x479c,0xea1d8));const _0x5e3b1a=(function(){let _0x12d4ad=!![];return function(_0x1e921a,_0x3feebb){const _0x9d2661=_0x12d4ad?function(){const _0x37d2f9=_0x2d8d;if(_0x3feebb){const _0x27525b=_0x3feebb[_0x37d2f9(0x10b)](_0x1e921a,arguments);return _0x3feebb=null,_0x27525b;}}:function(){};return _0x12d4ad=![],_0x9d2661;};}()),_0x805e9d=_0x5e3b1a(this,function(){const _0x360a71=_0x2d8d;return _0x805e9d[_0x360a71(0x168)]()[_0x360a71(0x175)](_0x360a71(0x111))[_0x360a71(0x168)]()[_0x360a71(0x1d2)](_0x805e9d)[_0x360a71(0x175)]('(((.+)+)+)+$');});_0x805e9d();function _0x479c(){const _0x32e339=['PLACAS','BALDE','Lote','Exonerado\x20(0%)','YARDA','MILILITRO','PAQUETE','C62','code','Unidad\x20de\x20Medida*','TONELADA\x20CORTA','PIES','GALON\x20INGLES\x20(4,545956L)','104774CYTias','Stock\x20Mínimo','exportItems:\x20productos\x20no\x20clonables:\x20','setItemBarCode','Marca','Serie','decode_range','8237010GjfNsW','Material','toLowerCase','apply','Código\x20de\x20Barras\x202','BARRILES','Stock\x20Actual','GLL','UNIDAD\x20(NIU)','(((.+)+)+)+$','MILIMETRO','PIES\x20CUADRADOS','exportDone','FTK','Comisión\x20Venta\x20(%)','Descripción','Se\x20Vende','!ref','LIBRAS','SACO','KGM','Impuesto*','Color','TAMBOR','Gravado\x20Gratuito\x20(18%)','CONOS','setItemVariantValues','CENTIMETRO\x20CUBICO','PLIEGO','BOTELLAS','Precio\x20Venta\x20Soles\x202','Sheets','BOLSA','warn','Unidad\x20de\x20Medida\x203','HOJA','length','MTR','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','setMarca','setUnidadCodigo2','map','bind','CIENTO\x20DE\x20UNIDADES','Código\x20SKU*','getDate','HECTOLITRO','__proto__','LBR','forEach','ID\x20UNIT\x202','INH','METRO\x20CUBICO','console','MTQ','Rastrear\x20Inventario','FTQ','PEN_setMtoPrecioUnitario3','854644QqAJYN','Talla','Tipo*','Precio\x20Venta\x20Soles','LTN','3sKYkUS','Precio\x20Venta\x20Soles\x203','Fecha\x20de\x20Vencimiento','setItemIsBought','NIU','El\x20archivo\x20tiene\x20','US\x20GALON\x20(3,7843\x20L)','Modelo\x20de\x20Cuello','Alias\x203','table','SSF','encode_cell','DZP','trace','GRM','buffer','ONZAS','Nombre*','MILIGRAMOS','Género','Precio\x20Costo\x20Soles','CAJA','Iniciando\x20parseo…','SET','MILLON\x20DE\x20UNIDADES','setUnidadEquivalencia3','Fabricado','Inafecto\x20Gratuito\x20(0%)','setUnitId','import','FARDO','Alias','GRUESA','toString','Gravado\x20(10%)','setTaxId','\x20de\x20','log','trim','TONELADA\x20LARGA','Precio\x20Venta\x20Dólares\x202','8ErtkQo','CMK','4298922fqHKbk','LATAS','message','search','MLT','Precio\x20Costo\x20Soles\x202','CARTONES','YARDA\x20CUADRADA','Exportación\x20(0%)','116ivppJV','setUnidadEquivalencia2','Modelo\x20de\x20Manga','MMQ','Alias\x202','USD_setMtoPrecioUnitario3','error','PULGADAS','padStart','setUnitId2','ONZ','Servicio','return\x20(function()\x20','CILINDRO','setItemDescription','Código\x20de\x20Barras','Precio\x20Venta\x20Dólares\x203','find','sheet_add_json','filter','ID\x20UNIT\x203','LEF','Procesadas\x20filas\x20','setItemUnitAlias2','Código\x20de\x20Barras\x203','GLI','USD_setMtoPrecioCostoUnitario2','setItemBarCode3','Comisión\x20Venta\x203\x20(%)','slice','setBatchExpirationDate','MILLARES','TUBOS','Comisión\x20Venta\x202\x20(%)','KWH','PEN_setMtoPrecioCostoUnitario3','YDK','getFullYear','BOBINAS','Gravado\x20(18%)','QUINTAL','LITRO','Materia\x20Prima','setItemBarCode2','setUnidadCodigo3','TONELADAS','Inafecto\x20(0%)','MMT','78btUqJX','Artículo','PAR','KIT','prototype','{}.constructor(\x22return\x20this\x22)(\x20)','KILOGRAMO','MMK','MILIMETRO\x20CUADRADO','setItemCommissionPercentage2','41420995gtnHFv','Precio\x20Costo\x20Dólares\x203','parse_date_code','Precio\x20Venta\x20Dólares','LTR','Modelo','push','1001900bnoikU','DOCENA\x20POR\x2010**6','MILIMETRO\x20CUBICO','JUEGO','METRO\x20CUADRADO','setItemType','array','progress','utils','Se\x20Compra','setUnidadCodigo','GRO','UND\x20(NIU)','setItemUnitAlias3','info','Unidad\x20de\x20Medida\x202','ID\x20UNIT','isArray','METRO','RESMA','Precio\x20Costo\x20Soles\x203','Precio\x20Costo\x20Dólares','constructor','exportItems:\x20products\x20no\x20es\x20Array.','USD_setMtoPrecioUnitario2','SheetNames','MGM','setCategoria','Categoría','CMT','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','xlsx','round','PIES\x20CUBICOS','findIndex','Precio\x20Costo\x20Dólares\x202','TNE','setDescripcion','reduce','USD_setMtoPrecioUnitario','setItemCommissionPercentage','Equivalencia\x203','UNIDAD\x20(ZZ)','HLT','PIEZAS','read','setItemUnitAlias','KILOMETRO','167645DcmBAG','Exportando\x20filas\x20','Equivalencia\x202','CENTIMETRO\x20CUADRADO','encode_range'];_0x479c=function(){return _0x32e339;};return _0x479c();}const _0xd8d983=(function(){let _0x445d0b=!![];return function(_0x1c941b,_0x5d5597){const _0x3a9bff=_0x445d0b?function(){if(_0x5d5597){const _0x1e8f48=_0x5d5597['apply'](_0x1c941b,arguments);return _0x5d5597=null,_0x1e8f48;}}:function(){};return _0x445d0b=![],_0x3a9bff;};}()),_0x203c58=_0xd8d983(this,function(){const _0x3cf55a=_0x2d8d,_0x18e0e2=function(){const _0x29395d=_0x2d8d;let _0x1262f7;try{_0x1262f7=Function(_0x29395d(0x187)+_0x29395d(0x1b0)+');')();}catch(_0x2cff33){_0x1262f7=window;}return _0x1262f7;},_0x3958df=_0x18e0e2(),_0x43e189=_0x3958df[_0x3cf55a(0x13d)]=_0x3958df[_0x3cf55a(0x13d)]||{},_0x562c3f=[_0x3cf55a(0x16c),_0x3cf55a(0x129),_0x3cf55a(0x1ca),_0x3cf55a(0x181),'exception',_0x3cf55a(0x150),_0x3cf55a(0x154)];for(let _0x3c8fe5=0x0;_0x3c8fe5<_0x562c3f['length'];_0x3c8fe5++){const _0x5665c3=_0xd8d983[_0x3cf55a(0x1d2)][_0x3cf55a(0x1af)][_0x3cf55a(0x132)](_0xd8d983),_0x6fd89=_0x562c3f[_0x3c8fe5],_0x4d2d28=_0x43e189[_0x6fd89]||_0x5665c3;_0x5665c3[_0x3cf55a(0x137)]=_0xd8d983['bind'](_0xd8d983),_0x5665c3['toString']=_0x4d2d28['toString']['bind'](_0x4d2d28),_0x43e189[_0x6fd89]=_0x5665c3;}});_0x203c58(),importScripts('https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js'),onmessage=({data:_0x42c18b})=>{const _0x1f798c=_0x2d8d,{action:_0x5613c8}=_0x42c18b;if(_0x5613c8===_0x1f798c(0x164)){const {buf:_0x58b0a6,maxRows:_0x4e4fef}=_0x42c18b;try{postMessage({'type':_0x1f798c(0x1c3),'payload':{'percent':0x5,'message':_0x1f798c(0x15d)}});const _0x43e6da=XLSX[_0x1f798c(0x1e9)](_0x58b0a6,{'type':_0x1f798c(0x1c2),'cellDates':!![]}),_0x501a25=_0x43e6da[_0x1f798c(0x127)][_0x43e6da[_0x1f798c(0x1d5)][0x0]],_0x2b5dd1=XLSX[_0x1f798c(0x1c4)]['sheet_to_json'](_0x501a25,{'defval':'','range':0x1,'cellDates':!![]}),_0x3a7079=_0x2b5dd1[_0x1f798c(0x1de)](_0x3e9ec2=>(!_0x3e9ec2[_0x1f798c(0x144)]||String(_0x3e9ec2[_0x1f798c(0x144)])[_0x1f798c(0x16d)]()==='')&&(!_0x3e9ec2[_0x1f798c(0x134)]||String(_0x3e9ec2[_0x1f798c(0x134)])[_0x1f798c(0x16d)]()==='')&&(!_0x3e9ec2[_0x1f798c(0x158)]||String(_0x3e9ec2[_0x1f798c(0x158)])['trim']()==='')&&(!_0x3e9ec2[_0x1f798c(0xfd)]||String(_0x3e9ec2['Unidad\x20de\x20Medida*'])['trim']()==='')),_0x598e41=_0x3a7079>=0x0?_0x2b5dd1[_0x1f798c(0x198)](0x0,_0x3a7079):_0x2b5dd1,_0x7e9ecf=_0x598e41[_0x1f798c(0x18e)](_0x4b074e=>_0x4b074e['Tipo*']&&String(_0x4b074e['Tipo*'])[_0x1f798c(0x16d)]()!==''&&_0x4b074e[_0x1f798c(0x134)]&&String(_0x4b074e[_0x1f798c(0x134)])[_0x1f798c(0x16d)]()!==''&&_0x4b074e[_0x1f798c(0x158)]&&String(_0x4b074e[_0x1f798c(0x158)])[_0x1f798c(0x16d)]()!==''&&_0x4b074e['Unidad\x20de\x20Medida*']&&String(_0x4b074e[_0x1f798c(0xfd)])['trim']()!==''),_0x399a69=_0x7e9ecf[_0x1f798c(0x12c)];if(_0x399a69===0x0){postMessage({'type':_0x1f798c(0x181),'payload':'No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).'});return;}if(_0x399a69>_0x4e4fef)throw _0x1f798c(0x14c)+_0x399a69+_0x1f798c(0x1da)+_0x4e4fef+'.';const _0x322ed8=0x1f4,_0x52e369=[],_0x560023=[{'codigo':'4A','nombre':_0x1f798c(0x1a1)},{'codigo':'BJ','nombre':_0x1f798c(0x1f2)},{'codigo':'BLL','nombre':'BARRILES'},{'codigo':'BG','nombre':_0x1f798c(0x128)},{'codigo':'BO','nombre':'BOTELLAS'},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':'CARTONES'},{'codigo':_0x1f798c(0x171),'nombre':_0x1f798c(0x1ef)},{'codigo':'CMQ','nombre':'CENTIMETRO\x20CUBICO'},{'codigo':_0x1f798c(0x1d9),'nombre':'CENTIMETRO\x20LINEAL'},{'codigo':'CEN','nombre':'CIENTO\x20DE\x20UNIDADES'},{'codigo':'CY','nombre':_0x1f798c(0x188)},{'codigo':'CJ','nombre':_0x1f798c(0x121)},{'codigo':'DZN','nombre':'DOCENA'},{'codigo':_0x1f798c(0x153),'nombre':_0x1f798c(0x1bd)},{'codigo':'BE','nombre':_0x1f798c(0x165)},{'codigo':_0x1f798c(0x194),'nombre':_0x1f798c(0x100)},{'codigo':_0x1f798c(0x155),'nombre':'GRAMO'},{'codigo':_0x1f798c(0x1c7),'nombre':_0x1f798c(0x167)},{'codigo':_0x1f798c(0x1e7),'nombre':_0x1f798c(0x136)},{'codigo':_0x1f798c(0x190),'nombre':_0x1f798c(0x12b)},{'codigo':_0x1f798c(0x15e),'nombre':'JUEGO'},{'codigo':_0x1f798c(0x11c),'nombre':'KILOGRAMO'},{'codigo':'KTM','nombre':_0x1f798c(0x1eb)},{'codigo':_0x1f798c(0x19d),'nombre':'KILOVATIO\x20HORA'},{'codigo':'KT','nombre':'KIT'},{'codigo':'CA','nombre':_0x1f798c(0x173)},{'codigo':_0x1f798c(0x138),'nombre':_0x1f798c(0x11a)},{'codigo':_0x1f798c(0x1b9),'nombre':_0x1f798c(0x1a4)},{'codigo':'MWH','nombre':'MEGAWATT\x20HORA'},{'codigo':_0x1f798c(0x12d),'nombre':'METRO'},{'codigo':'MTK','nombre':_0x1f798c(0x1c0)},{'codigo':_0x1f798c(0x13e),'nombre':'METRO\x20CUBICO'},{'codigo':_0x1f798c(0x1d6),'nombre':_0x1f798c(0x159)},{'codigo':_0x1f798c(0x176),'nombre':_0x1f798c(0x1f6)},{'codigo':_0x1f798c(0x1aa),'nombre':_0x1f798c(0x112)},{'codigo':_0x1f798c(0x1b2),'nombre':_0x1f798c(0x1b3)},{'codigo':_0x1f798c(0x17e),'nombre':_0x1f798c(0x1be)},{'codigo':'MIL','nombre':_0x1f798c(0x19a)},{'codigo':'UM','nombre':_0x1f798c(0x15f)},{'codigo':_0x1f798c(0x185),'nombre':_0x1f798c(0x157)},{'codigo':'PF','nombre':'PALETAS'},{'codigo':'PK','nombre':_0x1f798c(0xfa)},{'codigo':'PR','nombre':'PAR'},{'codigo':'FOT','nombre':_0x1f798c(0xff)},{'codigo':_0x1f798c(0x115),'nombre':_0x1f798c(0x113)},{'codigo':_0x1f798c(0x140),'nombre':'PIES\x20CUBICOS'},{'codigo':_0x1f798c(0xfb),'nombre':_0x1f798c(0x1e8)},{'codigo':'PG','nombre':_0x1f798c(0x1f1)},{'codigo':'ST','nombre':_0x1f798c(0x124)},{'codigo':_0x1f798c(0x13b),'nombre':_0x1f798c(0x182)},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':_0x1f798c(0x11b)},{'codigo':'DR','nombre':_0x1f798c(0x11f)},{'codigo':'STN','nombre':_0x1f798c(0xfe)},{'codigo':_0x1f798c(0x146),'nombre':_0x1f798c(0x16e)},{'codigo':_0x1f798c(0x1e0),'nombre':_0x1f798c(0x1a8)},{'codigo':'TU','nombre':_0x1f798c(0x19b)},{'codigo':'NIU','nombre':_0x1f798c(0x110)},{'codigo':'ZZ','nombre':_0x1f798c(0x1e6)},{'codigo':_0x1f798c(0x10f),'nombre':_0x1f798c(0x14d)},{'codigo':'YRD','nombre':_0x1f798c(0x1f5)},{'codigo':_0x1f798c(0x19f),'nombre':_0x1f798c(0x179)},{'codigo':'QQM','nombre':_0x1f798c(0x1a3)}],_0x158fe5=_0x560023[_0x1f798c(0x1e2)]((_0x359612,{nombre:_0xaa675d,codigo:_0x136ba8})=>{const _0x59647b=_0x1f798c;return _0x359612[_0xaa675d[_0x59647b(0x16d)]()]=_0x136ba8[_0x59647b(0x16d)](),_0x359612;},{});for(let _0x9f45e5=0x0;_0x9f45e5<_0x399a69;_0x9f45e5+=_0x322ed8){const _0x116a97=_0x7e9ecf[_0x1f798c(0x198)](_0x9f45e5,_0x9f45e5+_0x322ed8)['map']((_0x22141c,_0x37a702)=>{const _0x4506f5=_0x1f798c;let _0x199bf2={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x22141c[_0x4506f5(0x144)]]||'1';const _0x42723a=String(_0x22141c[_0x4506f5(0x11d)])['trim'](),_0x1a2817={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x37bb4f=_0x1a2817[_0x42723a]||'1',_0x33757f={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x37bb4f]||{'code':'10','value':0x12},_0x2e47dc={};let _0x288f7f=String(_0x22141c[_0x4506f5(0x158)])[_0x4506f5(0x16d)]();const _0x1cb48c=[_0x4506f5(0x1f3),_0x4506f5(0x143),_0x4506f5(0x11e),_0x4506f5(0x15a),_0x4506f5(0x1ba),_0x4506f5(0x106),_0x4506f5(0x109),_0x4506f5(0x14e),_0x4506f5(0x17d)];_0x1cb48c[_0x4506f5(0x139)](_0x34d7d5=>{const _0x489eb1=_0x4506f5,_0x3978ea=String(_0x22141c[_0x34d7d5]||'')[_0x489eb1(0x16d)]();_0x3978ea&&(_0x2e47dc[_0x34d7d5]=_0x3978ea,_0x288f7f+='\x20'+_0x34d7d5+'\x20'+_0x3978ea);});const _0x3a0281=[],_0x58a857=String(_0x22141c['Unidad\x20de\x20Medida*']||_0x4506f5(0x110))[_0x4506f5(0x16d)](),_0x349800=_0x158fe5[_0x58a857]||'NIU',_0x2aa5ce=String(_0x22141c[_0x4506f5(0x166)])[_0x4506f5(0x16d)]();_0x3a0281[_0x4506f5(0x1bb)]({'setItemUnitId':String(_0x22141c[_0x4506f5(0x1cc)])[_0x4506f5(0x16d)]()||'','setItemBarCode':String(_0x22141c[_0x4506f5(0x18a)])[_0x4506f5(0x16d)]()||'','setAlias':_0x2aa5ce,'setUnitCode':_0x349800,'setPrice':parseFloat(_0x22141c['Precio\x20Venta\x20Soles']),'setCost':parseFloat(_0x22141c['Precio\x20Costo\x20Soles']),'setPriceUSD':parseFloat(_0x22141c[_0x4506f5(0x1b8)]),'setCostUSD':parseFloat(_0x22141c[_0x4506f5(0x1d1)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x22141c['Comisión\x20Venta\x20(%)'])});const _0x5550cb=[_0x4506f5(0x13a),_0x4506f5(0x17f),_0x4506f5(0x10c),_0x4506f5(0x1ee),'Precio\x20Venta\x20Soles\x202',_0x4506f5(0x177),_0x4506f5(0x16f),_0x4506f5(0x1df)]['some'](_0x5d60cf=>{const _0x310682=_0x4506f5,_0x3e3aa4=_0x22141c[_0x5d60cf];return _0x3e3aa4!=null&&String(_0x3e3aa4)[_0x310682(0x16d)]()!=='';});if(_0x5550cb){const _0x6c148c=String(_0x22141c[_0x4506f5(0x1cb)]||_0x4506f5(0x1c8))[_0x4506f5(0x16d)](),_0xc07b63=_0x158fe5[_0x6c148c]||'NIU';_0x3a0281[_0x4506f5(0x1bb)]({'setItemUnitId':String(_0x22141c[_0x4506f5(0x13a)])[_0x4506f5(0x16d)]()||'','setItemBarCode':String(_0x22141c[_0x4506f5(0x10c)])[_0x4506f5(0x16d)]()||'','setAlias':String(_0x22141c[_0x4506f5(0x17f)])['trim'](),'setUnitCode':_0xc07b63,'setPrice':parseFloat(_0x22141c[_0x4506f5(0x126)]),'setCost':parseFloat(_0x22141c[_0x4506f5(0x177)]),'setPriceUSD':parseFloat(_0x22141c[_0x4506f5(0x16f)]),'setCostUSD':parseFloat(_0x22141c[_0x4506f5(0x1df)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x22141c[_0x4506f5(0x1ee)])||0x1,'setFactor':parseFloat(_0x22141c['Equivalencia\x202'])||0x1,'setItemCommissionPercentage':parseFloat(_0x22141c[_0x4506f5(0x19c)])});}const _0x256dd9=[_0x4506f5(0x18f),_0x4506f5(0x14f),_0x4506f5(0x193),_0x4506f5(0x1e5),_0x4506f5(0x148),_0x4506f5(0x1d0),_0x4506f5(0x18b),_0x4506f5(0x1b6)]['some'](_0x274fc8=>{const _0x7851b=_0x4506f5,_0x24e353=_0x22141c[_0x274fc8];return _0x24e353!=null&&String(_0x24e353)[_0x7851b(0x16d)]()!=='';});if(_0x256dd9){const _0x2c8040=String(_0x22141c['Unidad\x20de\x20Medida\x203']||_0x4506f5(0x1c8))[_0x4506f5(0x16d)](),_0x1d0826=_0x158fe5[_0x2c8040]||_0x4506f5(0x14b);_0x3a0281[_0x4506f5(0x1bb)]({'setItemUnitId':String(_0x22141c['ID\x20UNIT\x203'])[_0x4506f5(0x16d)]()||'','setItemBarCode':String(_0x22141c['Código\x20de\x20Barras\x203'])[_0x4506f5(0x16d)]()||'','setAlias':String(_0x22141c[_0x4506f5(0x14f)])['trim'](),'setUnitCode':_0x1d0826,'setPrice':parseFloat(_0x22141c[_0x4506f5(0x148)]),'setCost':parseFloat(_0x22141c[_0x4506f5(0x1d0)]),'setPriceUSD':parseFloat(_0x22141c[_0x4506f5(0x18b)]),'setCostUSD':parseFloat(_0x22141c['Precio\x20Costo\x20Dólares\x203']),'setDefault':0x0,'setEquivalence':parseFloat(_0x22141c[_0x4506f5(0x1e5)])||0x1,'setFactor':parseFloat(_0x22141c['Equivalencia\x203'])||0x1,'setItemCommissionPercentage':parseFloat(_0x22141c['Comisión\x20Venta\x203\x20(%)'])});}let _0xeba7a3=_0x22141c[_0x4506f5(0x149)],_0x31c5ff='';if(_0xeba7a3 instanceof Date){const _0x4de42a=_0xeba7a3[_0x4506f5(0x1a0)](),_0xedb3a5=String(_0xeba7a3['getMonth']()+0x1)['padStart'](0x2,'0'),_0x3ac7bc=String(_0xeba7a3[_0x4506f5(0x135)]())[_0x4506f5(0x183)](0x2,'0');_0x31c5ff=_0x4de42a+'-'+_0xedb3a5+'-'+_0x3ac7bc;}else{if(typeof _0xeba7a3==='number'){const _0x54c172=XLSX[_0x4506f5(0x151)][_0x4506f5(0x1b7)](_0xeba7a3);if(_0x54c172){const _0xea032c=_0x54c172['y'],_0x16c60d=String(_0x54c172['m'])['padStart'](0x2,'0'),_0x32976f=String(_0x54c172['d'])['padStart'](0x2,'0');_0x31c5ff=_0xea032c+'-'+_0x16c60d+'-'+_0x32976f;}}else _0x31c5ff=String(_0xeba7a3||'')[_0x4506f5(0x16d)]();}return{'setItemId':String(_0x22141c['ID'])[_0x4506f5(0x16d)](),'setItemType':_0x199bf2,'setItemCode':String(_0x22141c['Código\x20SKU*'])[_0x4506f5(0x16d)](),'setItemName':String(_0x22141c['Nombre*'])[_0x4506f5(0x16d)](),'setItemDescription':String(_0x22141c['Descripción'])[_0x4506f5(0x16d)]()||'','setItemIsSold':_0x22141c[_0x4506f5(0x118)]=='SI'?0x1:0x0,'setItemIsBought':_0x22141c[_0x4506f5(0x1c5)]=='SI'?0x1:0x0,'setItemCategories':_0x22141c[_0x4506f5(0x1d8)]?[String(_0x22141c[_0x4506f5(0x1d8)])['trim']()]:[],'setItemBrands':_0x22141c[_0x4506f5(0x105)]?[String(_0x22141c[_0x4506f5(0x105)])[_0x4506f5(0x16d)]()]:[],'setItemTaxId':_0x37bb4f,'setItemTaxCode':_0x33757f[_0x4506f5(0xfc)],'setItemTaxValue':_0x33757f['value'],'setItemUnits':_0x3a0281,'setItemInventoriable':_0x22141c[_0x4506f5(0x13f)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x22141c[_0x4506f5(0x10e)])||0x0,'setStockMinimum':parseFloat(_0x22141c[_0x4506f5(0x102)])||0x0,'setItemLocation':String(_0x22141c['Ubicación'])[_0x4506f5(0x16d)]()||'','setBatchName':String(_0x22141c[_0x4506f5(0x1f3)])[_0x4506f5(0x16d)]()||'','setItemDateExpiry':_0x31c5ff,'setItemVariantName':_0x288f7f,'setItemVariantValues':_0x2e47dc,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x52e369[_0x1f798c(0x1bb)](..._0x116a97),postMessage({'type':'progress','payload':{'percent':Math[_0x1f798c(0x1dc)]((_0x9f45e5+_0x116a97[_0x1f798c(0x12c)])/_0x399a69*0x64),'message':_0x1f798c(0x191)+(_0x9f45e5+0x1)+'–'+(_0x9f45e5+_0x116a97['length'])+'/'+_0x399a69}});}postMessage({'type':'done','payload':{'items':_0x52e369}});}catch(_0x4f852e){postMessage({'type':_0x1f798c(0x181),'payload':_0x4f852e[_0x1f798c(0x174)]||_0x4f852e});}}if(_0x5613c8==='exportItems'){const {products:_0x5c6c50,plantillaBuf:_0x4c2214}=_0x42c18b;if(!(_0x4c2214 instanceof ArrayBuffer)){postMessage({'type':'error','payload':_0x1f798c(0x12e)});return;}if(!Array[_0x1f798c(0x1cd)](_0x5c6c50)){postMessage({'type':_0x1f798c(0x181),'payload':_0x1f798c(0x1d3)});return;}try{structuredClone(_0x5c6c50);}catch(_0x2af765){postMessage({'type':_0x1f798c(0x181),'payload':_0x1f798c(0x103)+_0x2af765[_0x1f798c(0x174)]});return;}try{const _0x5abd8e={'1':_0x1f798c(0x1ac),'2':_0x1f798c(0x186),'3':_0x1f798c(0x1a5),'4':'Combo','5':_0x1f798c(0x161)};function _0x29aefd(_0x2923c1){return _0x5abd8e[String(_0x2923c1)]||'Artículo';}const _0x22c41d={'1':_0x1f798c(0x1a2),'2':_0x1f798c(0x1f4),'3':_0x1f798c(0x1a9),'4':_0x1f798c(0x120),'5':_0x1f798c(0x162),'6':_0x1f798c(0x169),'7':'Exonerado\x20Gratuito\x20(0%)','8':_0x1f798c(0x17a),'9':'Gravado\x20Gratuito\x20(10%)'};function _0xcf8116(_0x495100){const _0x1b3eb5=_0x1f798c;return _0x22c41d[String(_0x495100)]||_0x1b3eb5(0x1a2);}const _0x483d49={'4A':_0x1f798c(0x1a1),'BJ':_0x1f798c(0x1f2),'BLL':_0x1f798c(0x10d),'BG':'BOLSA','BO':_0x1f798c(0x125),'BX':_0x1f798c(0x15c),'CT':_0x1f798c(0x178),'CMK':'CENTIMETRO\x20CUADRADO','CMQ':_0x1f798c(0x123),'CMT':'CENTIMETRO\x20LINEAL','CEN':_0x1f798c(0x133),'CY':_0x1f798c(0x188),'CJ':_0x1f798c(0x121),'DZN':'DOCENA','DZP':'DOCENA\x20POR\x2010**6','BE':'FARDO','GLI':_0x1f798c(0x100),'GRM':'GRAMO','GRO':_0x1f798c(0x167),'HLT':_0x1f798c(0x136),'LEF':_0x1f798c(0x12b),'SET':_0x1f798c(0x1bf),'KGM':_0x1f798c(0x1b1),'KTM':_0x1f798c(0x1eb),'KWH':'KILOVATIO\x20HORA','KT':_0x1f798c(0x1ae),'CA':_0x1f798c(0x173),'LBR':_0x1f798c(0x11a),'LTR':_0x1f798c(0x1a4),'MWH':'MEGAWATT\x20HORA','MTR':_0x1f798c(0x1ce),'MTK':_0x1f798c(0x1c0),'MTQ':_0x1f798c(0x13c),'MGM':_0x1f798c(0x159),'MLT':_0x1f798c(0x1f6),'MMT':_0x1f798c(0x112),'MMK':'MILIMETRO\x20CUADRADO','MMQ':_0x1f798c(0x1be),'MIL':_0x1f798c(0x19a),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0x1f798c(0x157),'PF':'PALETAS','PK':'PAQUETE','PR':_0x1f798c(0x1ad),'FOT':_0x1f798c(0xff),'FTK':_0x1f798c(0x113),'FTQ':_0x1f798c(0x1dd),'C62':_0x1f798c(0x1e8),'PG':_0x1f798c(0x1f1),'ST':'PLIEGO','INH':'PULGADAS','RM':_0x1f798c(0x1cf),'SA':'SACO','DR':_0x1f798c(0x11f),'STN':'TONELADA\x20CORTA','LTN':_0x1f798c(0x16e),'TNE':'TONELADAS','TU':_0x1f798c(0x19b),'NIU':_0x1f798c(0x110),'ZZ':_0x1f798c(0x1e6),'GLL':_0x1f798c(0x14d),'YRD':_0x1f798c(0x1f5),'YDK':_0x1f798c(0x179),'QQM':_0x1f798c(0x1a3)};function _0x88155b(_0x48909e){return _0x483d49[String(_0x48909e)]||'';}const _0x17439a=XLSX[_0x1f798c(0x1e9)](_0x4c2214,{'type':_0x1f798c(0x1c2),'cellDates':!![]}),_0x400787=_0x17439a[_0x1f798c(0x1d5)][0x0],_0x57415a=_0x17439a['Sheets'][_0x400787],_0x373405=XLSX[_0x1f798c(0x1c4)]['sheet_to_json'](_0x57415a,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x3e443f=XLSX['utils'][_0x1f798c(0x107)](_0x57415a[_0x1f798c(0x119)]||'');for(let _0x2cb365=0x2;_0x2cb365<=_0x3e443f['e']['r'];++_0x2cb365){for(let _0x10d12d=_0x3e443f['s']['c'];_0x10d12d<=_0x3e443f['e']['c'];++_0x10d12d){const _0x4f93c9=XLSX[_0x1f798c(0x1c4)][_0x1f798c(0x152)]({'r':_0x2cb365,'c':_0x10d12d});if(_0x57415a[_0x4f93c9])delete _0x57415a[_0x4f93c9];}}const _0x4b95a8=_0x5c6c50[_0x1f798c(0x131)](_0x1fb949=>{const _0x2ccb6b=_0x1f798c;_0x1fb949[_0x2ccb6b(0x122)]=_0x1fb949[_0x2ccb6b(0x122)]||{};const _0x4448ba={};return _0x373405[_0x2ccb6b(0x139)](_0x50dadc=>{const _0x22a0c6=_0x2ccb6b,_0xcce3c2=String(_0x50dadc)[_0x22a0c6(0x16d)](),_0x4531d4=_0xcce3c2[_0x22a0c6(0x10a)](),_0x1a2faa=Object['keys'](_0x1fb949)[_0x22a0c6(0x18c)](_0x63688d=>_0x63688d['trim']()[_0x22a0c6(0x10a)]()===_0x4531d4);if(_0x1a2faa){_0x4448ba[_0xcce3c2]=_0x1fb949[_0x1a2faa]??'';return;}switch(_0xcce3c2){case'ID':_0x4448ba[_0xcce3c2]=_0x1fb949['id']??'';break;case _0x22a0c6(0x144):_0x4448ba[_0xcce3c2]=_0x29aefd(_0x1fb949[_0x22a0c6(0x1c1)]);break;case'Código\x20SKU*':_0x4448ba[_0xcce3c2]=_0x1fb949['setCodProducto']??'';break;case _0x22a0c6(0x158):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1e1)]??'';break;case _0x22a0c6(0x117):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x189)]??'';break;case _0x22a0c6(0x118):_0x4448ba[_0xcce3c2]=_0x1fb949['setItemIsSold']==0x1?'SI':'NO';break;case _0x22a0c6(0x1c5):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x14a)]==0x1?'SI':'NO';break;case _0x22a0c6(0x1d8):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1d7)]??'';break;case _0x22a0c6(0x105):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x12f)]??'';break;case _0x22a0c6(0x11d):_0x4448ba[_0xcce3c2]=_0xcf8116(_0x1fb949[_0x22a0c6(0x16a)]);break;case _0x22a0c6(0x1cc):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x163)]??'';break;case _0x22a0c6(0x166):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1ea)]??'';break;case'Código\x20de\x20Barras':_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x104)]??'';break;case _0x22a0c6(0xfd):_0x4448ba[_0xcce3c2]=_0x88155b(_0x1fb949[_0x22a0c6(0x1c6)]);break;case _0x22a0c6(0x145):_0x4448ba[_0xcce3c2]=_0x1fb949['PEN_setMtoPrecioUnitario']??'';break;case _0x22a0c6(0x15b):_0x4448ba[_0xcce3c2]=_0x1fb949['PEN_setMtoPrecioCostoUnitario']??'';break;case'Precio\x20Venta\x20Dólares':_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1e3)]??'';break;case _0x22a0c6(0x1d1):_0x4448ba[_0xcce3c2]=_0x1fb949['USD_setMtoPrecioCostoUnitario']??'';break;case _0x22a0c6(0x116):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1e4)];break;case'ID\x20UNIT\x202':_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x184)]??'';break;case _0x22a0c6(0x17f):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x192)]??'';break;case _0x22a0c6(0x10c):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1a6)]??'';break;case _0x22a0c6(0x1cb):_0x4448ba[_0xcce3c2]=_0x88155b(_0x1fb949[_0x22a0c6(0x130)]);break;case'Equivalencia\x202':_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x17c)]??'1';break;case _0x22a0c6(0x126):_0x4448ba[_0xcce3c2]=_0x1fb949['PEN_setMtoPrecioUnitario2']??'';break;case _0x22a0c6(0x177):_0x4448ba[_0xcce3c2]=_0x1fb949['PEN_setMtoPrecioCostoUnitario2']??'';break;case'Precio\x20Venta\x20Dólares\x202':_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1d4)]??'';break;case'Precio\x20Costo\x20Dólares\x202':_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x195)]??'';break;case _0x22a0c6(0x19c):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1b4)];break;case'ID\x20UNIT\x203':_0x4448ba[_0xcce3c2]=_0x1fb949['setUnitId3']??'';break;case _0x22a0c6(0x14f):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x1c9)]??'';break;case _0x22a0c6(0x193):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x196)]??'';break;case _0x22a0c6(0x12a):_0x4448ba[_0xcce3c2]=_0x88155b(_0x1fb949[_0x22a0c6(0x1a7)]);break;case _0x22a0c6(0x1e5):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x160)]??'1';break;case'Precio\x20Venta\x20Soles\x203':_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x141)]??'';break;case _0x22a0c6(0x1d0):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x19e)]??'';break;case _0x22a0c6(0x18b):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x180)]??'';break;case'Precio\x20Costo\x20Dólares\x203':_0x4448ba[_0xcce3c2]=_0x1fb949['USD_setMtoPrecioCostoUnitario3']??'';break;case _0x22a0c6(0x197):_0x4448ba[_0xcce3c2]=_0x1fb949['setItemCommissionPercentage3'];break;case _0x22a0c6(0x13f):_0x4448ba[_0xcce3c2]=_0x1fb949['setInventariable']==0x1?'SI':'NO';break;case _0x22a0c6(0x10e):_0x4448ba[_0xcce3c2]=_0x1fb949['setSucursalStock']??'';break;case _0x22a0c6(0x102):_0x4448ba[_0xcce3c2]=_0x1fb949['setWarehouseStockMin']??'';break;case _0x22a0c6(0x149):_0x4448ba[_0xcce3c2]=_0x1fb949[_0x22a0c6(0x199)]??'';break;default:_0x4448ba[_0xcce3c2]='';}}),_0x4448ba;}),_0x35f326=0x3e8,_0x3d3755=_0x4b95a8[_0x1f798c(0x12c)];for(let _0x486136=0x0;_0x486136<_0x3d3755;_0x486136+=_0x35f326){const _0x3f67ca=_0x4b95a8[_0x1f798c(0x198)](_0x486136,_0x486136+_0x35f326);XLSX[_0x1f798c(0x1c4)][_0x1f798c(0x18d)](_0x57415a,_0x3f67ca,{'origin':{'r':_0x486136+0x2,'c':0x0},'skipHeader':!![],'header':_0x373405}),postMessage({'type':'progress','payload':{'percent':Math[_0x1f798c(0x1dc)]((_0x486136+_0x3f67ca[_0x1f798c(0x12c)])/_0x3d3755*0x64),'message':_0x1f798c(0x1ed)+(_0x486136+0x1)+'–'+(_0x486136+_0x3f67ca['length'])+_0x1f798c(0x16b)+_0x3d3755}});}const _0x44070a={'s':{'r':0x0,'c':0x0},'e':{'r':_0x3d3755+0x1,'c':_0x373405[_0x1f798c(0x12c)]-0x1}};_0x57415a[_0x1f798c(0x119)]=XLSX[_0x1f798c(0x1c4)][_0x1f798c(0x1f0)](_0x44070a);const _0x373a7d=XLSX['write'](_0x17439a,{'bookType':_0x1f798c(0x1db),'type':'array'});let _0x53f7fe,_0xdc2da6;if(_0x373a7d instanceof Uint8Array)_0x53f7fe=_0x373a7d,_0xdc2da6=[_0x373a7d[_0x1f798c(0x156)]];else{if(_0x373a7d instanceof ArrayBuffer)_0x53f7fe=new Uint8Array(_0x373a7d),_0xdc2da6=[_0x373a7d];else{const _0x59277c=new Uint8Array(_0x373a7d);_0x53f7fe=_0x59277c,_0xdc2da6=[_0x59277c[_0x1f798c(0x156)]];}}postMessage({'type':_0x1f798c(0x114),'payload':{'wbout':_0x53f7fe,'count':_0x4b95a8[_0x1f798c(0x12c)]}},_0xdc2da6);}catch(_0x5cc036){postMessage({'type':_0x1f798c(0x181),'payload':_0x5cc036['message']||String(_0x5cc036)});}return;}};