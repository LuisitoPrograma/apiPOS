/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.3.8
*/

(function(_0x5d79b9,_0x286da3){const _0x5b6ba5=_0x3257,_0x403cfd=_0x5d79b9();while(!![]){try{const _0x34f0ea=parseInt(_0x5b6ba5(0x155))/0x1*(parseInt(_0x5b6ba5(0x101))/0x2)+-parseInt(_0x5b6ba5(0x13a))/0x3*(-parseInt(_0x5b6ba5(0x126))/0x4)+-parseInt(_0x5b6ba5(0x166))/0x5+-parseInt(_0x5b6ba5(0xe6))/0x6*(-parseInt(_0x5b6ba5(0x10d))/0x7)+-parseInt(_0x5b6ba5(0x1ac))/0x8+-parseInt(_0x5b6ba5(0x15f))/0x9+-parseInt(_0x5b6ba5(0x177))/0xa*(-parseInt(_0x5b6ba5(0x169))/0xb);if(_0x34f0ea===_0x286da3)break;else _0x403cfd['push'](_0x403cfd['shift']());}catch(_0x48a8b5){_0x403cfd['push'](_0x403cfd['shift']());}}}(_0x3305,0xa9608));const _0x797b73=(function(){let _0x210de5=!![];return function(_0x508188,_0x1b81bc){const _0x3d886e=_0x210de5?function(){const _0x100346=_0x3257;if(_0x1b81bc){const _0xaf3bdd=_0x1b81bc[_0x100346(0x171)](_0x508188,arguments);return _0x1b81bc=null,_0xaf3bdd;}}:function(){};return _0x210de5=![],_0x3d886e;};}()),_0x57c518=_0x797b73(this,function(){const _0x2a532a=_0x3257;return _0x57c518[_0x2a532a(0xef)]()[_0x2a532a(0x1a6)]('(((.+)+)+)+$')[_0x2a532a(0xef)]()[_0x2a532a(0xe0)](_0x57c518)[_0x2a532a(0x1a6)](_0x2a532a(0x115));});_0x57c518();function _0x3305(){const _0x243bfa=['exportItems:\x20products\x20no\x20es\x20Array.','GRUESA','Código\x20de\x20Barras','CAJA','DOCENA\x20POR\x2010**6','METRO\x20CUADRADO','CONOS','console','TONELADAS','Código\x20de\x20Barras\x202','progress','SACO','US\x20GALON\x20(3,7843\x20L)','KILOVATIO\x20HORA','Exonerado\x20(0%)','sheet_to_json','reduce','Precio\x20Venta\x20Soles','664enpvMt','MWH','YARDA\x20CUADRADA','Artículo','Descripción','Unidad\x20de\x20Medida*','GRAMO','BALDE','USD_setMtoPrecioUnitario','FTK','5893560uidFbs','UNIDAD\x20(NIU)','array','!ref','done','CENTIMETRO\x20CUBICO','El\x20archivo\x20tiene\x20','6929825GTqmLA','prototype','setBatchExpirationDate','539HFZgeq','HOJA','KILOMETRO','MILLARES','¿Rastrear\x20Inventario?','BARRILES','TONELADA\x20LARGA','read','apply','ID\x20UNIT\x202','buffer','BLL','MILIMETRO','map','97570YQEvBY','MGM','Nombre\x20del\x20Lote','Modelo\x20de\x20Manga','GLL','\x20de\x20','setCategoria','KTM','warn','info','Serie','LBR','length','SET','setItemVariantValues','message','Precio\x20Costo\x20Dólares\x202','Gravado\x20(18%)','ID\x20UNIT','MTK','UNIDAD\x20(ZZ)','PIES','Sheets','forEach','CENTIMETRO\x20CUADRADO','TAMBOR','Impuesto*','PAQUETE','MILILITRO','BOBINAS','ONZAS','MILIMETRO\x20CUADRADO','BOTELLAS','BOLSA','TONELADA\x20CORTA','LATAS','number','Precio\x20Venta\x20Dólares\x202','Precio\x20Costo\x20Soles','toLowerCase','Combo','setItemBarCode','QQM','import','value','DZN','GLI','search','MTQ','PLIEGO','PIES\x20CUBICOS','slice','USD_setMtoPrecioCostoUnitario','112392KmzGMG','MILIMETRO\x20CUBICO','Gravado\x20(10%)','PLACAS','setUnitId2','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','CMQ','MILLON\x20DE\x20UNIDADES','Unidad\x20de\x20Medida\x202','Precio\x20Venta\x20Dólares','CMT','error','HLT','constructor','KGM','CARTONES','find','trim','YDK','712158ViYLBO','Fabricado','Equivalencia\x202','Marca','Tipo*','PULGADAS','{}.constructor(\x22return\x20this\x22)(\x20)','setMarca','Procesadas\x20filas\x20','toString','FTQ','Nombre*','Precio\x20Costo\x20Soles\x202','PIEZAS','xlsx','FOT','SheetNames','sheet_add_json','CILINDRO','Stock\x20Mínimo','Categoría','PIES\x20CUADRADOS','__proto__','Stock\x20Actual','Inafecto\x20(0%)','RESMA','MMQ','1306OqYzfI','QUINTAL','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','Servicio','LITRO','findIndex','MMT','encode_range','KIT','MIL','GRO','MTR','56LFdXoY','Ubicación','return\x20(function()\x20','exception','Exonerado\x20Gratuito\x20(0%)','code','KILOGRAMO','YARDA','(((.+)+)+)+$','ONZ','table','getFullYear','METRO','Material','Fecha\x20de\x20Vencimiento','setUnitId','Color','PEN_setMtoPrecioCostoUnitario2','setItemDescription','LEF','decode_range','TUBOS','setDescripcion','Precio\x20Venta\x20Soles\x202','USD_setMtoPrecioCostoUnitario2','3549572ZmOUdQ','bind','setSucursalStock','keys','setTaxId','DOCENA','LIBRAS','setItemBarCode2','PEN_setMtoPrecioUnitario','MEGAWATT\x20HORA','MILIGRAMOS','setUnidadCodigo2','Precio\x20Costo\x20Dólares','SSF','TNE','CEN','padStart','push','utils','NIU','3GbuoWU','METRO\x20CUBICO','Código\x20SKU*','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','write','setItemType','CMK','PAR','round'];_0x3305=function(){return _0x243bfa;};return _0x3305();}function _0x3257(_0x147dfc,_0x4e763d){const _0x10a798=_0x3305();return _0x3257=function(_0x4e88d4,_0x1a5650){_0x4e88d4=_0x4e88d4-0xdf;let _0x366485=_0x10a798[_0x4e88d4];return _0x366485;},_0x3257(_0x147dfc,_0x4e763d);}const _0x1a5650=(function(){let _0x192b86=!![];return function(_0x1e31e1,_0x314397){const _0x240300=_0x192b86?function(){const _0x5362a0=_0x3257;if(_0x314397){const _0x5e43a5=_0x314397[_0x5362a0(0x171)](_0x1e31e1,arguments);return _0x314397=null,_0x5e43a5;}}:function(){};return _0x192b86=![],_0x240300;};}()),_0x4e88d4=_0x1a5650(this,function(){const _0x1263ee=_0x3257,_0x21e405=function(){const _0x22029f=_0x3257;let _0xb2161e;try{_0xb2161e=Function(_0x22029f(0x10f)+_0x22029f(0xec)+');')();}catch(_0x25b145){_0xb2161e=window;}return _0xb2161e;},_0x2ad9af=_0x21e405(),_0x27b80f=_0x2ad9af[_0x1263ee(0x14a)]=_0x2ad9af['console']||{},_0x560795=['log',_0x1263ee(0x17f),_0x1263ee(0x180),_0x1263ee(0x1b7),_0x1263ee(0x110),_0x1263ee(0x117),'trace'];for(let _0x109520=0x0;_0x109520<_0x560795[_0x1263ee(0x183)];_0x109520++){const _0x1e49bf=_0x1a5650[_0x1263ee(0xe0)][_0x1263ee(0x167)][_0x1263ee(0x127)](_0x1a5650),_0x13e71c=_0x560795[_0x109520],_0x482d3a=_0x27b80f[_0x13e71c]||_0x1e49bf;_0x1e49bf[_0x1263ee(0xfc)]=_0x1a5650['bind'](_0x1a5650),_0x1e49bf['toString']=_0x482d3a[_0x1263ee(0xef)][_0x1263ee(0x127)](_0x482d3a),_0x27b80f[_0x13e71c]=_0x1e49bf;}});_0x4e88d4(),importScripts('https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js'),onmessage=({data:_0xe34a90})=>{const _0x22551d=_0x3257,{action:_0x1125a6}=_0xe34a90;if(_0x1125a6===_0x22551d(0x1a2)){const {buf:_0x4021cd,maxRows:_0x447abe}=_0xe34a90;try{postMessage({'type':_0x22551d(0x14d),'payload':{'percent':0x5,'message':'Iniciando\x20parseo…'}});const _0x74d4ac=XLSX[_0x22551d(0x170)](_0x4021cd,{'type':_0x22551d(0x161),'cellDates':!![]}),_0x13ce9e=_0x74d4ac[_0x22551d(0x18d)][_0x74d4ac[_0x22551d(0xf6)][0x0]],_0x2d2e8f=XLSX[_0x22551d(0x138)][_0x22551d(0x152)](_0x13ce9e,{'defval':'','range':0x1,'cellDates':!![]}),_0x4047db=_0x2d2e8f[_0x22551d(0x106)](_0x1a7a61=>(!_0x1a7a61[_0x22551d(0xea)]||String(_0x1a7a61[_0x22551d(0xea)])[_0x22551d(0xe4)]()==='')&&(!_0x1a7a61[_0x22551d(0x13c)]||String(_0x1a7a61['Código\x20SKU*'])[_0x22551d(0xe4)]()==='')&&(!_0x1a7a61['Nombre*']||String(_0x1a7a61[_0x22551d(0xf1)])[_0x22551d(0xe4)]()==='')&&(!_0x1a7a61[_0x22551d(0x15a)]||String(_0x1a7a61[_0x22551d(0x15a)])['trim']()==='')),_0x33280f=_0x4047db>=0x0?_0x2d2e8f[_0x22551d(0x1aa)](0x0,_0x4047db):_0x2d2e8f,_0x33e3cf=_0x33280f['filter'](_0x4ec926=>_0x4ec926['Tipo*']&&String(_0x4ec926[_0x22551d(0xea)])[_0x22551d(0xe4)]()!==''&&_0x4ec926[_0x22551d(0x13c)]&&String(_0x4ec926[_0x22551d(0x13c)])['trim']()!==''&&_0x4ec926['Nombre*']&&String(_0x4ec926[_0x22551d(0xf1)])['trim']()!==''&&_0x4ec926[_0x22551d(0x15a)]&&String(_0x4ec926[_0x22551d(0x15a)])['trim']()!==''),_0x154fcf=_0x33e3cf[_0x22551d(0x183)];if(_0x154fcf===0x0){postMessage({'type':_0x22551d(0x1b7),'payload':_0x22551d(0x13d)});return;}if(_0x154fcf>_0x447abe)throw _0x22551d(0x165)+_0x154fcf+_0x22551d(0x103)+_0x447abe+'.';const _0x15b627=0x1f4,_0x122c66=[],_0x5b69ab=[{'codigo':'4A','nombre':_0x22551d(0x194)},{'codigo':'BJ','nombre':_0x22551d(0x15c)},{'codigo':_0x22551d(0x174),'nombre':_0x22551d(0x16e)},{'codigo':'BG','nombre':_0x22551d(0x198)},{'codigo':'BO','nombre':_0x22551d(0x197)},{'codigo':'BX','nombre':_0x22551d(0x146)},{'codigo':'CT','nombre':_0x22551d(0xe2)},{'codigo':_0x22551d(0x140),'nombre':_0x22551d(0x18f)},{'codigo':_0x22551d(0x1b2),'nombre':_0x22551d(0x164)},{'codigo':_0x22551d(0x1b6),'nombre':'CENTIMETRO\x20LINEAL'},{'codigo':_0x22551d(0x135),'nombre':'CIENTO\x20DE\x20UNIDADES'},{'codigo':'CY','nombre':_0x22551d(0xf8)},{'codigo':'CJ','nombre':_0x22551d(0x149)},{'codigo':_0x22551d(0x1a4),'nombre':_0x22551d(0x12b)},{'codigo':'DZP','nombre':'DOCENA\x20POR\x2010**6'},{'codigo':'BE','nombre':'FARDO'},{'codigo':_0x22551d(0x1a5),'nombre':'GALON\x20INGLES\x20(4,545956L)'},{'codigo':'GRM','nombre':_0x22551d(0x15b)},{'codigo':_0x22551d(0x10b),'nombre':_0x22551d(0x144)},{'codigo':_0x22551d(0xdf),'nombre':'HECTOLITRO'},{'codigo':_0x22551d(0x120),'nombre':_0x22551d(0x16a)},{'codigo':_0x22551d(0x184),'nombre':'JUEGO'},{'codigo':_0x22551d(0xe1),'nombre':_0x22551d(0x113)},{'codigo':_0x22551d(0x17e),'nombre':_0x22551d(0x16b)},{'codigo':'KWH','nombre':_0x22551d(0x150)},{'codigo':'KT','nombre':_0x22551d(0x109)},{'codigo':'CA','nombre':_0x22551d(0x19a)},{'codigo':_0x22551d(0x182),'nombre':_0x22551d(0x12c)},{'codigo':'LTR','nombre':_0x22551d(0x105)},{'codigo':_0x22551d(0x156),'nombre':_0x22551d(0x12f)},{'codigo':_0x22551d(0x10c),'nombre':'METRO'},{'codigo':_0x22551d(0x18a),'nombre':'METRO\x20CUADRADO'},{'codigo':_0x22551d(0x1a7),'nombre':_0x22551d(0x13b)},{'codigo':_0x22551d(0x178),'nombre':'MILIGRAMOS'},{'codigo':'MLT','nombre':_0x22551d(0x193)},{'codigo':_0x22551d(0x107),'nombre':'MILIMETRO'},{'codigo':'MMK','nombre':_0x22551d(0x196)},{'codigo':_0x22551d(0x100),'nombre':_0x22551d(0x1ad)},{'codigo':_0x22551d(0x10a),'nombre':_0x22551d(0x16c)},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':_0x22551d(0x116),'nombre':_0x22551d(0x195)},{'codigo':'PF','nombre':'PALETAS'},{'codigo':'PK','nombre':'PAQUETE'},{'codigo':'PR','nombre':_0x22551d(0x141)},{'codigo':_0x22551d(0xf5),'nombre':_0x22551d(0x18c)},{'codigo':_0x22551d(0x15e),'nombre':_0x22551d(0xfb)},{'codigo':_0x22551d(0xf0),'nombre':_0x22551d(0x1a9)},{'codigo':'C62','nombre':_0x22551d(0xf3)},{'codigo':'PG','nombre':_0x22551d(0x1af)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':'INH','nombre':_0x22551d(0xeb)},{'codigo':'RM','nombre':_0x22551d(0xff)},{'codigo':'SA','nombre':_0x22551d(0x14e)},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':'STN','nombre':_0x22551d(0x199)},{'codigo':'LTN','nombre':_0x22551d(0x16f)},{'codigo':_0x22551d(0x134),'nombre':_0x22551d(0x14b)},{'codigo':'TU','nombre':_0x22551d(0x122)},{'codigo':'NIU','nombre':_0x22551d(0x160)},{'codigo':'ZZ','nombre':_0x22551d(0x18b)},{'codigo':_0x22551d(0x17b),'nombre':_0x22551d(0x14f)},{'codigo':'YRD','nombre':_0x22551d(0x114)},{'codigo':_0x22551d(0xe5),'nombre':_0x22551d(0x157)},{'codigo':_0x22551d(0x1a1),'nombre':_0x22551d(0x102)}],_0x392b85=_0x5b69ab[_0x22551d(0x153)]((_0x3d8fc7,{nombre:_0x1181c0,codigo:_0x4b1e95})=>{const _0x11e138=_0x22551d;return _0x3d8fc7[_0x1181c0[_0x11e138(0xe4)]()]=_0x4b1e95[_0x11e138(0xe4)](),_0x3d8fc7;},{});for(let _0x3e999a=0x0;_0x3e999a<_0x154fcf;_0x3e999a+=_0x15b627){const _0x21cf66=_0x33e3cf[_0x22551d(0x1aa)](_0x3e999a,_0x3e999a+_0x15b627)[_0x22551d(0x176)]((_0x1833b8,_0x278a46)=>{const _0x577d6e=_0x22551d;let _0x462264={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x1833b8['Tipo*']]||'1';const _0x53618d=String(_0x1833b8[_0x577d6e(0x191)])[_0x577d6e(0xe4)](),_0x43f0b7={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x2f596b=_0x43f0b7[_0x53618d]||'1',_0x4f2653={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x2f596b]||{'code':'10','value':0x12},_0x27df8d={};let _0x1c4dfd=String(_0x1833b8[_0x577d6e(0xf1)])[_0x577d6e(0xe4)]();const _0x3bc8e9=['Talla',_0x577d6e(0x11d),'Género','Modelo',_0x577d6e(0x181),_0x577d6e(0x11a),'Modelo\x20de\x20Cuello',_0x577d6e(0x17a)];_0x3bc8e9[_0x577d6e(0x18e)](_0x5ac070=>{const _0x4fc677=_0x577d6e,_0x594b69=String(_0x1833b8[_0x5ac070]||'')[_0x4fc677(0xe4)]();_0x594b69&&(_0x27df8d[_0x5ac070]=_0x594b69,_0x1c4dfd+='\x20'+_0x5ac070+'\x20'+_0x594b69);});const _0x6305d5=[],_0x1fda82=String(_0x1833b8[_0x577d6e(0x15a)]||_0x577d6e(0x160))[_0x577d6e(0xe4)](),_0x25231a=_0x392b85[_0x1fda82]||_0x577d6e(0x139);_0x6305d5[_0x577d6e(0x137)]({'setItemUnitId':String(_0x1833b8[_0x577d6e(0x189)])[_0x577d6e(0xe4)]()||'','setItemBarCode':String(_0x1833b8[_0x577d6e(0x145)])[_0x577d6e(0xe4)]()||'','setAlias':_0x1fda82,'setUnitCode':_0x25231a,'setPrice':parseFloat(_0x1833b8['Precio\x20Venta\x20Soles'])||0x0,'setCost':parseFloat(_0x1833b8[_0x577d6e(0x19d)])||0x0,'setPriceUSD':parseFloat(_0x1833b8[_0x577d6e(0x1b5)])||0x0,'setCostUSD':parseFloat(_0x1833b8[_0x577d6e(0x132)])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x53de64=[_0x577d6e(0x172),'Código\x20de\x20Barras\x202','Equivalencia\x202','Precio\x20Venta\x20Soles\x202',_0x577d6e(0xf2),_0x577d6e(0x19c),_0x577d6e(0x187)]['some'](_0xf0058b=>{const _0xc22436=_0x1833b8[_0xf0058b];return _0xc22436!=null&&String(_0xc22436)['trim']()!=='';});if(_0x53de64){const _0x82037d=String(_0x1833b8[_0x577d6e(0x1b4)]||'UND\x20(NIU)')[_0x577d6e(0xe4)](),_0x3876d8=_0x392b85[_0x82037d]||'NIU',_0x1c06f5=parseFloat(_0x1833b8['Precio\x20Venta\x20Soles\x202'])||0x0,_0x450359=parseFloat(_0x1833b8[_0x577d6e(0xf2)])||0x0,_0x5d04d4=parseFloat(_0x1833b8[_0x577d6e(0x19c)])||0x0,_0x1c8646=parseFloat(_0x1833b8[_0x577d6e(0x187)])||0x0,_0x179405=parseFloat(_0x1833b8['Equivalencia\x202'])||0x1;_0x6305d5['push']({'setItemUnitId':String(_0x1833b8['ID\x20UNIT\x202'])[_0x577d6e(0xe4)]()||'','setItemBarCode':String(_0x1833b8[_0x577d6e(0x14c)])['trim']()||'','setAlias':_0x82037d,'setUnitCode':_0x3876d8,'setPrice':_0x1c06f5,'setCost':_0x450359,'setPriceUSD':_0x5d04d4,'setCostUSD':_0x1c8646,'setDefault':0x0,'setEquivalence':_0x179405,'setFactor':_0x179405});}let _0x7688df=_0x1833b8[_0x577d6e(0x11b)],_0x14729c='';if(_0x7688df instanceof Date){const _0x525b87=_0x7688df[_0x577d6e(0x118)](),_0x5a19c7=String(_0x7688df['getMonth']()+0x1)[_0x577d6e(0x136)](0x2,'0'),_0x5e2416=String(_0x7688df['getDate']())[_0x577d6e(0x136)](0x2,'0');_0x14729c=_0x525b87+'-'+_0x5a19c7+'-'+_0x5e2416;}else{if(typeof _0x7688df===_0x577d6e(0x19b)){const _0xa831c1=XLSX[_0x577d6e(0x133)]['parse_date_code'](_0x7688df);if(_0xa831c1){const _0x6fd82c=_0xa831c1['y'],_0x18dfac=String(_0xa831c1['m'])[_0x577d6e(0x136)](0x2,'0'),_0x47c041=String(_0xa831c1['d'])[_0x577d6e(0x136)](0x2,'0');_0x14729c=_0x6fd82c+'-'+_0x18dfac+'-'+_0x47c041;}}else _0x14729c=String(_0x7688df||'')['trim']();}return{'setItemId':String(_0x1833b8['ID'])[_0x577d6e(0xe4)](),'setItemType':_0x462264,'setItemCode':String(_0x1833b8[_0x577d6e(0x13c)])[_0x577d6e(0xe4)](),'setItemName':String(_0x1833b8['Nombre*'])[_0x577d6e(0xe4)](),'setItemDescription':String(_0x1833b8[_0x577d6e(0x159)])[_0x577d6e(0xe4)]()||'','setItemCategories':_0x1833b8[_0x577d6e(0xfa)]?[String(_0x1833b8['Categoría'])[_0x577d6e(0xe4)]()]:[],'setItemBrands':_0x1833b8[_0x577d6e(0xe9)]?[String(_0x1833b8['Marca'])[_0x577d6e(0xe4)]()]:[],'setItemTaxId':_0x2f596b,'setItemTaxCode':_0x4f2653[_0x577d6e(0x112)],'setItemTaxValue':_0x4f2653[_0x577d6e(0x1a3)],'setItemUnits':_0x6305d5,'setItemInventoriable':_0x1833b8[_0x577d6e(0x16d)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x1833b8[_0x577d6e(0xfd)])||0x0,'setStockMinimum':parseFloat(_0x1833b8[_0x577d6e(0xf9)])||0x0,'setItemLocation':String(_0x1833b8[_0x577d6e(0x10e)])[_0x577d6e(0xe4)]()||'','setBatchName':String(_0x1833b8[_0x577d6e(0x179)])[_0x577d6e(0xe4)]()||'','setItemDateExpiry':_0x14729c,'setItemVariantName':_0x1c4dfd,'setItemVariantValues':_0x27df8d,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x122c66[_0x22551d(0x137)](..._0x21cf66),postMessage({'type':_0x22551d(0x14d),'payload':{'percent':Math[_0x22551d(0x142)]((_0x3e999a+_0x21cf66[_0x22551d(0x183)])/_0x154fcf*0x64),'message':_0x22551d(0xee)+(_0x3e999a+0x1)+'–'+(_0x3e999a+_0x21cf66[_0x22551d(0x183)])+'/'+_0x154fcf}});}postMessage({'type':_0x22551d(0x163),'payload':{'items':_0x122c66}});}catch(_0x2b16ed){postMessage({'type':_0x22551d(0x1b7),'payload':_0x2b16ed[_0x22551d(0x186)]||_0x2b16ed});}}if(_0x1125a6==='exportItems'){const {products:_0x342e3f,plantillaBuf:_0x55ffcf}=_0xe34a90;if(!(_0x55ffcf instanceof ArrayBuffer)){postMessage({'type':'error','payload':_0x22551d(0x1b1)});return;}if(!Array['isArray'](_0x342e3f)){postMessage({'type':_0x22551d(0x1b7),'payload':_0x22551d(0x143)});return;}try{structuredClone(_0x342e3f);}catch(_0x30c4e6){postMessage({'type':_0x22551d(0x1b7),'payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x30c4e6['message']});return;}try{const _0x4fe61b={'1':_0x22551d(0x158),'2':_0x22551d(0x104),'3':'Materia\x20Prima','4':_0x22551d(0x19f),'5':_0x22551d(0xe7)};function _0x2faedc(_0x355e8f){const _0x1fb492=_0x22551d;return _0x4fe61b[String(_0x355e8f)]||_0x1fb492(0x158);}const _0x2c4582={'1':'Gravado\x20(18%)','2':_0x22551d(0x151),'3':_0x22551d(0xfe),'4':'Gravado\x20Gratuito\x20(18%)','5':'Inafecto\x20Gratuito\x20(0%)','6':_0x22551d(0x1ae),'7':_0x22551d(0x111),'8':'Exportación\x20(0%)','9':'Gravado\x20Gratuito\x20(10%)'};function _0xc803f(_0x1611ae){const _0x450471=_0x22551d;return _0x2c4582[String(_0x1611ae)]||_0x450471(0x188);}const _0x46af51={'4A':_0x22551d(0x194),'BJ':_0x22551d(0x15c),'BLL':'BARRILES','BG':'BOLSA','BO':_0x22551d(0x197),'BX':_0x22551d(0x146),'CT':_0x22551d(0xe2),'CMK':_0x22551d(0x18f),'CMQ':_0x22551d(0x164),'CMT':'CENTIMETRO\x20LINEAL','CEN':'CIENTO\x20DE\x20UNIDADES','CY':_0x22551d(0xf8),'CJ':_0x22551d(0x149),'DZN':_0x22551d(0x12b),'DZP':_0x22551d(0x147),'BE':'FARDO','GLI':'GALON\x20INGLES\x20(4,545956L)','GRM':_0x22551d(0x15b),'GRO':_0x22551d(0x144),'HLT':'HECTOLITRO','LEF':_0x22551d(0x16a),'SET':'JUEGO','KGM':_0x22551d(0x113),'KTM':_0x22551d(0x16b),'KWH':'KILOVATIO\x20HORA','KT':_0x22551d(0x109),'CA':_0x22551d(0x19a),'LBR':'LIBRAS','LTR':'LITRO','MWH':_0x22551d(0x12f),'MTR':_0x22551d(0x119),'MTK':_0x22551d(0x148),'MTQ':'METRO\x20CUBICO','MGM':_0x22551d(0x130),'MLT':'MILILITRO','MMT':_0x22551d(0x175),'MMK':_0x22551d(0x196),'MMQ':'MILIMETRO\x20CUBICO','MIL':_0x22551d(0x16c),'UM':_0x22551d(0x1b3),'ONZ':_0x22551d(0x195),'PF':'PALETAS','PK':_0x22551d(0x192),'PR':_0x22551d(0x141),'FOT':_0x22551d(0x18c),'FTK':'PIES\x20CUADRADOS','FTQ':_0x22551d(0x1a9),'C62':_0x22551d(0xf3),'PG':'PLACAS','ST':_0x22551d(0x1a8),'INH':_0x22551d(0xeb),'RM':_0x22551d(0xff),'SA':_0x22551d(0x14e),'DR':_0x22551d(0x190),'STN':'TONELADA\x20CORTA','LTN':_0x22551d(0x16f),'TNE':_0x22551d(0x14b),'TU':_0x22551d(0x122),'NIU':_0x22551d(0x160),'ZZ':_0x22551d(0x18b),'GLL':_0x22551d(0x14f),'YRD':_0x22551d(0x114),'YDK':_0x22551d(0x157),'QQM':_0x22551d(0x102)};function _0x69ded0(_0x2fe559){return _0x46af51[String(_0x2fe559)]||'';}const _0x4b4da0=XLSX[_0x22551d(0x170)](_0x55ffcf,{'type':_0x22551d(0x161),'cellDates':!![]}),_0x1ed8a8=_0x4b4da0[_0x22551d(0xf6)][0x0],_0x2a4916=_0x4b4da0['Sheets'][_0x1ed8a8],_0x4264a9=XLSX[_0x22551d(0x138)][_0x22551d(0x152)](_0x2a4916,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0xc90166=XLSX[_0x22551d(0x138)][_0x22551d(0x121)](_0x2a4916['!ref']||'');for(let _0x57dada=0x2;_0x57dada<=_0xc90166['e']['r'];++_0x57dada){for(let _0x24563a=_0xc90166['s']['c'];_0x24563a<=_0xc90166['e']['c'];++_0x24563a){const _0x289abf=XLSX['utils']['encode_cell']({'r':_0x57dada,'c':_0x24563a});if(_0x2a4916[_0x289abf])delete _0x2a4916[_0x289abf];}}const _0x2e7aad=_0x342e3f[_0x22551d(0x176)](_0x400874=>{const _0x34da90=_0x22551d;_0x400874[_0x34da90(0x185)]=_0x400874[_0x34da90(0x185)]||{};const _0x303e3c={};return _0x4264a9['forEach'](_0x2058a2=>{const _0x3e1c59=_0x34da90,_0x7bebe7=String(_0x2058a2)[_0x3e1c59(0xe4)](),_0x26fa5b=_0x7bebe7[_0x3e1c59(0x19e)](),_0x590c24=Object[_0x3e1c59(0x129)](_0x400874)[_0x3e1c59(0xe3)](_0x3f4cf1=>_0x3f4cf1['trim']()['toLowerCase']()===_0x26fa5b);if(_0x590c24){_0x303e3c[_0x7bebe7]=_0x400874[_0x590c24]??'';return;}switch(_0x7bebe7){case'ID':_0x303e3c[_0x7bebe7]=_0x400874['id']??'';break;case _0x3e1c59(0xea):_0x303e3c[_0x7bebe7]=_0x2faedc(_0x400874[_0x3e1c59(0x13f)]);break;case _0x3e1c59(0x13c):_0x303e3c[_0x7bebe7]=_0x400874['setCodProducto']??'';break;case _0x3e1c59(0xf1):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x123)]??'';break;case _0x3e1c59(0x159):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x11f)]??'';break;case _0x3e1c59(0xfa):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x17d)]??'';break;case _0x3e1c59(0xe9):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0xed)]??'';break;case'Impuesto*':_0x303e3c[_0x7bebe7]=_0xc803f(_0x400874[_0x3e1c59(0x12a)]);break;case _0x3e1c59(0x189):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x11c)]??'';break;case'Código\x20de\x20Barras':_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x1a0)]??'';break;case _0x3e1c59(0x15a):_0x303e3c[_0x7bebe7]=_0x69ded0(_0x400874['setUnidadCodigo']);break;case _0x3e1c59(0x154):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x12e)]??'';break;case'Precio\x20Costo\x20Soles':_0x303e3c[_0x7bebe7]=_0x400874['PEN_setMtoPrecioCostoUnitario']??'';break;case'Precio\x20Venta\x20Dólares':_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x15d)]??'';break;case _0x3e1c59(0x132):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x1ab)]??'';break;case _0x3e1c59(0x172):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x1b0)]??'';break;case'Código\x20de\x20Barras\x202':_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x12d)]??'';break;case _0x3e1c59(0x1b4):_0x303e3c[_0x7bebe7]=_0x69ded0(_0x400874[_0x3e1c59(0x131)]);break;case _0x3e1c59(0xe8):_0x303e3c[_0x7bebe7]=_0x400874['setUnidadEquivalencia2']??'1';break;case _0x3e1c59(0x124):_0x303e3c[_0x7bebe7]=_0x400874['PEN_setMtoPrecioUnitario2']??'';break;case _0x3e1c59(0xf2):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x11e)]??'';break;case'Precio\x20Venta\x20Dólares\x202':_0x303e3c[_0x7bebe7]=_0x400874['USD_setMtoPrecioUnitario2']??'';break;case'Precio\x20Costo\x20Dólares\x202':_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x125)]??'';break;case'¿Rastrear\x20Inventario?':_0x303e3c[_0x7bebe7]=_0x400874['setInventariable']==0x1?'SI':'NO';break;case _0x3e1c59(0xfd):_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x128)]??'';break;case _0x3e1c59(0xf9):_0x303e3c[_0x7bebe7]=_0x400874['setWarehouseStockMin']??'';break;case _0x3e1c59(0x179):_0x303e3c[_0x7bebe7]=_0x400874['setBatchName']??'';break;case'Fecha\x20de\x20Vencimiento':_0x303e3c[_0x7bebe7]=_0x400874[_0x3e1c59(0x168)]??'';break;default:_0x303e3c[_0x7bebe7]='';}}),_0x303e3c;}),_0x4046e2=0x3e8,_0x3132de=_0x2e7aad[_0x22551d(0x183)];for(let _0x46ae34=0x0;_0x46ae34<_0x3132de;_0x46ae34+=_0x4046e2){const _0x4bad28=_0x2e7aad['slice'](_0x46ae34,_0x46ae34+_0x4046e2);XLSX[_0x22551d(0x138)][_0x22551d(0xf7)](_0x2a4916,_0x4bad28,{'origin':{'r':_0x46ae34+0x2,'c':0x0},'skipHeader':!![],'header':_0x4264a9}),postMessage({'type':_0x22551d(0x14d),'payload':{'percent':Math[_0x22551d(0x142)]((_0x46ae34+_0x4bad28['length'])/_0x3132de*0x64),'message':'Exportando\x20filas\x20'+(_0x46ae34+0x1)+'–'+(_0x46ae34+_0x4bad28['length'])+_0x22551d(0x17c)+_0x3132de}});}const _0x484e69={'s':{'r':0x0,'c':0x0},'e':{'r':_0x3132de+0x1,'c':_0x4264a9['length']-0x1}};_0x2a4916[_0x22551d(0x162)]=XLSX['utils'][_0x22551d(0x108)](_0x484e69);const _0x2a339e=XLSX[_0x22551d(0x13e)](_0x4b4da0,{'bookType':_0x22551d(0xf4),'type':_0x22551d(0x161)});let _0x5cfdf0,_0x2b99fb;if(_0x2a339e instanceof Uint8Array)_0x5cfdf0=_0x2a339e,_0x2b99fb=[_0x2a339e[_0x22551d(0x173)]];else{if(_0x2a339e instanceof ArrayBuffer)_0x5cfdf0=new Uint8Array(_0x2a339e),_0x2b99fb=[_0x2a339e];else{const _0xf2a13b=new Uint8Array(_0x2a339e);_0x5cfdf0=_0xf2a13b,_0x2b99fb=[_0xf2a13b[_0x22551d(0x173)]];}}postMessage({'type':'exportDone','payload':{'wbout':_0x5cfdf0,'count':_0x2e7aad['length']}},_0x2b99fb);}catch(_0x29575c){postMessage({'type':_0x22551d(0x1b7),'payload':_0x29575c[_0x22551d(0x186)]||String(_0x29575c)});}return;}};