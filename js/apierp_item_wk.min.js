/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.0.9
*/

const _0x3584ea=_0xf18b;(function(_0x5c2742,_0x406041){const _0x168909=_0xf18b,_0x46a7b7=_0x5c2742();while(!![]){try{const _0xa66f29=parseInt(_0x168909(0x20e))/0x1*(parseInt(_0x168909(0x193))/0x2)+parseInt(_0x168909(0x15c))/0x3*(-parseInt(_0x168909(0x200))/0x4)+parseInt(_0x168909(0x20c))/0x5*(parseInt(_0x168909(0x1be))/0x6)+-parseInt(_0x168909(0x1ca))/0x7+parseInt(_0x168909(0x1b3))/0x8*(parseInt(_0x168909(0x1e8))/0x9)+-parseInt(_0x168909(0x1c8))/0xa+parseInt(_0x168909(0x188))/0xb;if(_0xa66f29===_0x406041)break;else _0x46a7b7['push'](_0x46a7b7['shift']());}catch(_0x39b4a9){_0x46a7b7['push'](_0x46a7b7['shift']());}}}(_0xa8a1,0x4d8f2));function _0xa8a1(){const _0x321f03=['MTQ','number','PALETAS','CENTIMETRO\x20CUBICO','LATAS','METRO','233037YpzhTR','El\x20archivo\x20tiene\x20','HOJA','exportItems','TNE','CENTIMETRO\x20LINEAL','SET','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','FARDO','Stock\x20Actual','apply','PEN_setMtoPrecioCostoUnitario3','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','trim','Comisión\x20Venta\x20(%)','GRO','push','Precio\x20Costo\x20Soles\x202','setItemUnitAlias','PAR','encode_range','MMQ','setItemBarCode','array','1348888xxaNpc','exportDone','MLT','message','Se\x20Compra','TAMBOR','TONELADA\x20CORTA','Inafecto\x20Gratuito\x20(0%)','SACO','log','PIES\x20CUBICOS','PEN_setMtoPrecioCostoUnitario2','5SdaYQM','setWarehouseStockMin','67cfDZoW','filter','decode_range','INH','GRUESA','setUnidadEquivalencia3','Tipo*','buffer','progress','setUnidadCodigo2','FTK','METRO\x20CUADRADO','PLACAS','Talla','UND\x20(NIU)','MILIGRAMOS','BARRILES','Material','(((.+)+)+)+$','CONOS','setCodProducto','Precio\x20Venta\x20Soles\x203','prototype','DOCENA\x20POR\x2010**6','BOLSA','Precio\x20Venta\x20Dólares\x202','Stock\x20Mínimo','Unidad\x20de\x20Medida*','HECTOLITRO','MGM','BOTELLAS','LEF','LBR','CIENTO\x20DE\x20UNIDADES','TUBOS','exception','Gravado\x20(10%)','reduce','UNIDAD\x20(ZZ)','Gravado\x20Gratuito\x20(18%)','setInventariable','!ref','PULGADAS','GALON\x20INGLES\x20(4,545956L)','CAJA','Alias\x202','LITRO','Precio\x20Venta\x20Soles\x202','Precio\x20Venta\x20Dólares','C62','MILILITRO','getMonth','TONELADAS','setUnidadCodigo3','SSF','CILINDRO','STN','Precio\x20Venta\x20Soles','PEN_setMtoPrecioUnitario3','Gravado\x20(18%)','MILIMETRO\x20CUADRADO','FOT','isArray','SheetNames','Equivalencia\x202','YARDA','Gravado\x20Gratuito\x20(10%)','CMT','setCategoria','USD_setMtoPrecioCostoUnitario3','Precio\x20Costo\x20Dólares\x202','Equivalencia\x203','read','Precio\x20Costo\x20Soles\x203','length','FTQ','CEN','toLowerCase','UNIDAD\x20(NIU)','Se\x20Vende','3VdaZIF','Exonerado\x20Gratuito\x20(0%)','setUnidadCodigo','setSucursalStock','Color','ONZAS','PIES\x20CUADRADOS','Código\x20de\x20Barras\x203','PEN_setMtoPrecioUnitario2','parse_date_code','Comisión\x20Venta\x203\x20(%)','CENTIMETRO\x20CUADRADO','code','MIL','Procesadas\x20filas\x20','ID\x20UNIT\x203','\x20de\x20','Precio\x20Costo\x20Dólares','keys','DZP','some','Sheets','ID\x20UNIT\x202','exportItems:\x20productos\x20no\x20clonables:\x20','sheet_add_json','GRM','PIES','USD_setMtoPrecioCostoUnitario','error','KILOMETRO','Código\x20SKU*','map','NIU','Descripción','USD_setMtoPrecioUnitario','USD_setMtoPrecioUnitario2','Comisión\x20Venta\x202\x20(%)','getFullYear','Alias','KWH','Alias\x203','Precio\x20Venta\x20Dólares\x203','setTaxId','ONZ','6271705qUdSTM','Inafecto\x20(0%)','CARTONES','MWH','sheet_to_json','YRD','PLIEGO','setItemIsBought','forEach','USD_setMtoPrecioCostoUnitario2','Nombre*','7128SStsEI','LTN','Combo','QQM','MILIMETRO\x20CUBICO','Código\x20de\x20Barras','Marca','HLT','Impuesto*','constructor','Artículo','PIEZAS','console','DOCENA','METRO\x20CUBICO','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','done','KILOGRAMO','Precio\x20Costo\x20Dólares\x203','utils','MTK','{}.constructor(\x22return\x20this\x22)(\x20)','RESMA','getDate','MMK','PEN_setMtoPrecioUnitario','USD_setMtoPrecioUnitario3','PAQUETE','setUnitId3','Fabricado','toString','info','88iECuMM','DZN','Fecha\x20de\x20Vencimiento','setItemUnitAlias3','findIndex','setItemCommissionPercentage','KIT','setItemVariantValues','setItemDescription','Modelo\x20de\x20Manga','setItemBarCode3','2820150XlfkIw','Lote','setItemCommissionPercentage3','MILLARES','MILLON\x20DE\x20UNIDADES','round','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','Precio\x20Costo\x20Soles','setItemIsSold','Exportación\x20(0%)','6244600nIAsNX','BALDE','1990989ExDyYZ','find','value','Código\x20de\x20Barras\x202','CMQ','BOBINAS','encode_cell','setItemBarCode2','GRAMO','setItemUnitAlias2','Rastrear\x20Inventario','LIBRAS','ID\x20UNIT','setDescripcion','bind','warn','Exonerado\x20(0%)','QUINTAL','setUnitId2','exportItems:\x20products\x20no\x20es\x20Array.','slice','padStart','Categoría','Iniciando\x20parseo…'];_0xa8a1=function(){return _0x321f03;};return _0xa8a1();}const _0x2ffe65=(function(){let _0x311b70=!![];return function(_0x2e3209,_0x4107ac){const _0x393fd2=_0x311b70?function(){const _0x31dbda=_0xf18b;if(_0x4107ac){const _0x3b7b94=_0x4107ac[_0x31dbda(0x1f2)](_0x2e3209,arguments);return _0x4107ac=null,_0x3b7b94;}}:function(){};return _0x311b70=![],_0x393fd2;};}()),_0xa02364=_0x2ffe65(this,function(){const _0x1f0e59=_0xf18b;return _0xa02364[_0x1f0e59(0x1b1)]()['search'](_0x1f0e59(0x220))[_0x1f0e59(0x1b1)]()[_0x1f0e59(0x19c)](_0xa02364)['search']('(((.+)+)+)+$');});function _0xf18b(_0x15b0ad,_0x50068a){const _0x44f63a=_0xa8a1();return _0xf18b=function(_0x27dab5,_0x365b8e){_0x27dab5=_0x27dab5-0x157;let _0x4cb940=_0x44f63a[_0x27dab5];return _0x4cb940;},_0xf18b(_0x15b0ad,_0x50068a);}_0xa02364();const _0x365b8e=(function(){let _0x52b3c6=!![];return function(_0x3cee03,_0x5183be){const _0x1edbd3=_0x52b3c6?function(){if(_0x5183be){const _0x34a2e7=_0x5183be['apply'](_0x3cee03,arguments);return _0x5183be=null,_0x34a2e7;}}:function(){};return _0x52b3c6=![],_0x1edbd3;};}()),_0x27dab5=_0x365b8e(this,function(){const _0x29931a=_0xf18b,_0x144984=function(){const _0x3c90fe=_0xf18b;let _0xe2beda;try{_0xe2beda=Function('return\x20(function()\x20'+_0x3c90fe(0x1a8)+');')();}catch(_0x12ec24){_0xe2beda=window;}return _0xe2beda;},_0x40c40b=_0x144984(),_0x122c4d=_0x40c40b['console']=_0x40c40b[_0x29931a(0x19f)]||{},_0x30419e=[_0x29931a(0x209),_0x29931a(0x1d9),_0x29931a(0x1b2),_0x29931a(0x178),_0x29931a(0x231),'table','trace'];for(let _0x47038e=0x0;_0x47038e<_0x30419e[_0x29931a(0x258)];_0x47038e++){const _0x564a98=_0x365b8e['constructor'][_0x29931a(0x224)][_0x29931a(0x1d8)](_0x365b8e),_0x4122a6=_0x30419e[_0x47038e],_0x37c7a6=_0x122c4d[_0x4122a6]||_0x564a98;_0x564a98['__proto__']=_0x365b8e[_0x29931a(0x1d8)](_0x365b8e),_0x564a98[_0x29931a(0x1b1)]=_0x37c7a6[_0x29931a(0x1b1)]['bind'](_0x37c7a6),_0x122c4d[_0x4122a6]=_0x564a98;}});_0x27dab5(),importScripts(_0x3584ea(0x1a2)),onmessage=({data:_0xdaf56})=>{const _0xe52752=_0x3584ea,{action:_0x517ac3}=_0xdaf56;if(_0x517ac3==='import'){const {buf:_0x4f5fff,maxRows:_0x34faf3}=_0xdaf56;try{postMessage({'type':_0xe52752(0x216),'payload':{'percent':0x5,'message':_0xe52752(0x1e1)}});const _0x5295df=XLSX[_0xe52752(0x256)](_0x4f5fff,{'type':_0xe52752(0x1ff),'cellDates':!![]}),_0x5c47d6=_0x5295df[_0xe52752(0x171)][_0x5295df[_0xe52752(0x24d)][0x0]],_0xcdbbe0=XLSX[_0xe52752(0x1a6)][_0xe52752(0x18c)](_0x5c47d6,{'defval':'','range':0x1,'cellDates':!![]}),_0x1c852d=_0xcdbbe0[_0xe52752(0x1b7)](_0xb4bc0b=>(!_0xb4bc0b['Tipo*']||String(_0xb4bc0b['Tipo*'])[_0xe52752(0x1f5)]()==='')&&(!_0xb4bc0b['Código\x20SKU*']||String(_0xb4bc0b[_0xe52752(0x17a)])['trim']()==='')&&(!_0xb4bc0b['Nombre*']||String(_0xb4bc0b[_0xe52752(0x192)])['trim']()==='')&&(!_0xb4bc0b[_0xe52752(0x229)]||String(_0xb4bc0b['Unidad\x20de\x20Medida*'])[_0xe52752(0x1f5)]()==='')),_0x46acd6=_0x1c852d>=0x0?_0xcdbbe0[_0xe52752(0x1de)](0x0,_0x1c852d):_0xcdbbe0,_0x4519f0=_0x46acd6[_0xe52752(0x20f)](_0x5a41ee=>_0x5a41ee['Tipo*']&&String(_0x5a41ee[_0xe52752(0x214)])[_0xe52752(0x1f5)]()!==''&&_0x5a41ee[_0xe52752(0x17a)]&&String(_0x5a41ee[_0xe52752(0x17a)])[_0xe52752(0x1f5)]()!==''&&_0x5a41ee[_0xe52752(0x192)]&&String(_0x5a41ee[_0xe52752(0x192)])[_0xe52752(0x1f5)]()!==''&&_0x5a41ee[_0xe52752(0x229)]&&String(_0x5a41ee['Unidad\x20de\x20Medida*'])[_0xe52752(0x1f5)]()!==''),_0x3842cc=_0x4519f0[_0xe52752(0x258)];if(_0x3842cc===0x0){postMessage({'type':_0xe52752(0x178),'payload':_0xe52752(0x1f4)});return;}if(_0x3842cc>_0x34faf3)throw _0xe52752(0x1e9)+_0x3842cc+_0xe52752(0x1c4)+_0x34faf3+'.';const _0x2777b9=0x1f4,_0x327e4a=[],_0x307859=[{'codigo':'4A','nombre':_0xe52752(0x1cf)},{'codigo':'BJ','nombre':_0xe52752(0x1c9)},{'codigo':'BLL','nombre':_0xe52752(0x21e)},{'codigo':'BG','nombre':_0xe52752(0x226)},{'codigo':'BO','nombre':_0xe52752(0x22c)},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':_0xe52752(0x18a)},{'codigo':'CMK','nombre':_0xe52752(0x167)},{'codigo':_0xe52752(0x1ce),'nombre':'CENTIMETRO\x20CUBICO'},{'codigo':_0xe52752(0x251),'nombre':_0xe52752(0x1ed)},{'codigo':_0xe52752(0x158),'nombre':_0xe52752(0x22f)},{'codigo':'CY','nombre':_0xe52752(0x245)},{'codigo':'CJ','nombre':_0xe52752(0x221)},{'codigo':_0xe52752(0x1b4),'nombre':_0xe52752(0x1a0)},{'codigo':_0xe52752(0x16f),'nombre':_0xe52752(0x225)},{'codigo':'BE','nombre':_0xe52752(0x1f0)},{'codigo':'GLI','nombre':'GALON\x20INGLES\x20(4,545956L)'},{'codigo':_0xe52752(0x175),'nombre':_0xe52752(0x1d2)},{'codigo':_0xe52752(0x1f7),'nombre':_0xe52752(0x212)},{'codigo':_0xe52752(0x19a),'nombre':_0xe52752(0x22a)},{'codigo':_0xe52752(0x22d),'nombre':_0xe52752(0x1ea)},{'codigo':_0xe52752(0x1ee),'nombre':'JUEGO'},{'codigo':'KGM','nombre':_0xe52752(0x1a4)},{'codigo':'KTM','nombre':_0xe52752(0x179)},{'codigo':_0xe52752(0x183),'nombre':'KILOVATIO\x20HORA'},{'codigo':'KT','nombre':_0xe52752(0x1b9)},{'codigo':'CA','nombre':_0xe52752(0x1e6)},{'codigo':_0xe52752(0x22e),'nombre':'LIBRAS'},{'codigo':'LTR','nombre':'LITRO'},{'codigo':_0xe52752(0x18b),'nombre':'MEGAWATT\x20HORA'},{'codigo':'MTR','nombre':_0xe52752(0x1e7)},{'codigo':_0xe52752(0x1a7),'nombre':_0xe52752(0x219)},{'codigo':_0xe52752(0x1e2),'nombre':'METRO\x20CUBICO'},{'codigo':_0xe52752(0x22b),'nombre':_0xe52752(0x21d)},{'codigo':_0xe52752(0x202),'nombre':_0xe52752(0x240)},{'codigo':'MMT','nombre':'MILIMETRO'},{'codigo':_0xe52752(0x1ab),'nombre':_0xe52752(0x24a)},{'codigo':_0xe52752(0x1fd),'nombre':_0xe52752(0x197)},{'codigo':_0xe52752(0x169),'nombre':_0xe52752(0x1c1)},{'codigo':'UM','nombre':_0xe52752(0x1c2)},{'codigo':_0xe52752(0x187),'nombre':_0xe52752(0x161)},{'codigo':'PF','nombre':_0xe52752(0x1e4)},{'codigo':'PK','nombre':_0xe52752(0x1ae)},{'codigo':'PR','nombre':_0xe52752(0x1fb)},{'codigo':_0xe52752(0x24b),'nombre':'PIES'},{'codigo':_0xe52752(0x218),'nombre':_0xe52752(0x162)},{'codigo':_0xe52752(0x157),'nombre':'PIES\x20CUBICOS'},{'codigo':_0xe52752(0x23f),'nombre':_0xe52752(0x19e)},{'codigo':'PG','nombre':_0xe52752(0x21a)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':_0xe52752(0x211),'nombre':_0xe52752(0x238)},{'codigo':'RM','nombre':_0xe52752(0x1a9)},{'codigo':'SA','nombre':_0xe52752(0x208)},{'codigo':'DR','nombre':_0xe52752(0x205)},{'codigo':_0xe52752(0x246),'nombre':_0xe52752(0x206)},{'codigo':_0xe52752(0x194),'nombre':'TONELADA\x20LARGA'},{'codigo':_0xe52752(0x1ec),'nombre':'TONELADAS'},{'codigo':'TU','nombre':_0xe52752(0x230)},{'codigo':'NIU','nombre':_0xe52752(0x15a)},{'codigo':'ZZ','nombre':_0xe52752(0x234)},{'codigo':'GLL','nombre':'US\x20GALON\x20(3,7843\x20L)'},{'codigo':_0xe52752(0x18d),'nombre':'YARDA'},{'codigo':'YDK','nombre':'YARDA\x20CUADRADA'},{'codigo':_0xe52752(0x196),'nombre':_0xe52752(0x1db)}],_0x4fc0a3=_0x307859[_0xe52752(0x233)]((_0x2cb947,{nombre:_0x4c1b68,codigo:_0x204cf5})=>{return _0x2cb947[_0x4c1b68['trim']()]=_0x204cf5['trim'](),_0x2cb947;},{});for(let _0x1b83bc=0x0;_0x1b83bc<_0x3842cc;_0x1b83bc+=_0x2777b9){const _0xbfeb3b=_0x4519f0['slice'](_0x1b83bc,_0x1b83bc+_0x2777b9)['map']((_0xa08340,_0x5d3f65)=>{const _0x3a66e4=_0xe52752;let _0xbb29dd={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0xa08340['Tipo*']]||'1';const _0x2f16c6=String(_0xa08340[_0x3a66e4(0x19b)])[_0x3a66e4(0x1f5)](),_0x3c7243={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x49fe83=_0x3c7243[_0x2f16c6]||'1',_0x54c467={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x49fe83]||{'code':'10','value':0x12},_0x3c8d0c={};let _0x22e180=String(_0xa08340[_0x3a66e4(0x192)])[_0x3a66e4(0x1f5)]();const _0xf8d6bc=[_0x3a66e4(0x1bf),_0x3a66e4(0x21b),_0x3a66e4(0x160),'Género','Modelo','Serie',_0x3a66e4(0x21f),'Modelo\x20de\x20Cuello',_0x3a66e4(0x1bc)];_0xf8d6bc[_0x3a66e4(0x190)](_0x42ccf3=>{const _0x233b55=_0x3a66e4,_0x42e3c0=String(_0xa08340[_0x42ccf3]||'')[_0x233b55(0x1f5)]();_0x42e3c0&&(_0x3c8d0c[_0x42ccf3]=_0x42e3c0,_0x22e180+='\x20'+_0x42ccf3+'\x20'+_0x42e3c0);});const _0x5ea44c=[],_0x56e459=String(_0xa08340[_0x3a66e4(0x229)]||_0x3a66e4(0x15a))[_0x3a66e4(0x1f5)](),_0x36e22d=_0x4fc0a3[_0x56e459]||_0x3a66e4(0x17c),_0x4ffeb7=String(_0xa08340['Alias'])[_0x3a66e4(0x1f5)]();_0x5ea44c[_0x3a66e4(0x1f8)]({'setItemUnitId':String(_0xa08340[_0x3a66e4(0x1d6)])[_0x3a66e4(0x1f5)]()||'','setItemBarCode':String(_0xa08340[_0x3a66e4(0x198)])[_0x3a66e4(0x1f5)]()||'','setAlias':_0x4ffeb7,'setUnitCode':_0x36e22d,'setPrice':parseFloat(_0xa08340[_0x3a66e4(0x247)]),'setCost':parseFloat(_0xa08340['Precio\x20Costo\x20Soles']),'setPriceUSD':parseFloat(_0xa08340[_0x3a66e4(0x23e)]),'setCostUSD':parseFloat(_0xa08340[_0x3a66e4(0x16d)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0xa08340[_0x3a66e4(0x1f6)])});const _0xe9a956=['ID\x20UNIT\x202',_0x3a66e4(0x23b),_0x3a66e4(0x1cd),_0x3a66e4(0x24e),'Precio\x20Venta\x20Soles\x202',_0x3a66e4(0x1f9),_0x3a66e4(0x227),_0x3a66e4(0x254)][_0x3a66e4(0x170)](_0x1757b2=>{const _0x3f9139=_0x3a66e4,_0x4f7e34=_0xa08340[_0x1757b2];return _0x4f7e34!=null&&String(_0x4f7e34)[_0x3f9139(0x1f5)]()!=='';});if(_0xe9a956){const _0x5a5b1b=String(_0xa08340['Unidad\x20de\x20Medida\x202']||_0x3a66e4(0x21c))['trim'](),_0x53cee6=_0x4fc0a3[_0x5a5b1b]||_0x3a66e4(0x17c);_0x5ea44c[_0x3a66e4(0x1f8)]({'setItemUnitId':String(_0xa08340[_0x3a66e4(0x172)])[_0x3a66e4(0x1f5)]()||'','setItemBarCode':String(_0xa08340[_0x3a66e4(0x1cd)])[_0x3a66e4(0x1f5)]()||'','setAlias':String(_0xa08340[_0x3a66e4(0x23b)])[_0x3a66e4(0x1f5)](),'setUnitCode':_0x53cee6,'setPrice':parseFloat(_0xa08340[_0x3a66e4(0x23d)]),'setCost':parseFloat(_0xa08340['Precio\x20Costo\x20Soles\x202']),'setPriceUSD':parseFloat(_0xa08340[_0x3a66e4(0x227)]),'setCostUSD':parseFloat(_0xa08340[_0x3a66e4(0x254)]),'setDefault':0x0,'setEquivalence':parseFloat(_0xa08340['Equivalencia\x202'])||0x1,'setFactor':parseFloat(_0xa08340[_0x3a66e4(0x24e)])||0x1,'setItemCommissionPercentage':parseFloat(_0xa08340[_0x3a66e4(0x180)])});}const _0x11d3fa=[_0x3a66e4(0x16b),_0x3a66e4(0x184),_0x3a66e4(0x163),_0x3a66e4(0x255),_0x3a66e4(0x223),'Precio\x20Costo\x20Soles\x203',_0x3a66e4(0x185),_0x3a66e4(0x1a5)][_0x3a66e4(0x170)](_0x2baa00=>{const _0x4301d0=_0x3a66e4,_0x5d432c=_0xa08340[_0x2baa00];return _0x5d432c!=null&&String(_0x5d432c)[_0x4301d0(0x1f5)]()!=='';});if(_0x11d3fa){const _0x9c8df2=String(_0xa08340['Unidad\x20de\x20Medida\x203']||'UND\x20(NIU)')[_0x3a66e4(0x1f5)](),_0x8f5d4b=_0x4fc0a3[_0x9c8df2]||'NIU';_0x5ea44c[_0x3a66e4(0x1f8)]({'setItemUnitId':String(_0xa08340[_0x3a66e4(0x16b)])['trim']()||'','setItemBarCode':String(_0xa08340[_0x3a66e4(0x163)])['trim']()||'','setAlias':String(_0xa08340['Alias\x203'])['trim'](),'setUnitCode':_0x8f5d4b,'setPrice':parseFloat(_0xa08340[_0x3a66e4(0x223)]),'setCost':parseFloat(_0xa08340[_0x3a66e4(0x257)]),'setPriceUSD':parseFloat(_0xa08340['Precio\x20Venta\x20Dólares\x203']),'setCostUSD':parseFloat(_0xa08340[_0x3a66e4(0x1a5)]),'setDefault':0x0,'setEquivalence':parseFloat(_0xa08340['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0xa08340['Equivalencia\x203'])||0x1,'setItemCommissionPercentage':parseFloat(_0xa08340[_0x3a66e4(0x166)])});}let _0x45a152=_0xa08340[_0x3a66e4(0x1b5)],_0x13aeb7='';if(_0x45a152 instanceof Date){const _0x5c1d31=_0x45a152[_0x3a66e4(0x181)](),_0x5ba84a=String(_0x45a152[_0x3a66e4(0x241)]()+0x1)[_0x3a66e4(0x1df)](0x2,'0'),_0x495042=String(_0x45a152[_0x3a66e4(0x1aa)]())[_0x3a66e4(0x1df)](0x2,'0');_0x13aeb7=_0x5c1d31+'-'+_0x5ba84a+'-'+_0x495042;}else{if(typeof _0x45a152===_0x3a66e4(0x1e3)){const _0x2a90ef=XLSX[_0x3a66e4(0x244)][_0x3a66e4(0x165)](_0x45a152);if(_0x2a90ef){const _0x4946a5=_0x2a90ef['y'],_0x230d6e=String(_0x2a90ef['m'])['padStart'](0x2,'0'),_0xbe4d00=String(_0x2a90ef['d'])[_0x3a66e4(0x1df)](0x2,'0');_0x13aeb7=_0x4946a5+'-'+_0x230d6e+'-'+_0xbe4d00;}}else _0x13aeb7=String(_0x45a152||'')[_0x3a66e4(0x1f5)]();}return{'setItemId':String(_0xa08340['ID'])[_0x3a66e4(0x1f5)](),'setItemType':_0xbb29dd,'setItemCode':String(_0xa08340['Código\x20SKU*'])[_0x3a66e4(0x1f5)](),'setItemName':String(_0xa08340[_0x3a66e4(0x192)])[_0x3a66e4(0x1f5)](),'setItemDescription':String(_0xa08340[_0x3a66e4(0x17d)])[_0x3a66e4(0x1f5)]()||'','setItemIsSold':_0xa08340[_0x3a66e4(0x15b)]=='SI'?0x1:0x0,'setItemIsBought':_0xa08340[_0x3a66e4(0x204)]=='SI'?0x1:0x0,'setItemCategories':_0xa08340['Categoría']?[String(_0xa08340[_0x3a66e4(0x1e0)])[_0x3a66e4(0x1f5)]()]:[],'setItemBrands':_0xa08340[_0x3a66e4(0x199)]?[String(_0xa08340['Marca'])[_0x3a66e4(0x1f5)]()]:[],'setItemTaxId':_0x49fe83,'setItemTaxCode':_0x54c467[_0x3a66e4(0x168)],'setItemTaxValue':_0x54c467[_0x3a66e4(0x1cc)],'setItemUnits':_0x5ea44c,'setItemInventoriable':_0xa08340[_0x3a66e4(0x1d4)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0xa08340[_0x3a66e4(0x1f1)])||0x0,'setStockMinimum':parseFloat(_0xa08340[_0x3a66e4(0x228)])||0x0,'setItemLocation':String(_0xa08340['Ubicación'])[_0x3a66e4(0x1f5)]()||'','setBatchName':String(_0xa08340['Lote'])['trim']()||'','setItemDateExpiry':_0x13aeb7,'setItemVariantName':_0x22e180,'setItemVariantValues':_0x3c8d0c,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x327e4a['push'](..._0xbfeb3b),postMessage({'type':_0xe52752(0x216),'payload':{'percent':Math[_0xe52752(0x1c3)]((_0x1b83bc+_0xbfeb3b[_0xe52752(0x258)])/_0x3842cc*0x64),'message':_0xe52752(0x16a)+(_0x1b83bc+0x1)+'–'+(_0x1b83bc+_0xbfeb3b['length'])+'/'+_0x3842cc}});}postMessage({'type':_0xe52752(0x1a3),'payload':{'items':_0x327e4a}});}catch(_0x7e159){postMessage({'type':_0xe52752(0x178),'payload':_0x7e159['message']||_0x7e159});}}if(_0x517ac3===_0xe52752(0x1eb)){const {products:_0x46f647,plantillaBuf:_0x295633}=_0xdaf56;if(!(_0x295633 instanceof ArrayBuffer)){postMessage({'type':_0xe52752(0x178),'payload':_0xe52752(0x1ef)});return;}if(!Array[_0xe52752(0x24c)](_0x46f647)){postMessage({'type':_0xe52752(0x178),'payload':_0xe52752(0x1dd)});return;}try{structuredClone(_0x46f647);}catch(_0x84c301){postMessage({'type':'error','payload':_0xe52752(0x173)+_0x84c301[_0xe52752(0x203)]});return;}try{const _0xcb7107={'1':_0xe52752(0x19d),'2':'Servicio','3':'Materia\x20Prima','4':_0xe52752(0x195),'5':_0xe52752(0x1b0)};function _0x5eb25b(_0xc07517){const _0x10b462=_0xe52752;return _0xcb7107[String(_0xc07517)]||_0x10b462(0x19d);}const _0x38f01f={'1':'Gravado\x20(18%)','2':_0xe52752(0x1da),'3':_0xe52752(0x189),'4':_0xe52752(0x235),'5':_0xe52752(0x207),'6':_0xe52752(0x232),'7':_0xe52752(0x15d),'8':_0xe52752(0x1c7),'9':_0xe52752(0x250)};function _0x311658(_0x478af4){const _0x7100e4=_0xe52752;return _0x38f01f[String(_0x478af4)]||_0x7100e4(0x249);}const _0x575e30={'4A':_0xe52752(0x1cf),'BJ':_0xe52752(0x1c9),'BLL':'BARRILES','BG':_0xe52752(0x226),'BO':_0xe52752(0x22c),'BX':_0xe52752(0x23a),'CT':'CARTONES','CMK':_0xe52752(0x167),'CMQ':_0xe52752(0x1e5),'CMT':'CENTIMETRO\x20LINEAL','CEN':_0xe52752(0x22f),'CY':_0xe52752(0x245),'CJ':'CONOS','DZN':_0xe52752(0x1a0),'DZP':_0xe52752(0x225),'BE':_0xe52752(0x1f0),'GLI':_0xe52752(0x239),'GRM':_0xe52752(0x1d2),'GRO':_0xe52752(0x212),'HLT':_0xe52752(0x22a),'LEF':_0xe52752(0x1ea),'SET':'JUEGO','KGM':_0xe52752(0x1a4),'KTM':'KILOMETRO','KWH':'KILOVATIO\x20HORA','KT':_0xe52752(0x1b9),'CA':_0xe52752(0x1e6),'LBR':_0xe52752(0x1d5),'LTR':_0xe52752(0x23c),'MWH':'MEGAWATT\x20HORA','MTR':_0xe52752(0x1e7),'MTK':'METRO\x20CUADRADO','MTQ':_0xe52752(0x1a1),'MGM':_0xe52752(0x21d),'MLT':_0xe52752(0x240),'MMT':'MILIMETRO','MMK':_0xe52752(0x24a),'MMQ':_0xe52752(0x197),'MIL':_0xe52752(0x1c1),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0xe52752(0x161),'PF':_0xe52752(0x1e4),'PK':_0xe52752(0x1ae),'PR':_0xe52752(0x1fb),'FOT':_0xe52752(0x176),'FTK':_0xe52752(0x162),'FTQ':_0xe52752(0x20a),'C62':_0xe52752(0x19e),'PG':_0xe52752(0x21a),'ST':_0xe52752(0x18e),'INH':_0xe52752(0x238),'RM':'RESMA','SA':'SACO','DR':'TAMBOR','STN':_0xe52752(0x206),'LTN':'TONELADA\x20LARGA','TNE':_0xe52752(0x242),'TU':_0xe52752(0x230),'NIU':_0xe52752(0x15a),'ZZ':_0xe52752(0x234),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':_0xe52752(0x24f),'YDK':'YARDA\x20CUADRADA','QQM':_0xe52752(0x1db)};function _0x161c1a(_0x44601b){return _0x575e30[String(_0x44601b)]||'';}const _0x44924f=XLSX[_0xe52752(0x256)](_0x295633,{'type':_0xe52752(0x1ff),'cellDates':!![]}),_0x5c617e=_0x44924f[_0xe52752(0x24d)][0x0],_0x41b1c9=_0x44924f[_0xe52752(0x171)][_0x5c617e],_0x47c78e=XLSX['utils'][_0xe52752(0x18c)](_0x41b1c9,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x24cc63=XLSX[_0xe52752(0x1a6)][_0xe52752(0x210)](_0x41b1c9[_0xe52752(0x237)]||'');for(let _0x5cf1e8=0x2;_0x5cf1e8<=_0x24cc63['e']['r'];++_0x5cf1e8){for(let _0x11cb1e=_0x24cc63['s']['c'];_0x11cb1e<=_0x24cc63['e']['c'];++_0x11cb1e){const _0x2172e1=XLSX[_0xe52752(0x1a6)][_0xe52752(0x1d0)]({'r':_0x5cf1e8,'c':_0x11cb1e});if(_0x41b1c9[_0x2172e1])delete _0x41b1c9[_0x2172e1];}}const _0x3c2837=_0x46f647[_0xe52752(0x17b)](_0x18c8c7=>{const _0x2dcf6a=_0xe52752;_0x18c8c7[_0x2dcf6a(0x1ba)]=_0x18c8c7[_0x2dcf6a(0x1ba)]||{};const _0x2d88d7={};return _0x47c78e[_0x2dcf6a(0x190)](_0x27ecc3=>{const _0x1d8ac6=_0x2dcf6a,_0x1f1bc6=String(_0x27ecc3)[_0x1d8ac6(0x1f5)](),_0x16f275=_0x1f1bc6[_0x1d8ac6(0x159)](),_0x24b025=Object[_0x1d8ac6(0x16e)](_0x18c8c7)[_0x1d8ac6(0x1cb)](_0x382a77=>_0x382a77[_0x1d8ac6(0x1f5)]()[_0x1d8ac6(0x159)]()===_0x16f275);if(_0x24b025){_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x24b025]??'';return;}switch(_0x1f1bc6){case'ID':_0x2d88d7[_0x1f1bc6]=_0x18c8c7['id']??'';break;case'Tipo*':_0x2d88d7[_0x1f1bc6]=_0x5eb25b(_0x18c8c7['setItemType']);break;case _0x1d8ac6(0x17a):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x222)]??'';break;case'Nombre*':_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1d7)]??'';break;case _0x1d8ac6(0x17d):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1bb)]??'';break;case _0x1d8ac6(0x15b):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1c6)]==0x1?'SI':'NO';break;case'Se\x20Compra':_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x18f)]==0x1?'SI':'NO';break;case _0x1d8ac6(0x1e0):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x252)]??'';break;case _0x1d8ac6(0x199):_0x2d88d7[_0x1f1bc6]=_0x18c8c7['setMarca']??'';break;case'Impuesto*':_0x2d88d7[_0x1f1bc6]=_0x311658(_0x18c8c7[_0x1d8ac6(0x186)]);break;case _0x1d8ac6(0x1d6):_0x2d88d7[_0x1f1bc6]=_0x18c8c7['setUnitId']??'';break;case _0x1d8ac6(0x182):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1fa)]??'';break;case'Código\x20de\x20Barras':_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1fe)]??'';break;case _0x1d8ac6(0x229):_0x2d88d7[_0x1f1bc6]=_0x161c1a(_0x18c8c7[_0x1d8ac6(0x15e)]);break;case _0x1d8ac6(0x247):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1ac)]??'';break;case _0x1d8ac6(0x1c5):_0x2d88d7[_0x1f1bc6]=_0x18c8c7['PEN_setMtoPrecioCostoUnitario']??'';break;case _0x1d8ac6(0x23e):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x17e)]??'';break;case _0x1d8ac6(0x16d):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x177)]??'';break;case _0x1d8ac6(0x1f6):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1b8)];break;case _0x1d8ac6(0x172):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1dc)]??'';break;case _0x1d8ac6(0x23b):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1d3)]??'';break;case _0x1d8ac6(0x1cd):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1d1)]??'';break;case'Unidad\x20de\x20Medida\x202':_0x2d88d7[_0x1f1bc6]=_0x161c1a(_0x18c8c7[_0x1d8ac6(0x217)]);break;case _0x1d8ac6(0x24e):_0x2d88d7[_0x1f1bc6]=_0x18c8c7['setUnidadEquivalencia2']??'1';break;case _0x1d8ac6(0x23d):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x164)]??'';break;case _0x1d8ac6(0x1f9):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x20b)]??'';break;case _0x1d8ac6(0x227):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x17f)]??'';break;case _0x1d8ac6(0x254):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x191)]??'';break;case'Comisión\x20Venta\x202\x20(%)':_0x2d88d7[_0x1f1bc6]=_0x18c8c7['setItemCommissionPercentage2'];break;case _0x1d8ac6(0x16b):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1af)]??'';break;case _0x1d8ac6(0x184):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1b6)]??'';break;case _0x1d8ac6(0x163):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1bd)]??'';break;case'Unidad\x20de\x20Medida\x203':_0x2d88d7[_0x1f1bc6]=_0x161c1a(_0x18c8c7[_0x1d8ac6(0x243)]);break;case _0x1d8ac6(0x255):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x213)]??'1';break;case _0x1d8ac6(0x223):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x248)]??'';break;case _0x1d8ac6(0x257):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1f3)]??'';break;case _0x1d8ac6(0x185):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1ad)]??'';break;case _0x1d8ac6(0x1a5):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x253)]??'';break;case _0x1d8ac6(0x166):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x1c0)];break;case _0x1d8ac6(0x1d4):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x236)]==0x1?'SI':'NO';break;case _0x1d8ac6(0x1f1):_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x15f)]??'';break;case'Stock\x20Mínimo':_0x2d88d7[_0x1f1bc6]=_0x18c8c7[_0x1d8ac6(0x20d)]??'';break;case _0x1d8ac6(0x1b5):_0x2d88d7[_0x1f1bc6]=_0x18c8c7['setBatchExpirationDate']??'';break;default:_0x2d88d7[_0x1f1bc6]='';}}),_0x2d88d7;}),_0x33fb2f=0x3e8,_0x3e5de6=_0x3c2837['length'];for(let _0x59ad90=0x0;_0x59ad90<_0x3e5de6;_0x59ad90+=_0x33fb2f){const _0x2344df=_0x3c2837['slice'](_0x59ad90,_0x59ad90+_0x33fb2f);XLSX[_0xe52752(0x1a6)][_0xe52752(0x174)](_0x41b1c9,_0x2344df,{'origin':{'r':_0x59ad90+0x2,'c':0x0},'skipHeader':!![],'header':_0x47c78e}),postMessage({'type':'progress','payload':{'percent':Math['round']((_0x59ad90+_0x2344df[_0xe52752(0x258)])/_0x3e5de6*0x64),'message':'Exportando\x20filas\x20'+(_0x59ad90+0x1)+'–'+(_0x59ad90+_0x2344df[_0xe52752(0x258)])+_0xe52752(0x16c)+_0x3e5de6}});}const _0x2ee613={'s':{'r':0x0,'c':0x0},'e':{'r':_0x3e5de6+0x1,'c':_0x47c78e[_0xe52752(0x258)]-0x1}};_0x41b1c9[_0xe52752(0x237)]=XLSX[_0xe52752(0x1a6)][_0xe52752(0x1fc)](_0x2ee613);const _0x25576e=XLSX['write'](_0x44924f,{'bookType':'xlsx','type':_0xe52752(0x1ff)});let _0x13a6a9,_0x53469d;if(_0x25576e instanceof Uint8Array)_0x13a6a9=_0x25576e,_0x53469d=[_0x25576e['buffer']];else{if(_0x25576e instanceof ArrayBuffer)_0x13a6a9=new Uint8Array(_0x25576e),_0x53469d=[_0x25576e];else{const _0x2fe84b=new Uint8Array(_0x25576e);_0x13a6a9=_0x2fe84b,_0x53469d=[_0x2fe84b[_0xe52752(0x215)]];}}postMessage({'type':_0xe52752(0x201),'payload':{'wbout':_0x13a6a9,'count':_0x3c2837[_0xe52752(0x258)]}},_0x53469d);}catch(_0x22bd8f){postMessage({'type':_0xe52752(0x178),'payload':_0x22bd8f['message']||String(_0x22bd8f)});}return;}};