/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.1.8
*/

const _0x479b4c=_0x1fd0;(function(_0x575d60,_0x10ccfc){const _0x4a558b=_0x1fd0,_0x7a8674=_0x575d60();while(!![]){try{const _0x210e48=-parseInt(_0x4a558b(0x281))/0x1*(-parseInt(_0x4a558b(0x257))/0x2)+-parseInt(_0x4a558b(0x24d))/0x3*(parseInt(_0x4a558b(0x253))/0x4)+parseInt(_0x4a558b(0x293))/0x5+parseInt(_0x4a558b(0x235))/0x6+-parseInt(_0x4a558b(0x1cc))/0x7*(-parseInt(_0x4a558b(0x1c0))/0x8)+parseInt(_0x4a558b(0x23d))/0x9+-parseInt(_0x4a558b(0x296))/0xa*(parseInt(_0x4a558b(0x282))/0xb);if(_0x210e48===_0x10ccfc)break;else _0x7a8674['push'](_0x7a8674['shift']());}catch(_0x19c6cf){_0x7a8674['push'](_0x7a8674['shift']());}}}(_0x43ff,0x6789b));const _0x39d9c0=(function(){let _0x448463=!![];return function(_0x243772,_0x68d5d){const _0x54d30c=_0x448463?function(){const _0x4b19fd=_0x1fd0;if(_0x68d5d){const _0x417677=_0x68d5d[_0x4b19fd(0x1f3)](_0x243772,arguments);return _0x68d5d=null,_0x417677;}}:function(){};return _0x448463=![],_0x54d30c;};}()),_0x581489=_0x39d9c0(this,function(){const _0x5c8cd7=_0x1fd0;return _0x581489[_0x5c8cd7(0x215)]()[_0x5c8cd7(0x231)](_0x5c8cd7(0x29c))[_0x5c8cd7(0x215)]()[_0x5c8cd7(0x20a)](_0x581489)[_0x5c8cd7(0x231)](_0x5c8cd7(0x29c));});function _0x43ff(){const _0x197abc=['KILOMETRO','Equivalencia\x203','ID\x20UNIT\x202','length','setItemVariantValues','setInventariable','BOTELLAS','QUINTAL','El\x20archivo\x20tiene\x20','DZN','Tipo*','PIES\x20CUADRADOS','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','MTR','CONOS','setItemBarCode','write','setUnidadEquivalencia3','GLI','setUnidadCodigo','constructor','Se\x20Compra','prototype','PIEZAS','Precio\x20Venta\x20Soles\x202','FOT','SSF','console','round','Comisión\x20Venta\x20(%)','Impuesto*','toString','USD_setMtoPrecioUnitario3','DOCENA','Comisión\x20Venta\x203\x20(%)','sheet_add_json','C62','GRM','BOLSA','code','Lote','SACO','setItemUnitAlias2','LEF','Modelo\x20de\x20Manga','progress','Material','toLowerCase','MILIMETRO\x20CUADRADO','BARRILES','PEN_setMtoPrecioCostoUnitario2','MWH','CENTIMETRO\x20LINEAL','GLL','Alias\x203','slice','Unidad\x20de\x20Medida\x203','DZP','KIT','search','isArray','MILLON\x20DE\x20UNIDADES','setItemDescription','735234cntKuK','exportDone','YARDA','Color','METRO\x20CUADRADO','CARTONES','PIES\x20CUBICOS','Exonerado\x20Gratuito\x20(0%)','4009770LJkkIY','HECTOLITRO','USD_setMtoPrecioCostoUnitario2','TNE','Precio\x20Costo\x20Dólares','Gravado\x20Gratuito\x20(10%)','NIU','Alias\x202','{}.constructor(\x22return\x20this\x22)(\x20)','JUEGO','DOCENA\x20POR\x2010**6','Código\x20SKU*','Precio\x20Venta\x20Soles','Unidad\x20de\x20Medida*','MGM','Fecha\x20de\x20Vencimiento','9UFykpc','done','table','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','bind','Precio\x20Venta\x20Soles\x203','176208SmwUmK','CAJA','Stock\x20Actual','TUBOS','890vsFOZX','setUnidadCodigo3','MTK','US\x20GALON\x20(3,7843\x20L)','MILILITRO','MILIGRAMOS','setItemBarCode3','GRO','UND\x20(NIU)','decode_range','BALDE','findIndex','MMT','CILINDRO','error','setUnitId','Gravado\x20(10%)','Exonerado\x20(0%)','\x20de\x20','Precio\x20Costo\x20Soles','TAMBOR','info','ONZ','Alias','Equivalencia\x202','PEN_setMtoPrecioCostoUnitario','setItemUnitAlias','KILOGRAMO','Marca','reduce','keys','YDK','push','PAR','Sheets','Iniciando\x20parseo…','setItemBarCode2','forEach','RESMA','LATAS','setCategoria','LTN','815Ljdzec','303490QjltvZ','map','Gravado\x20Gratuito\x20(18%)','log','utils','TONELADA\x20LARGA','Código\x20de\x20Barras\x202','Precio\x20Costo\x20Soles\x202','GRUESA','YRD','Categoría','LITRO','Comisión\x20Venta\x202\x20(%)','MTQ','padStart','Precio\x20Venta\x20Dólares','Combo','1201515ybRChg','FTQ','setUnitId2','300abafYA','Precio\x20Costo\x20Dólares\x202','YARDA\x20CUADRADA','Código\x20de\x20Barras\x203','UNIDAD\x20(ZZ)','ONZAS','(((.+)+)+)+$','setCodProducto','MILIMETRO\x20CUBICO','PALETAS','Precio\x20Venta\x20Dólares\x202','MEGAWATT\x20HORA','setSucursalStock','return\x20(function()\x20','Código\x20de\x20Barras','setUnitId3','KTM','Precio\x20Costo\x20Dólares\x203','sheet_to_json','message','array','USD_setMtoPrecioUnitario','TONELADA\x20CORTA','Descripción','MMK','Materia\x20Prima','Exportación\x20(0%)','Rastrear\x20Inventario','STN','BOBINAS','PIES','Modelo','PEN_setMtoPrecioUnitario2','!ref','Género','UNIDAD\x20(NIU)','40KsPkvW','TONELADAS','MMQ','METRO','Inafecto\x20(0%)','MILLARES','PEN_setMtoPrecioUnitario3','Stock\x20Mínimo','exportItems','Artículo','INH','PLACAS','298060ljkhpM','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','METRO\x20CUBICO','CENTIMETRO\x20CUADRADO','LIBRAS','KWH','GALON\x20INGLES\x20(4,545956L)','HLT','setItemCommissionPercentage3','exception','encode_cell','some','Inafecto\x20Gratuito\x20(0%)','read','setUnidadCodigo2','Precio\x20Venta\x20Dólares\x203','Talla','Unidad\x20de\x20Medida\x202','Gravado\x20(18%)','import','BLL','PULGADAS','CIENTO\x20DE\x20UNIDADES','Exportando\x20filas\x20','SheetNames','FTK','setItemIsBought','SET','setUnidadEquivalencia2','PAQUETE','ID\x20UNIT\x203','Serie','Modelo\x20de\x20Cuello','KILOVATIO\x20HORA','Precio\x20Costo\x20Soles\x203','Se\x20Vende','FARDO','HOJA','Nombre*','apply','trim','GRAMO'];_0x43ff=function(){return _0x197abc;};return _0x43ff();}function _0x1fd0(_0xe7488b,_0x1cb71c){const _0x574aae=_0x43ff();return _0x1fd0=function(_0x37d4eb,_0x35c11e){_0x37d4eb=_0x37d4eb-0x1ab;let _0x26e8e3=_0x574aae[_0x37d4eb];return _0x26e8e3;},_0x1fd0(_0xe7488b,_0x1cb71c);}_0x581489();const _0x35c11e=(function(){let _0x3d9bfb=!![];return function(_0xd1f08d,_0x157cc9){const _0x276976=_0x3d9bfb?function(){const _0x2ba6d5=_0x1fd0;if(_0x157cc9){const _0x182604=_0x157cc9[_0x2ba6d5(0x1f3)](_0xd1f08d,arguments);return _0x157cc9=null,_0x182604;}}:function(){};return _0x3d9bfb=![],_0x276976;};}()),_0x37d4eb=_0x35c11e(this,function(){const _0x13f300=_0x1fd0;let _0x480651;try{const _0x38e9c1=Function(_0x13f300(0x2a3)+_0x13f300(0x245)+');');_0x480651=_0x38e9c1();}catch(_0x19df0d){_0x480651=window;}const _0x3b8d16=_0x480651[_0x13f300(0x211)]=_0x480651[_0x13f300(0x211)]||{},_0x5ce02a=[_0x13f300(0x285),'warn',_0x13f300(0x26c),_0x13f300(0x265),_0x13f300(0x1d5),_0x13f300(0x24f),'trace'];for(let _0x4abf4c=0x0;_0x4abf4c<_0x5ce02a['length'];_0x4abf4c++){const _0x583533=_0x35c11e[_0x13f300(0x20a)][_0x13f300(0x20c)]['bind'](_0x35c11e),_0x21f147=_0x5ce02a[_0x4abf4c],_0x180aae=_0x3b8d16[_0x21f147]||_0x583533;_0x583533['__proto__']=_0x35c11e[_0x13f300(0x251)](_0x35c11e),_0x583533[_0x13f300(0x215)]=_0x180aae[_0x13f300(0x215)]['bind'](_0x180aae),_0x3b8d16[_0x21f147]=_0x583533;}});_0x37d4eb(),importScripts(_0x479b4c(0x250)),onmessage=({data:_0x37b664})=>{const _0x419d28=_0x479b4c,{action:_0x57312f}=_0x37b664;if(_0x57312f===_0x419d28(0x1df)){const {buf:_0x1853a2,maxRows:_0x2e5e77}=_0x37b664;try{postMessage({'type':_0x419d28(0x223),'payload':{'percent':0x5,'message':_0x419d28(0x27a)}});const _0xbd1603=XLSX[_0x419d28(0x1d9)](_0x1853a2,{'type':_0x419d28(0x1b0),'cellDates':!![]}),_0x3391b6=_0xbd1603['Sheets'][_0xbd1603[_0x419d28(0x1e4)][0x0]],_0x32c504=XLSX[_0x419d28(0x286)][_0x419d28(0x1ae)](_0x3391b6,{'defval':'','range':0x1,'cellDates':!![]}),_0x506ec5=_0x32c504[_0x419d28(0x262)](_0x520595=>(!_0x520595['Tipo*']||String(_0x520595[_0x419d28(0x200)])[_0x419d28(0x1f4)]()==='')&&(!_0x520595[_0x419d28(0x248)]||String(_0x520595[_0x419d28(0x248)])[_0x419d28(0x1f4)]()==='')&&(!_0x520595[_0x419d28(0x1f2)]||String(_0x520595['Nombre*'])[_0x419d28(0x1f4)]()==='')&&(!_0x520595['Unidad\x20de\x20Medida*']||String(_0x520595['Unidad\x20de\x20Medida*'])[_0x419d28(0x1f4)]()==='')),_0x214796=_0x506ec5>=0x0?_0x32c504['slice'](0x0,_0x506ec5):_0x32c504,_0x57843e=_0x214796['filter'](_0x2ee137=>_0x2ee137['Tipo*']&&String(_0x2ee137['Tipo*'])[_0x419d28(0x1f4)]()!==''&&_0x2ee137['Código\x20SKU*']&&String(_0x2ee137['Código\x20SKU*'])[_0x419d28(0x1f4)]()!==''&&_0x2ee137[_0x419d28(0x1f2)]&&String(_0x2ee137[_0x419d28(0x1f2)])['trim']()!==''&&_0x2ee137[_0x419d28(0x24a)]&&String(_0x2ee137[_0x419d28(0x24a)])[_0x419d28(0x1f4)]()!==''),_0x5e2c2d=_0x57843e[_0x419d28(0x1f9)];if(_0x5e2c2d===0x0){postMessage({'type':_0x419d28(0x265),'payload':_0x419d28(0x202)});return;}if(_0x5e2c2d>_0x2e5e77)throw _0x419d28(0x1fe)+_0x5e2c2d+_0x419d28(0x1cd)+_0x2e5e77+'.';const _0x1623de=0x1f4,_0x44a9be=[],_0x22b13b=[{'codigo':'4A','nombre':'BOBINAS'},{'codigo':'BJ','nombre':_0x419d28(0x261)},{'codigo':_0x419d28(0x1e0),'nombre':_0x419d28(0x227)},{'codigo':'BG','nombre':_0x419d28(0x21c)},{'codigo':'BO','nombre':_0x419d28(0x1fc)},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':_0x419d28(0x23a)},{'codigo':'CMK','nombre':_0x419d28(0x1cf)},{'codigo':'CMQ','nombre':'CENTIMETRO\x20CUBICO'},{'codigo':'CMT','nombre':_0x419d28(0x22a)},{'codigo':'CEN','nombre':_0x419d28(0x1e2)},{'codigo':'CY','nombre':_0x419d28(0x264)},{'codigo':'CJ','nombre':'CONOS'},{'codigo':_0x419d28(0x1ff),'nombre':_0x419d28(0x217)},{'codigo':_0x419d28(0x22f),'nombre':_0x419d28(0x247)},{'codigo':'BE','nombre':_0x419d28(0x1f0)},{'codigo':_0x419d28(0x208),'nombre':_0x419d28(0x1d2)},{'codigo':_0x419d28(0x21b),'nombre':_0x419d28(0x1f5)},{'codigo':_0x419d28(0x25e),'nombre':_0x419d28(0x28a)},{'codigo':_0x419d28(0x1d3),'nombre':_0x419d28(0x23e)},{'codigo':_0x419d28(0x221),'nombre':_0x419d28(0x1f1)},{'codigo':_0x419d28(0x1e7),'nombre':'JUEGO'},{'codigo':'KGM','nombre':_0x419d28(0x272)},{'codigo':_0x419d28(0x1ac),'nombre':'KILOMETRO'},{'codigo':_0x419d28(0x1d1),'nombre':_0x419d28(0x1ed)},{'codigo':'KT','nombre':_0x419d28(0x230)},{'codigo':'CA','nombre':_0x419d28(0x27e)},{'codigo':'LBR','nombre':_0x419d28(0x1d0)},{'codigo':'LTR','nombre':_0x419d28(0x28d)},{'codigo':_0x419d28(0x229),'nombre':_0x419d28(0x2a1)},{'codigo':_0x419d28(0x203),'nombre':_0x419d28(0x1c3)},{'codigo':_0x419d28(0x259),'nombre':'METRO\x20CUADRADO'},{'codigo':_0x419d28(0x28f),'nombre':_0x419d28(0x1ce)},{'codigo':_0x419d28(0x24b),'nombre':_0x419d28(0x25c)},{'codigo':'MLT','nombre':_0x419d28(0x25b)},{'codigo':_0x419d28(0x263),'nombre':'MILIMETRO'},{'codigo':_0x419d28(0x1b4),'nombre':_0x419d28(0x226)},{'codigo':_0x419d28(0x1c2),'nombre':_0x419d28(0x29e)},{'codigo':'MIL','nombre':_0x419d28(0x1c5)},{'codigo':'UM','nombre':_0x419d28(0x233)},{'codigo':_0x419d28(0x26d),'nombre':_0x419d28(0x29b)},{'codigo':'PF','nombre':_0x419d28(0x29f)},{'codigo':'PK','nombre':_0x419d28(0x1e9)},{'codigo':'PR','nombre':_0x419d28(0x278)},{'codigo':_0x419d28(0x20f),'nombre':_0x419d28(0x1ba)},{'codigo':_0x419d28(0x1e5),'nombre':_0x419d28(0x201)},{'codigo':_0x419d28(0x294),'nombre':_0x419d28(0x23b)},{'codigo':_0x419d28(0x21a),'nombre':_0x419d28(0x20d)},{'codigo':'PG','nombre':_0x419d28(0x1cb)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':_0x419d28(0x1ca),'nombre':_0x419d28(0x1e1)},{'codigo':'RM','nombre':_0x419d28(0x27d)},{'codigo':'SA','nombre':_0x419d28(0x21f)},{'codigo':'DR','nombre':_0x419d28(0x26b)},{'codigo':_0x419d28(0x1b8),'nombre':_0x419d28(0x1b2)},{'codigo':_0x419d28(0x280),'nombre':_0x419d28(0x287)},{'codigo':_0x419d28(0x240),'nombre':_0x419d28(0x1c1)},{'codigo':'TU','nombre':_0x419d28(0x256)},{'codigo':_0x419d28(0x243),'nombre':_0x419d28(0x1bf)},{'codigo':'ZZ','nombre':_0x419d28(0x29a)},{'codigo':_0x419d28(0x22b),'nombre':_0x419d28(0x25a)},{'codigo':_0x419d28(0x28b),'nombre':_0x419d28(0x237)},{'codigo':_0x419d28(0x276),'nombre':'YARDA\x20CUADRADA'},{'codigo':'QQM','nombre':_0x419d28(0x1fd)}],_0xc103e8=_0x22b13b[_0x419d28(0x274)]((_0xd19514,{nombre:_0x2cb7fb,codigo:_0xdb21df})=>{const _0x307168=_0x419d28;return _0xd19514[_0x2cb7fb['trim']()]=_0xdb21df[_0x307168(0x1f4)](),_0xd19514;},{});for(let _0x26402f=0x0;_0x26402f<_0x5e2c2d;_0x26402f+=_0x1623de){const _0xe73191=_0x57843e[_0x419d28(0x22d)](_0x26402f,_0x26402f+_0x1623de)['map']((_0x585a51,_0x47f499)=>{const _0x476bcc=_0x419d28;let _0x18885d={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x585a51[_0x476bcc(0x200)]]||'1';const _0x2e8588=String(_0x585a51['Impuesto*'])[_0x476bcc(0x1f4)](),_0x20d361={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x265b8f=_0x20d361[_0x2e8588]||'1',_0x208351={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x265b8f]||{'code':'10','value':0x12},_0x307134={};let _0x2a6fe2=String(_0x585a51[_0x476bcc(0x1f2)])[_0x476bcc(0x1f4)]();const _0x22fac5=[_0x476bcc(0x21e),_0x476bcc(0x1dc),_0x476bcc(0x238),_0x476bcc(0x1be),_0x476bcc(0x1bb),_0x476bcc(0x1eb),_0x476bcc(0x224),_0x476bcc(0x1ec),_0x476bcc(0x222)];_0x22fac5[_0x476bcc(0x27c)](_0x13e372=>{const _0x220677=_0x476bcc,_0x173bd1=String(_0x585a51[_0x13e372]||'')[_0x220677(0x1f4)]();_0x173bd1&&(_0x307134[_0x13e372]=_0x173bd1,_0x2a6fe2+='\x20'+_0x13e372+'\x20'+_0x173bd1);});const _0x160d49=[],_0x22fdbf=String(_0x585a51[_0x476bcc(0x24a)]||_0x476bcc(0x1bf))['trim'](),_0x180da2=_0xc103e8[_0x22fdbf]||'NIU',_0x1fcfa2=String(_0x585a51[_0x476bcc(0x26e)])[_0x476bcc(0x1f4)]();_0x160d49[_0x476bcc(0x277)]({'setItemUnitId':String(_0x585a51['ID\x20UNIT'])[_0x476bcc(0x1f4)]()||'','setItemBarCode':String(_0x585a51[_0x476bcc(0x2a4)])[_0x476bcc(0x1f4)]()||'','setAlias':_0x1fcfa2,'setUnitCode':_0x180da2,'setPrice':parseFloat(_0x585a51[_0x476bcc(0x249)]),'setCost':parseFloat(_0x585a51[_0x476bcc(0x26a)]),'setPriceUSD':parseFloat(_0x585a51['Precio\x20Venta\x20Dólares']),'setCostUSD':parseFloat(_0x585a51[_0x476bcc(0x241)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x585a51[_0x476bcc(0x213)])});const _0x30124d=['ID\x20UNIT\x202',_0x476bcc(0x244),_0x476bcc(0x288),_0x476bcc(0x26f),_0x476bcc(0x20e),'Precio\x20Costo\x20Soles\x202',_0x476bcc(0x2a0),_0x476bcc(0x297)][_0x476bcc(0x1d7)](_0x4c18de=>{const _0x5e47ac=_0x476bcc,_0x5a4951=_0x585a51[_0x4c18de];return _0x5a4951!=null&&String(_0x5a4951)[_0x5e47ac(0x1f4)]()!=='';});if(_0x30124d){const _0x45865d=String(_0x585a51['Unidad\x20de\x20Medida\x202']||_0x476bcc(0x25f))[_0x476bcc(0x1f4)](),_0x51f0ad=_0xc103e8[_0x45865d]||'NIU';_0x160d49[_0x476bcc(0x277)]({'setItemUnitId':String(_0x585a51[_0x476bcc(0x1f8)])['trim']()||'','setItemBarCode':String(_0x585a51[_0x476bcc(0x288)])[_0x476bcc(0x1f4)]()||'','setAlias':String(_0x585a51[_0x476bcc(0x244)])['trim'](),'setUnitCode':_0x51f0ad,'setPrice':parseFloat(_0x585a51[_0x476bcc(0x20e)]),'setCost':parseFloat(_0x585a51[_0x476bcc(0x289)]),'setPriceUSD':parseFloat(_0x585a51[_0x476bcc(0x2a0)]),'setCostUSD':parseFloat(_0x585a51[_0x476bcc(0x297)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x585a51[_0x476bcc(0x26f)])||0x1,'setFactor':parseFloat(_0x585a51[_0x476bcc(0x26f)])||0x1,'setItemCommissionPercentage':parseFloat(_0x585a51[_0x476bcc(0x28e)])});}const _0x2ac730=[_0x476bcc(0x1ea),'Alias\x203',_0x476bcc(0x299),_0x476bcc(0x1f7),'Precio\x20Venta\x20Soles\x203',_0x476bcc(0x1ee),_0x476bcc(0x1db),_0x476bcc(0x1ad)]['some'](_0x26d7d2=>{const _0x2c5a3=_0x585a51[_0x26d7d2];return _0x2c5a3!=null&&String(_0x2c5a3)['trim']()!=='';});if(_0x2ac730){const _0x5b2288=String(_0x585a51[_0x476bcc(0x22e)]||_0x476bcc(0x25f))[_0x476bcc(0x1f4)](),_0x44fee9=_0xc103e8[_0x5b2288]||_0x476bcc(0x243);_0x160d49['push']({'setItemUnitId':String(_0x585a51[_0x476bcc(0x1ea)])[_0x476bcc(0x1f4)]()||'','setItemBarCode':String(_0x585a51[_0x476bcc(0x299)])[_0x476bcc(0x1f4)]()||'','setAlias':String(_0x585a51[_0x476bcc(0x22c)])['trim'](),'setUnitCode':_0x44fee9,'setPrice':parseFloat(_0x585a51['Precio\x20Venta\x20Soles\x203']),'setCost':parseFloat(_0x585a51[_0x476bcc(0x1ee)]),'setPriceUSD':parseFloat(_0x585a51['Precio\x20Venta\x20Dólares\x203']),'setCostUSD':parseFloat(_0x585a51['Precio\x20Costo\x20Dólares\x203']),'setDefault':0x0,'setEquivalence':parseFloat(_0x585a51[_0x476bcc(0x1f7)])||0x1,'setFactor':parseFloat(_0x585a51['Equivalencia\x203'])||0x1,'setItemCommissionPercentage':parseFloat(_0x585a51[_0x476bcc(0x218)])});}let _0x43fa28=_0x585a51['Fecha\x20de\x20Vencimiento'],_0x142b96='';if(_0x43fa28 instanceof Date){const _0x4ad6ae=_0x43fa28['getFullYear'](),_0x2d600c=String(_0x43fa28['getMonth']()+0x1)[_0x476bcc(0x290)](0x2,'0'),_0x238a0e=String(_0x43fa28['getDate']())[_0x476bcc(0x290)](0x2,'0');_0x142b96=_0x4ad6ae+'-'+_0x2d600c+'-'+_0x238a0e;}else{if(typeof _0x43fa28==='number'){const _0x15f1c2=XLSX[_0x476bcc(0x210)]['parse_date_code'](_0x43fa28);if(_0x15f1c2){const _0x21131c=_0x15f1c2['y'],_0x44fb6c=String(_0x15f1c2['m'])['padStart'](0x2,'0'),_0x5055f8=String(_0x15f1c2['d'])[_0x476bcc(0x290)](0x2,'0');_0x142b96=_0x21131c+'-'+_0x44fb6c+'-'+_0x5055f8;}}else _0x142b96=String(_0x43fa28||'')[_0x476bcc(0x1f4)]();}return{'setItemId':String(_0x585a51['ID'])[_0x476bcc(0x1f4)](),'setItemType':_0x18885d,'setItemCode':String(_0x585a51[_0x476bcc(0x248)])[_0x476bcc(0x1f4)](),'setItemName':String(_0x585a51[_0x476bcc(0x1f2)])[_0x476bcc(0x1f4)](),'setItemDescription':String(_0x585a51[_0x476bcc(0x1b3)])[_0x476bcc(0x1f4)]()||'','setItemIsSold':_0x585a51[_0x476bcc(0x1ef)]=='SI'?0x1:0x0,'setItemIsBought':_0x585a51[_0x476bcc(0x20b)]=='SI'?0x1:0x0,'setItemCategories':_0x585a51[_0x476bcc(0x28c)]?[String(_0x585a51[_0x476bcc(0x28c)])['trim']()]:[],'setItemBrands':_0x585a51[_0x476bcc(0x273)]?[String(_0x585a51[_0x476bcc(0x273)])['trim']()]:[],'setItemTaxId':_0x265b8f,'setItemTaxCode':_0x208351[_0x476bcc(0x21d)],'setItemTaxValue':_0x208351['value'],'setItemUnits':_0x160d49,'setItemInventoriable':_0x585a51[_0x476bcc(0x1b7)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x585a51['Stock\x20Actual'])||0x0,'setStockMinimum':parseFloat(_0x585a51[_0x476bcc(0x1c7)])||0x0,'setItemLocation':String(_0x585a51['Ubicación'])[_0x476bcc(0x1f4)]()||'','setBatchName':String(_0x585a51[_0x476bcc(0x21e)])['trim']()||'','setItemDateExpiry':_0x142b96,'setItemVariantName':_0x2a6fe2,'setItemVariantValues':_0x307134,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x44a9be['push'](..._0xe73191),postMessage({'type':_0x419d28(0x223),'payload':{'percent':Math[_0x419d28(0x212)]((_0x26402f+_0xe73191[_0x419d28(0x1f9)])/_0x5e2c2d*0x64),'message':'Procesadas\x20filas\x20'+(_0x26402f+0x1)+'–'+(_0x26402f+_0xe73191[_0x419d28(0x1f9)])+'/'+_0x5e2c2d}});}postMessage({'type':_0x419d28(0x24e),'payload':{'items':_0x44a9be}});}catch(_0x4b787b){postMessage({'type':_0x419d28(0x265),'payload':_0x4b787b[_0x419d28(0x1af)]||_0x4b787b});}}if(_0x57312f===_0x419d28(0x1c8)){const {products:_0x234e19,plantillaBuf:_0x1846be}=_0x37b664;if(!(_0x1846be instanceof ArrayBuffer)){postMessage({'type':_0x419d28(0x265),'payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array[_0x419d28(0x232)](_0x234e19)){postMessage({'type':'error','payload':'exportItems:\x20products\x20no\x20es\x20Array.'});return;}try{structuredClone(_0x234e19);}catch(_0x4386e3){postMessage({'type':_0x419d28(0x265),'payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x4386e3[_0x419d28(0x1af)]});return;}try{const _0x54e4d2={'1':_0x419d28(0x1c9),'2':'Servicio','3':_0x419d28(0x1b5),'4':_0x419d28(0x292),'5':'Fabricado'};function _0x1e1532(_0x590255){const _0x17103c=_0x419d28;return _0x54e4d2[String(_0x590255)]||_0x17103c(0x1c9);}const _0x408458={'1':'Gravado\x20(18%)','2':_0x419d28(0x268),'3':_0x419d28(0x1c4),'4':_0x419d28(0x284),'5':_0x419d28(0x1d8),'6':_0x419d28(0x267),'7':_0x419d28(0x23c),'8':_0x419d28(0x1b6),'9':_0x419d28(0x242)};function _0xc459(_0x302043){const _0x11f79a=_0x419d28;return _0x408458[String(_0x302043)]||_0x11f79a(0x1de);}const _0x305d0f={'4A':_0x419d28(0x1b9),'BJ':_0x419d28(0x261),'BLL':_0x419d28(0x227),'BG':'BOLSA','BO':_0x419d28(0x1fc),'BX':_0x419d28(0x254),'CT':_0x419d28(0x23a),'CMK':'CENTIMETRO\x20CUADRADO','CMQ':'CENTIMETRO\x20CUBICO','CMT':_0x419d28(0x22a),'CEN':'CIENTO\x20DE\x20UNIDADES','CY':_0x419d28(0x264),'CJ':_0x419d28(0x204),'DZN':'DOCENA','DZP':_0x419d28(0x247),'BE':_0x419d28(0x1f0),'GLI':'GALON\x20INGLES\x20(4,545956L)','GRM':'GRAMO','GRO':_0x419d28(0x28a),'HLT':'HECTOLITRO','LEF':_0x419d28(0x1f1),'SET':_0x419d28(0x246),'KGM':_0x419d28(0x272),'KTM':_0x419d28(0x1f6),'KWH':'KILOVATIO\x20HORA','KT':'KIT','CA':_0x419d28(0x27e),'LBR':_0x419d28(0x1d0),'LTR':'LITRO','MWH':_0x419d28(0x2a1),'MTR':_0x419d28(0x1c3),'MTK':_0x419d28(0x239),'MTQ':_0x419d28(0x1ce),'MGM':_0x419d28(0x25c),'MLT':_0x419d28(0x25b),'MMT':'MILIMETRO','MMK':'MILIMETRO\x20CUADRADO','MMQ':'MILIMETRO\x20CUBICO','MIL':_0x419d28(0x1c5),'UM':_0x419d28(0x233),'ONZ':'ONZAS','PF':_0x419d28(0x29f),'PK':_0x419d28(0x1e9),'PR':_0x419d28(0x278),'FOT':'PIES','FTK':_0x419d28(0x201),'FTQ':'PIES\x20CUBICOS','C62':'PIEZAS','PG':'PLACAS','ST':'PLIEGO','INH':_0x419d28(0x1e1),'RM':_0x419d28(0x27d),'SA':_0x419d28(0x21f),'DR':_0x419d28(0x26b),'STN':'TONELADA\x20CORTA','LTN':'TONELADA\x20LARGA','TNE':'TONELADAS','TU':_0x419d28(0x256),'NIU':'UNIDAD\x20(NIU)','ZZ':_0x419d28(0x29a),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':'YARDA','YDK':_0x419d28(0x298),'QQM':_0x419d28(0x1fd)};function _0x19fba7(_0x1e229c){return _0x305d0f[String(_0x1e229c)]||'';}const _0x2a2dbf=XLSX[_0x419d28(0x1d9)](_0x1846be,{'type':'array','cellDates':!![]}),_0x590ca2=_0x2a2dbf[_0x419d28(0x1e4)][0x0],_0x2b95e8=_0x2a2dbf[_0x419d28(0x279)][_0x590ca2],_0x4c4490=XLSX[_0x419d28(0x286)][_0x419d28(0x1ae)](_0x2b95e8,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x361a53=XLSX[_0x419d28(0x286)][_0x419d28(0x260)](_0x2b95e8[_0x419d28(0x1bd)]||'');for(let _0x3866f1=0x2;_0x3866f1<=_0x361a53['e']['r'];++_0x3866f1){for(let _0x4cb90d=_0x361a53['s']['c'];_0x4cb90d<=_0x361a53['e']['c'];++_0x4cb90d){const _0x42d9f8=XLSX[_0x419d28(0x286)][_0x419d28(0x1d6)]({'r':_0x3866f1,'c':_0x4cb90d});if(_0x2b95e8[_0x42d9f8])delete _0x2b95e8[_0x42d9f8];}}const _0x396dd7=_0x234e19[_0x419d28(0x283)](_0x305cce=>{const _0x1a9b3f=_0x419d28;_0x305cce[_0x1a9b3f(0x1fa)]=_0x305cce[_0x1a9b3f(0x1fa)]||{};const _0x84dee0={};return _0x4c4490[_0x1a9b3f(0x27c)](_0x2d1549=>{const _0x211cdf=_0x1a9b3f,_0x4762c3=String(_0x2d1549)[_0x211cdf(0x1f4)](),_0x531970=_0x4762c3['toLowerCase'](),_0x90633c=Object[_0x211cdf(0x275)](_0x305cce)['find'](_0x1a1959=>_0x1a1959[_0x211cdf(0x1f4)]()[_0x211cdf(0x225)]()===_0x531970);if(_0x90633c){_0x84dee0[_0x4762c3]=_0x305cce[_0x90633c]??'';return;}switch(_0x4762c3){case'ID':_0x84dee0[_0x4762c3]=_0x305cce['id']??'';break;case _0x211cdf(0x200):_0x84dee0[_0x4762c3]=_0x1e1532(_0x305cce['setItemType']);break;case _0x211cdf(0x248):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x29d)]??'';break;case'Nombre*':_0x84dee0[_0x4762c3]=_0x305cce['setDescripcion']??'';break;case _0x211cdf(0x1b3):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x234)]??'';break;case _0x211cdf(0x1ef):_0x84dee0[_0x4762c3]=_0x305cce['setItemIsSold']==0x1?'SI':'NO';break;case'Se\x20Compra':_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x1e6)]==0x1?'SI':'NO';break;case _0x211cdf(0x28c):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x27f)]??'';break;case'Marca':_0x84dee0[_0x4762c3]=_0x305cce['setMarca']??'';break;case _0x211cdf(0x214):_0x84dee0[_0x4762c3]=_0xc459(_0x305cce['setTaxId']);break;case'ID\x20UNIT':_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x266)]??'';break;case _0x211cdf(0x26e):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x271)]??'';break;case'Código\x20de\x20Barras':_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x205)]??'';break;case'Unidad\x20de\x20Medida*':_0x84dee0[_0x4762c3]=_0x19fba7(_0x305cce[_0x211cdf(0x209)]);break;case _0x211cdf(0x249):_0x84dee0[_0x4762c3]=_0x305cce['PEN_setMtoPrecioUnitario']??'';break;case _0x211cdf(0x26a):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x270)]??'';break;case _0x211cdf(0x291):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x1b1)]??'';break;case _0x211cdf(0x241):_0x84dee0[_0x4762c3]=_0x305cce['USD_setMtoPrecioCostoUnitario']??'';break;case _0x211cdf(0x213):_0x84dee0[_0x4762c3]=_0x305cce['setItemCommissionPercentage'];break;case _0x211cdf(0x1f8):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x295)]??'';break;case _0x211cdf(0x244):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x220)]??'';break;case _0x211cdf(0x288):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x27b)]??'';break;case _0x211cdf(0x1dd):_0x84dee0[_0x4762c3]=_0x19fba7(_0x305cce[_0x211cdf(0x1da)]);break;case _0x211cdf(0x26f):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x1e8)]??'1';break;case'Precio\x20Venta\x20Soles\x202':_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x1bc)]??'';break;case _0x211cdf(0x289):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x228)]??'';break;case _0x211cdf(0x2a0):_0x84dee0[_0x4762c3]=_0x305cce['USD_setMtoPrecioUnitario2']??'';break;case _0x211cdf(0x297):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x23f)]??'';break;case'Comisión\x20Venta\x202\x20(%)':_0x84dee0[_0x4762c3]=_0x305cce['setItemCommissionPercentage2'];break;case _0x211cdf(0x1ea):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x1ab)]??'';break;case'Alias\x203':_0x84dee0[_0x4762c3]=_0x305cce['setItemUnitAlias3']??'';break;case _0x211cdf(0x299):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x25d)]??'';break;case _0x211cdf(0x22e):_0x84dee0[_0x4762c3]=_0x19fba7(_0x305cce[_0x211cdf(0x258)]);break;case _0x211cdf(0x1f7):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x207)]??'1';break;case _0x211cdf(0x252):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x1c6)]??'';break;case _0x211cdf(0x1ee):_0x84dee0[_0x4762c3]=_0x305cce['PEN_setMtoPrecioCostoUnitario3']??'';break;case _0x211cdf(0x1db):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x216)]??'';break;case _0x211cdf(0x1ad):_0x84dee0[_0x4762c3]=_0x305cce['USD_setMtoPrecioCostoUnitario3']??'';break;case _0x211cdf(0x218):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x1d4)];break;case _0x211cdf(0x1b7):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x1fb)]==0x1?'SI':'NO';break;case _0x211cdf(0x255):_0x84dee0[_0x4762c3]=_0x305cce[_0x211cdf(0x2a2)]??'';break;case _0x211cdf(0x1c7):_0x84dee0[_0x4762c3]=_0x305cce['setWarehouseStockMin']??'';break;case _0x211cdf(0x24c):_0x84dee0[_0x4762c3]=_0x305cce['setBatchExpirationDate']??'';break;default:_0x84dee0[_0x4762c3]='';}}),_0x84dee0;}),_0x1adb3e=0x3e8,_0x5378ad=_0x396dd7[_0x419d28(0x1f9)];for(let _0x2aaf17=0x0;_0x2aaf17<_0x5378ad;_0x2aaf17+=_0x1adb3e){const _0x35ddaf=_0x396dd7[_0x419d28(0x22d)](_0x2aaf17,_0x2aaf17+_0x1adb3e);XLSX[_0x419d28(0x286)][_0x419d28(0x219)](_0x2b95e8,_0x35ddaf,{'origin':{'r':_0x2aaf17+0x2,'c':0x0},'skipHeader':!![],'header':_0x4c4490}),postMessage({'type':_0x419d28(0x223),'payload':{'percent':Math['round']((_0x2aaf17+_0x35ddaf[_0x419d28(0x1f9)])/_0x5378ad*0x64),'message':_0x419d28(0x1e3)+(_0x2aaf17+0x1)+'–'+(_0x2aaf17+_0x35ddaf[_0x419d28(0x1f9)])+_0x419d28(0x269)+_0x5378ad}});}const _0x26bd96={'s':{'r':0x0,'c':0x0},'e':{'r':_0x5378ad+0x1,'c':_0x4c4490['length']-0x1}};_0x2b95e8['!ref']=XLSX[_0x419d28(0x286)]['encode_range'](_0x26bd96);const _0x28930c=XLSX[_0x419d28(0x206)](_0x2a2dbf,{'bookType':'xlsx','type':'array'});let _0x4bc8ef,_0x6c7a60;if(_0x28930c instanceof Uint8Array)_0x4bc8ef=_0x28930c,_0x6c7a60=[_0x28930c['buffer']];else{if(_0x28930c instanceof ArrayBuffer)_0x4bc8ef=new Uint8Array(_0x28930c),_0x6c7a60=[_0x28930c];else{const _0x12b1a0=new Uint8Array(_0x28930c);_0x4bc8ef=_0x12b1a0,_0x6c7a60=[_0x12b1a0['buffer']];}}postMessage({'type':_0x419d28(0x236),'payload':{'wbout':_0x4bc8ef,'count':_0x396dd7['length']}},_0x6c7a60);}catch(_0x1f031f){postMessage({'type':'error','payload':_0x1f031f[_0x419d28(0x1af)]||String(_0x1f031f)});}return;}};