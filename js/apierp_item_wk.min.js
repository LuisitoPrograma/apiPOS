/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.2.1
*/

(function(_0x47d448,_0x41be3b){const _0x59b525=_0x4a94,_0x26d286=_0x47d448();while(!![]){try{const _0x3cd0f2=-parseInt(_0x59b525(0x2b3))/0x1*(parseInt(_0x59b525(0x1d1))/0x2)+-parseInt(_0x59b525(0x2ca))/0x3*(-parseInt(_0x59b525(0x27b))/0x4)+-parseInt(_0x59b525(0x2b8))/0x5+-parseInt(_0x59b525(0x23b))/0x6+parseInt(_0x59b525(0x23a))/0x7*(parseInt(_0x59b525(0x1d7))/0x8)+-parseInt(_0x59b525(0x221))/0x9+parseInt(_0x59b525(0x1f5))/0xa*(parseInt(_0x59b525(0x263))/0xb);if(_0x3cd0f2===_0x41be3b)break;else _0x26d286['push'](_0x26d286['shift']());}catch(_0x3657b3){_0x26d286['push'](_0x26d286['shift']());}}}(_0x20ea,0x785a6));const _0x1d9d04=(function(){let _0x33c649=!![];return function(_0x14c81a,_0x4270f5){const _0x5b0d7e=_0x33c649?function(){const _0x5af6be=_0x4a94;if(_0x4270f5){const _0x327c3c=_0x4270f5[_0x5af6be(0x28e)](_0x14c81a,arguments);return _0x4270f5=null,_0x327c3c;}}:function(){};return _0x33c649=![],_0x5b0d7e;};}()),_0x38493c=_0x1d9d04(this,function(){const _0x56b97f=_0x4a94;return _0x38493c['toString']()['search'](_0x56b97f(0x1d0))[_0x56b97f(0x1d4)]()['constructor'](_0x38493c)[_0x56b97f(0x20f)](_0x56b97f(0x1d0));});function _0x20ea(){const _0x2717e4=['Fecha\x20de\x20Vencimiento','HOJA','Exportando\x20filas\x20','6828110CyQSMw','MILILITRO','PIES\x20CUADRADOS','forEach','length','TAMBOR','Precio\x20Venta\x20Soles\x203','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','Gravado\x20(18%)','PLIEGO','exportItems','array','Precio\x20Costo\x20Dólares','Descripción','isArray','MGM','PIES','ONZ','Precio\x20Costo\x20Soles','BOTELLAS','Serie','BOLSA','ID\x20UNIT','Exonerado\x20Gratuito\x20(0%)','GRAMO','Precio\x20Costo\x20Dólares\x202','search','Materia\x20Prima','YARDA','TONELADA\x20CORTA','Modelo\x20de\x20Manga','Código\x20de\x20Barras','setItemDescription','DZN','YDK','USD_setMtoPrecioCostoUnitario2','MWH','Código\x20de\x20Barras\x203','USD_setMtoPrecioUnitario','setItemUnitAlias','Unidad\x20de\x20Medida\x202','Unidad\x20de\x20Medida\x203','KILOMETRO','KILOGRAMO','1534410DsHpZB','KTM','QUINTAL','SACO','TONELADA\x20LARGA','setCodProducto','Gravado\x20(10%)','buffer','ID\x20UNIT\x203','message','parse_date_code','YARDA\x20CUADRADA','PLACAS','MIL','MMQ','Alias\x203','JUEGO','utils','setUnidadCodigo2','bind','Iniciando\x20parseo…','TONELADAS','PAR','setUnitId3','\x20de\x20','7jypsLr','4109418hHhBYf','BOBINAS','done','SSF','exception','setItemBarCode2','Comisión\x20Venta\x203\x20(%)','NIU','MLT','Precio\x20Costo\x20Soles\x203','log','FTK','setItemBarCode3','setItemVariantValues','MTR','Equivalencia\x203','MMT','MILIMETRO\x20CUBICO','Precio\x20Venta\x20Soles\x202','exportDone','KIT','CARTONES','error','CIENTO\x20DE\x20UNIDADES','encode_cell','LIBRAS','Categoría','Procesadas\x20filas\x20','UNIDAD\x20(ZZ)','DZP','GRO','KILOVATIO\x20HORA','STN','setUnitId','QQM','METRO\x20CUADRADO','FTQ','keys','getMonth','setWarehouseStockMin','11JPUTHm','PIEZAS','setUnidadEquivalencia3','Precio\x20Costo\x20Dólares\x203','Precio\x20Venta\x20Dólares\x202','constructor','BALDE','MILIGRAMOS','HECTOLITRO','MILLARES','Modelo','Se\x20Vende','Precio\x20Venta\x20Dólares\x203','BARRILES','USD_setMtoPrecioCostoUnitario3','setDescripcion','FOT','SET','Tipo*','prototype','Impuesto*','setMarca','Talla','RESMA','478420kkCVnv','CENTIMETRO\x20CUADRADO','Código\x20SKU*','DOCENA','info','Equivalencia\x202','SheetNames','Género','Combo','KWH','Unidad\x20de\x20Medida*','console','HLT','Rastrear\x20Inventario','setItemIsBought','MMK','C62','PEN_setMtoPrecioUnitario2','TNE','apply','USD_setMtoPrecioUnitario2','PALETAS','!ref','push','LATAS','getDate','reduce','Exportación\x20(0%)','CEN','Stock\x20Mínimo','Fabricado','DOCENA\x20POR\x2010**6','BLL','Artículo','round','Lote','MEGAWATT\x20HORA','CENTIMETRO\x20LINEAL','trace','Comisión\x20Venta\x20(%)','METRO','MTQ','Código\x20de\x20Barras\x202','sheet_add_json','LBR','map','Nombre*','Exonerado\x20(0%)','USD_setMtoPrecioCostoUnitario','CMT','UND\x20(NIU)','getFullYear','trim','MILIMETRO\x20CUADRADO','ID\x20UNIT\x202','CMQ','5473ZFdPtc','Alias','ONZAS','FARDO','setItemCommissionPercentage2','794265EfoUaM','PAQUETE','UNIDAD\x20(NIU)','INH','setItemUnitAlias2','Precio\x20Venta\x20Dólares','CILINDRO','LEF','Gravado\x20Gratuito\x20(18%)','read','Sheets','Se\x20Compra','__proto__','setSucursalStock','Alias\x202','filter','Material','value','18cYdAlj','METRO\x20CUBICO','MILIMETRO','PULGADAS','GLL','decode_range','(((.+)+)+)+$','152LlsbuD','GRM','find','toString','LTN','progress','4181752qdffUo','Precio\x20Venta\x20Soles','PEN_setMtoPrecioCostoUnitario','Marca','LITRO','MILLON\x20DE\x20UNIDADES','El\x20archivo\x20tiene\x20','padStart','warn','setItemUnitAlias3','findIndex','CONOS','toLowerCase','CENTIMETRO\x20CUBICO','GALON\x20INGLES\x20(4,545956L)','write','some','table','GRUESA','CAJA','slice','Precio\x20Costo\x20Soles\x202','setInventariable','Comisión\x20Venta\x202\x20(%)','TUBOS','Inafecto\x20Gratuito\x20(0%)','Gravado\x20Gratuito\x20(10%)'];_0x20ea=function(){return _0x2717e4;};return _0x20ea();}_0x38493c();const _0x21a309=(function(){let _0x50911a=!![];return function(_0x473bf8,_0x28eb74){const _0x27e7ac=_0x50911a?function(){const _0x25f267=_0x4a94;if(_0x28eb74){const _0x4c3b5e=_0x28eb74[_0x25f267(0x28e)](_0x473bf8,arguments);return _0x28eb74=null,_0x4c3b5e;}}:function(){};return _0x50911a=![],_0x27e7ac;};}()),_0x508583=_0x21a309(this,function(){const _0x135e70=_0x4a94,_0x5e95da=function(){let _0x564af3;try{_0x564af3=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5cf186){_0x564af3=window;}return _0x564af3;},_0x3ef409=_0x5e95da(),_0x32ab96=_0x3ef409[_0x135e70(0x286)]=_0x3ef409[_0x135e70(0x286)]||{},_0x34c831=[_0x135e70(0x245),_0x135e70(0x1df),_0x135e70(0x27f),_0x135e70(0x251),_0x135e70(0x23f),_0x135e70(0x1e8),_0x135e70(0x2a1)];for(let _0x2eadcf=0x0;_0x2eadcf<_0x34c831[_0x135e70(0x1f9)];_0x2eadcf++){const _0x465dc1=_0x21a309[_0x135e70(0x268)][_0x135e70(0x276)][_0x135e70(0x234)](_0x21a309),_0x12b0af=_0x34c831[_0x2eadcf],_0x55aa72=_0x32ab96[_0x12b0af]||_0x465dc1;_0x465dc1[_0x135e70(0x2c4)]=_0x21a309['bind'](_0x21a309),_0x465dc1['toString']=_0x55aa72[_0x135e70(0x1d4)][_0x135e70(0x234)](_0x55aa72),_0x32ab96[_0x12b0af]=_0x465dc1;}});function _0x4a94(_0x4ea0c5,_0x29b918){const _0x1da1cb=_0x20ea();return _0x4a94=function(_0x508583,_0x21a309){_0x508583=_0x508583-0x1d0;let _0x5bca2b=_0x1da1cb[_0x508583];return _0x5bca2b;},_0x4a94(_0x4ea0c5,_0x29b918);}_0x508583(),importScripts('https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js'),onmessage=({data:_0x3715dd})=>{const _0x48f6b2=_0x4a94,{action:_0x4971e1}=_0x3715dd;if(_0x4971e1==='import'){const {buf:_0x5458c3,maxRows:_0x3fc838}=_0x3715dd;try{postMessage({'type':_0x48f6b2(0x1d6),'payload':{'percent':0x5,'message':_0x48f6b2(0x235)}});const _0x157a26=XLSX[_0x48f6b2(0x2c1)](_0x5458c3,{'type':_0x48f6b2(0x200),'cellDates':!![]}),_0x465653=_0x157a26[_0x48f6b2(0x2c2)][_0x157a26[_0x48f6b2(0x281)][0x0]],_0x24e389=XLSX[_0x48f6b2(0x232)]['sheet_to_json'](_0x465653,{'defval':'','range':0x1,'cellDates':!![]}),_0x1cd34b=_0x24e389[_0x48f6b2(0x1e1)](_0x344b82=>(!_0x344b82[_0x48f6b2(0x275)]||String(_0x344b82[_0x48f6b2(0x275)])[_0x48f6b2(0x2af)]()==='')&&(!_0x344b82[_0x48f6b2(0x27d)]||String(_0x344b82[_0x48f6b2(0x27d)])[_0x48f6b2(0x2af)]()==='')&&(!_0x344b82[_0x48f6b2(0x2a9)]||String(_0x344b82[_0x48f6b2(0x2a9)])[_0x48f6b2(0x2af)]()==='')&&(!_0x344b82[_0x48f6b2(0x285)]||String(_0x344b82['Unidad\x20de\x20Medida*'])['trim']()==='')),_0x5d9bab=_0x1cd34b>=0x0?_0x24e389['slice'](0x0,_0x1cd34b):_0x24e389,_0x19c7da=_0x5d9bab[_0x48f6b2(0x2c7)](_0x15bde8=>_0x15bde8[_0x48f6b2(0x275)]&&String(_0x15bde8[_0x48f6b2(0x275)])[_0x48f6b2(0x2af)]()!==''&&_0x15bde8[_0x48f6b2(0x27d)]&&String(_0x15bde8[_0x48f6b2(0x27d)])[_0x48f6b2(0x2af)]()!==''&&_0x15bde8[_0x48f6b2(0x2a9)]&&String(_0x15bde8[_0x48f6b2(0x2a9)])['trim']()!==''&&_0x15bde8[_0x48f6b2(0x285)]&&String(_0x15bde8[_0x48f6b2(0x285)])[_0x48f6b2(0x2af)]()!==''),_0x123e9e=_0x19c7da[_0x48f6b2(0x1f9)];if(_0x123e9e===0x0){postMessage({'type':_0x48f6b2(0x251),'payload':'No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).'});return;}if(_0x123e9e>_0x3fc838)throw _0x48f6b2(0x1dd)+_0x123e9e+'\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20'+_0x3fc838+'.';const _0x5b3cc5=0x1f4,_0x4c6358=[],_0x508991=[{'codigo':'4A','nombre':_0x48f6b2(0x23c)},{'codigo':'BJ','nombre':_0x48f6b2(0x269)},{'codigo':_0x48f6b2(0x29b),'nombre':'BARRILES'},{'codigo':'BG','nombre':_0x48f6b2(0x20a)},{'codigo':'BO','nombre':_0x48f6b2(0x208)},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':'CARTONES'},{'codigo':'CMK','nombre':_0x48f6b2(0x27c)},{'codigo':_0x48f6b2(0x2b2),'nombre':_0x48f6b2(0x1e4)},{'codigo':_0x48f6b2(0x2ac),'nombre':_0x48f6b2(0x2a0)},{'codigo':_0x48f6b2(0x297),'nombre':_0x48f6b2(0x252)},{'codigo':'CY','nombre':_0x48f6b2(0x2be)},{'codigo':'CJ','nombre':'CONOS'},{'codigo':_0x48f6b2(0x216),'nombre':_0x48f6b2(0x27e)},{'codigo':_0x48f6b2(0x258),'nombre':_0x48f6b2(0x29a)},{'codigo':'BE','nombre':_0x48f6b2(0x2b6)},{'codigo':'GLI','nombre':'GALON\x20INGLES\x20(4,545956L)'},{'codigo':_0x48f6b2(0x1d2),'nombre':_0x48f6b2(0x20d)},{'codigo':_0x48f6b2(0x259),'nombre':_0x48f6b2(0x1e9)},{'codigo':_0x48f6b2(0x287),'nombre':'HECTOLITRO'},{'codigo':_0x48f6b2(0x2bf),'nombre':'HOJA'},{'codigo':_0x48f6b2(0x274),'nombre':_0x48f6b2(0x231)},{'codigo':'KGM','nombre':_0x48f6b2(0x220)},{'codigo':_0x48f6b2(0x222),'nombre':_0x48f6b2(0x21f)},{'codigo':_0x48f6b2(0x284),'nombre':_0x48f6b2(0x25a)},{'codigo':'KT','nombre':_0x48f6b2(0x24f)},{'codigo':'CA','nombre':_0x48f6b2(0x293)},{'codigo':_0x48f6b2(0x2a7),'nombre':_0x48f6b2(0x254)},{'codigo':'LTR','nombre':'LITRO'},{'codigo':_0x48f6b2(0x219),'nombre':_0x48f6b2(0x29f)},{'codigo':_0x48f6b2(0x249),'nombre':'METRO'},{'codigo':'MTK','nombre':_0x48f6b2(0x25e)},{'codigo':_0x48f6b2(0x2a4),'nombre':'METRO\x20CUBICO'},{'codigo':_0x48f6b2(0x204),'nombre':_0x48f6b2(0x26a)},{'codigo':_0x48f6b2(0x243),'nombre':_0x48f6b2(0x1f6)},{'codigo':_0x48f6b2(0x24b),'nombre':_0x48f6b2(0x2cc)},{'codigo':_0x48f6b2(0x28a),'nombre':_0x48f6b2(0x2b0)},{'codigo':_0x48f6b2(0x22f),'nombre':_0x48f6b2(0x24c)},{'codigo':_0x48f6b2(0x22e),'nombre':_0x48f6b2(0x26c)},{'codigo':'UM','nombre':_0x48f6b2(0x1dc)},{'codigo':_0x48f6b2(0x206),'nombre':_0x48f6b2(0x2b5)},{'codigo':'PF','nombre':_0x48f6b2(0x290)},{'codigo':'PK','nombre':_0x48f6b2(0x2b9)},{'codigo':'PR','nombre':_0x48f6b2(0x237)},{'codigo':_0x48f6b2(0x273),'nombre':_0x48f6b2(0x205)},{'codigo':_0x48f6b2(0x246),'nombre':_0x48f6b2(0x1f7)},{'codigo':_0x48f6b2(0x25f),'nombre':'PIES\x20CUBICOS'},{'codigo':_0x48f6b2(0x28b),'nombre':_0x48f6b2(0x264)},{'codigo':'PG','nombre':'PLACAS'},{'codigo':'ST','nombre':_0x48f6b2(0x1fe)},{'codigo':_0x48f6b2(0x2bb),'nombre':'PULGADAS'},{'codigo':'RM','nombre':_0x48f6b2(0x27a)},{'codigo':'SA','nombre':_0x48f6b2(0x224)},{'codigo':'DR','nombre':_0x48f6b2(0x1fa)},{'codigo':_0x48f6b2(0x25b),'nombre':_0x48f6b2(0x212)},{'codigo':_0x48f6b2(0x1d5),'nombre':_0x48f6b2(0x225)},{'codigo':_0x48f6b2(0x28d),'nombre':_0x48f6b2(0x236)},{'codigo':'TU','nombre':_0x48f6b2(0x1ef)},{'codigo':_0x48f6b2(0x242),'nombre':_0x48f6b2(0x2ba)},{'codigo':'ZZ','nombre':_0x48f6b2(0x257)},{'codigo':_0x48f6b2(0x2ce),'nombre':'US\x20GALON\x20(3,7843\x20L)'},{'codigo':'YRD','nombre':_0x48f6b2(0x211)},{'codigo':_0x48f6b2(0x217),'nombre':'YARDA\x20CUADRADA'},{'codigo':_0x48f6b2(0x25d),'nombre':_0x48f6b2(0x223)}],_0x5cd731=_0x508991[_0x48f6b2(0x295)]((_0x18c656,{nombre:_0x4858aa,codigo:_0x6c823d})=>{return _0x18c656[_0x4858aa['trim']()]=_0x6c823d['trim'](),_0x18c656;},{});for(let _0x36dae8=0x0;_0x36dae8<_0x123e9e;_0x36dae8+=_0x5b3cc5){const _0x49e825=_0x19c7da[_0x48f6b2(0x1eb)](_0x36dae8,_0x36dae8+_0x5b3cc5)[_0x48f6b2(0x2a8)]((_0x299b50,_0x3b617f)=>{const _0x131d3b=_0x48f6b2;let _0x2cd671={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x299b50[_0x131d3b(0x275)]]||'1';const _0x1c7b57=String(_0x299b50[_0x131d3b(0x277)])['trim'](),_0x545ed5={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x6911a1=_0x545ed5[_0x1c7b57]||'1',_0x3d4770={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x6911a1]||{'code':'10','value':0x12},_0x17605a={};let _0x19bd6f=String(_0x299b50[_0x131d3b(0x2a9)])['trim']();const _0x43bfb8=[_0x131d3b(0x29e),_0x131d3b(0x279),'Color',_0x131d3b(0x282),_0x131d3b(0x26d),_0x131d3b(0x209),_0x131d3b(0x2c8),'Modelo\x20de\x20Cuello',_0x131d3b(0x213)];_0x43bfb8[_0x131d3b(0x1f8)](_0x1179d7=>{const _0x543f44=_0x131d3b,_0x27a27e=String(_0x299b50[_0x1179d7]||'')[_0x543f44(0x2af)]();_0x27a27e&&(_0x17605a[_0x1179d7]=_0x27a27e,_0x19bd6f+='\x20'+_0x1179d7+'\x20'+_0x27a27e);});const _0xd3e8dd=[],_0x21669b=String(_0x299b50[_0x131d3b(0x285)]||_0x131d3b(0x2ba))[_0x131d3b(0x2af)](),_0x35f487=_0x5cd731[_0x21669b]||'NIU',_0x292b97=String(_0x299b50[_0x131d3b(0x2b4)])[_0x131d3b(0x2af)]();_0xd3e8dd[_0x131d3b(0x292)]({'setItemUnitId':String(_0x299b50[_0x131d3b(0x20b)])[_0x131d3b(0x2af)]()||'','setItemBarCode':String(_0x299b50[_0x131d3b(0x214)])[_0x131d3b(0x2af)]()||'','setAlias':_0x292b97,'setUnitCode':_0x35f487,'setPrice':parseFloat(_0x299b50['Precio\x20Venta\x20Soles']),'setCost':parseFloat(_0x299b50['Precio\x20Costo\x20Soles']),'setPriceUSD':parseFloat(_0x299b50[_0x131d3b(0x2bd)]),'setCostUSD':parseFloat(_0x299b50['Precio\x20Costo\x20Dólares']),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x299b50[_0x131d3b(0x2a2)])});const _0x7ef47d=['ID\x20UNIT\x202','Alias\x202',_0x131d3b(0x2a5),_0x131d3b(0x280),'Precio\x20Venta\x20Soles\x202','Precio\x20Costo\x20Soles\x202',_0x131d3b(0x267),_0x131d3b(0x20e)][_0x131d3b(0x1e7)](_0x13d33d=>{const _0xa336a9=_0x131d3b,_0x419a3e=_0x299b50[_0x13d33d];return _0x419a3e!=null&&String(_0x419a3e)[_0xa336a9(0x2af)]()!=='';});if(_0x7ef47d){const _0x224d97=String(_0x299b50['Unidad\x20de\x20Medida\x202']||_0x131d3b(0x2ad))[_0x131d3b(0x2af)](),_0x4c5573=_0x5cd731[_0x224d97]||_0x131d3b(0x242);_0xd3e8dd[_0x131d3b(0x292)]({'setItemUnitId':String(_0x299b50[_0x131d3b(0x2b1)])[_0x131d3b(0x2af)]()||'','setItemBarCode':String(_0x299b50['Código\x20de\x20Barras\x202'])[_0x131d3b(0x2af)]()||'','setAlias':String(_0x299b50[_0x131d3b(0x2c6)])[_0x131d3b(0x2af)](),'setUnitCode':_0x4c5573,'setPrice':parseFloat(_0x299b50[_0x131d3b(0x24d)]),'setCost':parseFloat(_0x299b50[_0x131d3b(0x1ec)]),'setPriceUSD':parseFloat(_0x299b50[_0x131d3b(0x267)]),'setCostUSD':parseFloat(_0x299b50['Precio\x20Costo\x20Dólares\x202']),'setDefault':0x0,'setEquivalence':parseFloat(_0x299b50[_0x131d3b(0x280)])||0x1,'setFactor':parseFloat(_0x299b50['Equivalencia\x202'])||0x1,'setItemCommissionPercentage':parseFloat(_0x299b50[_0x131d3b(0x1ee)])});}const _0x224c3a=[_0x131d3b(0x229),'Alias\x203',_0x131d3b(0x21a),_0x131d3b(0x24a),'Precio\x20Venta\x20Soles\x203',_0x131d3b(0x244),_0x131d3b(0x26f),_0x131d3b(0x266)][_0x131d3b(0x1e7)](_0x3f3c02=>{const _0x3ab711=_0x131d3b,_0x5810f4=_0x299b50[_0x3f3c02];return _0x5810f4!=null&&String(_0x5810f4)[_0x3ab711(0x2af)]()!=='';});if(_0x224c3a){const _0x206a21=String(_0x299b50[_0x131d3b(0x21e)]||_0x131d3b(0x2ad))[_0x131d3b(0x2af)](),_0x2c4809=_0x5cd731[_0x206a21]||_0x131d3b(0x242);_0xd3e8dd[_0x131d3b(0x292)]({'setItemUnitId':String(_0x299b50[_0x131d3b(0x229)])[_0x131d3b(0x2af)]()||'','setItemBarCode':String(_0x299b50[_0x131d3b(0x21a)])[_0x131d3b(0x2af)]()||'','setAlias':String(_0x299b50[_0x131d3b(0x230)])[_0x131d3b(0x2af)](),'setUnitCode':_0x2c4809,'setPrice':parseFloat(_0x299b50[_0x131d3b(0x1fb)]),'setCost':parseFloat(_0x299b50[_0x131d3b(0x244)]),'setPriceUSD':parseFloat(_0x299b50[_0x131d3b(0x26f)]),'setCostUSD':parseFloat(_0x299b50['Precio\x20Costo\x20Dólares\x203']),'setDefault':0x0,'setEquivalence':parseFloat(_0x299b50['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0x299b50['Equivalencia\x203'])||0x1,'setItemCommissionPercentage':parseFloat(_0x299b50[_0x131d3b(0x241)])});}let _0x1cae3f=_0x299b50[_0x131d3b(0x1f2)],_0x3945ec='';if(_0x1cae3f instanceof Date){const _0x4cd2c8=_0x1cae3f[_0x131d3b(0x2ae)](),_0x25f0fb=String(_0x1cae3f[_0x131d3b(0x261)]()+0x1)['padStart'](0x2,'0'),_0x986e91=String(_0x1cae3f[_0x131d3b(0x294)]())[_0x131d3b(0x1de)](0x2,'0');_0x3945ec=_0x4cd2c8+'-'+_0x25f0fb+'-'+_0x986e91;}else{if(typeof _0x1cae3f==='number'){const _0x1c4fa4=XLSX[_0x131d3b(0x23e)][_0x131d3b(0x22b)](_0x1cae3f);if(_0x1c4fa4){const _0x162d4f=_0x1c4fa4['y'],_0x16046b=String(_0x1c4fa4['m'])[_0x131d3b(0x1de)](0x2,'0'),_0x12da88=String(_0x1c4fa4['d'])[_0x131d3b(0x1de)](0x2,'0');_0x3945ec=_0x162d4f+'-'+_0x16046b+'-'+_0x12da88;}}else _0x3945ec=String(_0x1cae3f||'')[_0x131d3b(0x2af)]();}return{'setItemId':String(_0x299b50['ID'])[_0x131d3b(0x2af)](),'setItemType':_0x2cd671,'setItemCode':String(_0x299b50[_0x131d3b(0x27d)])['trim'](),'setItemName':String(_0x299b50[_0x131d3b(0x2a9)])['trim'](),'setItemDescription':String(_0x299b50[_0x131d3b(0x202)])[_0x131d3b(0x2af)]()||'','setItemIsSold':_0x299b50['Se\x20Vende']=='SI'?0x1:0x0,'setItemIsBought':_0x299b50[_0x131d3b(0x2c3)]=='SI'?0x1:0x0,'setItemCategories':_0x299b50[_0x131d3b(0x255)]?[String(_0x299b50['Categoría'])[_0x131d3b(0x2af)]()]:[],'setItemBrands':_0x299b50[_0x131d3b(0x1da)]?[String(_0x299b50['Marca'])[_0x131d3b(0x2af)]()]:[],'setItemTaxId':_0x6911a1,'setItemTaxCode':_0x3d4770['code'],'setItemTaxValue':_0x3d4770[_0x131d3b(0x2c9)],'setItemUnits':_0xd3e8dd,'setItemInventoriable':_0x299b50[_0x131d3b(0x288)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x299b50['Stock\x20Actual'])||0x0,'setStockMinimum':parseFloat(_0x299b50[_0x131d3b(0x298)])||0x0,'setItemLocation':String(_0x299b50['Ubicación'])[_0x131d3b(0x2af)]()||'','setBatchName':String(_0x299b50[_0x131d3b(0x29e)])[_0x131d3b(0x2af)]()||'','setItemDateExpiry':_0x3945ec,'setItemVariantName':_0x19bd6f,'setItemVariantValues':_0x17605a,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x4c6358[_0x48f6b2(0x292)](..._0x49e825),postMessage({'type':_0x48f6b2(0x1d6),'payload':{'percent':Math[_0x48f6b2(0x29d)]((_0x36dae8+_0x49e825[_0x48f6b2(0x1f9)])/_0x123e9e*0x64),'message':_0x48f6b2(0x256)+(_0x36dae8+0x1)+'–'+(_0x36dae8+_0x49e825[_0x48f6b2(0x1f9)])+'/'+_0x123e9e}});}postMessage({'type':_0x48f6b2(0x23d),'payload':{'items':_0x4c6358}});}catch(_0x513181){postMessage({'type':'error','payload':_0x513181[_0x48f6b2(0x22a)]||_0x513181});}}if(_0x4971e1===_0x48f6b2(0x1ff)){const {products:_0x4f4fec,plantillaBuf:_0x3a523b}=_0x3715dd;if(!(_0x3a523b instanceof ArrayBuffer)){postMessage({'type':'error','payload':_0x48f6b2(0x1fc)});return;}if(!Array[_0x48f6b2(0x203)](_0x4f4fec)){postMessage({'type':_0x48f6b2(0x251),'payload':'exportItems:\x20products\x20no\x20es\x20Array.'});return;}try{structuredClone(_0x4f4fec);}catch(_0x468618){postMessage({'type':'error','payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x468618[_0x48f6b2(0x22a)]});return;}try{const _0x35512b={'1':_0x48f6b2(0x29c),'2':'Servicio','3':_0x48f6b2(0x210),'4':_0x48f6b2(0x283),'5':_0x48f6b2(0x299)};function _0x346f86(_0x147805){return _0x35512b[String(_0x147805)]||'Artículo';}const _0x5880c1={'1':_0x48f6b2(0x1fd),'2':_0x48f6b2(0x2aa),'3':'Inafecto\x20(0%)','4':_0x48f6b2(0x2c0),'5':_0x48f6b2(0x1f0),'6':_0x48f6b2(0x227),'7':_0x48f6b2(0x20c),'8':_0x48f6b2(0x296),'9':_0x48f6b2(0x1f1)};function _0x51f43e(_0x2d2969){const _0x2f644d=_0x48f6b2;return _0x5880c1[String(_0x2d2969)]||_0x2f644d(0x1fd);}const _0x3ad215={'4A':_0x48f6b2(0x23c),'BJ':_0x48f6b2(0x269),'BLL':_0x48f6b2(0x270),'BG':_0x48f6b2(0x20a),'BO':'BOTELLAS','BX':_0x48f6b2(0x1ea),'CT':_0x48f6b2(0x250),'CMK':'CENTIMETRO\x20CUADRADO','CMQ':'CENTIMETRO\x20CUBICO','CMT':_0x48f6b2(0x2a0),'CEN':_0x48f6b2(0x252),'CY':_0x48f6b2(0x2be),'CJ':_0x48f6b2(0x1e2),'DZN':_0x48f6b2(0x27e),'DZP':_0x48f6b2(0x29a),'BE':_0x48f6b2(0x2b6),'GLI':_0x48f6b2(0x1e5),'GRM':'GRAMO','GRO':_0x48f6b2(0x1e9),'HLT':_0x48f6b2(0x26b),'LEF':_0x48f6b2(0x1f3),'SET':_0x48f6b2(0x231),'KGM':_0x48f6b2(0x220),'KTM':_0x48f6b2(0x21f),'KWH':_0x48f6b2(0x25a),'KT':_0x48f6b2(0x24f),'CA':_0x48f6b2(0x293),'LBR':'LIBRAS','LTR':_0x48f6b2(0x1db),'MWH':_0x48f6b2(0x29f),'MTR':_0x48f6b2(0x2a3),'MTK':'METRO\x20CUADRADO','MTQ':_0x48f6b2(0x2cb),'MGM':_0x48f6b2(0x26a),'MLT':_0x48f6b2(0x1f6),'MMT':_0x48f6b2(0x2cc),'MMK':_0x48f6b2(0x2b0),'MMQ':_0x48f6b2(0x24c),'MIL':'MILLARES','UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0x48f6b2(0x2b5),'PF':_0x48f6b2(0x290),'PK':_0x48f6b2(0x2b9),'PR':_0x48f6b2(0x237),'FOT':_0x48f6b2(0x205),'FTK':_0x48f6b2(0x1f7),'FTQ':'PIES\x20CUBICOS','C62':_0x48f6b2(0x264),'PG':_0x48f6b2(0x22d),'ST':_0x48f6b2(0x1fe),'INH':_0x48f6b2(0x2cd),'RM':'RESMA','SA':_0x48f6b2(0x224),'DR':_0x48f6b2(0x1fa),'STN':_0x48f6b2(0x212),'LTN':'TONELADA\x20LARGA','TNE':_0x48f6b2(0x236),'TU':_0x48f6b2(0x1ef),'NIU':_0x48f6b2(0x2ba),'ZZ':'UNIDAD\x20(ZZ)','GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':_0x48f6b2(0x211),'YDK':_0x48f6b2(0x22c),'QQM':_0x48f6b2(0x223)};function _0x26198d(_0x596fe2){return _0x3ad215[String(_0x596fe2)]||'';}const _0xcb90b0=XLSX['read'](_0x3a523b,{'type':_0x48f6b2(0x200),'cellDates':!![]}),_0x251623=_0xcb90b0[_0x48f6b2(0x281)][0x0],_0x349e86=_0xcb90b0[_0x48f6b2(0x2c2)][_0x251623],_0xaae1=XLSX['utils']['sheet_to_json'](_0x349e86,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x57790a=XLSX[_0x48f6b2(0x232)][_0x48f6b2(0x2cf)](_0x349e86['!ref']||'');for(let _0x80fd85=0x2;_0x80fd85<=_0x57790a['e']['r'];++_0x80fd85){for(let _0x43dacf=_0x57790a['s']['c'];_0x43dacf<=_0x57790a['e']['c'];++_0x43dacf){const _0x3827b7=XLSX[_0x48f6b2(0x232)][_0x48f6b2(0x253)]({'r':_0x80fd85,'c':_0x43dacf});if(_0x349e86[_0x3827b7])delete _0x349e86[_0x3827b7];}}const _0x8c052=_0x4f4fec[_0x48f6b2(0x2a8)](_0x52b11b=>{const _0x1744e7=_0x48f6b2;_0x52b11b[_0x1744e7(0x248)]=_0x52b11b[_0x1744e7(0x248)]||{};const _0x492963={};return _0xaae1[_0x1744e7(0x1f8)](_0xc2f908=>{const _0x1cf71d=_0x1744e7,_0x36c863=String(_0xc2f908)[_0x1cf71d(0x2af)](),_0x1070b3=_0x36c863['toLowerCase'](),_0x477dc7=Object[_0x1cf71d(0x260)](_0x52b11b)[_0x1cf71d(0x1d3)](_0x1889f4=>_0x1889f4[_0x1cf71d(0x2af)]()[_0x1cf71d(0x1e3)]()===_0x1070b3);if(_0x477dc7){_0x492963[_0x36c863]=_0x52b11b[_0x477dc7]??'';return;}switch(_0x36c863){case'ID':_0x492963[_0x36c863]=_0x52b11b['id']??'';break;case _0x1cf71d(0x275):_0x492963[_0x36c863]=_0x346f86(_0x52b11b['setItemType']);break;case'Código\x20SKU*':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x226)]??'';break;case'Nombre*':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x272)]??'';break;case'Descripción':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x215)]??'';break;case _0x1cf71d(0x26e):_0x492963[_0x36c863]=_0x52b11b['setItemIsSold']==0x1?'SI':'NO';break;case _0x1cf71d(0x2c3):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x289)]==0x1?'SI':'NO';break;case _0x1cf71d(0x255):_0x492963[_0x36c863]=_0x52b11b['setCategoria']??'';break;case _0x1cf71d(0x1da):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x278)]??'';break;case _0x1cf71d(0x277):_0x492963[_0x36c863]=_0x51f43e(_0x52b11b['setTaxId']);break;case _0x1cf71d(0x20b):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x25c)]??'';break;case _0x1cf71d(0x2b4):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x21c)]??'';break;case _0x1cf71d(0x214):_0x492963[_0x36c863]=_0x52b11b['setItemBarCode']??'';break;case _0x1cf71d(0x285):_0x492963[_0x36c863]=_0x26198d(_0x52b11b['setUnidadCodigo']);break;case _0x1cf71d(0x1d8):_0x492963[_0x36c863]=_0x52b11b['PEN_setMtoPrecioUnitario']??'';break;case _0x1cf71d(0x207):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x1d9)]??'';break;case'Precio\x20Venta\x20Dólares':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x21b)]??'';break;case _0x1cf71d(0x201):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x2ab)]??'';break;case _0x1cf71d(0x2a2):_0x492963[_0x36c863]=_0x52b11b['setItemCommissionPercentage'];break;case _0x1cf71d(0x2b1):_0x492963[_0x36c863]=_0x52b11b['setUnitId2']??'';break;case'Alias\x202':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x2bc)]??'';break;case _0x1cf71d(0x2a5):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x240)]??'';break;case _0x1cf71d(0x21d):_0x492963[_0x36c863]=_0x26198d(_0x52b11b[_0x1cf71d(0x233)]);break;case _0x1cf71d(0x280):_0x492963[_0x36c863]=_0x52b11b['setUnidadEquivalencia2']??'1';break;case _0x1cf71d(0x24d):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x28c)]??'';break;case'Precio\x20Costo\x20Soles\x202':_0x492963[_0x36c863]=_0x52b11b['PEN_setMtoPrecioCostoUnitario2']??'';break;case'Precio\x20Venta\x20Dólares\x202':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x28f)]??'';break;case'Precio\x20Costo\x20Dólares\x202':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x218)]??'';break;case _0x1cf71d(0x1ee):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x2b7)];break;case'ID\x20UNIT\x203':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x238)]??'';break;case _0x1cf71d(0x230):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x1e0)]??'';break;case _0x1cf71d(0x21a):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x247)]??'';break;case _0x1cf71d(0x21e):_0x492963[_0x36c863]=_0x26198d(_0x52b11b['setUnidadCodigo3']);break;case _0x1cf71d(0x24a):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x265)]??'1';break;case _0x1cf71d(0x1fb):_0x492963[_0x36c863]=_0x52b11b['PEN_setMtoPrecioUnitario3']??'';break;case _0x1cf71d(0x244):_0x492963[_0x36c863]=_0x52b11b['PEN_setMtoPrecioCostoUnitario3']??'';break;case _0x1cf71d(0x26f):_0x492963[_0x36c863]=_0x52b11b['USD_setMtoPrecioUnitario3']??'';break;case _0x1cf71d(0x266):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x271)]??'';break;case _0x1cf71d(0x241):_0x492963[_0x36c863]=_0x52b11b['setItemCommissionPercentage3'];break;case _0x1cf71d(0x288):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x1ed)]==0x1?'SI':'NO';break;case'Stock\x20Actual':_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x2c5)]??'';break;case _0x1cf71d(0x298):_0x492963[_0x36c863]=_0x52b11b[_0x1cf71d(0x262)]??'';break;case _0x1cf71d(0x1f2):_0x492963[_0x36c863]=_0x52b11b['setBatchExpirationDate']??'';break;default:_0x492963[_0x36c863]='';}}),_0x492963;}),_0x36910e=0x3e8,_0x2577e5=_0x8c052[_0x48f6b2(0x1f9)];for(let _0x2c9e8c=0x0;_0x2c9e8c<_0x2577e5;_0x2c9e8c+=_0x36910e){const _0x176fe6=_0x8c052[_0x48f6b2(0x1eb)](_0x2c9e8c,_0x2c9e8c+_0x36910e);XLSX[_0x48f6b2(0x232)][_0x48f6b2(0x2a6)](_0x349e86,_0x176fe6,{'origin':{'r':_0x2c9e8c+0x2,'c':0x0},'skipHeader':!![],'header':_0xaae1}),postMessage({'type':_0x48f6b2(0x1d6),'payload':{'percent':Math[_0x48f6b2(0x29d)]((_0x2c9e8c+_0x176fe6['length'])/_0x2577e5*0x64),'message':_0x48f6b2(0x1f4)+(_0x2c9e8c+0x1)+'–'+(_0x2c9e8c+_0x176fe6[_0x48f6b2(0x1f9)])+_0x48f6b2(0x239)+_0x2577e5}});}const _0x31c621={'s':{'r':0x0,'c':0x0},'e':{'r':_0x2577e5+0x1,'c':_0xaae1['length']-0x1}};_0x349e86[_0x48f6b2(0x291)]=XLSX[_0x48f6b2(0x232)]['encode_range'](_0x31c621);const _0x4298c2=XLSX[_0x48f6b2(0x1e6)](_0xcb90b0,{'bookType':'xlsx','type':_0x48f6b2(0x200)});let _0x4bd155,_0x2d0aea;if(_0x4298c2 instanceof Uint8Array)_0x4bd155=_0x4298c2,_0x2d0aea=[_0x4298c2[_0x48f6b2(0x228)]];else{if(_0x4298c2 instanceof ArrayBuffer)_0x4bd155=new Uint8Array(_0x4298c2),_0x2d0aea=[_0x4298c2];else{const _0x34d78e=new Uint8Array(_0x4298c2);_0x4bd155=_0x34d78e,_0x2d0aea=[_0x34d78e[_0x48f6b2(0x228)]];}}postMessage({'type':_0x48f6b2(0x24e),'payload':{'wbout':_0x4bd155,'count':_0x8c052[_0x48f6b2(0x1f9)]}},_0x2d0aea);}catch(_0x29652f){postMessage({'type':'error','payload':_0x29652f[_0x48f6b2(0x22a)]||String(_0x29652f)});}return;}};