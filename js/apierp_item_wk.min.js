/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.3.6
*/

function _0x21e0(){const _0x3594c4=['MTQ','Combo','MMK','CENTIMETRO\x20CUADRADO','setItemType','Fabricado','1832760LEXREd','Género','log','exportItems','Unidad\x20de\x20Medida\x202','CARTONES','BOTELLAS','Color','!ref','TONELADA\x20LARGA','Categoría','Exonerado\x20Gratuito\x20(0%)','padStart','GRAMO','reduce','Precio\x20Costo\x20Soles\x202','map','exportItems:\x20products\x20no\x20es\x20Array.','3678WBUhLa','search','Stock\x20Mínimo','MILIGRAMOS','buffer','array','UND\x20(NIU)','CENTIMETRO\x20LINEAL','GALON\x20INGLES\x20(4,545956L)','sheet_to_json','Equivalencia\x202','error','METRO\x20CUBICO','Nombre*','GRUESA','return\x20(function()\x20','setItemDescription','MWH','done','YARDA\x20CUADRADA','LATAS','import','Modelo\x20de\x20Cuello','setSucursalStock','TUBOS','Materia\x20Prima','findIndex','apply','some','HOJA','BALDE','toString','LBR','MILILITRO','CIENTO\x20DE\x20UNIDADES','Artículo','setInventariable','Precio\x20Costo\x20Soles','code','keys','Tipo*','USD_setMtoPrecioCostoUnitario','round','setUnidadCodigo2','MILIMETRO\x20CUADRADO','Inafecto\x20Gratuito\x20(0%)','ONZAS','setWarehouseStockMin','setDescripcion','message','BOBINAS','152NpgawD','forEach','CMQ','DZN','Servicio','FTQ','CAJA','MEGAWATT\x20HORA','TAMBOR','table','Impuesto*','trace','Exonerado\x20(0%)','Fecha\x20de\x20Vencimiento','ID\x20UNIT\x202','LTN','value','slice','LIBRAS','toLowerCase','utils','prototype','PAQUETE','LTR','DOCENA\x20POR\x2010**6','info','UNIDAD\x20(NIU)','DOCENA','Precio\x20Venta\x20Soles\x202','ONZ','Precio\x20Costo\x20Dólares\x202','YDK','561BALspq','METRO\x20CUADRADO','PEN_setMtoPrecioUnitario2','setItemBarCode2','xlsx','CONOS','1905990OgZBrF','RESMA','Inafecto\x20(0%)','PULGADAS','PLACAS','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','LITRO','Gravado\x20Gratuito\x20(10%)','read','Sheets','MILIMETRO\x20CUBICO','7916uDixRU','Serie','HLT','KILOVATIO\x20HORA','PIES\x20CUBICOS','exportDone','PEN_setMtoPrecioCostoUnitario2','DZP','508716safcUp','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','6937689ponRWM','5125bqvZWA','exception','TNE','parse_date_code','setUnidadCodigo','32zbpHRG','MTR','METRO','(((.+)+)+)+$','getFullYear','ID\x20UNIT','Nombre\x20del\x20Lote','setItemBarCode','Gravado\x20Gratuito\x20(18%)','PIEZAS','__proto__','CENTIMETRO\x20CUBICO','MIL','Iniciando\x20parseo…','Gravado\x20(18%)','MMT','PALETAS','1484pdjoom','setCodProducto','NIU','Unidad\x20de\x20Medida*','filter','MILIMETRO','GRO','USD_setMtoPrecioCostoUnitario2','SACO','setItemVariantValues','Stock\x20Actual','Exportando\x20filas\x20','number','console','Material','Modelo\x20de\x20Manga','KILOGRAMO','Gravado\x20(10%)','BARRILES','Ubicación','setTaxId','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','constructor','length','CMT','Exportación\x20(0%)','Descripción','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','progress','MLT','El\x20archivo\x20tiene\x20','KGM','Precio\x20Costo\x20Dólares','US\x20GALON\x20(3,7843\x20L)','PIES\x20CUADRADOS','\x20de\x20','CILINDRO','setBatchName','GLI','setCategoria','MILLARES','Código\x20de\x20Barras\x202','PEN_setMtoPrecioCostoUnitario','Código\x20de\x20Barras','push','YARDA','PAR','Marca','¿Rastrear\x20Inventario?','JUEGO','PIES','trim','FARDO','BOLSA','Precio\x20Venta\x20Dólares\x202','MILLON\x20DE\x20UNIDADES','find','bind','Precio\x20Venta\x20Dólares','Código\x20SKU*','setBatchExpirationDate','TONELADA\x20CORTA'];_0x21e0=function(){return _0x3594c4;};return _0x21e0();}const _0x59944e=_0xeede;(function(_0x49e751,_0x1750e0){const _0x28eb3c=_0xeede,_0x5e63e6=_0x49e751();while(!![]){try{const _0x404529=-parseInt(_0x28eb3c(0x1fd))/0x1*(-parseInt(_0x28eb3c(0x29c))/0x2)+-parseInt(_0x28eb3c(0x2bc))/0x3*(-parseInt(_0x28eb3c(0x1f2))/0x4)+parseInt(_0x28eb3c(0x257))/0x5+parseInt(_0x28eb3c(0x269))/0x6*(parseInt(_0x28eb3c(0x213))/0x7)+-parseInt(_0x28eb3c(0x202))/0x8*(parseInt(_0x28eb3c(0x1fa))/0x9)+-parseInt(_0x28eb3c(0x2c2))/0xa+-parseInt(_0x28eb3c(0x1fc))/0xb;if(_0x404529===_0x1750e0)break;else _0x5e63e6['push'](_0x5e63e6['shift']());}catch(_0x138a9a){_0x5e63e6['push'](_0x5e63e6['shift']());}}}(_0x21e0,0x32f2f));function _0xeede(_0x4fe2e4,_0x56460d){const _0x149a91=_0x21e0();return _0xeede=function(_0x2d2a17,_0x11510b){_0x2d2a17=_0x2d2a17-0x1eb;let _0x35f3fd=_0x149a91[_0x2d2a17];return _0x35f3fd;},_0xeede(_0x4fe2e4,_0x56460d);}const _0x20b00c=(function(){let _0xf78a13=!![];return function(_0x12d697,_0x29dc00){const _0x5eaf01=_0xf78a13?function(){const _0x4e8540=_0xeede;if(_0x29dc00){const _0x8fb82a=_0x29dc00[_0x4e8540(0x284)](_0x12d697,arguments);return _0x29dc00=null,_0x8fb82a;}}:function(){};return _0xf78a13=![],_0x5eaf01;};}()),_0x217771=_0x20b00c(this,function(){const _0x472cda=_0xeede;return _0x217771[_0x472cda(0x288)]()[_0x472cda(0x26a)](_0x472cda(0x205))[_0x472cda(0x288)]()['constructor'](_0x217771)['search'](_0x472cda(0x205));});_0x217771();const _0x11510b=(function(){let _0x3cde8d=!![];return function(_0xc53701,_0x44d8f6){const _0x3a360d=_0x3cde8d?function(){const _0x5c47bf=_0xeede;if(_0x44d8f6){const _0x4fba48=_0x44d8f6[_0x5c47bf(0x284)](_0xc53701,arguments);return _0x44d8f6=null,_0x4fba48;}}:function(){};return _0x3cde8d=![],_0x3a360d;};}()),_0x2d2a17=_0x11510b(this,function(){const _0x40a5ac=_0xeede,_0x3a7a33=function(){const _0x41d8b1=_0xeede;let _0x20c29b;try{_0x20c29b=Function(_0x41d8b1(0x278)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x380c13){_0x20c29b=window;}return _0x20c29b;},_0x34df40=_0x3a7a33(),_0x5306c6=_0x34df40[_0x40a5ac(0x220)]=_0x34df40[_0x40a5ac(0x220)]||{},_0x3504d7=[_0x40a5ac(0x259),'warn',_0x40a5ac(0x2b5),_0x40a5ac(0x274),_0x40a5ac(0x1fe),_0x40a5ac(0x2a5),_0x40a5ac(0x2a7)];for(let _0x12eb70=0x0;_0x12eb70<_0x3504d7[_0x40a5ac(0x22a)];_0x12eb70++){const _0x43d7e9=_0x11510b[_0x40a5ac(0x229)][_0x40a5ac(0x2b1)][_0x40a5ac(0x24c)](_0x11510b),_0x19963e=_0x3504d7[_0x12eb70],_0x1fbf82=_0x5306c6[_0x19963e]||_0x43d7e9;_0x43d7e9[_0x40a5ac(0x20c)]=_0x11510b['bind'](_0x11510b),_0x43d7e9['toString']=_0x1fbf82['toString']['bind'](_0x1fbf82),_0x5306c6[_0x19963e]=_0x43d7e9;}});_0x2d2a17(),importScripts(_0x59944e(0x22e)),onmessage=({data:_0x581f13})=>{const _0xb6e840=_0x59944e,{action:_0x307491}=_0x581f13;if(_0x307491===_0xb6e840(0x27e)){const {buf:_0x2aafce,maxRows:_0x2e7c98}=_0x581f13;try{postMessage({'type':_0xb6e840(0x22f),'payload':{'percent':0x5,'message':_0xb6e840(0x20f)}});const _0xcbfd22=XLSX[_0xb6e840(0x1ef)](_0x2aafce,{'type':_0xb6e840(0x26e),'cellDates':!![]}),_0x3c1c71=_0xcbfd22[_0xb6e840(0x1f0)][_0xcbfd22['SheetNames'][0x0]],_0x24a0f2=XLSX[_0xb6e840(0x2b0)][_0xb6e840(0x272)](_0x3c1c71,{'defval':'','range':0x1,'cellDates':!![]}),_0x207a8a=_0x24a0f2[_0xb6e840(0x283)](_0x157df0=>(!_0x157df0['Tipo*']||String(_0x157df0[_0xb6e840(0x291)])[_0xb6e840(0x246)]()==='')&&(!_0x157df0[_0xb6e840(0x24e)]||String(_0x157df0[_0xb6e840(0x24e)])[_0xb6e840(0x246)]()==='')&&(!_0x157df0[_0xb6e840(0x276)]||String(_0x157df0[_0xb6e840(0x276)])[_0xb6e840(0x246)]()==='')&&(!_0x157df0[_0xb6e840(0x216)]||String(_0x157df0[_0xb6e840(0x216)])[_0xb6e840(0x246)]()==='')),_0x490a1c=_0x207a8a>=0x0?_0x24a0f2[_0xb6e840(0x2ad)](0x0,_0x207a8a):_0x24a0f2,_0x52fff6=_0x490a1c[_0xb6e840(0x217)](_0x4fd6d5=>_0x4fd6d5['Tipo*']&&String(_0x4fd6d5['Tipo*'])['trim']()!==''&&_0x4fd6d5['Código\x20SKU*']&&String(_0x4fd6d5[_0xb6e840(0x24e)])[_0xb6e840(0x246)]()!==''&&_0x4fd6d5[_0xb6e840(0x276)]&&String(_0x4fd6d5['Nombre*'])['trim']()!==''&&_0x4fd6d5[_0xb6e840(0x216)]&&String(_0x4fd6d5[_0xb6e840(0x216)])[_0xb6e840(0x246)]()!==''),_0x3c90e0=_0x52fff6['length'];if(_0x3c90e0===0x0){postMessage({'type':_0xb6e840(0x274),'payload':_0xb6e840(0x1fb)});return;}if(_0x3c90e0>_0x2e7c98)throw _0xb6e840(0x231)+_0x3c90e0+_0xb6e840(0x1ec)+_0x2e7c98+'.';const _0xb29d23=0x1f4,_0x2931ac=[],_0x2099ae=[{'codigo':'4A','nombre':_0xb6e840(0x29b)},{'codigo':'BJ','nombre':_0xb6e840(0x287)},{'codigo':'BLL','nombre':_0xb6e840(0x225)},{'codigo':'BG','nombre':_0xb6e840(0x248)},{'codigo':'BO','nombre':_0xb6e840(0x25d)},{'codigo':'BX','nombre':_0xb6e840(0x2a2)},{'codigo':'CT','nombre':_0xb6e840(0x25c)},{'codigo':'CMK','nombre':_0xb6e840(0x254)},{'codigo':_0xb6e840(0x29e),'nombre':_0xb6e840(0x20d)},{'codigo':_0xb6e840(0x22b),'nombre':'CENTIMETRO\x20LINEAL'},{'codigo':'CEN','nombre':_0xb6e840(0x28b)},{'codigo':'CY','nombre':_0xb6e840(0x237)},{'codigo':'CJ','nombre':'CONOS'},{'codigo':_0xb6e840(0x29f),'nombre':_0xb6e840(0x2b7)},{'codigo':_0xb6e840(0x1f9),'nombre':_0xb6e840(0x2b4)},{'codigo':'BE','nombre':_0xb6e840(0x247)},{'codigo':_0xb6e840(0x239),'nombre':'GALON\x20INGLES\x20(4,545956L)'},{'codigo':'GRM','nombre':_0xb6e840(0x264)},{'codigo':_0xb6e840(0x219),'nombre':_0xb6e840(0x277)},{'codigo':_0xb6e840(0x1f4),'nombre':'HECTOLITRO'},{'codigo':'LEF','nombre':_0xb6e840(0x286)},{'codigo':'SET','nombre':_0xb6e840(0x244)},{'codigo':_0xb6e840(0x232),'nombre':_0xb6e840(0x223)},{'codigo':'KTM','nombre':'KILOMETRO'},{'codigo':'KWH','nombre':_0xb6e840(0x1f5)},{'codigo':'KT','nombre':'KIT'},{'codigo':'CA','nombre':_0xb6e840(0x27d)},{'codigo':_0xb6e840(0x289),'nombre':_0xb6e840(0x2ae)},{'codigo':_0xb6e840(0x2b3),'nombre':'LITRO'},{'codigo':_0xb6e840(0x27a),'nombre':_0xb6e840(0x2a3)},{'codigo':_0xb6e840(0x203),'nombre':_0xb6e840(0x204)},{'codigo':'MTK','nombre':_0xb6e840(0x2bd)},{'codigo':_0xb6e840(0x251),'nombre':_0xb6e840(0x275)},{'codigo':'MGM','nombre':_0xb6e840(0x26c)},{'codigo':_0xb6e840(0x230),'nombre':_0xb6e840(0x28a)},{'codigo':_0xb6e840(0x211),'nombre':'MILIMETRO'},{'codigo':_0xb6e840(0x253),'nombre':_0xb6e840(0x295)},{'codigo':'MMQ','nombre':'MILIMETRO\x20CUBICO'},{'codigo':_0xb6e840(0x20e),'nombre':_0xb6e840(0x23b)},{'codigo':'UM','nombre':_0xb6e840(0x24a)},{'codigo':_0xb6e840(0x2b9),'nombre':_0xb6e840(0x297)},{'codigo':'PF','nombre':_0xb6e840(0x212)},{'codigo':'PK','nombre':_0xb6e840(0x2b2)},{'codigo':'PR','nombre':_0xb6e840(0x241)},{'codigo':'FOT','nombre':_0xb6e840(0x245)},{'codigo':'FTK','nombre':_0xb6e840(0x235)},{'codigo':_0xb6e840(0x2a1),'nombre':'PIES\x20CUBICOS'},{'codigo':'C62','nombre':_0xb6e840(0x20b)},{'codigo':'PG','nombre':'PLACAS'},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':'INH','nombre':_0xb6e840(0x2c5)},{'codigo':'RM','nombre':_0xb6e840(0x2c3)},{'codigo':'SA','nombre':_0xb6e840(0x21b)},{'codigo':'DR','nombre':_0xb6e840(0x2a4)},{'codigo':'STN','nombre':_0xb6e840(0x250)},{'codigo':_0xb6e840(0x2ab),'nombre':_0xb6e840(0x260)},{'codigo':_0xb6e840(0x1ff),'nombre':'TONELADAS'},{'codigo':'TU','nombre':'TUBOS'},{'codigo':_0xb6e840(0x215),'nombre':_0xb6e840(0x2b6)},{'codigo':'ZZ','nombre':'UNIDAD\x20(ZZ)'},{'codigo':'GLL','nombre':_0xb6e840(0x234)},{'codigo':'YRD','nombre':_0xb6e840(0x240)},{'codigo':_0xb6e840(0x2bb),'nombre':_0xb6e840(0x27c)},{'codigo':'QQM','nombre':'QUINTAL'}],_0x3dc639=_0x2099ae[_0xb6e840(0x265)]((_0x9e736e,{nombre:_0x1e8d7f,codigo:_0x447501})=>{const _0x21104a=_0xb6e840;return _0x9e736e[_0x1e8d7f[_0x21104a(0x246)]()]=_0x447501[_0x21104a(0x246)](),_0x9e736e;},{});for(let _0x5e90=0x0;_0x5e90<_0x3c90e0;_0x5e90+=_0xb29d23){const _0x339b37=_0x52fff6[_0xb6e840(0x2ad)](_0x5e90,_0x5e90+_0xb29d23)['map']((_0x3d60d5,_0xd55423)=>{const _0x279b85=_0xb6e840;let _0x4c6390={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x3d60d5[_0x279b85(0x291)]]||'1';const _0x507ab4=String(_0x3d60d5[_0x279b85(0x2a6)])[_0x279b85(0x246)](),_0x32c88b={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x4b56fd=_0x32c88b[_0x507ab4]||'1',_0x2aa7d5={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x4b56fd]||{'code':'10','value':0x12},_0x4a256c={};let _0x184b9b=String(_0x3d60d5[_0x279b85(0x276)])[_0x279b85(0x246)]();const _0x3c5820=['Talla',_0x279b85(0x25e),_0x279b85(0x258),'Modelo',_0x279b85(0x1f3),_0x279b85(0x221),_0x279b85(0x27f),_0x279b85(0x222)];_0x3c5820[_0x279b85(0x29d)](_0x56c5a2=>{const _0x529632=_0x279b85,_0x4b1068=String(_0x3d60d5[_0x56c5a2]||'')[_0x529632(0x246)]();_0x4b1068&&(_0x4a256c[_0x56c5a2]=_0x4b1068,_0x184b9b+='\x20'+_0x56c5a2+'\x20'+_0x4b1068);});const _0x33ded7=[],_0x4ae284=String(_0x3d60d5[_0x279b85(0x216)]||_0x279b85(0x2b6))[_0x279b85(0x246)](),_0x5899df=_0x3dc639[_0x4ae284]||_0x279b85(0x215);_0x33ded7[_0x279b85(0x23f)]({'setItemUnitId':String(_0x3d60d5[_0x279b85(0x207)])[_0x279b85(0x246)]()||'','setItemBarCode':String(_0x3d60d5[_0x279b85(0x23e)])['trim']()||'','setAlias':_0x4ae284,'setUnitCode':_0x5899df,'setPrice':parseFloat(_0x3d60d5['Precio\x20Venta\x20Soles'])||0x0,'setCost':parseFloat(_0x3d60d5['Precio\x20Costo\x20Soles'])||0x0,'setPriceUSD':parseFloat(_0x3d60d5['Precio\x20Venta\x20Dólares'])||0x0,'setCostUSD':parseFloat(_0x3d60d5['Precio\x20Costo\x20Dólares'])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x2b77f3=[_0x279b85(0x2aa),'Código\x20de\x20Barras\x202',_0x279b85(0x273),_0x279b85(0x2b8),_0x279b85(0x266),_0x279b85(0x249),_0x279b85(0x2ba)][_0x279b85(0x285)](_0xcb15d7=>{const _0x4236ba=_0x279b85,_0x9252d3=_0x3d60d5[_0xcb15d7];return _0x9252d3!=null&&String(_0x9252d3)[_0x4236ba(0x246)]()!=='';});if(_0x2b77f3){const _0x4b4067=String(_0x3d60d5[_0x279b85(0x25b)]||_0x279b85(0x26f))[_0x279b85(0x246)](),_0x288145=_0x3dc639[_0x4b4067]||'NIU',_0x152759=parseFloat(_0x3d60d5['Precio\x20Venta\x20Soles\x202'])||0x0,_0x1a2741=parseFloat(_0x3d60d5[_0x279b85(0x266)])||0x0,_0x3136bc=parseFloat(_0x3d60d5[_0x279b85(0x249)])||0x0,_0x5bebfb=parseFloat(_0x3d60d5[_0x279b85(0x2ba)])||0x0,_0x591e01=parseFloat(_0x3d60d5[_0x279b85(0x273)])||0x1;_0x33ded7[_0x279b85(0x23f)]({'setItemUnitId':String(_0x3d60d5[_0x279b85(0x2aa)])[_0x279b85(0x246)]()||'','setItemBarCode':String(_0x3d60d5[_0x279b85(0x23c)])[_0x279b85(0x246)]()||'','setAlias':_0x4b4067,'setUnitCode':_0x288145,'setPrice':_0x152759,'setCost':_0x1a2741,'setPriceUSD':_0x3136bc,'setCostUSD':_0x5bebfb,'setDefault':0x0,'setEquivalence':_0x591e01,'setFactor':_0x591e01});}let _0x3b97aa=_0x3d60d5[_0x279b85(0x2a9)],_0x240827='';if(_0x3b97aa instanceof Date){const _0x2b88d5=_0x3b97aa[_0x279b85(0x206)](),_0x50154b=String(_0x3b97aa['getMonth']()+0x1)[_0x279b85(0x263)](0x2,'0'),_0x202f55=String(_0x3b97aa['getDate']())[_0x279b85(0x263)](0x2,'0');_0x240827=_0x2b88d5+'-'+_0x50154b+'-'+_0x202f55;}else{if(typeof _0x3b97aa===_0x279b85(0x21f)){const _0x1b64ee=XLSX['SSF'][_0x279b85(0x200)](_0x3b97aa);if(_0x1b64ee){const _0x2ce4c0=_0x1b64ee['y'],_0x552231=String(_0x1b64ee['m'])[_0x279b85(0x263)](0x2,'0'),_0x31cfaa=String(_0x1b64ee['d'])[_0x279b85(0x263)](0x2,'0');_0x240827=_0x2ce4c0+'-'+_0x552231+'-'+_0x31cfaa;}}else _0x240827=String(_0x3b97aa||'')[_0x279b85(0x246)]();}return{'setItemId':String(_0x3d60d5['ID'])[_0x279b85(0x246)](),'setItemType':_0x4c6390,'setItemCode':String(_0x3d60d5[_0x279b85(0x24e)])[_0x279b85(0x246)](),'setItemName':String(_0x3d60d5['Nombre*'])[_0x279b85(0x246)](),'setItemDescription':String(_0x3d60d5[_0x279b85(0x22d)])[_0x279b85(0x246)]()||'','setItemCategories':_0x3d60d5['Categoría']?[String(_0x3d60d5[_0x279b85(0x261)])[_0x279b85(0x246)]()]:[],'setItemBrands':_0x3d60d5[_0x279b85(0x242)]?[String(_0x3d60d5[_0x279b85(0x242)])[_0x279b85(0x246)]()]:[],'setItemTaxId':_0x4b56fd,'setItemTaxCode':_0x2aa7d5[_0x279b85(0x28f)],'setItemTaxValue':_0x2aa7d5[_0x279b85(0x2ac)],'setItemUnits':_0x33ded7,'setItemInventoriable':_0x3d60d5[_0x279b85(0x243)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x3d60d5[_0x279b85(0x21d)])||0x0,'setStockMinimum':parseFloat(_0x3d60d5[_0x279b85(0x26b)])||0x0,'setItemLocation':String(_0x3d60d5[_0x279b85(0x226)])['trim']()||'','setBatchName':String(_0x3d60d5[_0x279b85(0x208)])[_0x279b85(0x246)]()||'','setItemDateExpiry':_0x240827,'setItemVariantName':_0x184b9b,'setItemVariantValues':_0x4a256c,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x2931ac[_0xb6e840(0x23f)](..._0x339b37),postMessage({'type':_0xb6e840(0x22f),'payload':{'percent':Math[_0xb6e840(0x293)]((_0x5e90+_0x339b37[_0xb6e840(0x22a)])/_0x3c90e0*0x64),'message':'Procesadas\x20filas\x20'+(_0x5e90+0x1)+'–'+(_0x5e90+_0x339b37[_0xb6e840(0x22a)])+'/'+_0x3c90e0}});}postMessage({'type':_0xb6e840(0x27b),'payload':{'items':_0x2931ac}});}catch(_0x4c8fde){postMessage({'type':_0xb6e840(0x274),'payload':_0x4c8fde[_0xb6e840(0x29a)]||_0x4c8fde});}}if(_0x307491===_0xb6e840(0x25a)){const {products:_0x1e5192,plantillaBuf:_0x5ad271}=_0x581f13;if(!(_0x5ad271 instanceof ArrayBuffer)){postMessage({'type':_0xb6e840(0x274),'payload':_0xb6e840(0x228)});return;}if(!Array['isArray'](_0x1e5192)){postMessage({'type':'error','payload':_0xb6e840(0x268)});return;}try{structuredClone(_0x1e5192);}catch(_0x2fb048){postMessage({'type':_0xb6e840(0x274),'payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x2fb048[_0xb6e840(0x29a)]});return;}try{const _0x4f51ad={'1':_0xb6e840(0x28c),'2':_0xb6e840(0x2a0),'3':_0xb6e840(0x282),'4':_0xb6e840(0x252),'5':_0xb6e840(0x256)};function _0xb9a09a(_0x2788f8){return _0x4f51ad[String(_0x2788f8)]||'Artículo';}const _0x338c28={'1':_0xb6e840(0x210),'2':_0xb6e840(0x2a8),'3':_0xb6e840(0x2c4),'4':_0xb6e840(0x20a),'5':_0xb6e840(0x296),'6':_0xb6e840(0x224),'7':_0xb6e840(0x262),'8':_0xb6e840(0x22c),'9':_0xb6e840(0x1ee)};function _0x2939ab(_0x38699c){return _0x338c28[String(_0x38699c)]||'Gravado\x20(18%)';}const _0x48f083={'4A':_0xb6e840(0x29b),'BJ':_0xb6e840(0x287),'BLL':_0xb6e840(0x225),'BG':_0xb6e840(0x248),'BO':_0xb6e840(0x25d),'BX':'CAJA','CT':_0xb6e840(0x25c),'CMK':_0xb6e840(0x254),'CMQ':_0xb6e840(0x20d),'CMT':_0xb6e840(0x270),'CEN':_0xb6e840(0x28b),'CY':'CILINDRO','CJ':_0xb6e840(0x2c1),'DZN':_0xb6e840(0x2b7),'DZP':_0xb6e840(0x2b4),'BE':_0xb6e840(0x247),'GLI':_0xb6e840(0x271),'GRM':_0xb6e840(0x264),'GRO':'GRUESA','HLT':'HECTOLITRO','LEF':_0xb6e840(0x286),'SET':'JUEGO','KGM':_0xb6e840(0x223),'KTM':'KILOMETRO','KWH':_0xb6e840(0x1f5),'KT':'KIT','CA':_0xb6e840(0x27d),'LBR':'LIBRAS','LTR':_0xb6e840(0x1ed),'MWH':_0xb6e840(0x2a3),'MTR':_0xb6e840(0x204),'MTK':'METRO\x20CUADRADO','MTQ':_0xb6e840(0x275),'MGM':'MILIGRAMOS','MLT':_0xb6e840(0x28a),'MMT':_0xb6e840(0x218),'MMK':_0xb6e840(0x295),'MMQ':_0xb6e840(0x1f1),'MIL':_0xb6e840(0x23b),'UM':_0xb6e840(0x24a),'ONZ':_0xb6e840(0x297),'PF':_0xb6e840(0x212),'PK':_0xb6e840(0x2b2),'PR':'PAR','FOT':_0xb6e840(0x245),'FTK':'PIES\x20CUADRADOS','FTQ':_0xb6e840(0x1f6),'C62':'PIEZAS','PG':_0xb6e840(0x1eb),'ST':'PLIEGO','INH':_0xb6e840(0x2c5),'RM':'RESMA','SA':_0xb6e840(0x21b),'DR':_0xb6e840(0x2a4),'STN':_0xb6e840(0x250),'LTN':_0xb6e840(0x260),'TNE':'TONELADAS','TU':_0xb6e840(0x281),'NIU':_0xb6e840(0x2b6),'ZZ':'UNIDAD\x20(ZZ)','GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':'YARDA','YDK':'YARDA\x20CUADRADA','QQM':'QUINTAL'};function _0x3721d3(_0x287ec0){return _0x48f083[String(_0x287ec0)]||'';}const _0x43280e=XLSX[_0xb6e840(0x1ef)](_0x5ad271,{'type':_0xb6e840(0x26e),'cellDates':!![]}),_0x4786a5=_0x43280e['SheetNames'][0x0],_0x4a2121=_0x43280e[_0xb6e840(0x1f0)][_0x4786a5],_0x11f690=XLSX[_0xb6e840(0x2b0)][_0xb6e840(0x272)](_0x4a2121,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x28fdab=XLSX[_0xb6e840(0x2b0)]['decode_range'](_0x4a2121[_0xb6e840(0x25f)]||'');for(let _0x350cc1=0x2;_0x350cc1<=_0x28fdab['e']['r'];++_0x350cc1){for(let _0x58687a=_0x28fdab['s']['c'];_0x58687a<=_0x28fdab['e']['c'];++_0x58687a){const _0x444895=XLSX[_0xb6e840(0x2b0)]['encode_cell']({'r':_0x350cc1,'c':_0x58687a});if(_0x4a2121[_0x444895])delete _0x4a2121[_0x444895];}}const _0x464963=_0x1e5192[_0xb6e840(0x267)](_0x50f772=>{const _0x293277=_0xb6e840;_0x50f772[_0x293277(0x21c)]=_0x50f772[_0x293277(0x21c)]||{};const _0x12ee8d={};return _0x11f690[_0x293277(0x29d)](_0x556110=>{const _0x836945=_0x293277,_0x569a33=String(_0x556110)['trim'](),_0x469173=_0x569a33[_0x836945(0x2af)](),_0x2809c2=Object[_0x836945(0x290)](_0x50f772)[_0x836945(0x24b)](_0x2100a2=>_0x2100a2[_0x836945(0x246)]()['toLowerCase']()===_0x469173);if(_0x2809c2){_0x12ee8d[_0x569a33]=_0x50f772[_0x2809c2]??'';return;}switch(_0x569a33){case'ID':_0x12ee8d[_0x569a33]=_0x50f772['id']??'';break;case _0x836945(0x291):_0x12ee8d[_0x569a33]=_0xb9a09a(_0x50f772[_0x836945(0x255)]);break;case'Código\x20SKU*':_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x214)]??'';break;case _0x836945(0x276):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x299)]??'';break;case _0x836945(0x22d):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x279)]??'';break;case'Categoría':_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x23a)]??'';break;case _0x836945(0x242):_0x12ee8d[_0x569a33]=_0x50f772['setMarca']??'';break;case _0x836945(0x2a6):_0x12ee8d[_0x569a33]=_0x2939ab(_0x50f772[_0x836945(0x227)]);break;case'ID\x20UNIT':_0x12ee8d[_0x569a33]=_0x50f772['setUnitId']??'';break;case'Código\x20de\x20Barras':_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x209)]??'';break;case _0x836945(0x216):_0x12ee8d[_0x569a33]=_0x3721d3(_0x50f772[_0x836945(0x201)]);break;case'Precio\x20Venta\x20Soles':_0x12ee8d[_0x569a33]=_0x50f772['PEN_setMtoPrecioUnitario']??'';break;case _0x836945(0x28e):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x23d)]??'';break;case _0x836945(0x24d):_0x12ee8d[_0x569a33]=_0x50f772['USD_setMtoPrecioUnitario']??'';break;case _0x836945(0x233):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x292)]??'';break;case'ID\x20UNIT\x202':_0x12ee8d[_0x569a33]=_0x50f772['setUnitId2']??'';break;case _0x836945(0x23c):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x2bf)]??'';break;case'Unidad\x20de\x20Medida\x202':_0x12ee8d[_0x569a33]=_0x3721d3(_0x50f772[_0x836945(0x294)]);break;case _0x836945(0x273):_0x12ee8d[_0x569a33]=_0x50f772['setUnidadEquivalencia2']??'1';break;case _0x836945(0x2b8):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x2be)]??'';break;case _0x836945(0x266):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x1f8)]??'';break;case _0x836945(0x249):_0x12ee8d[_0x569a33]=_0x50f772['USD_setMtoPrecioUnitario2']??'';break;case _0x836945(0x2ba):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x21a)]??'';break;case'¿Rastrear\x20Inventario?':_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x28d)]==0x1?'SI':'NO';break;case'Stock\x20Actual':_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x280)]??'';break;case'Stock\x20Mínimo':_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x298)]??'';break;case'Nombre\x20del\x20Lote':_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x238)]??'';break;case _0x836945(0x2a9):_0x12ee8d[_0x569a33]=_0x50f772[_0x836945(0x24f)]??'';break;default:_0x12ee8d[_0x569a33]='';}}),_0x12ee8d;}),_0x4f3070=0x3e8,_0x2b8f18=_0x464963[_0xb6e840(0x22a)];for(let _0x235469=0x0;_0x235469<_0x2b8f18;_0x235469+=_0x4f3070){const _0x8c3d0e=_0x464963['slice'](_0x235469,_0x235469+_0x4f3070);XLSX[_0xb6e840(0x2b0)]['sheet_add_json'](_0x4a2121,_0x8c3d0e,{'origin':{'r':_0x235469+0x2,'c':0x0},'skipHeader':!![],'header':_0x11f690}),postMessage({'type':'progress','payload':{'percent':Math[_0xb6e840(0x293)]((_0x235469+_0x8c3d0e[_0xb6e840(0x22a)])/_0x2b8f18*0x64),'message':_0xb6e840(0x21e)+(_0x235469+0x1)+'–'+(_0x235469+_0x8c3d0e['length'])+_0xb6e840(0x236)+_0x2b8f18}});}const _0x54690f={'s':{'r':0x0,'c':0x0},'e':{'r':_0x2b8f18+0x1,'c':_0x11f690[_0xb6e840(0x22a)]-0x1}};_0x4a2121[_0xb6e840(0x25f)]=XLSX['utils']['encode_range'](_0x54690f);const _0x18e883=XLSX['write'](_0x43280e,{'bookType':_0xb6e840(0x2c0),'type':_0xb6e840(0x26e)});let _0x4e2683,_0x142d90;if(_0x18e883 instanceof Uint8Array)_0x4e2683=_0x18e883,_0x142d90=[_0x18e883[_0xb6e840(0x26d)]];else{if(_0x18e883 instanceof ArrayBuffer)_0x4e2683=new Uint8Array(_0x18e883),_0x142d90=[_0x18e883];else{const _0xd5bc32=new Uint8Array(_0x18e883);_0x4e2683=_0xd5bc32,_0x142d90=[_0xd5bc32[_0xb6e840(0x26d)]];}}postMessage({'type':_0xb6e840(0x1f7),'payload':{'wbout':_0x4e2683,'count':_0x464963[_0xb6e840(0x22a)]}},_0x142d90);}catch(_0x3e69d3){postMessage({'type':_0xb6e840(0x274),'payload':_0x3e69d3['message']||String(_0x3e69d3)});}return;}};