/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.1.7
*/

function _0x4a8d(){const _0x425886=['setItemUnitAlias3','Stock\x20Actual','read','setItemUnitAlias','PLIEGO','TONELADA\x20CORTA','TUBOS','C62','HOJA','PAR','ID\x20UNIT\x203','MILIMETRO\x20CUBICO','KILOGRAMO','LTN','setItemCommissionPercentage','bind','TONELADAS','Color','MTQ','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','MILILITRO','Comisión\x20Venta\x203\x20(%)','exportItems:\x20productos\x20no\x20clonables:\x20','13575618FGicMV','Fabricado','USD_setMtoPrecioCostoUnitario3','FTK','Procesadas\x20filas\x20','FOT','Nombre*','Precio\x20Costo\x20Soles\x202','code','FTQ','PEN_setMtoPrecioUnitario3','Impuesto*','Género','Talla','setItemVariantValues','padStart','PEN_setMtoPrecioCostoUnitario2','CEN','setUnidadEquivalencia2','GALON\x20INGLES\x20(4,545956L)','round','Marca','exportItems','CMK','MIL','FARDO','setUnitId2','parse_date_code','ID\x20UNIT\x202','Unidad\x20de\x20Medida\x202','MGM','YARDA','(((.+)+)+)+$','info','GRAMO','setTaxId','encode_cell','GRM','MTK','Código\x20SKU*','ONZAS','Unidad\x20de\x20Medida\x203','Sheets','METRO\x20CUADRADO','getFullYear','Precio\x20Costo\x20Dólares','!ref','buffer','GRUESA','BOLSA','Precio\x20Venta\x20Dólares\x202','\x20de\x20','26455700AEUADh','isArray','setUnitId','CENTIMETRO\x20LINEAL','Alias\x203','setMarca','Stock\x20Mínimo','CENTIMETRO\x20CUADRADO','setItemIsBought','USD_setMtoPrecioCostoUnitario2','warn','Precio\x20Costo\x20Soles','MMQ','CAJA','constructor','PIES','Precio\x20Costo\x20Dólares\x203','array','UND\x20(NIU)','DOCENA','ID\x20UNIT','Precio\x20Venta\x20Soles\x202','MILLARES','setUnitId3','setUnidadCodigo3','setUnidadCodigo2','sheet_to_json','TAMBOR','BARRILES','LITRO','Artículo','Exonerado\x20(0%)','UNIDAD\x20(NIU)','CARTONES','ONZ','Comisión\x20Venta\x202\x20(%)','YARDA\x20CUADRADA','USD_setMtoPrecioUnitario3','Precio\x20Venta\x20Dólares\x203','MMT','__proto__','Servicio','MILIMETRO\x20CUADRADO','search','{}.constructor(\x22return\x20this\x22)(\x20)','done','PEN_setMtoPrecioUnitario','DZN','Categoría','setItemUnitAlias2','INH','1860iUaEZs','Gravado\x20(18%)','push','PULGADAS','YRD','MWH','QQM','toString','PEN_setMtoPrecioCostoUnitario','CENTIMETRO\x20CUBICO','Alias\x202','setItemIsSold','value','DOCENA\x20POR\x2010**6','Comisión\x20Venta\x20(%)','reduce','MMK','25064vDvtfP','PAQUETE','Gravado\x20(10%)','2TihwoY','Se\x20Compra','console','NIU','error','Serie','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','Precio\x20Venta\x20Soles\x203','sheet_add_json','Precio\x20Venta\x20Dólares','BLL','PEN_setMtoPrecioUnitario2','Rastrear\x20Inventario','GLI','PIES\x20CUADRADOS','BOTELLAS','table','Código\x20de\x20Barras\x203','MLT','decode_range','MTR','CMQ','some','KIT','749lQUSbe','SACO','Exportando\x20filas\x20','setWarehouseStockMin','setCodProducto','map','PIES\x20CUBICOS','RESMA','xlsx','CILINDRO','JUEGO','12844IRSxPb','CIENTO\x20DE\x20UNIDADES','1953927DHyUdz','METRO','LTR','Unidad\x20de\x20Medida*','return\x20(function()\x20','PIEZAS','utils','Tipo*','BALDE','Modelo\x20de\x20Cuello','setInventariable','LIBRAS','UNIDAD\x20(ZZ)','Precio\x20Venta\x20Soles','setItemCommissionPercentage2','setItemType','setItemDescription','PALETAS','TONELADA\x20LARGA','trim','SET','US\x20GALON\x20(3,7843\x20L)','BOBINAS','Se\x20Vende','apply','Código\x20de\x20Barras\x202','write','1477092BQUDld','message','Precio\x20Costo\x20Soles\x203','GRO','SheetNames','prototype','setItemBarCode2','length','PEN_setMtoPrecioCostoUnitario3','KWH','filter','Lote','PLACAS','QUINTAL','LATAS','USD_setMtoPrecioUnitario','HECTOLITRO','LEF','KILOMETRO','find','Descripción','Exonerado\x20Gratuito\x20(0%)','Equivalencia\x202','Código\x20de\x20Barras','METRO\x20CUBICO','Modelo\x20de\x20Manga','MEGAWATT\x20HORA','keys','number','findIndex','Equivalencia\x203','toLowerCase','MILIGRAMOS','forEach','Iniciando\x20parseo…','DZP','Alias','MILIMETRO','9931992oFePaM','Precio\x20Costo\x20Dólares\x202','Fecha\x20de\x20Vencimiento','CONOS'];_0x4a8d=function(){return _0x425886;};return _0x4a8d();}(function(_0x5d5c2a,_0x4816ef){const _0x39133f=_0x437f,_0x338838=_0x5d5c2a();while(!![]){try{const _0x76ecbc=parseInt(_0x39133f(0x230))/0x1+-parseInt(_0x39133f(0x1f0))/0x2*(-parseInt(_0x39133f(0x215))/0x3)+parseInt(_0x39133f(0x213))/0x4*(parseInt(_0x39133f(0x1dc))/0x5)+-parseInt(_0x39133f(0x256))/0x6+-parseInt(_0x39133f(0x208))/0x7*(-parseInt(_0x39133f(0x1ed))/0x8)+parseInt(_0x39133f(0x271))/0x9+-parseInt(_0x39133f(0x2a5))/0xa;if(_0x76ecbc===_0x4816ef)break;else _0x338838['push'](_0x338838['shift']());}catch(_0x2e5b36){_0x338838['push'](_0x338838['shift']());}}}(_0x4a8d,0xd3558));const _0x5a9167=(function(){let _0x2f4c88=!![];return function(_0x590019,_0x72deb){const _0x563940=_0x2f4c88?function(){const _0x338f8d=_0x437f;if(_0x72deb){const _0x75500e=_0x72deb[_0x338f8d(0x22d)](_0x590019,arguments);return _0x72deb=null,_0x75500e;}}:function(){};return _0x2f4c88=![],_0x563940;};}()),_0xd632b8=_0x5a9167(this,function(){const _0x54b48c=_0x437f;return _0xd632b8['toString']()['search']('(((.+)+)+)+$')['toString']()[_0x54b48c(0x2b3)](_0xd632b8)[_0x54b48c(0x1d4)](_0x54b48c(0x291));});_0xd632b8();const _0x1f6a94=(function(){let _0x39aafa=!![];return function(_0x1d6b66,_0x4397f0){const _0x5bc3a9=_0x39aafa?function(){if(_0x4397f0){const _0x34750c=_0x4397f0['apply'](_0x1d6b66,arguments);return _0x4397f0=null,_0x34750c;}}:function(){};return _0x39aafa=![],_0x5bc3a9;};}()),_0xd1fe75=_0x1f6a94(this,function(){const _0x38b66b=_0x437f,_0x57671e=function(){const _0x42bbe9=_0x437f;let _0x5d87d9;try{_0x5d87d9=Function(_0x42bbe9(0x219)+_0x42bbe9(0x1d5)+');')();}catch(_0x1eaacf){_0x5d87d9=window;}return _0x5d87d9;},_0x413173=_0x57671e(),_0x30d979=_0x413173[_0x38b66b(0x1f2)]=_0x413173['console']||{},_0x445397=['log',_0x38b66b(0x2af),_0x38b66b(0x292),_0x38b66b(0x1f4),'exception',_0x38b66b(0x200),'trace'];for(let _0x1188bc=0x0;_0x1188bc<_0x445397[_0x38b66b(0x237)];_0x1188bc++){const _0x3ec622=_0x1f6a94[_0x38b66b(0x2b3)][_0x38b66b(0x235)]['bind'](_0x1f6a94),_0x5b6a47=_0x445397[_0x1188bc],_0x39430c=_0x30d979[_0x5b6a47]||_0x3ec622;_0x3ec622[_0x38b66b(0x1d1)]=_0x1f6a94[_0x38b66b(0x269)](_0x1f6a94),_0x3ec622[_0x38b66b(0x1e3)]=_0x39430c[_0x38b66b(0x1e3)][_0x38b66b(0x269)](_0x39430c),_0x30d979[_0x5b6a47]=_0x3ec622;}});function _0x437f(_0x2b60a9,_0x2f3ab5){const _0x35fbab=_0x4a8d();return _0x437f=function(_0xd1fe75,_0x1f6a94){_0xd1fe75=_0xd1fe75-0x1c4;let _0x4505a9=_0x35fbab[_0xd1fe75];return _0x4505a9;},_0x437f(_0x2b60a9,_0x2f3ab5);}_0xd1fe75(),importScripts('https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js'),onmessage=({data:_0x17f977})=>{const _0x30feb2=_0x437f,{action:_0x286537}=_0x17f977;if(_0x286537==='import'){const {buf:_0x2834f6,maxRows:_0x1d6706}=_0x17f977;try{postMessage({'type':'progress','payload':{'percent':0x5,'message':_0x30feb2(0x252)}});const _0x54e556=XLSX[_0x30feb2(0x25c)](_0x2834f6,{'type':_0x30feb2(0x2b6),'cellDates':!![]}),_0x4bdaa6=_0x54e556[_0x30feb2(0x29b)][_0x54e556[_0x30feb2(0x234)][0x0]],_0xb3b735=XLSX[_0x30feb2(0x21b)]['sheet_to_json'](_0x4bdaa6,{'defval':'','range':0x1,'cellDates':!![]}),_0x13318e=_0xb3b735[_0x30feb2(0x24d)](_0x424c5e=>(!_0x424c5e[_0x30feb2(0x21c)]||String(_0x424c5e['Tipo*'])[_0x30feb2(0x228)]()==='')&&(!_0x424c5e[_0x30feb2(0x298)]||String(_0x424c5e[_0x30feb2(0x298)])[_0x30feb2(0x228)]()==='')&&(!_0x424c5e['Nombre*']||String(_0x424c5e[_0x30feb2(0x277)])['trim']()==='')&&(!_0x424c5e['Unidad\x20de\x20Medida*']||String(_0x424c5e['Unidad\x20de\x20Medida*'])[_0x30feb2(0x228)]()==='')),_0x286d8e=_0x13318e>=0x0?_0xb3b735['slice'](0x0,_0x13318e):_0xb3b735,_0x19c716=_0x286d8e[_0x30feb2(0x23a)](_0x13d2b7=>_0x13d2b7['Tipo*']&&String(_0x13d2b7[_0x30feb2(0x21c)])[_0x30feb2(0x228)]()!==''&&_0x13d2b7[_0x30feb2(0x298)]&&String(_0x13d2b7[_0x30feb2(0x298)])['trim']()!==''&&_0x13d2b7[_0x30feb2(0x277)]&&String(_0x13d2b7['Nombre*'])[_0x30feb2(0x228)]()!==''&&_0x13d2b7[_0x30feb2(0x218)]&&String(_0x13d2b7['Unidad\x20de\x20Medida*'])[_0x30feb2(0x228)]()!==''),_0x662949=_0x19c716['length'];if(_0x662949===0x0){postMessage({'type':_0x30feb2(0x1f4),'payload':_0x30feb2(0x1f6)});return;}if(_0x662949>_0x1d6706)throw'El\x20archivo\x20tiene\x20'+_0x662949+'\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20'+_0x1d6706+'.';const _0x4a59eb=0x1f4,_0x43cc5d=[],_0x285606=[{'codigo':'4A','nombre':_0x30feb2(0x22b)},{'codigo':'BJ','nombre':_0x30feb2(0x21d)},{'codigo':_0x30feb2(0x1fa),'nombre':_0x30feb2(0x1c5)},{'codigo':'BG','nombre':_0x30feb2(0x2a2)},{'codigo':'BO','nombre':_0x30feb2(0x1ff)},{'codigo':'BX','nombre':_0x30feb2(0x2b2)},{'codigo':'CT','nombre':_0x30feb2(0x1ca)},{'codigo':_0x30feb2(0x288),'nombre':_0x30feb2(0x2ac)},{'codigo':_0x30feb2(0x205),'nombre':_0x30feb2(0x1e5)},{'codigo':'CMT','nombre':_0x30feb2(0x2a8)},{'codigo':_0x30feb2(0x282),'nombre':_0x30feb2(0x214)},{'codigo':'CY','nombre':_0x30feb2(0x211)},{'codigo':'CJ','nombre':_0x30feb2(0x259)},{'codigo':_0x30feb2(0x1d8),'nombre':_0x30feb2(0x2b8)},{'codigo':_0x30feb2(0x253),'nombre':_0x30feb2(0x1e9)},{'codigo':'BE','nombre':_0x30feb2(0x28a)},{'codigo':_0x30feb2(0x1fd),'nombre':_0x30feb2(0x284)},{'codigo':_0x30feb2(0x296),'nombre':_0x30feb2(0x293)},{'codigo':_0x30feb2(0x233),'nombre':_0x30feb2(0x2a1)},{'codigo':'HLT','nombre':'HECTOLITRO'},{'codigo':_0x30feb2(0x241),'nombre':'HOJA'},{'codigo':_0x30feb2(0x229),'nombre':'JUEGO'},{'codigo':'KGM','nombre':_0x30feb2(0x266)},{'codigo':'KTM','nombre':_0x30feb2(0x242)},{'codigo':_0x30feb2(0x239),'nombre':'KILOVATIO\x20HORA'},{'codigo':'KT','nombre':_0x30feb2(0x207)},{'codigo':'CA','nombre':_0x30feb2(0x23e)},{'codigo':'LBR','nombre':_0x30feb2(0x220)},{'codigo':_0x30feb2(0x217),'nombre':_0x30feb2(0x1c6)},{'codigo':_0x30feb2(0x1e1),'nombre':_0x30feb2(0x24a)},{'codigo':_0x30feb2(0x204),'nombre':_0x30feb2(0x216)},{'codigo':_0x30feb2(0x297),'nombre':'METRO\x20CUADRADO'},{'codigo':_0x30feb2(0x26c),'nombre':_0x30feb2(0x248)},{'codigo':_0x30feb2(0x28f),'nombre':_0x30feb2(0x250)},{'codigo':_0x30feb2(0x202),'nombre':_0x30feb2(0x26e)},{'codigo':_0x30feb2(0x1d0),'nombre':_0x30feb2(0x255)},{'codigo':_0x30feb2(0x1ec),'nombre':_0x30feb2(0x1d3)},{'codigo':_0x30feb2(0x2b1),'nombre':_0x30feb2(0x265)},{'codigo':_0x30feb2(0x289),'nombre':_0x30feb2(0x2bb)},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':_0x30feb2(0x1cb),'nombre':_0x30feb2(0x299)},{'codigo':'PF','nombre':_0x30feb2(0x226)},{'codigo':'PK','nombre':_0x30feb2(0x1ee)},{'codigo':'PR','nombre':_0x30feb2(0x263)},{'codigo':_0x30feb2(0x276),'nombre':'PIES'},{'codigo':_0x30feb2(0x274),'nombre':_0x30feb2(0x1fe)},{'codigo':_0x30feb2(0x27a),'nombre':_0x30feb2(0x20e)},{'codigo':_0x30feb2(0x261),'nombre':_0x30feb2(0x21a)},{'codigo':'PG','nombre':_0x30feb2(0x23c)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':_0x30feb2(0x1db),'nombre':_0x30feb2(0x1df)},{'codigo':'RM','nombre':_0x30feb2(0x20f)},{'codigo':'SA','nombre':_0x30feb2(0x209)},{'codigo':'DR','nombre':_0x30feb2(0x1c4)},{'codigo':'STN','nombre':_0x30feb2(0x25f)},{'codigo':_0x30feb2(0x267),'nombre':'TONELADA\x20LARGA'},{'codigo':'TNE','nombre':_0x30feb2(0x26a)},{'codigo':'TU','nombre':_0x30feb2(0x260)},{'codigo':'NIU','nombre':'UNIDAD\x20(NIU)'},{'codigo':'ZZ','nombre':'UNIDAD\x20(ZZ)'},{'codigo':'GLL','nombre':'US\x20GALON\x20(3,7843\x20L)'},{'codigo':_0x30feb2(0x1e0),'nombre':_0x30feb2(0x290)},{'codigo':'YDK','nombre':_0x30feb2(0x1cd)},{'codigo':_0x30feb2(0x1e2),'nombre':_0x30feb2(0x23d)}],_0x16036d=_0x285606[_0x30feb2(0x1eb)]((_0x19c62a,{nombre:_0x3720cc,codigo:_0x18f70c})=>{const _0x34899e=_0x30feb2;return _0x19c62a[_0x3720cc[_0x34899e(0x228)]()]=_0x18f70c['trim'](),_0x19c62a;},{});for(let _0x1b9ef3=0x0;_0x1b9ef3<_0x662949;_0x1b9ef3+=_0x4a59eb){const _0x6d9628=_0x19c716['slice'](_0x1b9ef3,_0x1b9ef3+_0x4a59eb)['map']((_0x3f0878,_0x98c116)=>{const _0x8843f8=_0x30feb2;let _0x25fd0b={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x3f0878[_0x8843f8(0x21c)]]||'1';const _0x207e04=String(_0x3f0878[_0x8843f8(0x27c)])[_0x8843f8(0x228)](),_0x30def6={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x451f1a=_0x30def6[_0x207e04]||'1',_0x305863={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x451f1a]||{'code':'10','value':0x12},_0x50496a={};let _0x172f9f=String(_0x3f0878['Nombre*'])[_0x8843f8(0x228)]();const _0x5266c5=[_0x8843f8(0x23b),_0x8843f8(0x27e),_0x8843f8(0x26b),_0x8843f8(0x27d),'Modelo',_0x8843f8(0x1f5),'Material',_0x8843f8(0x21e),_0x8843f8(0x249)];_0x5266c5[_0x8843f8(0x251)](_0x1519ef=>{const _0x189d34=_0x8843f8,_0x34b4c4=String(_0x3f0878[_0x1519ef]||'')[_0x189d34(0x228)]();_0x34b4c4&&(_0x50496a[_0x1519ef]=_0x34b4c4,_0x172f9f+='\x20'+_0x1519ef+'\x20'+_0x34b4c4);});const _0x179007=[],_0x7e9b20=String(_0x3f0878[_0x8843f8(0x218)]||_0x8843f8(0x1c9))[_0x8843f8(0x228)](),_0x3bed59=_0x16036d[_0x7e9b20]||'NIU',_0x4eedd1=String(_0x3f0878[_0x8843f8(0x254)])[_0x8843f8(0x228)]();_0x179007['push']({'setItemUnitId':String(_0x3f0878[_0x8843f8(0x2b9)])[_0x8843f8(0x228)]()||'','setItemBarCode':String(_0x3f0878['Código\x20de\x20Barras'])[_0x8843f8(0x228)]()||'','setAlias':_0x4eedd1,'setUnitCode':_0x3bed59,'setPrice':parseFloat(_0x3f0878[_0x8843f8(0x222)]),'setCost':parseFloat(_0x3f0878[_0x8843f8(0x2b0)]),'setPriceUSD':parseFloat(_0x3f0878['Precio\x20Venta\x20Dólares']),'setCostUSD':parseFloat(_0x3f0878[_0x8843f8(0x29e)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x3f0878[_0x8843f8(0x1ea)])});const _0x411f15=[_0x8843f8(0x28d),_0x8843f8(0x1e6),'Código\x20de\x20Barras\x202',_0x8843f8(0x246),_0x8843f8(0x2ba),_0x8843f8(0x278),'Precio\x20Venta\x20Dólares\x202','Precio\x20Costo\x20Dólares\x202'][_0x8843f8(0x206)](_0x3b3335=>{const _0x5aa7e5=_0x8843f8,_0x18c0a8=_0x3f0878[_0x3b3335];return _0x18c0a8!=null&&String(_0x18c0a8)[_0x5aa7e5(0x228)]()!=='';});if(_0x411f15){const _0x4da1b7=String(_0x3f0878['Unidad\x20de\x20Medida\x202']||'UND\x20(NIU)')['trim'](),_0x52bd93=_0x16036d[_0x4da1b7]||_0x8843f8(0x1f3);_0x179007[_0x8843f8(0x1de)]({'setItemUnitId':String(_0x3f0878[_0x8843f8(0x28d)])[_0x8843f8(0x228)]()||'','setItemBarCode':String(_0x3f0878[_0x8843f8(0x22e)])[_0x8843f8(0x228)]()||'','setAlias':String(_0x3f0878['Alias\x202'])[_0x8843f8(0x228)](),'setUnitCode':_0x52bd93,'setPrice':parseFloat(_0x3f0878[_0x8843f8(0x2ba)]),'setCost':parseFloat(_0x3f0878['Precio\x20Costo\x20Soles\x202']),'setPriceUSD':parseFloat(_0x3f0878[_0x8843f8(0x2a3)]),'setCostUSD':parseFloat(_0x3f0878[_0x8843f8(0x257)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x3f0878['Equivalencia\x202'])||0x1,'setFactor':parseFloat(_0x3f0878['Equivalencia\x202'])||0x1,'setItemCommissionPercentage':parseFloat(_0x3f0878[_0x8843f8(0x1cc)])});}const _0x40e45c=[_0x8843f8(0x264),_0x8843f8(0x2a9),_0x8843f8(0x201),'Equivalencia\x203',_0x8843f8(0x1f7),_0x8843f8(0x232),_0x8843f8(0x1cf),_0x8843f8(0x2b5)][_0x8843f8(0x206)](_0x6e1775=>{const _0x32cb7f=_0x3f0878[_0x6e1775];return _0x32cb7f!=null&&String(_0x32cb7f)['trim']()!=='';});if(_0x40e45c){const _0x464b25=String(_0x3f0878[_0x8843f8(0x29a)]||_0x8843f8(0x2b7))[_0x8843f8(0x228)](),_0x4afd45=_0x16036d[_0x464b25]||_0x8843f8(0x1f3);_0x179007[_0x8843f8(0x1de)]({'setItemUnitId':String(_0x3f0878[_0x8843f8(0x264)])['trim']()||'','setItemBarCode':String(_0x3f0878[_0x8843f8(0x201)])[_0x8843f8(0x228)]()||'','setAlias':String(_0x3f0878[_0x8843f8(0x2a9)])[_0x8843f8(0x228)](),'setUnitCode':_0x4afd45,'setPrice':parseFloat(_0x3f0878[_0x8843f8(0x1f7)]),'setCost':parseFloat(_0x3f0878[_0x8843f8(0x232)]),'setPriceUSD':parseFloat(_0x3f0878[_0x8843f8(0x1cf)]),'setCostUSD':parseFloat(_0x3f0878[_0x8843f8(0x2b5)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x3f0878[_0x8843f8(0x24e)])||0x1,'setFactor':parseFloat(_0x3f0878[_0x8843f8(0x24e)])||0x1,'setItemCommissionPercentage':parseFloat(_0x3f0878[_0x8843f8(0x26f)])});}let _0x585fd3=_0x3f0878[_0x8843f8(0x258)],_0x4245a3='';if(_0x585fd3 instanceof Date){const _0x3e5222=_0x585fd3[_0x8843f8(0x29d)](),_0x34bc10=String(_0x585fd3['getMonth']()+0x1)[_0x8843f8(0x280)](0x2,'0'),_0x1fe209=String(_0x585fd3['getDate']())[_0x8843f8(0x280)](0x2,'0');_0x4245a3=_0x3e5222+'-'+_0x34bc10+'-'+_0x1fe209;}else{if(typeof _0x585fd3===_0x8843f8(0x24c)){const _0x3c9a9f=XLSX['SSF'][_0x8843f8(0x28c)](_0x585fd3);if(_0x3c9a9f){const _0x552736=_0x3c9a9f['y'],_0xbd3602=String(_0x3c9a9f['m'])[_0x8843f8(0x280)](0x2,'0'),_0x40e7ea=String(_0x3c9a9f['d'])[_0x8843f8(0x280)](0x2,'0');_0x4245a3=_0x552736+'-'+_0xbd3602+'-'+_0x40e7ea;}}else _0x4245a3=String(_0x585fd3||'')[_0x8843f8(0x228)]();}return{'setItemId':String(_0x3f0878['ID'])[_0x8843f8(0x228)](),'setItemType':_0x25fd0b,'setItemCode':String(_0x3f0878[_0x8843f8(0x298)])[_0x8843f8(0x228)](),'setItemName':String(_0x3f0878['Nombre*'])[_0x8843f8(0x228)](),'setItemDescription':String(_0x3f0878[_0x8843f8(0x244)])[_0x8843f8(0x228)]()||'','setItemIsSold':_0x3f0878[_0x8843f8(0x22c)]=='SI'?0x1:0x0,'setItemIsBought':_0x3f0878['Se\x20Compra']=='SI'?0x1:0x0,'setItemCategories':_0x3f0878[_0x8843f8(0x1d9)]?[String(_0x3f0878[_0x8843f8(0x1d9)])['trim']()]:[],'setItemBrands':_0x3f0878['Marca']?[String(_0x3f0878[_0x8843f8(0x286)])[_0x8843f8(0x228)]()]:[],'setItemTaxId':_0x451f1a,'setItemTaxCode':_0x305863[_0x8843f8(0x279)],'setItemTaxValue':_0x305863[_0x8843f8(0x1e8)],'setItemUnits':_0x179007,'setItemInventoriable':_0x3f0878['Rastrear\x20Inventario']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x3f0878[_0x8843f8(0x25b)])||0x0,'setStockMinimum':parseFloat(_0x3f0878[_0x8843f8(0x2ab)])||0x0,'setItemLocation':String(_0x3f0878['Ubicación'])[_0x8843f8(0x228)]()||'','setBatchName':String(_0x3f0878[_0x8843f8(0x23b)])[_0x8843f8(0x228)]()||'','setItemDateExpiry':_0x4245a3,'setItemVariantName':_0x172f9f,'setItemVariantValues':_0x50496a,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x43cc5d[_0x30feb2(0x1de)](..._0x6d9628),postMessage({'type':'progress','payload':{'percent':Math['round']((_0x1b9ef3+_0x6d9628[_0x30feb2(0x237)])/_0x662949*0x64),'message':_0x30feb2(0x275)+(_0x1b9ef3+0x1)+'–'+(_0x1b9ef3+_0x6d9628[_0x30feb2(0x237)])+'/'+_0x662949}});}postMessage({'type':_0x30feb2(0x1d6),'payload':{'items':_0x43cc5d}});}catch(_0x56e868){postMessage({'type':_0x30feb2(0x1f4),'payload':_0x56e868['message']||_0x56e868});}}if(_0x286537===_0x30feb2(0x287)){const {products:_0x111e89,plantillaBuf:_0x19009c}=_0x17f977;if(!(_0x19009c instanceof ArrayBuffer)){postMessage({'type':_0x30feb2(0x1f4),'payload':_0x30feb2(0x26d)});return;}if(!Array[_0x30feb2(0x2a6)](_0x111e89)){postMessage({'type':'error','payload':'exportItems:\x20products\x20no\x20es\x20Array.'});return;}try{structuredClone(_0x111e89);}catch(_0x1b3126){postMessage({'type':_0x30feb2(0x1f4),'payload':_0x30feb2(0x270)+_0x1b3126[_0x30feb2(0x231)]});return;}try{const _0x4ed25e={'1':_0x30feb2(0x1c7),'2':_0x30feb2(0x1d2),'3':'Materia\x20Prima','4':'Combo','5':_0x30feb2(0x272)};function _0xfb13fb(_0x3fbee1){const _0x4d69ef=_0x30feb2;return _0x4ed25e[String(_0x3fbee1)]||_0x4d69ef(0x1c7);}const _0x44c39a={'1':_0x30feb2(0x1dd),'2':_0x30feb2(0x1c8),'3':'Inafecto\x20(0%)','4':'Gravado\x20Gratuito\x20(18%)','5':'Inafecto\x20Gratuito\x20(0%)','6':_0x30feb2(0x1ef),'7':_0x30feb2(0x245),'8':'Exportación\x20(0%)','9':'Gravado\x20Gratuito\x20(10%)'};function _0x36b052(_0xe4ea77){const _0xba14ca=_0x30feb2;return _0x44c39a[String(_0xe4ea77)]||_0xba14ca(0x1dd);}const _0x455036={'4A':_0x30feb2(0x22b),'BJ':_0x30feb2(0x21d),'BLL':'BARRILES','BG':'BOLSA','BO':_0x30feb2(0x1ff),'BX':_0x30feb2(0x2b2),'CT':_0x30feb2(0x1ca),'CMK':_0x30feb2(0x2ac),'CMQ':_0x30feb2(0x1e5),'CMT':_0x30feb2(0x2a8),'CEN':_0x30feb2(0x214),'CY':'CILINDRO','CJ':_0x30feb2(0x259),'DZN':_0x30feb2(0x2b8),'DZP':'DOCENA\x20POR\x2010**6','BE':_0x30feb2(0x28a),'GLI':_0x30feb2(0x284),'GRM':_0x30feb2(0x293),'GRO':_0x30feb2(0x2a1),'HLT':_0x30feb2(0x240),'LEF':_0x30feb2(0x262),'SET':_0x30feb2(0x212),'KGM':'KILOGRAMO','KTM':_0x30feb2(0x242),'KWH':'KILOVATIO\x20HORA','KT':'KIT','CA':'LATAS','LBR':'LIBRAS','LTR':_0x30feb2(0x1c6),'MWH':'MEGAWATT\x20HORA','MTR':_0x30feb2(0x216),'MTK':_0x30feb2(0x29c),'MTQ':_0x30feb2(0x248),'MGM':_0x30feb2(0x250),'MLT':_0x30feb2(0x26e),'MMT':_0x30feb2(0x255),'MMK':'MILIMETRO\x20CUADRADO','MMQ':'MILIMETRO\x20CUBICO','MIL':_0x30feb2(0x2bb),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0x30feb2(0x299),'PF':_0x30feb2(0x226),'PK':_0x30feb2(0x1ee),'PR':_0x30feb2(0x263),'FOT':_0x30feb2(0x2b4),'FTK':_0x30feb2(0x1fe),'FTQ':_0x30feb2(0x20e),'C62':_0x30feb2(0x21a),'PG':_0x30feb2(0x23c),'ST':_0x30feb2(0x25e),'INH':_0x30feb2(0x1df),'RM':_0x30feb2(0x20f),'SA':'SACO','DR':_0x30feb2(0x1c4),'STN':_0x30feb2(0x25f),'LTN':_0x30feb2(0x227),'TNE':_0x30feb2(0x26a),'TU':_0x30feb2(0x260),'NIU':'UNIDAD\x20(NIU)','ZZ':_0x30feb2(0x221),'GLL':_0x30feb2(0x22a),'YRD':_0x30feb2(0x290),'YDK':_0x30feb2(0x1cd),'QQM':_0x30feb2(0x23d)};function _0x185103(_0x1f6e3d){return _0x455036[String(_0x1f6e3d)]||'';}const _0x322220=XLSX[_0x30feb2(0x25c)](_0x19009c,{'type':_0x30feb2(0x2b6),'cellDates':!![]}),_0x3349f6=_0x322220[_0x30feb2(0x234)][0x0],_0x321fd8=_0x322220['Sheets'][_0x3349f6],_0x2197cf=XLSX[_0x30feb2(0x21b)][_0x30feb2(0x2bf)](_0x321fd8,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x46179a=XLSX['utils'][_0x30feb2(0x203)](_0x321fd8[_0x30feb2(0x29f)]||'');for(let _0x149a4c=0x2;_0x149a4c<=_0x46179a['e']['r'];++_0x149a4c){for(let _0x51870a=_0x46179a['s']['c'];_0x51870a<=_0x46179a['e']['c'];++_0x51870a){const _0x4ee97c=XLSX['utils'][_0x30feb2(0x295)]({'r':_0x149a4c,'c':_0x51870a});if(_0x321fd8[_0x4ee97c])delete _0x321fd8[_0x4ee97c];}}const _0x1e187b=_0x111e89[_0x30feb2(0x20d)](_0x1a498e=>{const _0x27be3c=_0x30feb2;_0x1a498e[_0x27be3c(0x27f)]=_0x1a498e[_0x27be3c(0x27f)]||{};const _0x41b8be={};return _0x2197cf['forEach'](_0x4b03b=>{const _0x3eeb7e=_0x27be3c,_0xe5503=String(_0x4b03b)[_0x3eeb7e(0x228)](),_0x36f016=_0xe5503['toLowerCase'](),_0x47daec=Object[_0x3eeb7e(0x24b)](_0x1a498e)[_0x3eeb7e(0x243)](_0x2608bc=>_0x2608bc['trim']()[_0x3eeb7e(0x24f)]()===_0x36f016);if(_0x47daec){_0x41b8be[_0xe5503]=_0x1a498e[_0x47daec]??'';return;}switch(_0xe5503){case'ID':_0x41b8be[_0xe5503]=_0x1a498e['id']??'';break;case _0x3eeb7e(0x21c):_0x41b8be[_0xe5503]=_0xfb13fb(_0x1a498e[_0x3eeb7e(0x224)]);break;case'Código\x20SKU*':_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x20c)]??'';break;case'Nombre*':_0x41b8be[_0xe5503]=_0x1a498e['setDescripcion']??'';break;case _0x3eeb7e(0x244):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x225)]??'';break;case _0x3eeb7e(0x22c):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x1e7)]==0x1?'SI':'NO';break;case _0x3eeb7e(0x1f1):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x2ad)]==0x1?'SI':'NO';break;case _0x3eeb7e(0x1d9):_0x41b8be[_0xe5503]=_0x1a498e['setCategoria']??'';break;case _0x3eeb7e(0x286):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x2aa)]??'';break;case _0x3eeb7e(0x27c):_0x41b8be[_0xe5503]=_0x36b052(_0x1a498e[_0x3eeb7e(0x294)]);break;case _0x3eeb7e(0x2b9):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x2a7)]??'';break;case'Alias':_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x25d)]??'';break;case _0x3eeb7e(0x247):_0x41b8be[_0xe5503]=_0x1a498e['setItemBarCode']??'';break;case _0x3eeb7e(0x218):_0x41b8be[_0xe5503]=_0x185103(_0x1a498e['setUnidadCodigo']);break;case _0x3eeb7e(0x222):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x1d7)]??'';break;case _0x3eeb7e(0x2b0):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x1e4)]??'';break;case _0x3eeb7e(0x1f9):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x23f)]??'';break;case _0x3eeb7e(0x29e):_0x41b8be[_0xe5503]=_0x1a498e['USD_setMtoPrecioCostoUnitario']??'';break;case'Comisión\x20Venta\x20(%)':_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x268)];break;case'ID\x20UNIT\x202':_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x28b)]??'';break;case _0x3eeb7e(0x1e6):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x1da)]??'';break;case _0x3eeb7e(0x22e):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x236)]??'';break;case _0x3eeb7e(0x28e):_0x41b8be[_0xe5503]=_0x185103(_0x1a498e[_0x3eeb7e(0x2be)]);break;case _0x3eeb7e(0x246):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x283)]??'1';break;case _0x3eeb7e(0x2ba):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x1fb)]??'';break;case _0x3eeb7e(0x278):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x281)]??'';break;case _0x3eeb7e(0x2a3):_0x41b8be[_0xe5503]=_0x1a498e['USD_setMtoPrecioUnitario2']??'';break;case _0x3eeb7e(0x257):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x2ae)]??'';break;case _0x3eeb7e(0x1cc):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x223)];break;case'ID\x20UNIT\x203':_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x2bc)]??'';break;case _0x3eeb7e(0x2a9):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x25a)]??'';break;case _0x3eeb7e(0x201):_0x41b8be[_0xe5503]=_0x1a498e['setItemBarCode3']??'';break;case _0x3eeb7e(0x29a):_0x41b8be[_0xe5503]=_0x185103(_0x1a498e[_0x3eeb7e(0x2bd)]);break;case _0x3eeb7e(0x24e):_0x41b8be[_0xe5503]=_0x1a498e['setUnidadEquivalencia3']??'1';break;case'Precio\x20Venta\x20Soles\x203':_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x27b)]??'';break;case _0x3eeb7e(0x232):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x238)]??'';break;case _0x3eeb7e(0x1cf):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x1ce)]??'';break;case _0x3eeb7e(0x2b5):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x273)]??'';break;case'Comisión\x20Venta\x203\x20(%)':_0x41b8be[_0xe5503]=_0x1a498e['setItemCommissionPercentage3'];break;case _0x3eeb7e(0x1fc):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x21f)]==0x1?'SI':'NO';break;case _0x3eeb7e(0x25b):_0x41b8be[_0xe5503]=_0x1a498e['setSucursalStock']??'';break;case _0x3eeb7e(0x2ab):_0x41b8be[_0xe5503]=_0x1a498e[_0x3eeb7e(0x20b)]??'';break;case'Fecha\x20de\x20Vencimiento':_0x41b8be[_0xe5503]=_0x1a498e['setBatchExpirationDate']??'';break;default:_0x41b8be[_0xe5503]='';}}),_0x41b8be;}),_0x47e6e1=0x3e8,_0x5c9438=_0x1e187b[_0x30feb2(0x237)];for(let _0x38d471=0x0;_0x38d471<_0x5c9438;_0x38d471+=_0x47e6e1){const _0x30aaaf=_0x1e187b['slice'](_0x38d471,_0x38d471+_0x47e6e1);XLSX[_0x30feb2(0x21b)][_0x30feb2(0x1f8)](_0x321fd8,_0x30aaaf,{'origin':{'r':_0x38d471+0x2,'c':0x0},'skipHeader':!![],'header':_0x2197cf}),postMessage({'type':'progress','payload':{'percent':Math[_0x30feb2(0x285)]((_0x38d471+_0x30aaaf[_0x30feb2(0x237)])/_0x5c9438*0x64),'message':_0x30feb2(0x20a)+(_0x38d471+0x1)+'–'+(_0x38d471+_0x30aaaf[_0x30feb2(0x237)])+_0x30feb2(0x2a4)+_0x5c9438}});}const _0x2ba87c={'s':{'r':0x0,'c':0x0},'e':{'r':_0x5c9438+0x1,'c':_0x2197cf[_0x30feb2(0x237)]-0x1}};_0x321fd8[_0x30feb2(0x29f)]=XLSX[_0x30feb2(0x21b)]['encode_range'](_0x2ba87c);const _0x4cd66b=XLSX[_0x30feb2(0x22f)](_0x322220,{'bookType':_0x30feb2(0x210),'type':_0x30feb2(0x2b6)});let _0x4f7cc9,_0x28015d;if(_0x4cd66b instanceof Uint8Array)_0x4f7cc9=_0x4cd66b,_0x28015d=[_0x4cd66b[_0x30feb2(0x2a0)]];else{if(_0x4cd66b instanceof ArrayBuffer)_0x4f7cc9=new Uint8Array(_0x4cd66b),_0x28015d=[_0x4cd66b];else{const _0x43589f=new Uint8Array(_0x4cd66b);_0x4f7cc9=_0x43589f,_0x28015d=[_0x43589f[_0x30feb2(0x2a0)]];}}postMessage({'type':'exportDone','payload':{'wbout':_0x4f7cc9,'count':_0x1e187b[_0x30feb2(0x237)]}},_0x28015d);}catch(_0x2154bb){postMessage({'type':_0x30feb2(0x1f4),'payload':_0x2154bb[_0x30feb2(0x231)]||String(_0x2154bb)});}return;}};