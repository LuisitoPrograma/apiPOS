/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.2.2
*/

function _0x58af(_0xc35a5e,_0x51d94a){const _0x47bc06=_0x280d();return _0x58af=function(_0xb76ef2,_0x2f9565){_0xb76ef2=_0xb76ef2-0x9e;let _0xca1521=_0x47bc06[_0xb76ef2];return _0xca1521;},_0x58af(_0xc35a5e,_0x51d94a);}const _0xdbb4b4=_0x58af;(function(_0xc347d7,_0x1c86a4){const _0x3ae615=_0x58af,_0x181ce8=_0xc347d7();while(!![]){try{const _0x2e5a07=parseInt(_0x3ae615(0x122))/0x1*(-parseInt(_0x3ae615(0x11c))/0x2)+parseInt(_0x3ae615(0x103))/0x3+-parseInt(_0x3ae615(0x14b))/0x4*(-parseInt(_0x3ae615(0x102))/0x5)+parseInt(_0x3ae615(0x10f))/0x6+parseInt(_0x3ae615(0xbc))/0x7*(parseInt(_0x3ae615(0xb7))/0x8)+parseInt(_0x3ae615(0xc5))/0x9+-parseInt(_0x3ae615(0x12d))/0xa*(parseInt(_0x3ae615(0x145))/0xb);if(_0x2e5a07===_0x1c86a4)break;else _0x181ce8['push'](_0x181ce8['shift']());}catch(_0xb58aef){_0x181ce8['push'](_0x181ce8['shift']());}}}(_0x280d,0x9b4de));function _0x280d(){const _0x54d625=['parse_date_code','setUnitId','exportItems:\x20products\x20no\x20es\x20Array.','length','USD_setMtoPrecioUnitario','getFullYear','PEN_setMtoPrecioCostoUnitario2','Precio\x20Venta\x20Soles\x202','MIL','INH','NIU','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','read','Gravado\x20Gratuito\x20(10%)','padStart','Fabricado','MILLARES','Categoría','filter','GRAMO','LTN','BOBINAS','exportItems:\x20productos\x20no\x20clonables:\x20','Descripción','UND\x20(NIU)','prototype','ID\x20UNIT\x202','setItemVariantValues','PALETAS','BARRILES','getMonth','setItemDescription','Inafecto\x20(0%)','Color','LTR','MILIMETRO\x20CUBICO','TONELADA\x20LARGA','DOCENA\x20POR\x2010**6','Gravado\x20Gratuito\x20(18%)','LEF','MILIMETRO','setItemType','RESMA','setItemBarCode','5453192QrYpSR','number','FTK','log','Inafecto\x20Gratuito\x20(0%)','7mHDtiw','BLL','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','YARDA\x20CUADRADA','PAR','sheet_to_json','{}.constructor(\x22return\x20this\x22)(\x20)','SSF','CAJA','8238528awBcGF','Procesadas\x20filas\x20','PIES','FARDO','LATAS','message','GALON\x20INGLES\x20(4,545956L)','info','KILOVATIO\x20HORA','CENTIMETRO\x20CUBICO','CEN','Precio\x20Venta\x20Soles','GRUESA','MWH','import','UNIDAD\x20(NIU)','LIBRAS','SheetNames','apply','CMT','exportDone','MILILITRO','UNIDAD\x20(ZZ)','Exonerado\x20(0%)','MEGAWATT\x20HORA','write','CARTONES','Código\x20de\x20Barras','USD_setMtoPrecioUnitario2','getDate','table','round','Marca','encode_range','forEach','MMQ','Código\x20de\x20Barras\x202','Serie','CENTIMETRO\x20CUADRADO','FOT','DZP','Ubicación','reduce','PULGADAS','CMQ','YRD','setUnidadCodigo2','MTK','KGM','code','Materia\x20Prima','DOCENA','Impuesto*','FTQ','Precio\x20Costo\x20Soles\x202','Precio\x20Costo\x20Dólares\x202','findIndex','Stock\x20Actual','Gravado\x20(18%)','SET','Servicio','95FNyQFG','3214983WovhLf','setWarehouseStockMin','TONELADA\x20CORTA','slice','Código\x20SKU*','setInventariable','PIES\x20CUADRADOS','GRO','buffer','Stock\x20Mínimo','BALDE','exception','1764282ycwnes','Nombre*','console','Unidad\x20de\x20Medida\x202','array','Fecha\x20de\x20Vencimiento','GLL','setUnidadEquivalencia2','METRO','keys','MTR','!ref','QUINTAL','10408lRsaqy','error','return\x20(function()\x20','map','setDescripcion','USD_setMtoPrecioCostoUnitario','162ARHJwZ','MILLON\x20DE\x20UNIDADES','ID\x20UNIT','JUEGO','some','STN','Gravado\x20(10%)','setBatchName','Precio\x20Venta\x20Dólares','MTQ','¿Rastrear\x20Inventario?','23306330tygSal','warn','Iniciando\x20parseo…','TONELADAS','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','TAMBOR','ONZAS','Unidad\x20de\x20Medida*','sheet_add_json','toString','bind','BOTELLAS','search','Artículo','KIT','HECTOLITRO','KWH','push','KTM','US\x20GALON\x20(3,7843\x20L)','encode_cell','Precio\x20Costo\x20Dólares','El\x20archivo\x20tiene\x20','trim','11qGRGFZ','PLIEGO','__proto__','PEN_setMtoPrecioUnitario','CMK','CILINDRO','178328SbsIoX','MILIGRAMOS','Sheets','trace','Nombre\x20del\x20Lote','Equivalencia\x202','progress','LITRO','Tipo*','(((.+)+)+)+$','decode_range','MMT','PAQUETE','METRO\x20CUBICO','TUBOS','METRO\x20CUADRADO','SACO','CIENTO\x20DE\x20UNIDADES','HLT','GRM','setMarca','PIES\x20CUBICOS','utils','toLowerCase','CONOS','Precio\x20Costo\x20Soles','setTaxId','YDK','BOLSA','setItemBarCode2','PEN_setMtoPrecioUnitario2','MILIMETRO\x20CUADRADO','setSucursalStock','GLI','Talla','PIEZAS','Género','TNE','Precio\x20Venta\x20Dólares\x202','setCategoria','setBatchExpirationDate','CENTIMETRO\x20LINEAL'];_0x280d=function(){return _0x54d625;};return _0x280d();}const _0x5c738c=(function(){let _0x341bdf=!![];return function(_0x4dcc9c,_0x3dfff1){const _0x514fab=_0x341bdf?function(){const _0x2169e7=_0x58af;if(_0x3dfff1){const _0x5bfdb1=_0x3dfff1[_0x2169e7(0xd7)](_0x4dcc9c,arguments);return _0x3dfff1=null,_0x5bfdb1;}}:function(){};return _0x341bdf=![],_0x514fab;};}()),_0x19ae87=_0x5c738c(this,function(){const _0x136e1c=_0x58af;return _0x19ae87[_0x136e1c(0x136)]()[_0x136e1c(0x139)](_0x136e1c(0x154))[_0x136e1c(0x136)]()['constructor'](_0x19ae87)['search']('(((.+)+)+)+$');});_0x19ae87();const _0x2f9565=(function(){let _0x575fc7=!![];return function(_0x5b2194,_0x550103){const _0x50f459=_0x575fc7?function(){const _0x41ad20=_0x58af;if(_0x550103){const _0x479989=_0x550103[_0x41ad20(0xd7)](_0x5b2194,arguments);return _0x550103=null,_0x479989;}}:function(){};return _0x575fc7=![],_0x50f459;};}()),_0xb76ef2=_0x2f9565(this,function(){const _0x22f0cb=_0x58af;let _0x2fbdf0;try{const _0x303b95=Function(_0x22f0cb(0x11e)+_0x22f0cb(0xc2)+');');_0x2fbdf0=_0x303b95();}catch(_0x1e58b3){_0x2fbdf0=window;}const _0x46cca1=_0x2fbdf0[_0x22f0cb(0x111)]=_0x2fbdf0[_0x22f0cb(0x111)]||{},_0x36d46f=[_0x22f0cb(0xba),_0x22f0cb(0x12e),_0x22f0cb(0xcc),_0x22f0cb(0x11d),_0x22f0cb(0x10e),_0x22f0cb(0xe3),_0x22f0cb(0x14e)];for(let _0x2afcc0=0x0;_0x2afcc0<_0x36d46f[_0x22f0cb(0x178)];_0x2afcc0++){const _0x533385=_0x2f9565['constructor'][_0x22f0cb(0xa4)][_0x22f0cb(0x137)](_0x2f9565),_0x47e81e=_0x36d46f[_0x2afcc0],_0x4610d5=_0x46cca1[_0x47e81e]||_0x533385;_0x533385[_0x22f0cb(0x147)]=_0x2f9565[_0x22f0cb(0x137)](_0x2f9565),_0x533385['toString']=_0x4610d5['toString']['bind'](_0x4610d5),_0x46cca1[_0x47e81e]=_0x533385;}});_0xb76ef2(),importScripts(_0xdbb4b4(0x131)),onmessage=({data:_0x1854dd})=>{const _0x5e5fd7=_0xdbb4b4,{action:_0x5cae10}=_0x1854dd;if(_0x5cae10===_0x5e5fd7(0xd3)){const {buf:_0x20a589,maxRows:_0x28d5d1}=_0x1854dd;try{postMessage({'type':_0x5e5fd7(0x151),'payload':{'percent':0x5,'message':_0x5e5fd7(0x12f)}});const _0x504350=XLSX[_0x5e5fd7(0x181)](_0x20a589,{'type':_0x5e5fd7(0x113),'cellDates':!![]}),_0x3fcbb1=_0x504350['Sheets'][_0x504350[_0x5e5fd7(0xd6)][0x0]],_0x19dcea=XLSX['utils'][_0x5e5fd7(0xc1)](_0x3fcbb1,{'defval':'','range':0x1,'cellDates':!![]}),_0x36fda0=_0x19dcea[_0x5e5fd7(0xfd)](_0x3122b5=>(!_0x3122b5['Tipo*']||String(_0x3122b5[_0x5e5fd7(0x153)])[_0x5e5fd7(0x144)]()==='')&&(!_0x3122b5[_0x5e5fd7(0x107)]||String(_0x3122b5[_0x5e5fd7(0x107)])[_0x5e5fd7(0x144)]()==='')&&(!_0x3122b5['Nombre*']||String(_0x3122b5['Nombre*'])['trim']()==='')&&(!_0x3122b5[_0x5e5fd7(0x134)]||String(_0x3122b5[_0x5e5fd7(0x134)])['trim']()==='')),_0x53a43d=_0x36fda0>=0x0?_0x19dcea[_0x5e5fd7(0x106)](0x0,_0x36fda0):_0x19dcea,_0x1123f5=_0x53a43d[_0x5e5fd7(0x187)](_0x45f9e2=>_0x45f9e2[_0x5e5fd7(0x153)]&&String(_0x45f9e2[_0x5e5fd7(0x153)])[_0x5e5fd7(0x144)]()!==''&&_0x45f9e2['Código\x20SKU*']&&String(_0x45f9e2[_0x5e5fd7(0x107)])[_0x5e5fd7(0x144)]()!==''&&_0x45f9e2[_0x5e5fd7(0x110)]&&String(_0x45f9e2['Nombre*'])[_0x5e5fd7(0x144)]()!==''&&_0x45f9e2[_0x5e5fd7(0x134)]&&String(_0x45f9e2[_0x5e5fd7(0x134)])[_0x5e5fd7(0x144)]()!==''),_0x2d8b13=_0x1123f5[_0x5e5fd7(0x178)];if(_0x2d8b13===0x0){postMessage({'type':_0x5e5fd7(0x11d),'payload':_0x5e5fd7(0x180)});return;}if(_0x2d8b13>_0x28d5d1)throw _0x5e5fd7(0x143)+_0x2d8b13+_0x5e5fd7(0xbe)+_0x28d5d1+'.';const _0xecd1e4=0x1f4,_0x5915d4=[],_0x16257e=[{'codigo':'4A','nombre':_0x5e5fd7(0xa0)},{'codigo':'BJ','nombre':_0x5e5fd7(0x10d)},{'codigo':_0x5e5fd7(0xbd),'nombre':_0x5e5fd7(0xa8)},{'codigo':'BG','nombre':_0x5e5fd7(0x167)},{'codigo':'BO','nombre':_0x5e5fd7(0x138)},{'codigo':'BX','nombre':_0x5e5fd7(0xc4)},{'codigo':'CT','nombre':_0x5e5fd7(0xdf)},{'codigo':_0x5e5fd7(0x149),'nombre':_0x5e5fd7(0xeb)},{'codigo':_0x5e5fd7(0xf1),'nombre':'CENTIMETRO\x20CUBICO'},{'codigo':_0x5e5fd7(0xd8),'nombre':_0x5e5fd7(0x174)},{'codigo':_0x5e5fd7(0xcf),'nombre':_0x5e5fd7(0x15c)},{'codigo':'CY','nombre':_0x5e5fd7(0x14a)},{'codigo':'CJ','nombre':_0x5e5fd7(0x163)},{'codigo':'DZN','nombre':_0x5e5fd7(0xf8)},{'codigo':_0x5e5fd7(0xed),'nombre':'DOCENA\x20POR\x2010**6'},{'codigo':'BE','nombre':_0x5e5fd7(0xc8)},{'codigo':_0x5e5fd7(0x16c),'nombre':_0x5e5fd7(0xcb)},{'codigo':_0x5e5fd7(0x15e),'nombre':_0x5e5fd7(0x9e)},{'codigo':_0x5e5fd7(0x10a),'nombre':_0x5e5fd7(0xd1)},{'codigo':_0x5e5fd7(0x15d),'nombre':_0x5e5fd7(0x13c)},{'codigo':_0x5e5fd7(0xb2),'nombre':'HOJA'},{'codigo':_0x5e5fd7(0x100),'nombre':'JUEGO'},{'codigo':_0x5e5fd7(0xf5),'nombre':'KILOGRAMO'},{'codigo':_0x5e5fd7(0x13f),'nombre':'KILOMETRO'},{'codigo':_0x5e5fd7(0x13d),'nombre':_0x5e5fd7(0xcd)},{'codigo':'KT','nombre':'KIT'},{'codigo':'CA','nombre':_0x5e5fd7(0xc9)},{'codigo':'LBR','nombre':_0x5e5fd7(0xd5)},{'codigo':_0x5e5fd7(0xad),'nombre':_0x5e5fd7(0x152)},{'codigo':_0x5e5fd7(0xd2),'nombre':'MEGAWATT\x20HORA'},{'codigo':_0x5e5fd7(0x119),'nombre':_0x5e5fd7(0x117)},{'codigo':_0x5e5fd7(0xf4),'nombre':'METRO\x20CUADRADO'},{'codigo':_0x5e5fd7(0x12b),'nombre':_0x5e5fd7(0x158)},{'codigo':'MGM','nombre':_0x5e5fd7(0x14c)},{'codigo':'MLT','nombre':_0x5e5fd7(0xda)},{'codigo':_0x5e5fd7(0x156),'nombre':_0x5e5fd7(0xb3)},{'codigo':'MMK','nombre':_0x5e5fd7(0x16a)},{'codigo':_0x5e5fd7(0xe8),'nombre':_0x5e5fd7(0xae)},{'codigo':_0x5e5fd7(0x17d),'nombre':_0x5e5fd7(0x185)},{'codigo':'UM','nombre':_0x5e5fd7(0x123)},{'codigo':'ONZ','nombre':_0x5e5fd7(0x133)},{'codigo':'PF','nombre':_0x5e5fd7(0xa7)},{'codigo':'PK','nombre':_0x5e5fd7(0x157)},{'codigo':'PR','nombre':_0x5e5fd7(0xc0)},{'codigo':_0x5e5fd7(0xec),'nombre':_0x5e5fd7(0xc7)},{'codigo':_0x5e5fd7(0xb9),'nombre':'PIES\x20CUADRADOS'},{'codigo':_0x5e5fd7(0xfa),'nombre':_0x5e5fd7(0x160)},{'codigo':'C62','nombre':_0x5e5fd7(0x16e)},{'codigo':'PG','nombre':'PLACAS'},{'codigo':'ST','nombre':_0x5e5fd7(0x146)},{'codigo':_0x5e5fd7(0x17e),'nombre':_0x5e5fd7(0xf0)},{'codigo':'RM','nombre':_0x5e5fd7(0xb5)},{'codigo':'SA','nombre':_0x5e5fd7(0x15b)},{'codigo':'DR','nombre':_0x5e5fd7(0x132)},{'codigo':_0x5e5fd7(0x127),'nombre':'TONELADA\x20CORTA'},{'codigo':_0x5e5fd7(0x9f),'nombre':_0x5e5fd7(0xaf)},{'codigo':_0x5e5fd7(0x170),'nombre':_0x5e5fd7(0x130)},{'codigo':'TU','nombre':_0x5e5fd7(0x159)},{'codigo':_0x5e5fd7(0x17f),'nombre':_0x5e5fd7(0xd4)},{'codigo':'ZZ','nombre':_0x5e5fd7(0xdb)},{'codigo':_0x5e5fd7(0x115),'nombre':_0x5e5fd7(0x140)},{'codigo':_0x5e5fd7(0xf2),'nombre':'YARDA'},{'codigo':_0x5e5fd7(0x166),'nombre':_0x5e5fd7(0xbf)},{'codigo':'QQM','nombre':_0x5e5fd7(0x11b)}],_0x130a04=_0x16257e[_0x5e5fd7(0xef)]((_0x144400,{nombre:_0x592f59,codigo:_0x5842fd})=>{return _0x144400[_0x592f59['trim']()]=_0x5842fd['trim'](),_0x144400;},{});for(let _0x25c220=0x0;_0x25c220<_0x2d8b13;_0x25c220+=_0xecd1e4){const _0x5567e8=_0x1123f5['slice'](_0x25c220,_0x25c220+_0xecd1e4)[_0x5e5fd7(0x11f)]((_0x36fb68,_0x5e915b)=>{const _0x64e2cb=_0x5e5fd7;let _0x30fc6e={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x36fb68[_0x64e2cb(0x153)]]||'1';const _0x184377=String(_0x36fb68[_0x64e2cb(0xf9)])[_0x64e2cb(0x144)](),_0x43f957={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x34140c=_0x43f957[_0x184377]||'1',_0x4f2e77={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x34140c]||{'code':'10','value':0x12},_0x5bf072={};let _0x1c9239=String(_0x36fb68['Nombre*'])[_0x64e2cb(0x144)]();const _0x4ef4a1=[_0x64e2cb(0x16d),_0x64e2cb(0xac),_0x64e2cb(0x16f),'Modelo',_0x64e2cb(0xea),'Material','Modelo\x20de\x20Cuello','Modelo\x20de\x20Manga'];_0x4ef4a1['forEach'](_0x3f3073=>{const _0x323416=_0x64e2cb,_0x2ff851=String(_0x36fb68[_0x3f3073]||'')[_0x323416(0x144)]();_0x2ff851&&(_0x5bf072[_0x3f3073]=_0x2ff851,_0x1c9239+='\x20'+_0x3f3073+'\x20'+_0x2ff851);});const _0x4a3d22=[],_0x3a5bbd=String(_0x36fb68['Unidad\x20de\x20Medida*']||_0x64e2cb(0xd4))[_0x64e2cb(0x144)](),_0x55a4d7=_0x130a04[_0x3a5bbd]||'NIU';_0x4a3d22[_0x64e2cb(0x13e)]({'setItemUnitId':String(_0x36fb68[_0x64e2cb(0x124)])[_0x64e2cb(0x144)]()||'','setItemBarCode':String(_0x36fb68[_0x64e2cb(0xe0)])[_0x64e2cb(0x144)]()||'','setAlias':_0x3a5bbd,'setUnitCode':_0x55a4d7,'setPrice':parseFloat(_0x36fb68[_0x64e2cb(0xd0)])||0x0,'setCost':parseFloat(_0x36fb68[_0x64e2cb(0x164)])||0x0,'setPriceUSD':parseFloat(_0x36fb68['Precio\x20Venta\x20Dólares'])||0x0,'setCostUSD':parseFloat(_0x36fb68[_0x64e2cb(0x142)])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x293543=[_0x64e2cb(0xa5),'Código\x20de\x20Barras\x202',_0x64e2cb(0x150),_0x64e2cb(0x17c),_0x64e2cb(0xfb),'Precio\x20Venta\x20Dólares\x202','Precio\x20Costo\x20Dólares\x202'][_0x64e2cb(0x126)](_0x425532=>{const _0x4167d9=_0x36fb68[_0x425532];return _0x4167d9!=null&&String(_0x4167d9)['trim']()!=='';});if(_0x293543){const _0x504b74=String(_0x36fb68[_0x64e2cb(0x112)]||_0x64e2cb(0xa3))[_0x64e2cb(0x144)](),_0x16a60f=_0x130a04[_0x504b74]||_0x64e2cb(0x17f),_0x12645=parseFloat(_0x36fb68[_0x64e2cb(0x17c)])||0x0,_0x22077b=parseFloat(_0x36fb68[_0x64e2cb(0xfb)])||0x0,_0x24f478=parseFloat(_0x36fb68[_0x64e2cb(0x171)])||0x0,_0x213343=parseFloat(_0x36fb68[_0x64e2cb(0xfc)])||0x0,_0x55d586=parseFloat(_0x36fb68[_0x64e2cb(0x150)])||0x1;_0x4a3d22[_0x64e2cb(0x13e)]({'setItemUnitId':String(_0x36fb68[_0x64e2cb(0xa5)])['trim']()||'','setItemBarCode':String(_0x36fb68['Código\x20de\x20Barras\x202'])[_0x64e2cb(0x144)]()||'','setAlias':_0x504b74,'setUnitCode':_0x16a60f,'setPrice':_0x12645,'setCost':_0x22077b,'setPriceUSD':_0x24f478,'setCostUSD':_0x213343,'setDefault':0x0,'setEquivalence':_0x55d586,'setFactor':_0x55d586});}let _0xc4faa4=_0x36fb68[_0x64e2cb(0x114)],_0x4ec041='';if(_0xc4faa4 instanceof Date){const _0x15a6b0=_0xc4faa4[_0x64e2cb(0x17a)](),_0x5daf96=String(_0xc4faa4[_0x64e2cb(0xa9)]()+0x1)[_0x64e2cb(0x183)](0x2,'0'),_0x56590a=String(_0xc4faa4[_0x64e2cb(0xe2)]())[_0x64e2cb(0x183)](0x2,'0');_0x4ec041=_0x15a6b0+'-'+_0x5daf96+'-'+_0x56590a;}else{if(typeof _0xc4faa4===_0x64e2cb(0xb8)){const _0x5aed38=XLSX[_0x64e2cb(0xc3)][_0x64e2cb(0x175)](_0xc4faa4);if(_0x5aed38){const _0x2d3cc3=_0x5aed38['y'],_0x3ef646=String(_0x5aed38['m'])['padStart'](0x2,'0'),_0x1b74db=String(_0x5aed38['d'])[_0x64e2cb(0x183)](0x2,'0');_0x4ec041=_0x2d3cc3+'-'+_0x3ef646+'-'+_0x1b74db;}}else _0x4ec041=String(_0xc4faa4||'')[_0x64e2cb(0x144)]();}return{'setItemId':String(_0x36fb68['ID'])[_0x64e2cb(0x144)](),'setItemType':_0x30fc6e,'setItemCode':String(_0x36fb68[_0x64e2cb(0x107)])[_0x64e2cb(0x144)](),'setItemName':String(_0x36fb68['Nombre*'])['trim'](),'setItemDescription':String(_0x36fb68['Descripción'])[_0x64e2cb(0x144)]()||'','setItemCategories':_0x36fb68[_0x64e2cb(0x186)]?[String(_0x36fb68['Categoría'])[_0x64e2cb(0x144)]()]:[],'setItemBrands':_0x36fb68[_0x64e2cb(0xe5)]?[String(_0x36fb68['Marca'])[_0x64e2cb(0x144)]()]:[],'setItemTaxId':_0x34140c,'setItemTaxCode':_0x4f2e77[_0x64e2cb(0xf6)],'setItemTaxValue':_0x4f2e77['value'],'setItemUnits':_0x4a3d22,'setItemInventoriable':_0x36fb68[_0x64e2cb(0x12c)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x36fb68[_0x64e2cb(0xfe)])||0x0,'setStockMinimum':parseFloat(_0x36fb68[_0x64e2cb(0x10c)])||0x0,'setItemLocation':String(_0x36fb68[_0x64e2cb(0xee)])[_0x64e2cb(0x144)]()||'','setBatchName':String(_0x36fb68[_0x64e2cb(0x14f)])[_0x64e2cb(0x144)]()||'','setItemDateExpiry':_0x4ec041,'setItemVariantName':_0x1c9239,'setItemVariantValues':_0x5bf072,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x5915d4[_0x5e5fd7(0x13e)](..._0x5567e8),postMessage({'type':_0x5e5fd7(0x151),'payload':{'percent':Math[_0x5e5fd7(0xe4)]((_0x25c220+_0x5567e8[_0x5e5fd7(0x178)])/_0x2d8b13*0x64),'message':_0x5e5fd7(0xc6)+(_0x25c220+0x1)+'–'+(_0x25c220+_0x5567e8['length'])+'/'+_0x2d8b13}});}postMessage({'type':'done','payload':{'items':_0x5915d4}});}catch(_0x5bb551){postMessage({'type':_0x5e5fd7(0x11d),'payload':_0x5bb551[_0x5e5fd7(0xca)]||_0x5bb551});}}if(_0x5cae10==='exportItems'){const {products:_0xdf192f,plantillaBuf:_0x5379ed}=_0x1854dd;if(!(_0x5379ed instanceof ArrayBuffer)){postMessage({'type':'error','payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array['isArray'](_0xdf192f)){postMessage({'type':'error','payload':_0x5e5fd7(0x177)});return;}try{structuredClone(_0xdf192f);}catch(_0x435a3e){postMessage({'type':_0x5e5fd7(0x11d),'payload':_0x5e5fd7(0xa1)+_0x435a3e[_0x5e5fd7(0xca)]});return;}try{const _0x50dad2={'1':_0x5e5fd7(0x13a),'2':_0x5e5fd7(0x101),'3':_0x5e5fd7(0xf7),'4':'Combo','5':_0x5e5fd7(0x184)};function _0x535567(_0x3f0a54){const _0x23cba2=_0x5e5fd7;return _0x50dad2[String(_0x3f0a54)]||_0x23cba2(0x13a);}const _0x29873f={'1':_0x5e5fd7(0xff),'2':_0x5e5fd7(0xdc),'3':_0x5e5fd7(0xab),'4':_0x5e5fd7(0xb1),'5':_0x5e5fd7(0xbb),'6':_0x5e5fd7(0x128),'7':'Exonerado\x20Gratuito\x20(0%)','8':'Exportación\x20(0%)','9':_0x5e5fd7(0x182)};function _0x1cc4ca(_0x9b8c0e){return _0x29873f[String(_0x9b8c0e)]||'Gravado\x20(18%)';}const _0x35ab6c={'4A':'BOBINAS','BJ':_0x5e5fd7(0x10d),'BLL':_0x5e5fd7(0xa8),'BG':'BOLSA','BO':'BOTELLAS','BX':'CAJA','CT':_0x5e5fd7(0xdf),'CMK':_0x5e5fd7(0xeb),'CMQ':_0x5e5fd7(0xce),'CMT':_0x5e5fd7(0x174),'CEN':'CIENTO\x20DE\x20UNIDADES','CY':_0x5e5fd7(0x14a),'CJ':'CONOS','DZN':_0x5e5fd7(0xf8),'DZP':_0x5e5fd7(0xb0),'BE':_0x5e5fd7(0xc8),'GLI':_0x5e5fd7(0xcb),'GRM':_0x5e5fd7(0x9e),'GRO':'GRUESA','HLT':_0x5e5fd7(0x13c),'LEF':'HOJA','SET':_0x5e5fd7(0x125),'KGM':'KILOGRAMO','KTM':'KILOMETRO','KWH':'KILOVATIO\x20HORA','KT':_0x5e5fd7(0x13b),'CA':_0x5e5fd7(0xc9),'LBR':_0x5e5fd7(0xd5),'LTR':_0x5e5fd7(0x152),'MWH':_0x5e5fd7(0xdd),'MTR':_0x5e5fd7(0x117),'MTK':_0x5e5fd7(0x15a),'MTQ':_0x5e5fd7(0x158),'MGM':_0x5e5fd7(0x14c),'MLT':_0x5e5fd7(0xda),'MMT':_0x5e5fd7(0xb3),'MMK':_0x5e5fd7(0x16a),'MMQ':_0x5e5fd7(0xae),'MIL':_0x5e5fd7(0x185),'UM':_0x5e5fd7(0x123),'ONZ':_0x5e5fd7(0x133),'PF':'PALETAS','PK':_0x5e5fd7(0x157),'PR':'PAR','FOT':'PIES','FTK':_0x5e5fd7(0x109),'FTQ':'PIES\x20CUBICOS','C62':_0x5e5fd7(0x16e),'PG':'PLACAS','ST':_0x5e5fd7(0x146),'INH':_0x5e5fd7(0xf0),'RM':_0x5e5fd7(0xb5),'SA':'SACO','DR':'TAMBOR','STN':_0x5e5fd7(0x105),'LTN':_0x5e5fd7(0xaf),'TNE':'TONELADAS','TU':_0x5e5fd7(0x159),'NIU':'UNIDAD\x20(NIU)','ZZ':_0x5e5fd7(0xdb),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':'YARDA','YDK':_0x5e5fd7(0xbf),'QQM':_0x5e5fd7(0x11b)};function _0x3c037c(_0x170358){return _0x35ab6c[String(_0x170358)]||'';}const _0x52a2e3=XLSX[_0x5e5fd7(0x181)](_0x5379ed,{'type':_0x5e5fd7(0x113),'cellDates':!![]}),_0x10f319=_0x52a2e3[_0x5e5fd7(0xd6)][0x0],_0x44a5da=_0x52a2e3[_0x5e5fd7(0x14d)][_0x10f319],_0x5b75f7=XLSX[_0x5e5fd7(0x161)][_0x5e5fd7(0xc1)](_0x44a5da,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x365fcb=XLSX[_0x5e5fd7(0x161)][_0x5e5fd7(0x155)](_0x44a5da[_0x5e5fd7(0x11a)]||'');for(let _0x519c70=0x2;_0x519c70<=_0x365fcb['e']['r'];++_0x519c70){for(let _0x5e0574=_0x365fcb['s']['c'];_0x5e0574<=_0x365fcb['e']['c'];++_0x5e0574){const _0x41cb10=XLSX[_0x5e5fd7(0x161)][_0x5e5fd7(0x141)]({'r':_0x519c70,'c':_0x5e0574});if(_0x44a5da[_0x41cb10])delete _0x44a5da[_0x41cb10];}}const _0x5250b6=_0xdf192f['map'](_0x12eb61=>{const _0x421533=_0x5e5fd7;_0x12eb61[_0x421533(0xa6)]=_0x12eb61[_0x421533(0xa6)]||{};const _0x35caaf={};return _0x5b75f7[_0x421533(0xe7)](_0xf9d1b0=>{const _0x5f4a45=_0x421533,_0x2edb1a=String(_0xf9d1b0)['trim'](),_0x4d8ffb=_0x2edb1a['toLowerCase'](),_0x58f7fd=Object[_0x5f4a45(0x118)](_0x12eb61)['find'](_0x28cbbe=>_0x28cbbe[_0x5f4a45(0x144)]()[_0x5f4a45(0x162)]()===_0x4d8ffb);if(_0x58f7fd){_0x35caaf[_0x2edb1a]=_0x12eb61[_0x58f7fd]??'';return;}switch(_0x2edb1a){case'ID':_0x35caaf[_0x2edb1a]=_0x12eb61['id']??'';break;case _0x5f4a45(0x153):_0x35caaf[_0x2edb1a]=_0x535567(_0x12eb61[_0x5f4a45(0xb4)]);break;case _0x5f4a45(0x107):_0x35caaf[_0x2edb1a]=_0x12eb61['setCodProducto']??'';break;case _0x5f4a45(0x110):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x120)]??'';break;case _0x5f4a45(0xa2):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0xaa)]??'';break;case _0x5f4a45(0x186):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x172)]??'';break;case _0x5f4a45(0xe5):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x15f)]??'';break;case _0x5f4a45(0xf9):_0x35caaf[_0x2edb1a]=_0x1cc4ca(_0x12eb61[_0x5f4a45(0x165)]);break;case _0x5f4a45(0x124):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x176)]??'';break;case _0x5f4a45(0xe0):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0xb6)]??'';break;case _0x5f4a45(0x134):_0x35caaf[_0x2edb1a]=_0x3c037c(_0x12eb61['setUnidadCodigo']);break;case'Precio\x20Venta\x20Soles':_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x148)]??'';break;case'Precio\x20Costo\x20Soles':_0x35caaf[_0x2edb1a]=_0x12eb61['PEN_setMtoPrecioCostoUnitario']??'';break;case _0x5f4a45(0x12a):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x179)]??'';break;case _0x5f4a45(0x142):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x121)]??'';break;case'ID\x20UNIT\x202':_0x35caaf[_0x2edb1a]=_0x12eb61['setUnitId2']??'';break;case _0x5f4a45(0xe9):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x168)]??'';break;case _0x5f4a45(0x112):_0x35caaf[_0x2edb1a]=_0x3c037c(_0x12eb61[_0x5f4a45(0xf3)]);break;case'Equivalencia\x202':_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x116)]??'1';break;case _0x5f4a45(0x17c):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x169)]??'';break;case _0x5f4a45(0xfb):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x17b)]??'';break;case'Precio\x20Venta\x20Dólares\x202':_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0xe1)]??'';break;case _0x5f4a45(0xfc):_0x35caaf[_0x2edb1a]=_0x12eb61['USD_setMtoPrecioCostoUnitario2']??'';break;case'¿Rastrear\x20Inventario?':_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x108)]==0x1?'SI':'NO';break;case _0x5f4a45(0xfe):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x16b)]??'';break;case _0x5f4a45(0x10c):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x104)]??'';break;case _0x5f4a45(0x14f):_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x129)]??'';break;case'Fecha\x20de\x20Vencimiento':_0x35caaf[_0x2edb1a]=_0x12eb61[_0x5f4a45(0x173)]??'';break;default:_0x35caaf[_0x2edb1a]='';}}),_0x35caaf;});XLSX['utils'][_0x5e5fd7(0x135)](_0x44a5da,_0x5250b6,{'origin':'A3','skipHeader':!![],'header':_0x5b75f7});const _0x688b93={'s':{'r':0x0,'c':0x0},'e':{'r':_0x5250b6[_0x5e5fd7(0x178)]+0x1,'c':_0x5b75f7[_0x5e5fd7(0x178)]-0x1}};_0x44a5da['!ref']=XLSX[_0x5e5fd7(0x161)][_0x5e5fd7(0xe6)](_0x688b93);const _0x34290c=XLSX[_0x5e5fd7(0xde)](_0x52a2e3,{'bookType':'xlsx','type':_0x5e5fd7(0x113)});let _0x4552d7,_0xa2aaea;if(_0x34290c instanceof Uint8Array)_0x4552d7=_0x34290c,_0xa2aaea=[_0x34290c[_0x5e5fd7(0x10b)]];else{if(_0x34290c instanceof ArrayBuffer)_0x4552d7=new Uint8Array(_0x34290c),_0xa2aaea=[_0x34290c];else{const _0x5c784b=new Uint8Array(_0x34290c);_0x4552d7=_0x5c784b,_0xa2aaea=[_0x5c784b[_0x5e5fd7(0x10b)]];}}postMessage({'type':_0x5e5fd7(0xd9),'payload':{'wbout':_0x4552d7,'count':_0x5250b6['length']}},_0xa2aaea);}catch(_0x120d6b){postMessage({'type':_0x5e5fd7(0x11d),'payload':_0x120d6b[_0x5e5fd7(0xca)]||String(_0x120d6b)});}return;}};