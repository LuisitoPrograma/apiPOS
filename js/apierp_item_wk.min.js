/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.0.8
*/

const _0x538d27=_0x3269;(function(_0x49c8cf,_0x103dbd){const _0x10ff1a=_0x3269,_0x449579=_0x49c8cf();while(!![]){try{const _0x11d76f=-parseInt(_0x10ff1a(0xf9))/0x1*(parseInt(_0x10ff1a(0x1a2))/0x2)+parseInt(_0x10ff1a(0x151))/0x3+-parseInt(_0x10ff1a(0x10e))/0x4*(-parseInt(_0x10ff1a(0x17d))/0x5)+-parseInt(_0x10ff1a(0x110))/0x6+-parseInt(_0x10ff1a(0x1b5))/0x7+parseInt(_0x10ff1a(0xec))/0x8+parseInt(_0x10ff1a(0xe7))/0x9;if(_0x11d76f===_0x103dbd)break;else _0x449579['push'](_0x449579['shift']());}catch(_0x2a0b00){_0x449579['push'](_0x449579['shift']());}}}(_0x4833,0x4aeb5));const _0x57dbfc=(function(){let _0x55fa38=!![];return function(_0x2601ca,_0xe5effd){const _0x3ae94e=_0x55fa38?function(){const _0xd155e0=_0x3269;if(_0xe5effd){const _0x372dc6=_0xe5effd[_0xd155e0(0x197)](_0x2601ca,arguments);return _0xe5effd=null,_0x372dc6;}}:function(){};return _0x55fa38=![],_0x3ae94e;};}()),_0x1ea37e=_0x57dbfc(this,function(){const _0x52b9eb=_0x3269;return _0x1ea37e['toString']()[_0x52b9eb(0x179)](_0x52b9eb(0x19d))['toString']()[_0x52b9eb(0x14b)](_0x1ea37e)[_0x52b9eb(0x179)](_0x52b9eb(0x19d));});function _0x4833(){const _0x22c7f0=['CIENTO\x20DE\x20UNIDADES','Precio\x20Venta\x20Soles','Precio\x20Venta\x20Dólares\x202','findIndex','FARDO','Exonerado\x20(0%)','FTQ','import','xlsx','decode_range','Precio\x20Costo\x20Dólares','exception','CAJA','PAQUETE','BLL','setCategoria','Comisión\x20Venta\x203\x20(%)','PIES','BALDE','filter','USD_setMtoPrecioUnitario','Serie','setUnidadCodigo2','buffer','CEN','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','GRAMO','BARRILES','array','ID\x20UNIT','SSF','setInventariable','KIT','SACO','Alias\x203','setUnitId3','TAMBOR','TNE','search','encode_range','MILIMETRO\x20CUADRADO','setBatchExpirationDate','29405bytIrV','UNIDAD\x20(ZZ)','FOT','USD_setMtoPrecioCostoUnitario','length','Se\x20Vende','UNIDAD\x20(NIU)','TONELADA\x20LARGA','Fabricado','getDate','return\x20(function()\x20','Fecha\x20de\x20Vencimiento','PEN_setMtoPrecioCostoUnitario2','Código\x20SKU*','Precio\x20Venta\x20Soles\x202','LIBRAS','trim','padStart','info','setDescripcion','Nombre*','DZN','CENTIMETRO\x20CUBICO','setUnidadEquivalencia3','MILLON\x20DE\x20UNIDADES','SET','apply','Código\x20de\x20Barras','exportDone','CONOS','setTaxId','round','(((.+)+)+)+$','CENTIMETRO\x20LINEAL','parse_date_code','LEF','Precio\x20Venta\x20Dólares','61034jiPtQz','ID\x20UNIT\x202','YARDA\x20CUADRADA','PIES\x20CUBICOS','KTM','PEN_setMtoPrecioUnitario3','USD_setMtoPrecioUnitario3','HECTOLITRO','Alias','HLT','table','toLowerCase','KILOMETRO','Precio\x20Costo\x20Soles','Alias\x202','MWH','forEach','Gravado\x20Gratuito\x20(18%)','setItemUnitAlias2','1137661UWOUfh','Lote','setUnidadCodigo3','PIEZAS','setItemUnitAlias3','setItemVariantValues','Servicio','Modelo','getFullYear','ONZAS','UND\x20(NIU)','Descripción','METRO','setSucursalStock','find','trace','setWarehouseStockMin','CENTIMETRO\x20CUADRADO','METRO\x20CUBICO','code','setItemIsBought','US\x20GALON\x20(3,7843\x20L)','MMK','MTK','GRM','!ref','LITRO','slice','MILLARES','DOCENA','exportItems:\x20products\x20no\x20es\x20Array.','Materia\x20Prima','Equivalencia\x202','BOTELLAS','toString','PEN_setMtoPrecioUnitario','Gravado\x20Gratuito\x20(10%)','value','message','reduce','PULGADAS','done','prototype','number','ID\x20UNIT\x203','STN','MGM','7591347rFgLJf','MILIGRAMOS','Unidad\x20de\x20Medida\x203','MILILITRO','setItemCommissionPercentage','120064BcbDyh','C62','PALETAS','PEN_setMtoPrecioCostoUnitario3','sheet_to_json','TONELADA\x20CORTA','LATAS','El\x20archivo\x20tiene\x20','progress','exportItems:\x20productos\x20no\x20clonables:\x20','Comisión\x20Venta\x20(%)','Exportación\x20(0%)','console','18DJduFG','Impuesto*','FTK','GALON\x20INGLES\x20(4,545956L)','PLACAS','NIU','GLL','setUnidadCodigo','GRUESA','INH','some','setUnitId','Precio\x20Costo\x20Dólares\x203','Sheets','Gravado\x20(18%)','Talla','setUnitId2','Modelo\x20de\x20Manga','TUBOS','RESMA','Marca','316pXgBWJ','Precio\x20Venta\x20Soles\x203','3474240mhhfIL','map','PEN_setMtoPrecioUnitario2','GRO','QUINTAL','isArray','error','USD_setMtoPrecioCostoUnitario2','MTR','sheet_add_json','Stock\x20Mínimo','Precio\x20Costo\x20Soles\x202','DOCENA\x20POR\x2010**6','Unidad\x20de\x20Medida\x202','setItemIsSold','Comisión\x20Venta\x202\x20(%)','KWH','{}.constructor(\x22return\x20this\x22)(\x20)','SheetNames','push','Exportando\x20filas\x20','Artículo','Código\x20de\x20Barras\x203','MILIMETRO\x20CUBICO','setItemType','__proto__','USD_setMtoPrecioCostoUnitario3','Equivalencia\x203','read','LTR','Stock\x20Actual','YARDA','CMQ','Precio\x20Costo\x20Dólares\x202','HOJA','CMT','METRO\x20CUADRADO','Precio\x20Venta\x20Dólares\x203','Unidad\x20de\x20Medida*','PAR','Procesadas\x20filas\x20','USD_setMtoPrecioUnitario2','TONELADAS','Material','GLI','Modelo\x20de\x20Cuello','Se\x20Compra','\x20de\x20','warn','utils','write','log','keys','CARTONES','Precio\x20Costo\x20Soles\x203','BOBINAS','Código\x20de\x20Barras\x202','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','Tipo*','constructor','MIL','Gravado\x20(10%)','PIES\x20CUADRADOS','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','YRD','823944tkIFAZ','Categoría'];_0x4833=function(){return _0x22c7f0;};return _0x4833();}_0x1ea37e();const _0x308fcb=(function(){let _0x538f31=!![];return function(_0xf9b6a7,_0x54983e){const _0x1d12f9=_0x538f31?function(){const _0x1fa2e6=_0x3269;if(_0x54983e){const _0x22c863=_0x54983e[_0x1fa2e6(0x197)](_0xf9b6a7,arguments);return _0x54983e=null,_0x22c863;}}:function(){};return _0x538f31=![],_0x1d12f9;};}()),_0x15a3a9=_0x308fcb(this,function(){const _0x289e35=_0x3269,_0x2f7b0e=function(){const _0x258ad4=_0x3269;let _0x41455f;try{_0x41455f=Function(_0x258ad4(0x187)+_0x258ad4(0x121)+');')();}catch(_0x200d8c){_0x41455f=window;}return _0x41455f;},_0x5c4f86=_0x2f7b0e(),_0x58a7ea=_0x5c4f86[_0x289e35(0xf8)]=_0x5c4f86[_0x289e35(0xf8)]||{},_0x3c7658=[_0x289e35(0x143),_0x289e35(0x140),_0x289e35(0x18f),_0x289e35(0x116),_0x289e35(0x15e),_0x289e35(0x1ac),_0x289e35(0x1c4)];for(let _0x22b6bc=0x0;_0x22b6bc<_0x3c7658['length'];_0x22b6bc++){const _0x2b25cb=_0x308fcb[_0x289e35(0x14b)][_0x289e35(0xe2)]['bind'](_0x308fcb),_0x45e36d=_0x3c7658[_0x22b6bc],_0x6f9d72=_0x58a7ea[_0x45e36d]||_0x2b25cb;_0x2b25cb[_0x289e35(0x129)]=_0x308fcb['bind'](_0x308fcb),_0x2b25cb[_0x289e35(0xda)]=_0x6f9d72[_0x289e35(0xda)]['bind'](_0x6f9d72),_0x58a7ea[_0x45e36d]=_0x2b25cb;}});function _0x3269(_0x30fc18,_0x3a7198){const _0x266a9b=_0x4833();return _0x3269=function(_0x15a3a9,_0x308fcb){_0x15a3a9=_0x15a3a9-0xda;let _0x3c5984=_0x266a9b[_0x15a3a9];return _0x3c5984;},_0x3269(_0x30fc18,_0x3a7198);}_0x15a3a9(),importScripts(_0x538d27(0x149)),onmessage=({data:_0xb8c54d})=>{const _0x1bf9e1=_0x538d27,{action:_0x41b21b}=_0xb8c54d;if(_0x41b21b===_0x1bf9e1(0x15a)){const {buf:_0x3e73d6,maxRows:_0x3a4c4b}=_0xb8c54d;try{postMessage({'type':_0x1bf9e1(0xf4),'payload':{'percent':0x5,'message':'Iniciando\x20parseo…'}});const _0x4c927e=XLSX[_0x1bf9e1(0x12c)](_0x3e73d6,{'type':_0x1bf9e1(0x16f),'cellDates':!![]}),_0x439ac9=_0x4c927e[_0x1bf9e1(0x106)][_0x4c927e['SheetNames'][0x0]],_0x1043bc=XLSX['utils'][_0x1bf9e1(0xf0)](_0x439ac9,{'defval':'','range':0x1,'cellDates':!![]}),_0x4cec01=_0x1043bc[_0x1bf9e1(0x156)](_0x108307=>(!_0x108307['Tipo*']||String(_0x108307[_0x1bf9e1(0x14a)])[_0x1bf9e1(0x18d)]()==='')&&(!_0x108307[_0x1bf9e1(0x18a)]||String(_0x108307[_0x1bf9e1(0x18a)])['trim']()==='')&&(!_0x108307[_0x1bf9e1(0x191)]||String(_0x108307[_0x1bf9e1(0x191)])[_0x1bf9e1(0x18d)]()==='')&&(!_0x108307['Unidad\x20de\x20Medida*']||String(_0x108307[_0x1bf9e1(0x136)])[_0x1bf9e1(0x18d)]()==='')),_0x4c8f03=_0x4cec01>=0x0?_0x1043bc['slice'](0x0,_0x4cec01):_0x1043bc,_0xca8de9=_0x4c8f03[_0x1bf9e1(0x166)](_0x4fb5ef=>_0x4fb5ef['Tipo*']&&String(_0x4fb5ef['Tipo*'])[_0x1bf9e1(0x18d)]()!==''&&_0x4fb5ef[_0x1bf9e1(0x18a)]&&String(_0x4fb5ef['Código\x20SKU*'])[_0x1bf9e1(0x18d)]()!==''&&_0x4fb5ef[_0x1bf9e1(0x191)]&&String(_0x4fb5ef[_0x1bf9e1(0x191)])[_0x1bf9e1(0x18d)]()!==''&&_0x4fb5ef[_0x1bf9e1(0x136)]&&String(_0x4fb5ef[_0x1bf9e1(0x136)])['trim']()!==''),_0x1cac74=_0xca8de9[_0x1bf9e1(0x181)];if(_0x1cac74===0x0){postMessage({'type':'error','payload':_0x1bf9e1(0x16c)});return;}if(_0x1cac74>_0x3a4c4b)throw _0x1bf9e1(0xf3)+_0x1cac74+_0x1bf9e1(0x14f)+_0x3a4c4b+'.';const _0x5aee2a=0x1f4,_0x18c245=[],_0x5e50c2=[{'codigo':'4A','nombre':_0x1bf9e1(0x147)},{'codigo':'BJ','nombre':_0x1bf9e1(0x165)},{'codigo':_0x1bf9e1(0x161),'nombre':'BARRILES'},{'codigo':'BG','nombre':'BOLSA'},{'codigo':'BO','nombre':'BOTELLAS'},{'codigo':'BX','nombre':'CAJA'},{'codigo':'CT','nombre':_0x1bf9e1(0x145)},{'codigo':'CMK','nombre':_0x1bf9e1(0x1c6)},{'codigo':_0x1bf9e1(0x130),'nombre':_0x1bf9e1(0x193)},{'codigo':_0x1bf9e1(0x133),'nombre':_0x1bf9e1(0x19e)},{'codigo':_0x1bf9e1(0x16b),'nombre':_0x1bf9e1(0x153)},{'codigo':'CY','nombre':'CILINDRO'},{'codigo':'CJ','nombre':_0x1bf9e1(0x19a)},{'codigo':_0x1bf9e1(0x192),'nombre':_0x1bf9e1(0x1d2)},{'codigo':'DZP','nombre':_0x1bf9e1(0x11c)},{'codigo':'BE','nombre':_0x1bf9e1(0x157)},{'codigo':_0x1bf9e1(0x13c),'nombre':_0x1bf9e1(0xfc)},{'codigo':_0x1bf9e1(0x1cd),'nombre':_0x1bf9e1(0x16d)},{'codigo':_0x1bf9e1(0x113),'nombre':_0x1bf9e1(0x101)},{'codigo':_0x1bf9e1(0x1ab),'nombre':_0x1bf9e1(0x1a9)},{'codigo':_0x1bf9e1(0x1a0),'nombre':_0x1bf9e1(0x132)},{'codigo':_0x1bf9e1(0x196),'nombre':'JUEGO'},{'codigo':'KGM','nombre':'KILOGRAMO'},{'codigo':_0x1bf9e1(0x1a6),'nombre':_0x1bf9e1(0x1ae)},{'codigo':_0x1bf9e1(0x120),'nombre':'KILOVATIO\x20HORA'},{'codigo':'KT','nombre':_0x1bf9e1(0x173)},{'codigo':'CA','nombre':_0x1bf9e1(0xf2)},{'codigo':'LBR','nombre':_0x1bf9e1(0x18c)},{'codigo':_0x1bf9e1(0x12d),'nombre':_0x1bf9e1(0x1cf)},{'codigo':_0x1bf9e1(0x1b1),'nombre':'MEGAWATT\x20HORA'},{'codigo':_0x1bf9e1(0x118),'nombre':'METRO'},{'codigo':_0x1bf9e1(0x1cc),'nombre':_0x1bf9e1(0x134)},{'codigo':'MTQ','nombre':_0x1bf9e1(0x1c7)},{'codigo':_0x1bf9e1(0xe6),'nombre':_0x1bf9e1(0xe8)},{'codigo':'MLT','nombre':_0x1bf9e1(0xea)},{'codigo':'MMT','nombre':'MILIMETRO'},{'codigo':_0x1bf9e1(0x1cb),'nombre':'MILIMETRO\x20CUADRADO'},{'codigo':'MMQ','nombre':'MILIMETRO\x20CUBICO'},{'codigo':_0x1bf9e1(0x14c),'nombre':_0x1bf9e1(0x1d1)},{'codigo':'UM','nombre':_0x1bf9e1(0x195)},{'codigo':'ONZ','nombre':_0x1bf9e1(0x1be)},{'codigo':'PF','nombre':_0x1bf9e1(0xee)},{'codigo':'PK','nombre':_0x1bf9e1(0x160)},{'codigo':'PR','nombre':_0x1bf9e1(0x137)},{'codigo':_0x1bf9e1(0x17f),'nombre':_0x1bf9e1(0x164)},{'codigo':_0x1bf9e1(0xfb),'nombre':_0x1bf9e1(0x14e)},{'codigo':_0x1bf9e1(0x159),'nombre':'PIES\x20CUBICOS'},{'codigo':_0x1bf9e1(0xed),'nombre':'PIEZAS'},{'codigo':'PG','nombre':_0x1bf9e1(0xfd)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':_0x1bf9e1(0x102),'nombre':_0x1bf9e1(0xe0)},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':_0x1bf9e1(0x174)},{'codigo':'DR','nombre':_0x1bf9e1(0x177)},{'codigo':_0x1bf9e1(0xe5),'nombre':_0x1bf9e1(0xf1)},{'codigo':'LTN','nombre':_0x1bf9e1(0x184)},{'codigo':_0x1bf9e1(0x178),'nombre':'TONELADAS'},{'codigo':'TU','nombre':'TUBOS'},{'codigo':_0x1bf9e1(0xfe),'nombre':_0x1bf9e1(0x183)},{'codigo':'ZZ','nombre':_0x1bf9e1(0x17e)},{'codigo':_0x1bf9e1(0xff),'nombre':_0x1bf9e1(0x1ca)},{'codigo':_0x1bf9e1(0x150),'nombre':_0x1bf9e1(0x12f)},{'codigo':'YDK','nombre':_0x1bf9e1(0x1a4)},{'codigo':'QQM','nombre':_0x1bf9e1(0x114)}],_0x3c292c=_0x5e50c2[_0x1bf9e1(0xdf)]((_0xa25d79,{nombre:_0x35cf7a,codigo:_0x406eb4})=>{const _0x20ceaf=_0x1bf9e1;return _0xa25d79[_0x35cf7a['trim']()]=_0x406eb4[_0x20ceaf(0x18d)](),_0xa25d79;},{});for(let _0x11e70d=0x0;_0x11e70d<_0x1cac74;_0x11e70d+=_0x5aee2a){const _0x831598=_0xca8de9['slice'](_0x11e70d,_0x11e70d+_0x5aee2a)[_0x1bf9e1(0x111)]((_0x199953,_0x313ad9)=>{const _0x9b26fd=_0x1bf9e1;let _0x2efc94={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x199953[_0x9b26fd(0x14a)]]||'1';const _0x2401e3=String(_0x199953['Impuesto*'])[_0x9b26fd(0x18d)](),_0x16d0f2={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x2c7d64=_0x16d0f2[_0x2401e3]||'1',_0x292c8e={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x2c7d64]||{'code':'10','value':0x12},_0x446f98={};let _0x517691=String(_0x199953[_0x9b26fd(0x191)])[_0x9b26fd(0x18d)]();const _0x328851=[_0x9b26fd(0x1b6),_0x9b26fd(0x108),'Color','Género',_0x9b26fd(0x1bc),_0x9b26fd(0x168),_0x9b26fd(0x13b),_0x9b26fd(0x13d),_0x9b26fd(0x10a)];_0x328851[_0x9b26fd(0x1b2)](_0x3d8868=>{const _0x4bd631=String(_0x199953[_0x3d8868]||'')['trim']();_0x4bd631&&(_0x446f98[_0x3d8868]=_0x4bd631,_0x517691+='\x20'+_0x3d8868+'\x20'+_0x4bd631);});const _0x994d7e=[],_0x4a5ace=String(_0x199953[_0x9b26fd(0x136)]||_0x9b26fd(0x183))[_0x9b26fd(0x18d)](),_0x573c76=_0x3c292c[_0x4a5ace]||'NIU',_0x311d25=String(_0x199953['Alias'])[_0x9b26fd(0x18d)]();_0x994d7e[_0x9b26fd(0x123)]({'setItemUnitId':String(_0x199953[_0x9b26fd(0x170)])[_0x9b26fd(0x18d)]()||'','setItemBarCode':String(_0x199953['Código\x20de\x20Barras'])[_0x9b26fd(0x18d)]()||'','setAlias':_0x311d25,'setUnitCode':_0x573c76,'setPrice':parseFloat(_0x199953[_0x9b26fd(0x154)]),'setCost':parseFloat(_0x199953[_0x9b26fd(0x1af)]),'setPriceUSD':parseFloat(_0x199953[_0x9b26fd(0x1a1)]),'setCostUSD':parseFloat(_0x199953[_0x9b26fd(0x15d)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x199953[_0x9b26fd(0xf6)])});const _0x5eea60=[_0x9b26fd(0x1a3),_0x9b26fd(0x1b0),_0x9b26fd(0x148),_0x9b26fd(0x1d5),_0x9b26fd(0x18b),_0x9b26fd(0x11b),_0x9b26fd(0x155),'Precio\x20Costo\x20Dólares\x202'][_0x9b26fd(0x103)](_0x5dd1aa=>{const _0x2e2351=_0x9b26fd,_0x1392fc=_0x199953[_0x5dd1aa];return _0x1392fc!=null&&String(_0x1392fc)[_0x2e2351(0x18d)]()!=='';});if(_0x5eea60){const _0x1861b0=String(_0x199953[_0x9b26fd(0x11d)]||_0x9b26fd(0x1bf))[_0x9b26fd(0x18d)](),_0xa32939=_0x3c292c[_0x1861b0]||_0x9b26fd(0xfe);_0x994d7e['push']({'setItemUnitId':String(_0x199953[_0x9b26fd(0x1a3)])[_0x9b26fd(0x18d)]()||'','setItemBarCode':String(_0x199953[_0x9b26fd(0x148)])[_0x9b26fd(0x18d)]()||'','setAlias':String(_0x199953[_0x9b26fd(0x1b0)])[_0x9b26fd(0x18d)](),'setUnitCode':_0xa32939,'setPrice':parseFloat(_0x199953[_0x9b26fd(0x18b)]),'setCost':parseFloat(_0x199953[_0x9b26fd(0x11b)]),'setPriceUSD':parseFloat(_0x199953['Precio\x20Venta\x20Dólares\x202']),'setCostUSD':parseFloat(_0x199953['Precio\x20Costo\x20Dólares\x202']),'setDefault':0x0,'setEquivalence':parseFloat(_0x199953[_0x9b26fd(0x1d5)])||0x1,'setFactor':parseFloat(_0x199953['Equivalencia\x202'])||0x1,'setItemCommissionPercentage':parseFloat(_0x199953['Comisión\x20Venta\x202\x20(%)'])});}const _0x1fcb7e=['ID\x20UNIT\x203',_0x9b26fd(0x175),_0x9b26fd(0x126),'Equivalencia\x203',_0x9b26fd(0x10f),_0x9b26fd(0x146),'Precio\x20Venta\x20Dólares\x203',_0x9b26fd(0x105)][_0x9b26fd(0x103)](_0x81b0d5=>{const _0x2dce01=_0x199953[_0x81b0d5];return _0x2dce01!=null&&String(_0x2dce01)['trim']()!=='';});if(_0x1fcb7e){const _0x32090d=String(_0x199953[_0x9b26fd(0xe9)]||'UND\x20(NIU)')[_0x9b26fd(0x18d)](),_0xab4b3c=_0x3c292c[_0x32090d]||_0x9b26fd(0xfe);_0x994d7e[_0x9b26fd(0x123)]({'setItemUnitId':String(_0x199953[_0x9b26fd(0xe4)])['trim']()||'','setItemBarCode':String(_0x199953[_0x9b26fd(0x126)])[_0x9b26fd(0x18d)]()||'','setAlias':String(_0x199953[_0x9b26fd(0x175)])[_0x9b26fd(0x18d)](),'setUnitCode':_0xab4b3c,'setPrice':parseFloat(_0x199953[_0x9b26fd(0x10f)]),'setCost':parseFloat(_0x199953['Precio\x20Costo\x20Soles\x203']),'setPriceUSD':parseFloat(_0x199953['Precio\x20Venta\x20Dólares\x203']),'setCostUSD':parseFloat(_0x199953[_0x9b26fd(0x105)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x199953['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0x199953[_0x9b26fd(0x12b)])||0x1,'setItemCommissionPercentage':parseFloat(_0x199953[_0x9b26fd(0x163)])});}let _0x4147a3=_0x199953[_0x9b26fd(0x188)],_0x1f1102='';if(_0x4147a3 instanceof Date){const _0x375540=_0x4147a3[_0x9b26fd(0x1bd)](),_0x36c310=String(_0x4147a3['getMonth']()+0x1)[_0x9b26fd(0x18e)](0x2,'0'),_0x2faa5c=String(_0x4147a3[_0x9b26fd(0x186)]())['padStart'](0x2,'0');_0x1f1102=_0x375540+'-'+_0x36c310+'-'+_0x2faa5c;}else{if(typeof _0x4147a3===_0x9b26fd(0xe3)){const _0x39da1d=XLSX[_0x9b26fd(0x171)][_0x9b26fd(0x19f)](_0x4147a3);if(_0x39da1d){const _0x423378=_0x39da1d['y'],_0x1e6abe=String(_0x39da1d['m'])['padStart'](0x2,'0'),_0x5bed0a=String(_0x39da1d['d'])[_0x9b26fd(0x18e)](0x2,'0');_0x1f1102=_0x423378+'-'+_0x1e6abe+'-'+_0x5bed0a;}}else _0x1f1102=String(_0x4147a3||'')[_0x9b26fd(0x18d)]();}return{'setItemId':String(_0x199953['ID'])['trim'](),'setItemType':_0x2efc94,'setItemCode':String(_0x199953['Código\x20SKU*'])[_0x9b26fd(0x18d)](),'setItemName':String(_0x199953[_0x9b26fd(0x191)])['trim'](),'setItemDescription':String(_0x199953['Descripción'])['trim']()||'','setItemIsSold':_0x199953['Se\x20Vende']=='SI'?0x1:0x0,'setItemIsBought':_0x199953['Se\x20Compra']=='SI'?0x1:0x0,'setItemCategories':_0x199953[_0x9b26fd(0x152)]?[String(_0x199953[_0x9b26fd(0x152)])[_0x9b26fd(0x18d)]()]:[],'setItemBrands':_0x199953['Marca']?[String(_0x199953[_0x9b26fd(0x10d)])[_0x9b26fd(0x18d)]()]:[],'setItemTaxId':_0x2c7d64,'setItemTaxCode':_0x292c8e[_0x9b26fd(0x1c8)],'setItemTaxValue':_0x292c8e[_0x9b26fd(0xdd)],'setItemUnits':_0x994d7e,'setItemInventoriable':_0x199953['Rastrear\x20Inventario']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x199953[_0x9b26fd(0x12e)])||0x0,'setStockMinimum':parseFloat(_0x199953[_0x9b26fd(0x11a)])||0x0,'setItemLocation':String(_0x199953['Ubicación'])[_0x9b26fd(0x18d)]()||'','setBatchName':String(_0x199953[_0x9b26fd(0x1b6)])['trim']()||'','setItemDateExpiry':_0x1f1102,'setItemVariantName':_0x517691,'setItemVariantValues':_0x446f98,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x18c245[_0x1bf9e1(0x123)](..._0x831598),postMessage({'type':'progress','payload':{'percent':Math[_0x1bf9e1(0x19c)]((_0x11e70d+_0x831598[_0x1bf9e1(0x181)])/_0x1cac74*0x64),'message':_0x1bf9e1(0x138)+(_0x11e70d+0x1)+'–'+(_0x11e70d+_0x831598[_0x1bf9e1(0x181)])+'/'+_0x1cac74}});}postMessage({'type':_0x1bf9e1(0xe1),'payload':{'items':_0x18c245}});}catch(_0x53de03){postMessage({'type':_0x1bf9e1(0x116),'payload':_0x53de03[_0x1bf9e1(0xde)]||_0x53de03});}}if(_0x41b21b==='exportItems'){const {products:_0x1f39bc,plantillaBuf:_0x146bfc}=_0xb8c54d;if(!(_0x146bfc instanceof ArrayBuffer)){postMessage({'type':_0x1bf9e1(0x116),'payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array[_0x1bf9e1(0x115)](_0x1f39bc)){postMessage({'type':_0x1bf9e1(0x116),'payload':_0x1bf9e1(0x1d3)});return;}try{structuredClone(_0x1f39bc);}catch(_0x475fb6){postMessage({'type':_0x1bf9e1(0x116),'payload':_0x1bf9e1(0xf5)+_0x475fb6[_0x1bf9e1(0xde)]});return;}try{const _0x2544e4={'1':_0x1bf9e1(0x125),'2':_0x1bf9e1(0x1bb),'3':_0x1bf9e1(0x1d4),'4':'Combo','5':_0x1bf9e1(0x185)};function _0x3548b2(_0x5b22af){const _0x218df2=_0x1bf9e1;return _0x2544e4[String(_0x5b22af)]||_0x218df2(0x125);}const _0x559143={'1':_0x1bf9e1(0x107),'2':_0x1bf9e1(0x158),'3':'Inafecto\x20(0%)','4':_0x1bf9e1(0x1b3),'5':'Inafecto\x20Gratuito\x20(0%)','6':_0x1bf9e1(0x14d),'7':'Exonerado\x20Gratuito\x20(0%)','8':_0x1bf9e1(0xf7),'9':_0x1bf9e1(0xdc)};function _0x393cc3(_0x4c89c4){const _0x566fe9=_0x1bf9e1;return _0x559143[String(_0x4c89c4)]||_0x566fe9(0x107);}const _0x59af54={'4A':_0x1bf9e1(0x147),'BJ':_0x1bf9e1(0x165),'BLL':_0x1bf9e1(0x16e),'BG':'BOLSA','BO':_0x1bf9e1(0x1d6),'BX':_0x1bf9e1(0x15f),'CT':_0x1bf9e1(0x145),'CMK':'CENTIMETRO\x20CUADRADO','CMQ':'CENTIMETRO\x20CUBICO','CMT':_0x1bf9e1(0x19e),'CEN':'CIENTO\x20DE\x20UNIDADES','CY':'CILINDRO','CJ':_0x1bf9e1(0x19a),'DZN':_0x1bf9e1(0x1d2),'DZP':_0x1bf9e1(0x11c),'BE':_0x1bf9e1(0x157),'GLI':_0x1bf9e1(0xfc),'GRM':_0x1bf9e1(0x16d),'GRO':_0x1bf9e1(0x101),'HLT':'HECTOLITRO','LEF':_0x1bf9e1(0x132),'SET':'JUEGO','KGM':'KILOGRAMO','KTM':_0x1bf9e1(0x1ae),'KWH':'KILOVATIO\x20HORA','KT':_0x1bf9e1(0x173),'CA':_0x1bf9e1(0xf2),'LBR':_0x1bf9e1(0x18c),'LTR':'LITRO','MWH':'MEGAWATT\x20HORA','MTR':_0x1bf9e1(0x1c1),'MTK':'METRO\x20CUADRADO','MTQ':_0x1bf9e1(0x1c7),'MGM':'MILIGRAMOS','MLT':_0x1bf9e1(0xea),'MMT':'MILIMETRO','MMK':_0x1bf9e1(0x17b),'MMQ':_0x1bf9e1(0x127),'MIL':_0x1bf9e1(0x1d1),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':_0x1bf9e1(0x1be),'PF':_0x1bf9e1(0xee),'PK':'PAQUETE','PR':_0x1bf9e1(0x137),'FOT':_0x1bf9e1(0x164),'FTK':'PIES\x20CUADRADOS','FTQ':_0x1bf9e1(0x1a5),'C62':_0x1bf9e1(0x1b8),'PG':'PLACAS','ST':'PLIEGO','INH':_0x1bf9e1(0xe0),'RM':_0x1bf9e1(0x10c),'SA':_0x1bf9e1(0x174),'DR':'TAMBOR','STN':_0x1bf9e1(0xf1),'LTN':'TONELADA\x20LARGA','TNE':_0x1bf9e1(0x13a),'TU':_0x1bf9e1(0x10b),'NIU':_0x1bf9e1(0x183),'ZZ':'UNIDAD\x20(ZZ)','GLL':_0x1bf9e1(0x1ca),'YRD':_0x1bf9e1(0x12f),'YDK':_0x1bf9e1(0x1a4),'QQM':_0x1bf9e1(0x114)};function _0x4acb81(_0x1499b4){return _0x59af54[String(_0x1499b4)]||'';}const _0x44f759=XLSX[_0x1bf9e1(0x12c)](_0x146bfc,{'type':_0x1bf9e1(0x16f),'cellDates':!![]}),_0x31944a=_0x44f759[_0x1bf9e1(0x122)][0x0],_0x2be587=_0x44f759[_0x1bf9e1(0x106)][_0x31944a],_0x3e1e79=XLSX['utils'][_0x1bf9e1(0xf0)](_0x2be587,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x1e18e8=XLSX['utils'][_0x1bf9e1(0x15c)](_0x2be587[_0x1bf9e1(0x1ce)]||'');for(let _0x75a7fb=0x2;_0x75a7fb<=_0x1e18e8['e']['r'];++_0x75a7fb){for(let _0x2270ef=_0x1e18e8['s']['c'];_0x2270ef<=_0x1e18e8['e']['c'];++_0x2270ef){const _0x3f6e01=XLSX['utils']['encode_cell']({'r':_0x75a7fb,'c':_0x2270ef});if(_0x2be587[_0x3f6e01])delete _0x2be587[_0x3f6e01];}}const _0xa412a1=_0x1f39bc[_0x1bf9e1(0x111)](_0x1c5cbd=>{const _0x32e886=_0x1bf9e1;_0x1c5cbd[_0x32e886(0x1ba)]=_0x1c5cbd[_0x32e886(0x1ba)]||{};const _0x1694a5={};return _0x3e1e79['forEach'](_0x490de8=>{const _0x4c7614=_0x32e886,_0x529382=String(_0x490de8)['trim'](),_0x27b054=_0x529382[_0x4c7614(0x1ad)](),_0x355217=Object[_0x4c7614(0x144)](_0x1c5cbd)[_0x4c7614(0x1c3)](_0x25a22a=>_0x25a22a[_0x4c7614(0x18d)]()['toLowerCase']()===_0x27b054);if(_0x355217){_0x1694a5[_0x529382]=_0x1c5cbd[_0x355217]??'';return;}switch(_0x529382){case'ID':_0x1694a5[_0x529382]=_0x1c5cbd['id']??'';break;case _0x4c7614(0x14a):_0x1694a5[_0x529382]=_0x3548b2(_0x1c5cbd[_0x4c7614(0x128)]);break;case'Código\x20SKU*':_0x1694a5[_0x529382]=_0x1c5cbd['setCodProducto']??'';break;case _0x4c7614(0x191):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x190)]??'';break;case _0x4c7614(0x1c0):_0x1694a5[_0x529382]=_0x1c5cbd['setItemDescription']??'';break;case _0x4c7614(0x182):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x11e)]==0x1?'SI':'NO';break;case _0x4c7614(0x13e):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x1c9)]==0x1?'SI':'NO';break;case'Categoría':_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x162)]??'';break;case'Marca':_0x1694a5[_0x529382]=_0x1c5cbd['setMarca']??'';break;case _0x4c7614(0xfa):_0x1694a5[_0x529382]=_0x393cc3(_0x1c5cbd[_0x4c7614(0x19b)]);break;case _0x4c7614(0x170):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x104)]??'';break;case _0x4c7614(0x1aa):_0x1694a5[_0x529382]=_0x1c5cbd['setItemUnitAlias']??'';break;case _0x4c7614(0x198):_0x1694a5[_0x529382]=_0x1c5cbd['setItemBarCode']??'';break;case _0x4c7614(0x136):_0x1694a5[_0x529382]=_0x4acb81(_0x1c5cbd[_0x4c7614(0x100)]);break;case'Precio\x20Venta\x20Soles':_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0xdb)]??'';break;case'Precio\x20Costo\x20Soles':_0x1694a5[_0x529382]=_0x1c5cbd['PEN_setMtoPrecioCostoUnitario']??'';break;case _0x4c7614(0x1a1):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x167)]??'';break;case _0x4c7614(0x15d):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x180)]??'';break;case'Comisión\x20Venta\x20(%)':_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0xeb)];break;case _0x4c7614(0x1a3):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x109)]??'';break;case _0x4c7614(0x1b0):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x1b4)]??'';break;case _0x4c7614(0x148):_0x1694a5[_0x529382]=_0x1c5cbd['setItemBarCode2']??'';break;case'Unidad\x20de\x20Medida\x202':_0x1694a5[_0x529382]=_0x4acb81(_0x1c5cbd[_0x4c7614(0x169)]);break;case _0x4c7614(0x1d5):_0x1694a5[_0x529382]=_0x1c5cbd['setUnidadEquivalencia2']??'1';break;case _0x4c7614(0x18b):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x112)]??'';break;case'Precio\x20Costo\x20Soles\x202':_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x189)]??'';break;case _0x4c7614(0x155):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x139)]??'';break;case _0x4c7614(0x131):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x117)]??'';break;case _0x4c7614(0x11f):_0x1694a5[_0x529382]=_0x1c5cbd['setItemCommissionPercentage2'];break;case _0x4c7614(0xe4):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x176)]??'';break;case'Alias\x203':_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x1b9)]??'';break;case _0x4c7614(0x126):_0x1694a5[_0x529382]=_0x1c5cbd['setItemBarCode3']??'';break;case _0x4c7614(0xe9):_0x1694a5[_0x529382]=_0x4acb81(_0x1c5cbd[_0x4c7614(0x1b7)]);break;case'Equivalencia\x203':_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x194)]??'1';break;case _0x4c7614(0x10f):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x1a7)]??'';break;case _0x4c7614(0x146):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0xef)]??'';break;case _0x4c7614(0x135):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x1a8)]??'';break;case _0x4c7614(0x105):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x12a)]??'';break;case _0x4c7614(0x163):_0x1694a5[_0x529382]=_0x1c5cbd['setItemCommissionPercentage3'];break;case'Rastrear\x20Inventario':_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x172)]==0x1?'SI':'NO';break;case'Stock\x20Actual':_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x1c2)]??'';break;case _0x4c7614(0x11a):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x1c5)]??'';break;case _0x4c7614(0x188):_0x1694a5[_0x529382]=_0x1c5cbd[_0x4c7614(0x17c)]??'';break;default:_0x1694a5[_0x529382]='';}}),_0x1694a5;}),_0x32dc57=0x3e8,_0x26f866=_0xa412a1[_0x1bf9e1(0x181)];for(let _0x4ced55=0x0;_0x4ced55<_0x26f866;_0x4ced55+=_0x32dc57){const _0x2fdad1=_0xa412a1[_0x1bf9e1(0x1d0)](_0x4ced55,_0x4ced55+_0x32dc57);XLSX[_0x1bf9e1(0x141)][_0x1bf9e1(0x119)](_0x2be587,_0x2fdad1,{'origin':{'r':_0x4ced55+0x2,'c':0x0},'skipHeader':!![],'header':_0x3e1e79}),postMessage({'type':_0x1bf9e1(0xf4),'payload':{'percent':Math[_0x1bf9e1(0x19c)]((_0x4ced55+_0x2fdad1['length'])/_0x26f866*0x64),'message':_0x1bf9e1(0x124)+(_0x4ced55+0x1)+'–'+(_0x4ced55+_0x2fdad1[_0x1bf9e1(0x181)])+_0x1bf9e1(0x13f)+_0x26f866}});}const _0x1a47af={'s':{'r':0x0,'c':0x0},'e':{'r':_0x26f866+0x1,'c':_0x3e1e79['length']-0x1}};_0x2be587[_0x1bf9e1(0x1ce)]=XLSX['utils'][_0x1bf9e1(0x17a)](_0x1a47af);const _0x31a8cf=XLSX[_0x1bf9e1(0x142)](_0x44f759,{'bookType':_0x1bf9e1(0x15b),'type':'array'});let _0xc8310d,_0x373933;if(_0x31a8cf instanceof Uint8Array)_0xc8310d=_0x31a8cf,_0x373933=[_0x31a8cf[_0x1bf9e1(0x16a)]];else{if(_0x31a8cf instanceof ArrayBuffer)_0xc8310d=new Uint8Array(_0x31a8cf),_0x373933=[_0x31a8cf];else{const _0x9d2cb6=new Uint8Array(_0x31a8cf);_0xc8310d=_0x9d2cb6,_0x373933=[_0x9d2cb6[_0x1bf9e1(0x16a)]];}}postMessage({'type':_0x1bf9e1(0x199),'payload':{'wbout':_0xc8310d,'count':_0xa412a1[_0x1bf9e1(0x181)]}},_0x373933);}catch(_0x42d33d){postMessage({'type':_0x1bf9e1(0x116),'payload':_0x42d33d[_0x1bf9e1(0xde)]||String(_0x42d33d)});}return;}};