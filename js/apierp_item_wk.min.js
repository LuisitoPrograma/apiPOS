/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.4.3
*/

const _0x3f3d51=_0x50e8;(function(_0x241a7d,_0x2c7dc9){const _0x3f0274=_0x50e8,_0x12f639=_0x241a7d();while(!![]){try{const _0x5c302d=-parseInt(_0x3f0274(0xf2))/0x1+-parseInt(_0x3f0274(0x132))/0x2+parseInt(_0x3f0274(0x84))/0x3*(-parseInt(_0x3f0274(0x137))/0x4)+parseInt(_0x3f0274(0x140))/0x5*(parseInt(_0x3f0274(0x7a))/0x6)+-parseInt(_0x3f0274(0x125))/0x7*(-parseInt(_0x3f0274(0x12e))/0x8)+parseInt(_0x3f0274(0x8d))/0x9*(-parseInt(_0x3f0274(0xe9))/0xa)+-parseInt(_0x3f0274(0x141))/0xb*(-parseInt(_0x3f0274(0xe3))/0xc);if(_0x5c302d===_0x2c7dc9)break;else _0x12f639['push'](_0x12f639['shift']());}catch(_0xf4f1ad){_0x12f639['push'](_0x12f639['shift']());}}}(_0x30ce,0xc9781));const _0x3317cf=(function(){let _0x1bd255=!![];return function(_0x5478fc,_0x55bced){const _0xaca532=_0x1bd255?function(){if(_0x55bced){const _0xb19eb5=_0x55bced['apply'](_0x5478fc,arguments);return _0x55bced=null,_0xb19eb5;}}:function(){};return _0x1bd255=![],_0xaca532;};}()),_0xa060e9=_0x3317cf(this,function(){const _0x5537f5=_0x50e8;return _0xa060e9[_0x5537f5(0x112)]()[_0x5537f5(0x155)]('(((.+)+)+)+$')['toString']()[_0x5537f5(0xb7)](_0xa060e9)['search'](_0x5537f5(0x116));});function _0x30ce(){const _0x5123f6=['3277115qcDYeQ','4719319wytVfP','BALDE','SACO','BOTELLAS','Precio\x20Venta\x20Dólares\x203','Fecha\x20de\x20Vencimiento','CMQ','MILIMETRO','Código\x20de\x20Barras\x202','message','BOLSA','exportItems:\x20products\x20no\x20es\x20Array.','CAJA','isArray','PEN_setMtoPrecioCostoUnitario','write','forEach','setItemBarCode2','decode_range','MMK','search','FOT','GLL','CILINDRO','Gravado\x20Gratuito\x20(18%)','MLT','DZP','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','parse_date_code','TAMBOR','ID\x20UNIT\x202','table','Nombre*','KIT','HLT','BOBINAS','METRO\x20CUBICO','Marca','LBR','PIEZAS','PIES\x20CUADRADOS','6BRiFRx','Precio\x20Costo\x20Soles\x203','HOJA','Precio\x20Venta\x20Soles\x203','utils','Alias\x203','Código\x20de\x20Barras','\x20de\x20','Alias\x202','YARDA','906hEFbFZ','setItemUnitAlias2','USD_setMtoPrecioUnitario2','return\x20(function()\x20','Inafecto\x20(0%)','map','number','setDescripcion','Unidad\x20de\x20Medida\x203','110637ipWzNS','RESMA','array','LEF','CENTIMETRO\x20CUADRADO','read','Impuesto*','UNIDAD\x20(ZZ)','bind','done','setUnidadEquivalencia2','MEGAWATT\x20HORA','YARDA\x20CUADRADA','push','Exonerado\x20(0%)','Fabricado','DOCENA','TONELADAS','CMT','PLACAS','Gravado\x20(18%)','LATAS','El\x20archivo\x20tiene\x20','PEN_setMtoPrecioUnitario2','Unidad\x20de\x20Medida*','Tipo*','slice','console','QQM','setItemUnitAlias','filter','PIES','setCodProducto','Equivalencia\x202','Modelo\x20de\x20Manga','CARTONES','US\x20GALON\x20(3,7843\x20L)','setItemType','setMarca','xlsx','MMT','KILOGRAMO','constructor','setUnitId3','toLowerCase','sheet_to_json','GRO','Precio\x20Venta\x20Dólares\x202','SheetNames','CENTIMETRO\x20LINEAL','BARRILES','getFullYear','setUnidadCodigo2','Iniciando\x20parseo…','Precio\x20Venta\x20Soles\x202','findIndex','PALETAS','MILIMETRO\x20CUADRADO','MIL','USD_setMtoPrecioCostoUnitario3','QUINTAL','trace','Precio\x20Costo\x20Soles','KGM','METRO','LTR','MILIMETRO\x20CUBICO','buffer','PEN_setMtoPrecioUnitario','trim','JUEGO','GRUESA','DOCENA\x20POR\x2010**6','setUnitId','KILOMETRO','Gravado\x20Gratuito\x20(10%)','Lote','CEN','YDK','USD_setMtoPrecioUnitario','TONELADA\x20LARGA','LITRO','setItemBarCode','TNE','setWarehouseStockMin','¿Rastrear\x20Inventario?','120CSHmrr','length','LTN','setCategoria','NIU','Código\x20SKU*','470dzEFAq','Código\x20de\x20Barras\x203','Exonerado\x20Gratuito\x20(0%)','setItemDescription','Sheets','ID\x20UNIT','PULGADAS','Servicio','warn','964318ATPgQK','TUBOS','info','Precio\x20Venta\x20Dólares','Precio\x20Costo\x20Dólares\x203','Precio\x20Venta\x20Soles','USD_setMtoPrecioCostoUnitario','setBatchExpirationDate','GALON\x20INGLES\x20(4,545956L)','Color','Precio\x20Costo\x20Dólares\x202','exportItems','Stock\x20Mínimo','MILILITRO','HECTOLITRO','KILOVATIO\x20HORA','Modelo','CENTIMETRO\x20CUBICO','GRAMO','PAQUETE','Material','METRO\x20CUADRADO','PEN_setMtoPrecioCostoUnitario2','padStart','Modelo\x20de\x20Cuello','C62','KWH','USD_setMtoPrecioCostoUnitario2','UNIDAD\x20(NIU)','encode_cell','BLL','CIENTO\x20DE\x20UNIDADES','toString','PLIEGO','prototype','Serie','(((.+)+)+)+$','error','some','Unidad\x20de\x20Medida\x202','getDate','!ref','MILLON\x20DE\x20UNIDADES','setUnidadCodigo','getMonth','PAR','TONELADA\x20CORTA','setInventariable','FTQ','UND\x20(NIU)','Equivalencia\x203','1393dzGYjP','progress','find','LIBRAS','YRD','Exportación\x20(0%)','Precio\x20Costo\x20Soles\x202','Combo','Descripción','8936kLKPgc','CONOS','MILIGRAMOS','ID\x20UNIT\x203','2465412bvJyuh','Artículo','USD_setMtoPrecioUnitario3','Stock\x20Actual','setItemUnitAlias3','20768nzPGog','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','PEN_setMtoPrecioUnitario3','Categoría','DZN','PIES\x20CUBICOS','SSF','{}.constructor(\x22return\x20this\x22)(\x20)','exportDone'];_0x30ce=function(){return _0x5123f6;};return _0x30ce();}_0xa060e9();const _0x191e5d=(function(){let _0x1597c0=!![];return function(_0x1c7b98,_0x102802){const _0x5794b7=_0x1597c0?function(){if(_0x102802){const _0x3d795=_0x102802['apply'](_0x1c7b98,arguments);return _0x102802=null,_0x3d795;}}:function(){};return _0x1597c0=![],_0x5794b7;};}()),_0x1cb1cb=_0x191e5d(this,function(){const _0x3a8e7c=_0x50e8;let _0x5309cf;try{const _0x254bb1=Function(_0x3a8e7c(0x87)+_0x3a8e7c(0x13e)+');');_0x5309cf=_0x254bb1();}catch(_0x4fc5d9){_0x5309cf=window;}const _0x5bdc33=_0x5309cf[_0x3a8e7c(0xa8)]=_0x5309cf[_0x3a8e7c(0xa8)]||{},_0x1bf704=['log',_0x3a8e7c(0xf1),_0x3a8e7c(0xf4),_0x3a8e7c(0x117),'exception',_0x3a8e7c(0x160),_0x3a8e7c(0xca)];for(let _0x523af0=0x0;_0x523af0<_0x1bf704[_0x3a8e7c(0xe4)];_0x523af0++){const _0x46a83a=_0x191e5d[_0x3a8e7c(0xb7)][_0x3a8e7c(0x114)][_0x3a8e7c(0x95)](_0x191e5d),_0x1c1508=_0x1bf704[_0x523af0],_0x1f6337=_0x5bdc33[_0x1c1508]||_0x46a83a;_0x46a83a['__proto__']=_0x191e5d['bind'](_0x191e5d),_0x46a83a[_0x3a8e7c(0x112)]=_0x1f6337[_0x3a8e7c(0x112)]['bind'](_0x1f6337),_0x5bdc33[_0x1c1508]=_0x46a83a;}});function _0x50e8(_0x2750b9,_0x3e0cd1){const _0x356cbe=_0x30ce();return _0x50e8=function(_0x1cb1cb,_0x191e5d){_0x1cb1cb=_0x1cb1cb-0x73;let _0x55559b=_0x356cbe[_0x1cb1cb];return _0x55559b;},_0x50e8(_0x2750b9,_0x3e0cd1);}_0x1cb1cb(),importScripts(_0x3f3d51(0x138)),onmessage=({data:_0x20a083})=>{const _0x320c21=_0x3f3d51,{action:_0x1a9249}=_0x20a083;if(_0x1a9249==='import'){const {buf:_0x47f754,maxRows:_0x3addcf}=_0x20a083;try{postMessage({'type':_0x320c21(0x126),'payload':{'percent':0x5,'message':_0x320c21(0xc2)}});const _0xe80ec9=XLSX[_0x320c21(0x92)](_0x47f754,{'type':_0x320c21(0x8f),'cellDates':!![]}),_0x1b6124=_0xe80ec9[_0x320c21(0xed)][_0xe80ec9[_0x320c21(0xbd)][0x0]],_0x3aa70b=XLSX[_0x320c21(0x7e)][_0x320c21(0xba)](_0x1b6124,{'defval':'','range':0x1,'cellDates':!![]}),_0x331cd8=_0x3aa70b[_0x320c21(0xc4)](_0x257709=>(!_0x257709[_0x320c21(0xa6)]||String(_0x257709['Tipo*'])[_0x320c21(0xd2)]()==='')&&(!_0x257709[_0x320c21(0xe8)]||String(_0x257709['Código\x20SKU*'])[_0x320c21(0xd2)]()==='')&&(!_0x257709[_0x320c21(0x161)]||String(_0x257709[_0x320c21(0x161)])[_0x320c21(0xd2)]()==='')&&(!_0x257709[_0x320c21(0xa5)]||String(_0x257709[_0x320c21(0xa5)])[_0x320c21(0xd2)]()==='')),_0x3709e4=_0x331cd8>=0x0?_0x3aa70b['slice'](0x0,_0x331cd8):_0x3aa70b,_0x2e58e9=_0x3709e4[_0x320c21(0xab)](_0x8b64dc=>_0x8b64dc['Tipo*']&&String(_0x8b64dc[_0x320c21(0xa6)])[_0x320c21(0xd2)]()!==''&&_0x8b64dc['Código\x20SKU*']&&String(_0x8b64dc['Código\x20SKU*'])[_0x320c21(0xd2)]()!==''&&_0x8b64dc['Nombre*']&&String(_0x8b64dc[_0x320c21(0x161)])['trim']()!==''&&_0x8b64dc[_0x320c21(0xa5)]&&String(_0x8b64dc[_0x320c21(0xa5)])[_0x320c21(0xd2)]()!==''),_0x4434d4=_0x2e58e9[_0x320c21(0xe4)];if(_0x4434d4===0x0){postMessage({'type':'error','payload':_0x320c21(0x15c)});return;}if(_0x4434d4>_0x3addcf)throw _0x320c21(0xa3)+_0x4434d4+'\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20'+_0x3addcf+'.';const _0x154066=0x1f4,_0x400a12=[],_0x57eb98=[{'codigo':'4A','nombre':_0x320c21(0x74)},{'codigo':'BJ','nombre':'BALDE'},{'codigo':_0x320c21(0x110),'nombre':_0x320c21(0xbf)},{'codigo':'BG','nombre':'BOLSA'},{'codigo':'BO','nombre':'BOTELLAS'},{'codigo':'BX','nombre':_0x320c21(0x14d)},{'codigo':'CT','nombre':_0x320c21(0xb0)},{'codigo':'CMK','nombre':_0x320c21(0x91)},{'codigo':_0x320c21(0x147),'nombre':_0x320c21(0x103)},{'codigo':_0x320c21(0x9f),'nombre':_0x320c21(0xbe)},{'codigo':_0x320c21(0xda),'nombre':_0x320c21(0x111)},{'codigo':'CY','nombre':_0x320c21(0x158)},{'codigo':'CJ','nombre':_0x320c21(0x12f)},{'codigo':_0x320c21(0x13b),'nombre':_0x320c21(0x9d)},{'codigo':_0x320c21(0x15b),'nombre':_0x320c21(0xd5)},{'codigo':'BE','nombre':'FARDO'},{'codigo':'GLI','nombre':_0x320c21(0xfa)},{'codigo':'GRM','nombre':_0x320c21(0x104)},{'codigo':_0x320c21(0xbb),'nombre':_0x320c21(0xd4)},{'codigo':_0x320c21(0x73),'nombre':_0x320c21(0x100)},{'codigo':_0x320c21(0x90),'nombre':_0x320c21(0x7c)},{'codigo':'SET','nombre':_0x320c21(0xd3)},{'codigo':_0x320c21(0xcc),'nombre':'KILOGRAMO'},{'codigo':'KTM','nombre':_0x320c21(0xd7)},{'codigo':_0x320c21(0x10c),'nombre':'KILOVATIO\x20HORA'},{'codigo':'KT','nombre':_0x320c21(0x162)},{'codigo':'CA','nombre':_0x320c21(0xa2)},{'codigo':_0x320c21(0x77),'nombre':'LIBRAS'},{'codigo':_0x320c21(0xce),'nombre':_0x320c21(0xde)},{'codigo':'MWH','nombre':_0x320c21(0x98)},{'codigo':'MTR','nombre':_0x320c21(0xcd)},{'codigo':'MTK','nombre':'METRO\x20CUADRADO'},{'codigo':'MTQ','nombre':_0x320c21(0x75)},{'codigo':'MGM','nombre':_0x320c21(0x130)},{'codigo':_0x320c21(0x15a),'nombre':_0x320c21(0xff)},{'codigo':_0x320c21(0xb5),'nombre':'MILIMETRO'},{'codigo':_0x320c21(0x154),'nombre':_0x320c21(0xc6)},{'codigo':'MMQ','nombre':_0x320c21(0xcf)},{'codigo':_0x320c21(0xc7),'nombre':'MILLARES'},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':'ONZ','nombre':'ONZAS'},{'codigo':'PF','nombre':_0x320c21(0xc5)},{'codigo':'PK','nombre':_0x320c21(0x105)},{'codigo':'PR','nombre':'PAR'},{'codigo':_0x320c21(0x156),'nombre':_0x320c21(0xac)},{'codigo':'FTK','nombre':'PIES\x20CUADRADOS'},{'codigo':_0x320c21(0x122),'nombre':_0x320c21(0x13c)},{'codigo':_0x320c21(0x10b),'nombre':_0x320c21(0x78)},{'codigo':'PG','nombre':_0x320c21(0xa0)},{'codigo':'ST','nombre':_0x320c21(0x113)},{'codigo':'INH','nombre':_0x320c21(0xef)},{'codigo':'RM','nombre':_0x320c21(0x8e)},{'codigo':'SA','nombre':'SACO'},{'codigo':'DR','nombre':_0x320c21(0x15e)},{'codigo':'STN','nombre':_0x320c21(0x120)},{'codigo':_0x320c21(0xe5),'nombre':_0x320c21(0xdd)},{'codigo':_0x320c21(0xe0),'nombre':_0x320c21(0x9e)},{'codigo':'TU','nombre':_0x320c21(0xf3)},{'codigo':_0x320c21(0xe7),'nombre':_0x320c21(0x10e)},{'codigo':'ZZ','nombre':_0x320c21(0x94)},{'codigo':_0x320c21(0x157),'nombre':_0x320c21(0xb1)},{'codigo':_0x320c21(0x129),'nombre':_0x320c21(0x83)},{'codigo':_0x320c21(0xdb),'nombre':_0x320c21(0x99)},{'codigo':_0x320c21(0xa9),'nombre':_0x320c21(0xc9)}],_0x12f2e5=_0x57eb98['reduce']((_0xeddb6b,{nombre:_0x348d1f,codigo:_0x506623})=>{const _0x11e03d=_0x320c21;return _0xeddb6b[_0x348d1f['trim']()]=_0x506623[_0x11e03d(0xd2)](),_0xeddb6b;},{});for(let _0x5196c3=0x0;_0x5196c3<_0x4434d4;_0x5196c3+=_0x154066){const _0x3833d5=_0x2e58e9[_0x320c21(0xa7)](_0x5196c3,_0x5196c3+_0x154066)[_0x320c21(0x89)]((_0x3cb1cc,_0x13917c)=>{const _0xdec14f=_0x320c21;let _0x49e1b0={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x3cb1cc['Tipo*']]||'1';const _0x474c9f=String(_0x3cb1cc[_0xdec14f(0x93)])[_0xdec14f(0xd2)](),_0xabeda7={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x4faf81=_0xabeda7[_0x474c9f]||'1',_0x534a56={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x4faf81]||{'code':'10','value':0x12},_0x1b17a3={};let _0x568c1a=String(_0x3cb1cc[_0xdec14f(0x161)])[_0xdec14f(0xd2)]();const _0x32d06e=[_0xdec14f(0xd9),'Talla',_0xdec14f(0xfb),'Género',_0xdec14f(0x102),_0xdec14f(0x115),_0xdec14f(0x106),_0xdec14f(0x10a),_0xdec14f(0xaf)];_0x32d06e[_0xdec14f(0x151)](_0x3b653a=>{const _0x589349=_0xdec14f,_0x1695e2=String(_0x3cb1cc[_0x3b653a]||'')[_0x589349(0xd2)]();_0x1695e2&&(_0x1b17a3[_0x3b653a]=_0x1695e2,_0x568c1a+='\x20'+_0x3b653a+'\x20'+_0x1695e2);});const _0x2cbf1b=[],_0x4e97df=String(_0x3cb1cc[_0xdec14f(0xa5)]||'UNIDAD\x20(NIU)')[_0xdec14f(0xd2)](),_0x32c11e=_0x12f2e5[_0x4e97df]||_0xdec14f(0xe7),_0x5d28ef=String(_0x3cb1cc['Alias'])[_0xdec14f(0xd2)]();_0x2cbf1b[_0xdec14f(0x9a)]({'setItemUnitId':String(_0x3cb1cc[_0xdec14f(0xee)])[_0xdec14f(0xd2)]()||'','setItemBarCode':String(_0x3cb1cc['Código\x20de\x20Barras'])[_0xdec14f(0xd2)]()||'','setAlias':_0x5d28ef,'setUnitCode':_0x32c11e,'setPrice':parseFloat(_0x3cb1cc[_0xdec14f(0xf7)])||0x0,'setCost':parseFloat(_0x3cb1cc[_0xdec14f(0xcb)])||0x0,'setPriceUSD':parseFloat(_0x3cb1cc[_0xdec14f(0xf5)])||0x0,'setCostUSD':parseFloat(_0x3cb1cc['Precio\x20Costo\x20Dólares'])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x19de79=[_0xdec14f(0x15f),_0xdec14f(0x82),_0xdec14f(0x149),_0xdec14f(0xae),_0xdec14f(0xc3),'Precio\x20Costo\x20Soles\x202','Precio\x20Venta\x20Dólares\x202',_0xdec14f(0xfc)][_0xdec14f(0x118)](_0x21ffe1=>{const _0x5ec419=_0xdec14f,_0x3eda5f=_0x3cb1cc[_0x21ffe1];return _0x3eda5f!=null&&String(_0x3eda5f)[_0x5ec419(0xd2)]()!=='';});if(_0x19de79){const _0x20a564=String(_0x3cb1cc[_0xdec14f(0x119)]||_0xdec14f(0x123))[_0xdec14f(0xd2)](),_0x39baec=_0x12f2e5[_0x20a564]||'NIU',_0x563e30=String(_0x3cb1cc[_0xdec14f(0x82)])[_0xdec14f(0xd2)](),_0x4d1336=parseFloat(_0x3cb1cc[_0xdec14f(0xc3)])||0x0,_0x408aa2=parseFloat(_0x3cb1cc[_0xdec14f(0x12b)])||0x0,_0x52b74a=parseFloat(_0x3cb1cc[_0xdec14f(0xbc)])||0x0,_0x3290af=parseFloat(_0x3cb1cc[_0xdec14f(0xfc)])||0x0,_0x3ae4e9=parseFloat(_0x3cb1cc[_0xdec14f(0xae)])||0x1;_0x2cbf1b[_0xdec14f(0x9a)]({'setItemUnitId':String(_0x3cb1cc[_0xdec14f(0x15f)])[_0xdec14f(0xd2)]()||'','setItemBarCode':String(_0x3cb1cc[_0xdec14f(0x149)])['trim']()||'','setAlias':_0x563e30,'setUnitCode':_0x39baec,'setPrice':_0x4d1336,'setCost':_0x408aa2,'setPriceUSD':_0x52b74a,'setCostUSD':_0x3290af,'setDefault':0x0,'setEquivalence':_0x3ae4e9,'setFactor':_0x3ae4e9});}const _0x31db79=[_0xdec14f(0x131),_0xdec14f(0x7f),_0xdec14f(0xea),_0xdec14f(0x124),'Precio\x20Venta\x20Soles\x203',_0xdec14f(0x7b),'Precio\x20Venta\x20Dólares\x203',_0xdec14f(0xf6)][_0xdec14f(0x118)](_0x559261=>{const _0x1c5e90=_0xdec14f,_0x491567=_0x3cb1cc[_0x559261];return _0x491567!=null&&String(_0x491567)[_0x1c5e90(0xd2)]()!=='';});if(_0x31db79){const _0x1477b0=String(_0x3cb1cc[_0xdec14f(0x8c)]||_0xdec14f(0x123))[_0xdec14f(0xd2)](),_0x323b4f=_0x12f2e5[_0x1477b0]||_0xdec14f(0xe7),_0x2e343c=String(_0x3cb1cc[_0xdec14f(0x7f)])['trim'](),_0x25f717=parseFloat(_0x3cb1cc[_0xdec14f(0x7d)])||0x0,_0x19e383=parseFloat(_0x3cb1cc[_0xdec14f(0x7b)])||0x0,_0x719559=parseFloat(_0x3cb1cc[_0xdec14f(0x145)])||0x0,_0x1e791e=parseFloat(_0x3cb1cc['Precio\x20Costo\x20Dólares\x203'])||0x0,_0x17d73d=parseFloat(_0x3cb1cc[_0xdec14f(0x124)])||0x1;_0x2cbf1b[_0xdec14f(0x9a)]({'setItemUnitId':String(_0x3cb1cc[_0xdec14f(0x131)])[_0xdec14f(0xd2)]()||'','setItemBarCode':String(_0x3cb1cc[_0xdec14f(0xea)])[_0xdec14f(0xd2)]()||'','setAlias':_0x2e343c,'setUnitCode':_0x323b4f,'setPrice':_0x25f717,'setCost':_0x19e383,'setPriceUSD':_0x719559,'setCostUSD':_0x1e791e,'setDefault':0x0,'setEquivalence':_0x17d73d,'setFactor':_0x17d73d});}let _0x1c282f=_0x3cb1cc[_0xdec14f(0x146)],_0x43d9d9='';if(_0x1c282f instanceof Date){const _0x4cfbaa=_0x1c282f[_0xdec14f(0xc0)](),_0x279b66=String(_0x1c282f[_0xdec14f(0x11e)]()+0x1)['padStart'](0x2,'0'),_0x561661=String(_0x1c282f[_0xdec14f(0x11a)]())[_0xdec14f(0x109)](0x2,'0');_0x43d9d9=_0x4cfbaa+'-'+_0x279b66+'-'+_0x561661;}else{if(typeof _0x1c282f===_0xdec14f(0x8a)){const _0x17ce7d=XLSX[_0xdec14f(0x13d)][_0xdec14f(0x15d)](_0x1c282f);if(_0x17ce7d){const _0x2b1019=_0x17ce7d['y'],_0x123724=String(_0x17ce7d['m'])[_0xdec14f(0x109)](0x2,'0'),_0x5600e8=String(_0x17ce7d['d'])[_0xdec14f(0x109)](0x2,'0');_0x43d9d9=_0x2b1019+'-'+_0x123724+'-'+_0x5600e8;}}else _0x43d9d9=String(_0x1c282f||'')['trim']();}return{'setItemId':String(_0x3cb1cc['ID'])[_0xdec14f(0xd2)](),'setItemType':_0x49e1b0,'setItemCode':String(_0x3cb1cc[_0xdec14f(0xe8)])[_0xdec14f(0xd2)](),'setItemName':String(_0x3cb1cc[_0xdec14f(0x161)])[_0xdec14f(0xd2)](),'setItemDescription':String(_0x3cb1cc[_0xdec14f(0x12d)])[_0xdec14f(0xd2)]()||'','setItemCategories':_0x3cb1cc[_0xdec14f(0x13a)]?[String(_0x3cb1cc[_0xdec14f(0x13a)])['trim']()]:[],'setItemBrands':_0x3cb1cc['Marca']?[String(_0x3cb1cc[_0xdec14f(0x76)])[_0xdec14f(0xd2)]()]:[],'setItemTaxId':_0x4faf81,'setItemTaxCode':_0x534a56['code'],'setItemTaxValue':_0x534a56['value'],'setItemUnits':_0x2cbf1b,'setItemInventoriable':_0x3cb1cc[_0xdec14f(0xe2)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x3cb1cc['Stock\x20Actual'])||0x0,'setStockMinimum':parseFloat(_0x3cb1cc[_0xdec14f(0xfe)])||0x0,'setItemLocation':String(_0x3cb1cc['Ubicación'])[_0xdec14f(0xd2)]()||'','setBatchName':String(_0x3cb1cc['Lote'])[_0xdec14f(0xd2)]()||'','setItemDateExpiry':_0x43d9d9,'setItemVariantName':_0x568c1a,'setItemVariantValues':_0x1b17a3,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x400a12['push'](..._0x3833d5),postMessage({'type':_0x320c21(0x126),'payload':{'percent':Math['round']((_0x5196c3+_0x3833d5[_0x320c21(0xe4)])/_0x4434d4*0x64),'message':'Procesadas\x20filas\x20'+(_0x5196c3+0x1)+'–'+(_0x5196c3+_0x3833d5['length'])+'/'+_0x4434d4}});}postMessage({'type':_0x320c21(0x96),'payload':{'items':_0x400a12}});}catch(_0x5c5923){postMessage({'type':_0x320c21(0x117),'payload':_0x5c5923[_0x320c21(0x14a)]||_0x5c5923});}}if(_0x1a9249===_0x320c21(0xfd)){const {products:_0x2ad43b,plantillaBuf:_0x542e46}=_0x20a083;if(!(_0x542e46 instanceof ArrayBuffer)){postMessage({'type':_0x320c21(0x117),'payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array[_0x320c21(0x14e)](_0x2ad43b)){postMessage({'type':_0x320c21(0x117),'payload':_0x320c21(0x14c)});return;}try{structuredClone(_0x2ad43b);}catch(_0x216a28){postMessage({'type':'error','payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x216a28[_0x320c21(0x14a)]});return;}try{const _0xc855b8={'1':_0x320c21(0x133),'2':_0x320c21(0xf0),'3':'Materia\x20Prima','4':_0x320c21(0x12c),'5':_0x320c21(0x9c)};function _0x2e2de9(_0x5c8799){const _0x3231ca=_0x320c21;return _0xc855b8[String(_0x5c8799)]||_0x3231ca(0x133);}const _0xc11f35={'1':_0x320c21(0xa1),'2':_0x320c21(0x9b),'3':_0x320c21(0x88),'4':_0x320c21(0x159),'5':'Inafecto\x20Gratuito\x20(0%)','6':'Gravado\x20(10%)','7':_0x320c21(0xeb),'8':_0x320c21(0x12a),'9':_0x320c21(0xd8)};function _0x1af2ab(_0x1dc197){const _0x1c690e=_0x320c21;return _0xc11f35[String(_0x1dc197)]||_0x1c690e(0xa1);}const _0x51390d={'4A':_0x320c21(0x74),'BJ':_0x320c21(0x142),'BLL':'BARRILES','BG':_0x320c21(0x14b),'BO':_0x320c21(0x144),'BX':_0x320c21(0x14d),'CT':'CARTONES','CMK':_0x320c21(0x91),'CMQ':_0x320c21(0x103),'CMT':_0x320c21(0xbe),'CEN':'CIENTO\x20DE\x20UNIDADES','CY':_0x320c21(0x158),'CJ':'CONOS','DZN':_0x320c21(0x9d),'DZP':_0x320c21(0xd5),'BE':'FARDO','GLI':'GALON\x20INGLES\x20(4,545956L)','GRM':_0x320c21(0x104),'GRO':_0x320c21(0xd4),'HLT':_0x320c21(0x100),'LEF':_0x320c21(0x7c),'SET':'JUEGO','KGM':_0x320c21(0xb6),'KTM':_0x320c21(0xd7),'KWH':_0x320c21(0x101),'KT':'KIT','CA':_0x320c21(0xa2),'LBR':_0x320c21(0x128),'LTR':_0x320c21(0xde),'MWH':_0x320c21(0x98),'MTR':'METRO','MTK':_0x320c21(0x107),'MTQ':'METRO\x20CUBICO','MGM':'MILIGRAMOS','MLT':'MILILITRO','MMT':_0x320c21(0x148),'MMK':_0x320c21(0xc6),'MMQ':'MILIMETRO\x20CUBICO','MIL':'MILLARES','UM':_0x320c21(0x11c),'ONZ':'ONZAS','PF':_0x320c21(0xc5),'PK':_0x320c21(0x105),'PR':_0x320c21(0x11f),'FOT':_0x320c21(0xac),'FTK':_0x320c21(0x79),'FTQ':_0x320c21(0x13c),'C62':_0x320c21(0x78),'PG':_0x320c21(0xa0),'ST':_0x320c21(0x113),'INH':_0x320c21(0xef),'RM':'RESMA','SA':_0x320c21(0x143),'DR':_0x320c21(0x15e),'STN':'TONELADA\x20CORTA','LTN':_0x320c21(0xdd),'TNE':_0x320c21(0x9e),'TU':'TUBOS','NIU':_0x320c21(0x10e),'ZZ':_0x320c21(0x94),'GLL':_0x320c21(0xb1),'YRD':_0x320c21(0x83),'YDK':_0x320c21(0x99),'QQM':_0x320c21(0xc9)};function _0x211446(_0x45620f){return _0x51390d[String(_0x45620f)]||'';}const _0x3fc730=XLSX[_0x320c21(0x92)](_0x542e46,{'type':_0x320c21(0x8f),'cellDates':!![]}),_0x455a4b=_0x3fc730['SheetNames'][0x0],_0x541d71=_0x3fc730[_0x320c21(0xed)][_0x455a4b],_0x6008b9=XLSX[_0x320c21(0x7e)][_0x320c21(0xba)](_0x541d71,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x5d3630=XLSX['utils'][_0x320c21(0x153)](_0x541d71['!ref']||'');for(let _0x4e17b5=0x2;_0x4e17b5<=_0x5d3630['e']['r'];++_0x4e17b5){for(let _0x294b63=_0x5d3630['s']['c'];_0x294b63<=_0x5d3630['e']['c'];++_0x294b63){const _0x45cefd=XLSX[_0x320c21(0x7e)][_0x320c21(0x10f)]({'r':_0x4e17b5,'c':_0x294b63});if(_0x541d71[_0x45cefd])delete _0x541d71[_0x45cefd];}}const _0x4548a3=_0x2ad43b[_0x320c21(0x89)](_0x578201=>{_0x578201['setItemVariantValues']=_0x578201['setItemVariantValues']||{};const _0xeeaa8d={};return _0x6008b9['forEach'](_0x4d1eea=>{const _0x40a901=_0x50e8,_0x1b2bba=String(_0x4d1eea)['trim'](),_0x5cbbb1=_0x1b2bba['toLowerCase'](),_0x6b5568=Object['keys'](_0x578201)[_0x40a901(0x127)](_0x5d2052=>_0x5d2052[_0x40a901(0xd2)]()[_0x40a901(0xb9)]()===_0x5cbbb1);if(_0x6b5568){_0xeeaa8d[_0x1b2bba]=_0x578201[_0x6b5568]??'';return;}switch(_0x1b2bba){case'ID':_0xeeaa8d[_0x1b2bba]=_0x578201['id']??'';break;case _0x40a901(0xa6):_0xeeaa8d[_0x1b2bba]=_0x2e2de9(_0x578201[_0x40a901(0xb2)]);break;case _0x40a901(0xe8):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xad)]??'';break;case _0x40a901(0x161):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x8b)]??'';break;case _0x40a901(0x12d):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xec)]??'';break;case'Categoría':_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xe6)]??'';break;case _0x40a901(0x76):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xb3)]??'';break;case _0x40a901(0x93):_0xeeaa8d[_0x1b2bba]=_0x1af2ab(_0x578201['setTaxId']);break;case _0x40a901(0xee):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xd6)]??'';break;case'Alias':_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xaa)]??'';break;case _0x40a901(0x80):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xdf)]??'';break;case _0x40a901(0xa5):_0xeeaa8d[_0x1b2bba]=_0x211446(_0x578201[_0x40a901(0x11d)]);break;case _0x40a901(0xf7):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xd1)]??'';break;case _0x40a901(0xcb):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x14f)]??'';break;case _0x40a901(0xf5):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xdc)]??'';break;case'Precio\x20Costo\x20Dólares':_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xf8)]??'';break;case _0x40a901(0x15f):_0xeeaa8d[_0x1b2bba]=_0x578201['setUnitId2']??'';break;case'Alias\x202':_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x85)]??'';break;case _0x40a901(0x149):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x152)]??'';break;case _0x40a901(0x119):_0xeeaa8d[_0x1b2bba]=_0x211446(_0x578201[_0x40a901(0xc1)]);break;case _0x40a901(0xae):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x97)]??'1';break;case _0x40a901(0xc3):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xa4)]??'';break;case _0x40a901(0x12b):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x108)]??'';break;case _0x40a901(0xbc):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x86)]??'';break;case _0x40a901(0xfc):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x10d)]??'';break;case _0x40a901(0x131):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xb8)]??'';break;case _0x40a901(0x7f):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x136)]??'';break;case _0x40a901(0xea):_0xeeaa8d[_0x1b2bba]=_0x578201['setItemBarCode3']??'';break;case _0x40a901(0x8c):_0xeeaa8d[_0x1b2bba]=_0x211446(_0x578201['setUnidadCodigo3']);break;case'Equivalencia\x203':_0xeeaa8d[_0x1b2bba]=_0x578201['setUnidadEquivalencia3']??'1';break;case _0x40a901(0x7d):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x139)]??'';break;case _0x40a901(0x7b):_0xeeaa8d[_0x1b2bba]=_0x578201['PEN_setMtoPrecioCostoUnitario3']??'';break;case _0x40a901(0x145):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x134)]??'';break;case'Precio\x20Costo\x20Dólares\x203':_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xc8)]??'';break;case _0x40a901(0xe2):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0x121)]==0x1?'SI':'NO';break;case _0x40a901(0x135):_0xeeaa8d[_0x1b2bba]=_0x578201['setSucursalStock']??'';break;case _0x40a901(0xfe):_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xe1)]??'';break;case'Fecha\x20de\x20Vencimiento':_0xeeaa8d[_0x1b2bba]=_0x578201[_0x40a901(0xf9)]??'';break;default:_0xeeaa8d[_0x1b2bba]='';}}),_0xeeaa8d;}),_0x1b19ab=0x3e8,_0x5420e7=_0x4548a3['length'];for(let _0x4cb03d=0x0;_0x4cb03d<_0x5420e7;_0x4cb03d+=_0x1b19ab){const _0x17ca71=_0x4548a3['slice'](_0x4cb03d,_0x4cb03d+_0x1b19ab);XLSX[_0x320c21(0x7e)]['sheet_add_json'](_0x541d71,_0x17ca71,{'origin':{'r':_0x4cb03d+0x2,'c':0x0},'skipHeader':!![],'header':_0x6008b9}),postMessage({'type':_0x320c21(0x126),'payload':{'percent':Math['round']((_0x4cb03d+_0x17ca71['length'])/_0x5420e7*0x64),'message':'Exportando\x20filas\x20'+(_0x4cb03d+0x1)+'–'+(_0x4cb03d+_0x17ca71[_0x320c21(0xe4)])+_0x320c21(0x81)+_0x5420e7}});}const _0x303fc2={'s':{'r':0x0,'c':0x0},'e':{'r':_0x5420e7+0x1,'c':_0x6008b9[_0x320c21(0xe4)]-0x1}};_0x541d71[_0x320c21(0x11b)]=XLSX[_0x320c21(0x7e)]['encode_range'](_0x303fc2);const _0x5c9715=XLSX[_0x320c21(0x150)](_0x3fc730,{'bookType':_0x320c21(0xb4),'type':_0x320c21(0x8f)});let _0x364616,_0x10c2d6;if(_0x5c9715 instanceof Uint8Array)_0x364616=_0x5c9715,_0x10c2d6=[_0x5c9715[_0x320c21(0xd0)]];else{if(_0x5c9715 instanceof ArrayBuffer)_0x364616=new Uint8Array(_0x5c9715),_0x10c2d6=[_0x5c9715];else{const _0x2ca4b8=new Uint8Array(_0x5c9715);_0x364616=_0x2ca4b8,_0x10c2d6=[_0x2ca4b8[_0x320c21(0xd0)]];}}postMessage({'type':_0x320c21(0x13f),'payload':{'wbout':_0x364616,'count':_0x4548a3['length']}},_0x10c2d6);}catch(_0xbaa281){postMessage({'type':_0x320c21(0x117),'payload':_0xbaa281['message']||String(_0xbaa281)});}return;}};