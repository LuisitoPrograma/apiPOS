/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.4.4
*/

const _0x2df43b=_0xbd16;(function(_0x4daa27,_0x3a1549){const _0x209f40=_0xbd16,_0x54d413=_0x4daa27();while(!![]){try{const _0x1e3ac4=-parseInt(_0x209f40(0x277))/0x1*(-parseInt(_0x209f40(0x1ed))/0x2)+parseInt(_0x209f40(0x1c0))/0x3*(-parseInt(_0x209f40(0x249))/0x4)+-parseInt(_0x209f40(0x22d))/0x5+-parseInt(_0x209f40(0x25d))/0x6+parseInt(_0x209f40(0x218))/0x7+parseInt(_0x209f40(0x1e4))/0x8*(parseInt(_0x209f40(0x230))/0x9)+parseInt(_0x209f40(0x1da))/0xa;if(_0x1e3ac4===_0x3a1549)break;else _0x54d413['push'](_0x54d413['shift']());}catch(_0x37b560){_0x54d413['push'](_0x54d413['shift']());}}}(_0x40bd,0xc2c1e));const _0x20ca2b=(function(){let _0x5007c8=!![];return function(_0x51d1dd,_0x28ddd6){const _0x1e3d7b=_0x5007c8?function(){const _0x22c4e0=_0xbd16;if(_0x28ddd6){const _0x1526bf=_0x28ddd6[_0x22c4e0(0x21c)](_0x51d1dd,arguments);return _0x28ddd6=null,_0x1526bf;}}:function(){};return _0x5007c8=![],_0x1e3d7b;};}()),_0x1ddebd=_0x20ca2b(this,function(){const _0x4283cd=_0xbd16;return _0x1ddebd[_0x4283cd(0x207)]()[_0x4283cd(0x1e0)]('(((.+)+)+)+$')[_0x4283cd(0x207)]()['constructor'](_0x1ddebd)[_0x4283cd(0x1e0)](_0x4283cd(0x1bb));});function _0xbd16(_0x265bef,_0x29819d){const _0x526f82=_0x40bd();return _0xbd16=function(_0x5b3907,_0x1bb3ba){_0x5b3907=_0x5b3907-0x190;let _0x24e675=_0x526f82[_0x5b3907];return _0x24e675;},_0xbd16(_0x265bef,_0x29819d);}function _0x40bd(){const _0x4b9e89=['MIL','SET','3558fqKEcn','Equivalencia\x203','FARDO','BARRILES','Código\x20SKU*','message','SSF','Precio\x20Venta\x20Soles\x203','MMQ','Alias\x202','Color','HOJA','error','KILOGRAMO','BOLSA','NIU','buffer','!ref','setUnidadEquivalencia2','Alias','Modelo','PIES\x20CUBICOS','map','DOCENA\x20POR\x2010**6','utils','CAJA','toString','CEN','FTQ','METRO\x20CUADRADO','Stock\x20Actual','UNIDAD\x20(ZZ)','some','Categoría','PIES\x20CUADRADOS','setItemUnitAlias2','TUBOS','trim','LTR','Precio\x20Venta\x20Dólares\x203','TAMBOR','¿Rastrear\x20Inventario?','CENTIMETRO\x20CUBICO','6022345CdZxRQ','PEN_setMtoPrecioCostoUnitario2','setUnidadEquivalencia3','CENTIMETRO\x20CUADRADO','apply','Precio\x20Costo\x20Dólares\x203','read','QUINTAL','Combo','Precio\x20Costo\x20Dólares\x202','El\x20archivo\x20tiene\x20','KILOMETRO','Iniciando\x20parseo…','exportItems','slice','Tipo*','Materia\x20Prima','setSucursalStock','TNE','constructor','DOCENA','415505MhqtTL','info','PIES','4167pQuqYY','push','Material','encode_cell','GRUESA','PULGADAS','setItemUnitAlias','CMT','UNIDAD\x20(NIU)','MILLARES','encode_range','LATAS','getMonth','setMarca','ID\x20UNIT\x202','CIENTO\x20DE\x20UNIDADES','QQM','decode_range','setCodProducto','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','ID\x20UNIT\x203','padStart','setInventariable','warn','METRO','644884YnuYzq','Marca','progress','MGM','Modelo\x20de\x20Manga','findIndex','setUnidadCodigo','KILOVATIO\x20HORA','Gravado\x20(10%)','{}.constructor(\x22return\x20this\x22)(\x20)','LTN','Unidad\x20de\x20Medida\x203','trace','CILINDRO','YARDA\x20CUADRADA','Unidad\x20de\x20Medida*','MILIMETRO','MEGAWATT\x20HORA','RESMA','Inafecto\x20(0%)','8938188NPkZcr','console','code','MWH','Impuesto*','Ubicación','Precio\x20Costo\x20Soles\x202','Precio\x20Costo\x20Soles\x203','UND\x20(NIU)','GRAMO','TONELADA\x20CORTA','TONELADAS','PALETAS','Código\x20de\x20Barras\x203','Precio\x20Venta\x20Soles','PEN_setMtoPrecioUnitario','Exportando\x20filas\x20','Código\x20de\x20Barras\x202','Lote','Precio\x20Costo\x20Soles','MILIMETRO\x20CUBICO','LIBRAS','setItemBarCode2','CENTIMETRO\x20LINEAL','parse_date_code','round','765rRzoqe','LEF','write','USD_setMtoPrecioUnitario','exportItems:\x20products\x20no\x20es\x20Array.','Precio\x20Venta\x20Dólares\x202','Precio\x20Venta\x20Soles\x202','PIEZAS','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','Nombre*','USD_setMtoPrecioCostoUnitario3','LBR','setItemUnitAlias3','FOT','MILIMETRO\x20CUADRADO','METRO\x20CUBICO','MILIGRAMOS','PLACAS','__proto__','exception','Alias\x203','setCategoria','Gravado\x20(18%)','find','setItemVariantValues','Exportación\x20(0%)','Equivalencia\x202','MLT','US\x20GALON\x20(3,7843\x20L)','forEach','PEN_setMtoPrecioCostoUnitario3','BALDE','keys','length','LITRO','done','sheet_to_json','TONELADA\x20LARGA','PAQUETE','KWH','setUnidadCodigo2','Fecha\x20de\x20Vencimiento','CMK','DZP','toLowerCase','bind','Artículo','setItemBarCode3','PLIEGO','KIT','DZN','Stock\x20Mínimo','(((.+)+)+)+$','ID\x20UNIT','SheetNames','Género','YARDA','27TlLKPc','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','setItemType','setItemBarCode','Precio\x20Costo\x20Dólares','setUnitId3','return\x20(function()\x20','array','GLI','value','setUnitId2','setBatchExpirationDate','import','BOBINAS','filter','GALON\x20INGLES\x20(4,545956L)','HLT','setUnidadCodigo3','reduce','sheet_add_json','Talla','USD_setMtoPrecioCostoUnitario','BOTELLAS','SACO','Unidad\x20de\x20Medida\x202','YDK','6978570XAQpBW','MILILITRO','JUEGO','\x20de\x20','setUnitId','Fabricado','search','CARTONES','PEN_setMtoPrecioUnitario2','MTR','15592YXDiZi','Código\x20de\x20Barras','CONOS','Procesadas\x20filas\x20','Descripción','BLL','getDate'];_0x40bd=function(){return _0x4b9e89;};return _0x40bd();}_0x1ddebd();const _0x1bb3ba=(function(){let _0x45f926=!![];return function(_0x4710e3,_0x5cbd31){const _0x266841=_0x45f926?function(){const _0x59ff13=_0xbd16;if(_0x5cbd31){const _0x440508=_0x5cbd31[_0x59ff13(0x21c)](_0x4710e3,arguments);return _0x5cbd31=null,_0x440508;}}:function(){};return _0x45f926=![],_0x266841;};}()),_0x5b3907=_0x1bb3ba(this,function(){const _0x49a250=_0xbd16;let _0x13dbdf;try{const _0x2dfd6b=Function(_0x49a250(0x1c6)+_0x49a250(0x252)+');');_0x13dbdf=_0x2dfd6b();}catch(_0x250f29){_0x13dbdf=window;}const _0x54a151=_0x13dbdf[_0x49a250(0x25e)]=_0x13dbdf[_0x49a250(0x25e)]||{},_0x581043=['log',_0x49a250(0x247),_0x49a250(0x22e),'error',_0x49a250(0x19a),'table',_0x49a250(0x255)];for(let _0x19a289=0x0;_0x19a289<_0x581043[_0x49a250(0x1a8)];_0x19a289++){const _0x1fc1e3=_0x1bb3ba[_0x49a250(0x22b)]['prototype']['bind'](_0x1bb3ba),_0x1efcec=_0x581043[_0x19a289],_0x13b8fc=_0x54a151[_0x1efcec]||_0x1fc1e3;_0x1fc1e3[_0x49a250(0x199)]=_0x1bb3ba[_0x49a250(0x1b4)](_0x1bb3ba),_0x1fc1e3[_0x49a250(0x207)]=_0x13b8fc['toString']['bind'](_0x13b8fc),_0x54a151[_0x1efcec]=_0x1fc1e3;}});_0x5b3907(),importScripts(_0x2df43b(0x1c1)),onmessage=({data:_0xbb35da})=>{const _0x5e2036=_0x2df43b,{action:_0x773919}=_0xbb35da;if(_0x773919===_0x5e2036(0x1cc)){const {buf:_0x25d67a,maxRows:_0x34a83e}=_0xbb35da;try{postMessage({'type':_0x5e2036(0x24b),'payload':{'percent':0x5,'message':_0x5e2036(0x224)}});const _0x11a335=XLSX[_0x5e2036(0x21e)](_0x25d67a,{'type':_0x5e2036(0x1c7),'cellDates':!![]}),_0x27a15f=_0x11a335['Sheets'][_0x11a335[_0x5e2036(0x1bd)][0x0]],_0x3d87de=XLSX[_0x5e2036(0x205)][_0x5e2036(0x1ab)](_0x27a15f,{'defval':'','range':0x1,'cellDates':!![]}),_0x4e4433=_0x3d87de[_0x5e2036(0x24e)](_0x480b2c=>(!_0x480b2c['Tipo*']||String(_0x480b2c[_0x5e2036(0x227)])[_0x5e2036(0x212)]()==='')&&(!_0x480b2c[_0x5e2036(0x1f1)]||String(_0x480b2c[_0x5e2036(0x1f1)])[_0x5e2036(0x212)]()==='')&&(!_0x480b2c[_0x5e2036(0x190)]||String(_0x480b2c[_0x5e2036(0x190)])[_0x5e2036(0x212)]()==='')&&(!_0x480b2c[_0x5e2036(0x258)]||String(_0x480b2c['Unidad\x20de\x20Medida*'])['trim']()==='')),_0x1f156e=_0x4e4433>=0x0?_0x3d87de[_0x5e2036(0x226)](0x0,_0x4e4433):_0x3d87de,_0x1c6d51=_0x1f156e[_0x5e2036(0x1ce)](_0x41dcd7=>_0x41dcd7[_0x5e2036(0x227)]&&String(_0x41dcd7[_0x5e2036(0x227)])[_0x5e2036(0x212)]()!==''&&_0x41dcd7['Código\x20SKU*']&&String(_0x41dcd7[_0x5e2036(0x1f1)])[_0x5e2036(0x212)]()!==''&&_0x41dcd7[_0x5e2036(0x190)]&&String(_0x41dcd7[_0x5e2036(0x190)])[_0x5e2036(0x212)]()!==''&&_0x41dcd7[_0x5e2036(0x258)]&&String(_0x41dcd7[_0x5e2036(0x258)])[_0x5e2036(0x212)]()!==''),_0x5b6c97=_0x1c6d51[_0x5e2036(0x1a8)];if(_0x5b6c97===0x0){postMessage({'type':_0x5e2036(0x1f9),'payload':_0x5e2036(0x27f)});return;}if(_0x5b6c97>_0x34a83e)throw _0x5e2036(0x222)+_0x5b6c97+'\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20'+_0x34a83e+'.';const _0x94d256=0x1f4,_0x2233f4=[],_0x1de093=[{'codigo':'4A','nombre':_0x5e2036(0x1cd)},{'codigo':'BJ','nombre':_0x5e2036(0x1a6)},{'codigo':_0x5e2036(0x1e9),'nombre':_0x5e2036(0x1f0)},{'codigo':'BG','nombre':_0x5e2036(0x1fb)},{'codigo':'BO','nombre':_0x5e2036(0x1d6)},{'codigo':'BX','nombre':_0x5e2036(0x206)},{'codigo':'CT','nombre':_0x5e2036(0x1e1)},{'codigo':_0x5e2036(0x1b1),'nombre':_0x5e2036(0x21b)},{'codigo':'CMQ','nombre':_0x5e2036(0x217)},{'codigo':_0x5e2036(0x237),'nombre':_0x5e2036(0x274)},{'codigo':_0x5e2036(0x208),'nombre':'CIENTO\x20DE\x20UNIDADES'},{'codigo':'CY','nombre':_0x5e2036(0x256)},{'codigo':'CJ','nombre':_0x5e2036(0x1e6)},{'codigo':_0x5e2036(0x1b9),'nombre':_0x5e2036(0x22c)},{'codigo':_0x5e2036(0x1b2),'nombre':'DOCENA\x20POR\x2010**6'},{'codigo':'BE','nombre':_0x5e2036(0x1ef)},{'codigo':_0x5e2036(0x1c8),'nombre':_0x5e2036(0x1cf)},{'codigo':'GRM','nombre':_0x5e2036(0x266)},{'codigo':'GRO','nombre':_0x5e2036(0x234)},{'codigo':_0x5e2036(0x1d0),'nombre':'HECTOLITRO'},{'codigo':_0x5e2036(0x278),'nombre':_0x5e2036(0x1f8)},{'codigo':_0x5e2036(0x1ec),'nombre':_0x5e2036(0x1dc)},{'codigo':'KGM','nombre':_0x5e2036(0x1fa)},{'codigo':'KTM','nombre':'KILOMETRO'},{'codigo':_0x5e2036(0x1ae),'nombre':_0x5e2036(0x250)},{'codigo':'KT','nombre':_0x5e2036(0x1b8)},{'codigo':'CA','nombre':_0x5e2036(0x23b)},{'codigo':_0x5e2036(0x192),'nombre':_0x5e2036(0x272)},{'codigo':_0x5e2036(0x213),'nombre':'LITRO'},{'codigo':_0x5e2036(0x260),'nombre':_0x5e2036(0x25a)},{'codigo':_0x5e2036(0x1e3),'nombre':_0x5e2036(0x248)},{'codigo':'MTK','nombre':_0x5e2036(0x20a)},{'codigo':'MTQ','nombre':_0x5e2036(0x196)},{'codigo':_0x5e2036(0x24c),'nombre':_0x5e2036(0x197)},{'codigo':_0x5e2036(0x1a2),'nombre':_0x5e2036(0x1db)},{'codigo':'MMT','nombre':_0x5e2036(0x259)},{'codigo':'MMK','nombre':'MILIMETRO\x20CUADRADO'},{'codigo':_0x5e2036(0x1f5),'nombre':'MILIMETRO\x20CUBICO'},{'codigo':_0x5e2036(0x1eb),'nombre':'MILLARES'},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':'ONZ','nombre':'ONZAS'},{'codigo':'PF','nombre':'PALETAS'},{'codigo':'PK','nombre':_0x5e2036(0x1ad)},{'codigo':'PR','nombre':'PAR'},{'codigo':_0x5e2036(0x194),'nombre':'PIES'},{'codigo':'FTK','nombre':'PIES\x20CUADRADOS'},{'codigo':_0x5e2036(0x209),'nombre':_0x5e2036(0x202)},{'codigo':'C62','nombre':_0x5e2036(0x27e)},{'codigo':'PG','nombre':_0x5e2036(0x198)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':'INH','nombre':_0x5e2036(0x235)},{'codigo':'RM','nombre':_0x5e2036(0x25b)},{'codigo':'SA','nombre':_0x5e2036(0x1d7)},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':'STN','nombre':_0x5e2036(0x267)},{'codigo':_0x5e2036(0x253),'nombre':_0x5e2036(0x1ac)},{'codigo':_0x5e2036(0x22a),'nombre':'TONELADAS'},{'codigo':'TU','nombre':_0x5e2036(0x211)},{'codigo':_0x5e2036(0x1fc),'nombre':_0x5e2036(0x238)},{'codigo':'ZZ','nombre':_0x5e2036(0x20c)},{'codigo':'GLL','nombre':_0x5e2036(0x1a3)},{'codigo':'YRD','nombre':_0x5e2036(0x1bf)},{'codigo':_0x5e2036(0x1d9),'nombre':'YARDA\x20CUADRADA'},{'codigo':_0x5e2036(0x240),'nombre':_0x5e2036(0x21f)}],_0xf02a21=_0x1de093[_0x5e2036(0x1d2)]((_0x1826a5,{nombre:_0x2a8c43,codigo:_0xd9fc1e})=>{const _0x327efc=_0x5e2036;return _0x1826a5[_0x2a8c43[_0x327efc(0x212)]()]=_0xd9fc1e[_0x327efc(0x212)](),_0x1826a5;},{});for(let _0x28e314=0x0;_0x28e314<_0x5b6c97;_0x28e314+=_0x94d256){const _0x56e550=_0x1c6d51[_0x5e2036(0x226)](_0x28e314,_0x28e314+_0x94d256)[_0x5e2036(0x203)]((_0x4afccc,_0xc0de97)=>{const _0x4bfa3d=_0x5e2036;let _0x40e034={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x4afccc[_0x4bfa3d(0x227)]]||'1';const _0x17a31f=String(_0x4afccc[_0x4bfa3d(0x261)])[_0x4bfa3d(0x212)](),_0x390ea4={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x17233d=_0x390ea4[_0x17a31f]||'1',_0x13e7bd={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x17233d]||{'code':'10','value':0x12},_0x1be50c={};let _0xd78795=String(_0x4afccc[_0x4bfa3d(0x190)])[_0x4bfa3d(0x212)]();const _0xcee838=[_0x4bfa3d(0x26f),_0x4bfa3d(0x1d4),_0x4bfa3d(0x1f7),_0x4bfa3d(0x1be),_0x4bfa3d(0x201),'Serie',_0x4bfa3d(0x232),'Modelo\x20de\x20Cuello',_0x4bfa3d(0x24d)];_0xcee838[_0x4bfa3d(0x1a4)](_0xe900c0=>{const _0x228231=_0x4bfa3d,_0x59b239=String(_0x4afccc[_0xe900c0]||'')[_0x228231(0x212)]();_0x59b239&&(_0x1be50c[_0xe900c0]=_0x59b239,_0xd78795+='\x20'+_0xe900c0+'\x20'+_0x59b239);});const _0x3242d4=[],_0x465270=String(_0x4afccc[_0x4bfa3d(0x258)]||_0x4bfa3d(0x238))[_0x4bfa3d(0x212)](),_0x598f22=_0xf02a21[_0x465270]||_0x4bfa3d(0x1fc),_0x4ff417=String(_0x4afccc[_0x4bfa3d(0x200)])[_0x4bfa3d(0x212)]();_0x3242d4[_0x4bfa3d(0x231)]({'setItemUnitId':String(_0x4afccc[_0x4bfa3d(0x1bc)])[_0x4bfa3d(0x212)]()||'','setItemBarCode':String(_0x4afccc[_0x4bfa3d(0x1e5)])[_0x4bfa3d(0x212)]()||'','setAlias':_0x4ff417,'setUnitCode':_0x598f22,'setPrice':parseFloat(_0x4afccc[_0x4bfa3d(0x26b)])||0x0,'setCost':parseFloat(_0x4afccc['Precio\x20Costo\x20Soles'])||0x0,'setPriceUSD':parseFloat(_0x4afccc['Precio\x20Venta\x20Dólares'])||0x0,'setCostUSD':parseFloat(_0x4afccc[_0x4bfa3d(0x1c4)])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x306ffe=['ID\x20UNIT\x202','Alias\x202',_0x4bfa3d(0x26e),_0x4bfa3d(0x1a1),'Precio\x20Venta\x20Soles\x202',_0x4bfa3d(0x263),_0x4bfa3d(0x27c),_0x4bfa3d(0x221)][_0x4bfa3d(0x20d)](_0x4d8ad4=>{const _0xebecf=_0x4bfa3d,_0x400bad=_0x4afccc[_0x4d8ad4];return _0x400bad!=null&&String(_0x400bad)[_0xebecf(0x212)]()!=='';});if(_0x306ffe){const _0x379519=String(_0x4afccc[_0x4bfa3d(0x1d8)]||'UND\x20(NIU)')[_0x4bfa3d(0x212)](),_0x3a5521=_0xf02a21[_0x379519]||'NIU',_0x204974=String(_0x4afccc[_0x4bfa3d(0x1f6)])[_0x4bfa3d(0x212)](),_0x8ea95=parseFloat(_0x4afccc[_0x4bfa3d(0x27d)])||0x0,_0x3e9eb5=parseFloat(_0x4afccc[_0x4bfa3d(0x263)])||0x0,_0x3ef1c3=parseFloat(_0x4afccc['Precio\x20Venta\x20Dólares\x202'])||0x0,_0x47e0bf=parseFloat(_0x4afccc[_0x4bfa3d(0x221)])||0x0,_0x3f651c=parseFloat(_0x4afccc[_0x4bfa3d(0x1a1)])||0x1;_0x3242d4[_0x4bfa3d(0x231)]({'setItemUnitId':String(_0x4afccc[_0x4bfa3d(0x23e)])['trim']()||'','setItemBarCode':String(_0x4afccc[_0x4bfa3d(0x26e)])['trim']()||'','setAlias':_0x204974,'setUnitCode':_0x3a5521,'setPrice':_0x8ea95,'setCost':_0x3e9eb5,'setPriceUSD':_0x3ef1c3,'setCostUSD':_0x47e0bf,'setDefault':0x0,'setEquivalence':_0x3f651c,'setFactor':_0x3f651c});}const _0x4c9e63=[_0x4bfa3d(0x244),_0x4bfa3d(0x19b),_0x4bfa3d(0x26a),_0x4bfa3d(0x1ee),_0x4bfa3d(0x1f4),_0x4bfa3d(0x264),_0x4bfa3d(0x214),_0x4bfa3d(0x21d)]['some'](_0x3788d3=>{const _0x18d67d=_0x4afccc[_0x3788d3];return _0x18d67d!=null&&String(_0x18d67d)['trim']()!=='';});if(_0x4c9e63){const _0x202f81=String(_0x4afccc['Unidad\x20de\x20Medida\x203']||_0x4bfa3d(0x265))[_0x4bfa3d(0x212)](),_0x2434c0=_0xf02a21[_0x202f81]||_0x4bfa3d(0x1fc),_0x366a2a=String(_0x4afccc[_0x4bfa3d(0x19b)])['trim'](),_0x217c73=parseFloat(_0x4afccc['Precio\x20Venta\x20Soles\x203'])||0x0,_0x2fc499=parseFloat(_0x4afccc[_0x4bfa3d(0x264)])||0x0,_0x760572=parseFloat(_0x4afccc[_0x4bfa3d(0x214)])||0x0,_0x3be304=parseFloat(_0x4afccc[_0x4bfa3d(0x21d)])||0x0,_0x2b4846=parseFloat(_0x4afccc['Equivalencia\x203'])||0x1;_0x3242d4[_0x4bfa3d(0x231)]({'setItemUnitId':String(_0x4afccc[_0x4bfa3d(0x244)])['trim']()||'','setItemBarCode':String(_0x4afccc['Código\x20de\x20Barras\x203'])[_0x4bfa3d(0x212)]()||'','setAlias':_0x366a2a,'setUnitCode':_0x2434c0,'setPrice':_0x217c73,'setCost':_0x2fc499,'setPriceUSD':_0x760572,'setCostUSD':_0x3be304,'setDefault':0x0,'setEquivalence':_0x2b4846,'setFactor':_0x2b4846});}let _0x28bd56=_0x4afccc[_0x4bfa3d(0x1b0)],_0xf5b707='';if(_0x28bd56 instanceof Date){const _0x4273d8=_0x28bd56['getFullYear'](),_0x1df1b5=String(_0x28bd56[_0x4bfa3d(0x23c)]()+0x1)['padStart'](0x2,'0'),_0x3a52cb=String(_0x28bd56[_0x4bfa3d(0x1ea)]())[_0x4bfa3d(0x245)](0x2,'0');_0xf5b707=_0x4273d8+'-'+_0x1df1b5+'-'+_0x3a52cb;}else{if(typeof _0x28bd56==='number'){const _0x2242da=XLSX[_0x4bfa3d(0x1f3)][_0x4bfa3d(0x275)](_0x28bd56);if(_0x2242da){const _0x2b7d2e=_0x2242da['y'],_0x19a914=String(_0x2242da['m'])[_0x4bfa3d(0x245)](0x2,'0'),_0x246aab=String(_0x2242da['d'])[_0x4bfa3d(0x245)](0x2,'0');_0xf5b707=_0x2b7d2e+'-'+_0x19a914+'-'+_0x246aab;}}else _0xf5b707=String(_0x28bd56||'')[_0x4bfa3d(0x212)]();}return{'setItemId':String(_0x4afccc['ID'])['trim'](),'setItemType':_0x40e034,'setItemCode':String(_0x4afccc['Código\x20SKU*'])['trim'](),'setItemName':String(_0x4afccc[_0x4bfa3d(0x190)])['trim'](),'setItemDescription':String(_0x4afccc[_0x4bfa3d(0x1e8)])['trim']()||'','setItemCategories':_0x4afccc['Categoría']?[String(_0x4afccc[_0x4bfa3d(0x20e)])[_0x4bfa3d(0x212)]()]:[],'setItemBrands':_0x4afccc[_0x4bfa3d(0x24a)]?[String(_0x4afccc[_0x4bfa3d(0x24a)])[_0x4bfa3d(0x212)]()]:[],'setItemTaxId':_0x17233d,'setItemTaxCode':_0x13e7bd[_0x4bfa3d(0x25f)],'setItemTaxValue':_0x13e7bd[_0x4bfa3d(0x1c9)],'setItemUnits':_0x3242d4,'setItemInventoriable':_0x4afccc[_0x4bfa3d(0x216)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x4afccc[_0x4bfa3d(0x20b)])||0x0,'setStockMinimum':parseFloat(_0x4afccc[_0x4bfa3d(0x1ba)])||0x0,'setItemLocation':String(_0x4afccc[_0x4bfa3d(0x262)])[_0x4bfa3d(0x212)]()||'','setBatchName':String(_0x4afccc[_0x4bfa3d(0x26f)])[_0x4bfa3d(0x212)]()||'','setItemDateExpiry':_0xf5b707,'setItemVariantName':_0xd78795,'setItemVariantValues':_0x1be50c,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x2233f4[_0x5e2036(0x231)](..._0x56e550),postMessage({'type':_0x5e2036(0x24b),'payload':{'percent':Math[_0x5e2036(0x276)]((_0x28e314+_0x56e550['length'])/_0x5b6c97*0x64),'message':_0x5e2036(0x1e7)+(_0x28e314+0x1)+'–'+(_0x28e314+_0x56e550[_0x5e2036(0x1a8)])+'/'+_0x5b6c97}});}postMessage({'type':_0x5e2036(0x1aa),'payload':{'items':_0x2233f4}});}catch(_0x1b36f6){postMessage({'type':_0x5e2036(0x1f9),'payload':_0x1b36f6[_0x5e2036(0x1f2)]||_0x1b36f6});}}if(_0x773919===_0x5e2036(0x225)){const {products:_0x12bac9,plantillaBuf:_0x195a2c}=_0xbb35da;if(!(_0x195a2c instanceof ArrayBuffer)){postMessage({'type':'error','payload':_0x5e2036(0x243)});return;}if(!Array['isArray'](_0x12bac9)){postMessage({'type':'error','payload':_0x5e2036(0x27b)});return;}try{structuredClone(_0x12bac9);}catch(_0x3ad28d){postMessage({'type':'error','payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x3ad28d['message']});return;}try{const _0x27acbc={'1':_0x5e2036(0x1b5),'2':'Servicio','3':_0x5e2036(0x228),'4':_0x5e2036(0x220),'5':_0x5e2036(0x1df)};function _0x485096(_0x37280e){const _0x8effa=_0x5e2036;return _0x27acbc[String(_0x37280e)]||_0x8effa(0x1b5);}const _0xab343c={'1':_0x5e2036(0x19d),'2':'Exonerado\x20(0%)','3':_0x5e2036(0x25c),'4':'Gravado\x20Gratuito\x20(18%)','5':'Inafecto\x20Gratuito\x20(0%)','6':_0x5e2036(0x251),'7':'Exonerado\x20Gratuito\x20(0%)','8':_0x5e2036(0x1a0),'9':'Gravado\x20Gratuito\x20(10%)'};function _0x328bf6(_0x2d738e){const _0x402eed=_0x5e2036;return _0xab343c[String(_0x2d738e)]||_0x402eed(0x19d);}const _0x27f881={'4A':_0x5e2036(0x1cd),'BJ':_0x5e2036(0x1a6),'BLL':'BARRILES','BG':'BOLSA','BO':'BOTELLAS','BX':_0x5e2036(0x206),'CT':'CARTONES','CMK':_0x5e2036(0x21b),'CMQ':_0x5e2036(0x217),'CMT':_0x5e2036(0x274),'CEN':_0x5e2036(0x23f),'CY':_0x5e2036(0x256),'CJ':_0x5e2036(0x1e6),'DZN':_0x5e2036(0x22c),'DZP':_0x5e2036(0x204),'BE':'FARDO','GLI':_0x5e2036(0x1cf),'GRM':_0x5e2036(0x266),'GRO':'GRUESA','HLT':'HECTOLITRO','LEF':_0x5e2036(0x1f8),'SET':_0x5e2036(0x1dc),'KGM':'KILOGRAMO','KTM':_0x5e2036(0x223),'KWH':_0x5e2036(0x250),'KT':_0x5e2036(0x1b8),'CA':_0x5e2036(0x23b),'LBR':_0x5e2036(0x272),'LTR':_0x5e2036(0x1a9),'MWH':'MEGAWATT\x20HORA','MTR':_0x5e2036(0x248),'MTK':_0x5e2036(0x20a),'MTQ':_0x5e2036(0x196),'MGM':'MILIGRAMOS','MLT':_0x5e2036(0x1db),'MMT':_0x5e2036(0x259),'MMK':_0x5e2036(0x195),'MMQ':_0x5e2036(0x271),'MIL':_0x5e2036(0x239),'UM':'MILLON\x20DE\x20UNIDADES','ONZ':'ONZAS','PF':_0x5e2036(0x269),'PK':_0x5e2036(0x1ad),'PR':'PAR','FOT':_0x5e2036(0x22f),'FTK':_0x5e2036(0x20f),'FTQ':'PIES\x20CUBICOS','C62':_0x5e2036(0x27e),'PG':'PLACAS','ST':_0x5e2036(0x1b7),'INH':'PULGADAS','RM':_0x5e2036(0x25b),'SA':'SACO','DR':_0x5e2036(0x215),'STN':_0x5e2036(0x267),'LTN':_0x5e2036(0x1ac),'TNE':_0x5e2036(0x268),'TU':_0x5e2036(0x211),'NIU':_0x5e2036(0x238),'ZZ':_0x5e2036(0x20c),'GLL':_0x5e2036(0x1a3),'YRD':'YARDA','YDK':_0x5e2036(0x257),'QQM':_0x5e2036(0x21f)};function _0x5caaf8(_0x32a27f){return _0x27f881[String(_0x32a27f)]||'';}const _0x1a5350=XLSX[_0x5e2036(0x21e)](_0x195a2c,{'type':_0x5e2036(0x1c7),'cellDates':!![]}),_0x2c4836=_0x1a5350['SheetNames'][0x0],_0x267b63=_0x1a5350['Sheets'][_0x2c4836],_0x5a2523=XLSX['utils'][_0x5e2036(0x1ab)](_0x267b63,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x51f219=XLSX[_0x5e2036(0x205)][_0x5e2036(0x241)](_0x267b63[_0x5e2036(0x1fe)]||'');for(let _0x35da05=0x2;_0x35da05<=_0x51f219['e']['r'];++_0x35da05){for(let _0x50d10a=_0x51f219['s']['c'];_0x50d10a<=_0x51f219['e']['c'];++_0x50d10a){const _0x1faffd=XLSX['utils'][_0x5e2036(0x233)]({'r':_0x35da05,'c':_0x50d10a});if(_0x267b63[_0x1faffd])delete _0x267b63[_0x1faffd];}}const _0x1abfdd=_0x12bac9[_0x5e2036(0x203)](_0x1d4773=>{const _0x5ac410=_0x5e2036;_0x1d4773[_0x5ac410(0x19f)]=_0x1d4773[_0x5ac410(0x19f)]||{};const _0x16fc5a={};return _0x5a2523[_0x5ac410(0x1a4)](_0x1c8436=>{const _0x21bbbd=_0x5ac410,_0x19038e=String(_0x1c8436)['trim'](),_0xb89ebe=_0x19038e['toLowerCase'](),_0x501690=Object[_0x21bbbd(0x1a7)](_0x1d4773)[_0x21bbbd(0x19e)](_0x3f8c12=>_0x3f8c12['trim']()[_0x21bbbd(0x1b3)]()===_0xb89ebe);if(_0x501690){_0x16fc5a[_0x19038e]=_0x1d4773[_0x501690]??'';return;}switch(_0x19038e){case'ID':_0x16fc5a[_0x19038e]=_0x1d4773['id']??'';break;case _0x21bbbd(0x227):_0x16fc5a[_0x19038e]=_0x485096(_0x1d4773[_0x21bbbd(0x1c2)]);break;case _0x21bbbd(0x1f1):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x242)]??'';break;case _0x21bbbd(0x190):_0x16fc5a[_0x19038e]=_0x1d4773['setDescripcion']??'';break;case'Descripción':_0x16fc5a[_0x19038e]=_0x1d4773['setItemDescription']??'';break;case'Categoría':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x19c)]??'';break;case _0x21bbbd(0x24a):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x23d)]??'';break;case _0x21bbbd(0x261):_0x16fc5a[_0x19038e]=_0x328bf6(_0x1d4773['setTaxId']);break;case'ID\x20UNIT':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1de)]??'';break;case'Alias':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x236)]??'';break;case _0x21bbbd(0x1e5):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1c3)]??'';break;case'Unidad\x20de\x20Medida*':_0x16fc5a[_0x19038e]=_0x5caaf8(_0x1d4773[_0x21bbbd(0x24f)]);break;case'Precio\x20Venta\x20Soles':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x26c)]??'';break;case _0x21bbbd(0x270):_0x16fc5a[_0x19038e]=_0x1d4773['PEN_setMtoPrecioCostoUnitario']??'';break;case'Precio\x20Venta\x20Dólares':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x27a)]??'';break;case _0x21bbbd(0x1c4):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1d5)]??'';break;case _0x21bbbd(0x23e):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1ca)]??'';break;case _0x21bbbd(0x1f6):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x210)]??'';break;case _0x21bbbd(0x26e):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x273)]??'';break;case _0x21bbbd(0x1d8):_0x16fc5a[_0x19038e]=_0x5caaf8(_0x1d4773[_0x21bbbd(0x1af)]);break;case _0x21bbbd(0x1a1):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1ff)]??'1';break;case _0x21bbbd(0x27d):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1e2)]??'';break;case'Precio\x20Costo\x20Soles\x202':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x219)]??'';break;case _0x21bbbd(0x27c):_0x16fc5a[_0x19038e]=_0x1d4773['USD_setMtoPrecioUnitario2']??'';break;case _0x21bbbd(0x221):_0x16fc5a[_0x19038e]=_0x1d4773['USD_setMtoPrecioCostoUnitario2']??'';break;case _0x21bbbd(0x244):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1c5)]??'';break;case _0x21bbbd(0x19b):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x193)]??'';break;case'Código\x20de\x20Barras\x203':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1b6)]??'';break;case _0x21bbbd(0x254):_0x16fc5a[_0x19038e]=_0x5caaf8(_0x1d4773[_0x21bbbd(0x1d1)]);break;case _0x21bbbd(0x1ee):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x21a)]??'1';break;case _0x21bbbd(0x1f4):_0x16fc5a[_0x19038e]=_0x1d4773['PEN_setMtoPrecioUnitario3']??'';break;case'Precio\x20Costo\x20Soles\x203':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1a5)]??'';break;case'Precio\x20Venta\x20Dólares\x203':_0x16fc5a[_0x19038e]=_0x1d4773['USD_setMtoPrecioUnitario3']??'';break;case _0x21bbbd(0x21d):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x191)]??'';break;case _0x21bbbd(0x216):_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x246)]==0x1?'SI':'NO';break;case'Stock\x20Actual':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x229)]??'';break;case _0x21bbbd(0x1ba):_0x16fc5a[_0x19038e]=_0x1d4773['setWarehouseStockMin']??'';break;case'Fecha\x20de\x20Vencimiento':_0x16fc5a[_0x19038e]=_0x1d4773[_0x21bbbd(0x1cb)]??'';break;default:_0x16fc5a[_0x19038e]='';}}),_0x16fc5a;}),_0x533aab=0x3e8,_0x4a5804=_0x1abfdd[_0x5e2036(0x1a8)];for(let _0x5e566a=0x0;_0x5e566a<_0x4a5804;_0x5e566a+=_0x533aab){const _0x429980=_0x1abfdd[_0x5e2036(0x226)](_0x5e566a,_0x5e566a+_0x533aab);XLSX[_0x5e2036(0x205)][_0x5e2036(0x1d3)](_0x267b63,_0x429980,{'origin':{'r':_0x5e566a+0x2,'c':0x0},'skipHeader':!![],'header':_0x5a2523}),postMessage({'type':_0x5e2036(0x24b),'payload':{'percent':Math[_0x5e2036(0x276)]((_0x5e566a+_0x429980[_0x5e2036(0x1a8)])/_0x4a5804*0x64),'message':_0x5e2036(0x26d)+(_0x5e566a+0x1)+'–'+(_0x5e566a+_0x429980[_0x5e2036(0x1a8)])+_0x5e2036(0x1dd)+_0x4a5804}});}const _0x4d2a78={'s':{'r':0x0,'c':0x0},'e':{'r':_0x4a5804+0x1,'c':_0x5a2523['length']-0x1}};_0x267b63[_0x5e2036(0x1fe)]=XLSX[_0x5e2036(0x205)][_0x5e2036(0x23a)](_0x4d2a78);const _0x3a75e3=XLSX[_0x5e2036(0x279)](_0x1a5350,{'bookType':'xlsx','type':_0x5e2036(0x1c7)});let _0x3c489d,_0x372cf0;if(_0x3a75e3 instanceof Uint8Array)_0x3c489d=_0x3a75e3,_0x372cf0=[_0x3a75e3[_0x5e2036(0x1fd)]];else{if(_0x3a75e3 instanceof ArrayBuffer)_0x3c489d=new Uint8Array(_0x3a75e3),_0x372cf0=[_0x3a75e3];else{const _0x34b56a=new Uint8Array(_0x3a75e3);_0x3c489d=_0x34b56a,_0x372cf0=[_0x34b56a[_0x5e2036(0x1fd)]];}}postMessage({'type':'exportDone','payload':{'wbout':_0x3c489d,'count':_0x1abfdd[_0x5e2036(0x1a8)]}},_0x372cf0);}catch(_0x126870){postMessage({'type':_0x5e2036(0x1f9),'payload':_0x126870[_0x5e2036(0x1f2)]||String(_0x126870)});}return;}};