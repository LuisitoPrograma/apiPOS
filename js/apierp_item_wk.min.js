/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.1.5
*/

const _0x4556ba=_0x188a;function _0x188a(_0x39e499,_0x42db05){const _0x4ee87b=_0x189f();return _0x188a=function(_0x390310,_0x4914c6){_0x390310=_0x390310-0x176;let _0x58dfc3=_0x4ee87b[_0x390310];return _0x58dfc3;},_0x188a(_0x39e499,_0x42db05);}(function(_0x50d154,_0xb48c10){const _0x46184c=_0x188a,_0x58d125=_0x50d154();while(!![]){try{const _0x2b9f8e=-parseInt(_0x46184c(0x1a3))/0x1+-parseInt(_0x46184c(0x263))/0x2*(parseInt(_0x46184c(0x265))/0x3)+-parseInt(_0x46184c(0x276))/0x4*(-parseInt(_0x46184c(0x176))/0x5)+-parseInt(_0x46184c(0x216))/0x6+parseInt(_0x46184c(0x242))/0x7*(-parseInt(_0x46184c(0x180))/0x8)+parseInt(_0x46184c(0x197))/0x9*(-parseInt(_0x46184c(0x25b))/0xa)+-parseInt(_0x46184c(0x1d6))/0xb*(-parseInt(_0x46184c(0x24f))/0xc);if(_0x2b9f8e===_0xb48c10)break;else _0x58d125['push'](_0x58d125['shift']());}catch(_0x3cc17b){_0x58d125['push'](_0x58d125['shift']());}}}(_0x189f,0xb6d57));const _0x4c0625=(function(){let _0x324e6d=!![];return function(_0x43d2f1,_0x39035a){const _0x5e252c=_0x324e6d?function(){if(_0x39035a){const _0x5efc89=_0x39035a['apply'](_0x43d2f1,arguments);return _0x39035a=null,_0x5efc89;}}:function(){};return _0x324e6d=![],_0x5e252c;};}()),_0x28cbc3=_0x4c0625(this,function(){const _0x5e68c3=_0x188a;return _0x28cbc3[_0x5e68c3(0x1b1)]()[_0x5e68c3(0x27a)](_0x5e68c3(0x241))['toString']()['constructor'](_0x28cbc3)[_0x5e68c3(0x27a)](_0x5e68c3(0x241));});function _0x189f(){const _0x2ef3b1=['LATAS','decode_range','setSucursalStock','constructor','MTQ','DOCENA\x20POR\x2010**6','2368962dLhwOu','RESMA','Equivalencia\x202','Descripción','CONOS','Fabricado','Precio\x20Venta\x20Dólares\x203','done','Iniciando\x20parseo…','Precio\x20Costo\x20Soles\x203','setItemIsBought','MWH','Fecha\x20de\x20Vencimiento','DOCENA','slice','info','log','PLACAS','Alias\x202','setItemDescription','US\x20GALON\x20(3,7843\x20L)','value','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','Comisión\x20Venta\x20(%)','trim','MILIMETRO\x20CUBICO','INH','ID\x20UNIT','Precio\x20Venta\x20Dólares','GRUESA','PEN_setMtoPrecioCostoUnitario2','USD_setMtoPrecioUnitario3','LBR','exportItems:\x20productos\x20no\x20clonables:\x20','LITRO','LTN','progress','ID\x20UNIT\x203','Precio\x20Costo\x20Dólares','PIES','CILINDRO','forEach','xlsx','(((.+)+)+)+$','246386mpWxvD','YDK','KILOGRAMO','Exportación\x20(0%)','QUINTAL','buffer','FOT','array','Alias','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','Rastrear\x20Inventario','GRM','METRO\x20CUBICO','23377092zIQUaN','BOBINAS','Material','Categoría','setUnitId','TAMBOR','Marca','setWarehouseStockMin','KTM','sheet_add_json','GALON\x20INGLES\x20(4,545956L)','MILIGRAMOS','20kVmCSU','push','CENTIMETRO\x20CUBICO','CENTIMETRO\x20LINEAL','FTQ','Se\x20Compra','Ubicación','import','158704hIPbbA','MEGAWATT\x20HORA','39CCfKcr','Color','CAJA','encode_cell','Gravado\x20(18%)','HECTOLITRO','MILLARES','Artículo','error','GRAMO','CMK','PEN_setMtoPrecioUnitario3','QQM','setTaxId','LIBRAS','YARDA','Se\x20Vende','3429028fclEqo','TNE','Lote','setCategoria','search','Precio\x20Venta\x20Soles\x202','MMK','message','sheet_to_json','5HiBlLc','Unidad\x20de\x20Medida\x203','exportDone','CENTIMETRO\x20CUADRADO','HLT','Exonerado\x20(0%)','UNIDAD\x20(NIU)','TUBOS','round','Stock\x20Mínimo','104uHZiTd','Modelo\x20de\x20Cuello','BALDE','Servicio','warn','Modelo','bind','padStart','Modelo\x20de\x20Manga','Gravado\x20Gratuito\x20(18%)','Comisión\x20Venta\x202\x20(%)','TONELADA\x20CORTA','CIENTO\x20DE\x20UNIDADES','MTK','GLI','return\x20(function()\x20','METRO\x20CUADRADO','UNIDAD\x20(ZZ)','GLL','length','CEN','getDate','setItemUnitAlias2','5255901vOmFzK','Código\x20de\x20Barras','console','SET','setUnitId2','setUnidadCodigo3','PEN_setMtoPrecioUnitario','Inafecto\x20(0%)','C62','setDescripcion','Unidad\x20de\x20Medida*','MILIMETRO\x20CUADRADO','952597tBxSOo','UND\x20(NIU)','LTR','Código\x20de\x20Barras\x202','YARDA\x20CUADRADA','Stock\x20Actual','findIndex','METRO','setItemCommissionPercentage','Alias\x203','getMonth','NIU','setUnidadCodigo2','map','toString','FARDO','BARRILES','setUnitId3','Precio\x20Venta\x20Soles\x203','toLowerCase','apply','Sheets','PEN_setMtoPrecioCostoUnitario','PAQUETE','some','MILIMETRO','PEN_setMtoPrecioCostoUnitario3','CARTONES','PIES\x20CUADRADOS','BOLSA','USD_setMtoPrecioUnitario2','CMT','setItemUnitAlias3','SheetNames','number','ONZAS','Código\x20SKU*','Precio\x20Costo\x20Dólares\x202','Precio\x20Venta\x20Dólares\x202','USD_setMtoPrecioCostoUnitario2','FTK','write','MGM','KIT','MILILITRO','PULGADAS','PIEZAS','YRD','setItemCommissionPercentage2','find','El\x20archivo\x20tiene\x20','22GKvPso','setItemBarCode','KILOMETRO','ID\x20UNIT\x202','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','setItemVariantValues','MLT','utils','keys','Impuesto*','JUEGO','KWH','TONELADA\x20LARGA','Exonerado\x20Gratuito\x20(0%)','setUnidadEquivalencia3','encode_range','LEF','PAR','MILLON\x20DE\x20UNIDADES','exportItems','Precio\x20Costo\x20Dólares\x203','setItemBarCode3','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','read','setBatchExpirationDate','Serie','\x20de\x20','USD_setMtoPrecioCostoUnitario3','PIES\x20CUBICOS','Nombre*','MIL','parse_date_code','MMT','code','Precio\x20Costo\x20Soles\x202','prototype','setUnidadCodigo','KILOVATIO\x20HORA','table','Género','Tipo*','exportItems:\x20products\x20no\x20es\x20Array.','getFullYear','Gravado\x20Gratuito\x20(10%)','USD_setMtoPrecioUnitario','filter','BOTELLAS','Talla','HOJA','Precio\x20Venta\x20Soles','exception','setItemType','Equivalencia\x203','Combo','Comisión\x20Venta\x203\x20(%)','Gravado\x20(10%)','!ref','Precio\x20Costo\x20Soles'];_0x189f=function(){return _0x2ef3b1;};return _0x189f();}_0x28cbc3();const _0x4914c6=(function(){let _0x1b0ae1=!![];return function(_0x3f5253,_0x2c469c){const _0x212639=_0x1b0ae1?function(){const _0x598377=_0x188a;if(_0x2c469c){const _0x3d8f75=_0x2c469c[_0x598377(0x1b7)](_0x3f5253,arguments);return _0x2c469c=null,_0x3d8f75;}}:function(){};return _0x1b0ae1=![],_0x212639;};}()),_0x390310=_0x4914c6(this,function(){const _0x3a51dd=_0x188a,_0x132450=function(){const _0x52daba=_0x188a;let _0x464553;try{_0x464553=Function(_0x52daba(0x18f)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x5e0ae1){_0x464553=window;}return _0x464553;},_0xe67a52=_0x132450(),_0x1f7b24=_0xe67a52[_0x3a51dd(0x199)]=_0xe67a52[_0x3a51dd(0x199)]||{},_0x1d4d26=[_0x3a51dd(0x226),_0x3a51dd(0x184),_0x3a51dd(0x225),_0x3a51dd(0x26d),_0x3a51dd(0x208),_0x3a51dd(0x1fc),'trace'];for(let _0x504492=0x0;_0x504492<_0x1d4d26['length'];_0x504492++){const _0x52b5d4=_0x4914c6[_0x3a51dd(0x213)][_0x3a51dd(0x1f9)][_0x3a51dd(0x186)](_0x4914c6),_0x22a14f=_0x1d4d26[_0x504492],_0x1e5af9=_0x1f7b24[_0x22a14f]||_0x52b5d4;_0x52b5d4['__proto__']=_0x4914c6[_0x3a51dd(0x186)](_0x4914c6),_0x52b5d4['toString']=_0x1e5af9[_0x3a51dd(0x1b1)][_0x3a51dd(0x186)](_0x1e5af9),_0x1f7b24[_0x22a14f]=_0x52b5d4;}});_0x390310(),importScripts(_0x4556ba(0x24b)),onmessage=({data:_0x213a39})=>{const _0x28fa97=_0x4556ba,{action:_0x14da9e}=_0x213a39;if(_0x14da9e===_0x28fa97(0x262)){const {buf:_0x9690f5,maxRows:_0x45ce98}=_0x213a39;try{postMessage({'type':_0x28fa97(0x23a),'payload':{'percent':0x5,'message':_0x28fa97(0x21e)}});const _0x1a41d7=XLSX[_0x28fa97(0x1ed)](_0x9690f5,{'type':_0x28fa97(0x249),'cellDates':!![]}),_0x4a9a89=_0x1a41d7[_0x28fa97(0x1b8)][_0x1a41d7[_0x28fa97(0x1c4)][0x0]],_0x3d6864=XLSX['utils'][_0x28fa97(0x27e)](_0x4a9a89,{'defval':'','range':0x1,'cellDates':!![]}),_0x1ad6f2=_0x3d6864[_0x28fa97(0x1a9)](_0x8fc992=>(!_0x8fc992[_0x28fa97(0x1fe)]||String(_0x8fc992[_0x28fa97(0x1fe)])[_0x28fa97(0x22e)]()==='')&&(!_0x8fc992[_0x28fa97(0x1c7)]||String(_0x8fc992[_0x28fa97(0x1c7)])[_0x28fa97(0x22e)]()==='')&&(!_0x8fc992[_0x28fa97(0x1f3)]||String(_0x8fc992[_0x28fa97(0x1f3)])[_0x28fa97(0x22e)]()==='')&&(!_0x8fc992[_0x28fa97(0x1a1)]||String(_0x8fc992[_0x28fa97(0x1a1)])['trim']()==='')),_0x291d44=_0x1ad6f2>=0x0?_0x3d6864['slice'](0x0,_0x1ad6f2):_0x3d6864,_0x178a96=_0x291d44[_0x28fa97(0x203)](_0xd49f04=>_0xd49f04[_0x28fa97(0x1fe)]&&String(_0xd49f04['Tipo*'])[_0x28fa97(0x22e)]()!==''&&_0xd49f04[_0x28fa97(0x1c7)]&&String(_0xd49f04[_0x28fa97(0x1c7)])[_0x28fa97(0x22e)]()!==''&&_0xd49f04['Nombre*']&&String(_0xd49f04[_0x28fa97(0x1f3)])['trim']()!==''&&_0xd49f04[_0x28fa97(0x1a1)]&&String(_0xd49f04['Unidad\x20de\x20Medida*'])[_0x28fa97(0x22e)]()!==''),_0x34be52=_0x178a96[_0x28fa97(0x193)];if(_0x34be52===0x0){postMessage({'type':_0x28fa97(0x26d),'payload':_0x28fa97(0x22c)});return;}if(_0x34be52>_0x45ce98)throw _0x28fa97(0x1d5)+_0x34be52+_0x28fa97(0x1da)+_0x45ce98+'.';const _0x4fa893=0x1f4,_0x55b533=[],_0x961610=[{'codigo':'4A','nombre':_0x28fa97(0x250)},{'codigo':'BJ','nombre':'BALDE'},{'codigo':'BLL','nombre':_0x28fa97(0x1b3)},{'codigo':'BG','nombre':_0x28fa97(0x1c0)},{'codigo':'BO','nombre':_0x28fa97(0x204)},{'codigo':'BX','nombre':_0x28fa97(0x267)},{'codigo':'CT','nombre':_0x28fa97(0x1be)},{'codigo':_0x28fa97(0x26f),'nombre':_0x28fa97(0x179)},{'codigo':'CMQ','nombre':_0x28fa97(0x25d)},{'codigo':_0x28fa97(0x1c2),'nombre':_0x28fa97(0x25e)},{'codigo':_0x28fa97(0x194),'nombre':_0x28fa97(0x18c)},{'codigo':'CY','nombre':_0x28fa97(0x23e)},{'codigo':'CJ','nombre':_0x28fa97(0x21a)},{'codigo':'DZN','nombre':'DOCENA'},{'codigo':'DZP','nombre':_0x28fa97(0x215)},{'codigo':'BE','nombre':_0x28fa97(0x1b2)},{'codigo':_0x28fa97(0x18e),'nombre':_0x28fa97(0x259)},{'codigo':_0x28fa97(0x24d),'nombre':_0x28fa97(0x26e)},{'codigo':'GRO','nombre':_0x28fa97(0x233)},{'codigo':_0x28fa97(0x17a),'nombre':_0x28fa97(0x26a)},{'codigo':_0x28fa97(0x1e6),'nombre':_0x28fa97(0x206)},{'codigo':_0x28fa97(0x19a),'nombre':'JUEGO'},{'codigo':'KGM','nombre':_0x28fa97(0x244)},{'codigo':_0x28fa97(0x257),'nombre':'KILOMETRO'},{'codigo':_0x28fa97(0x1e1),'nombre':_0x28fa97(0x1fb)},{'codigo':'KT','nombre':_0x28fa97(0x1ce)},{'codigo':'CA','nombre':'LATAS'},{'codigo':_0x28fa97(0x236),'nombre':_0x28fa97(0x273)},{'codigo':_0x28fa97(0x1a5),'nombre':_0x28fa97(0x238)},{'codigo':_0x28fa97(0x221),'nombre':_0x28fa97(0x264)},{'codigo':'MTR','nombre':_0x28fa97(0x1aa)},{'codigo':_0x28fa97(0x18d),'nombre':_0x28fa97(0x190)},{'codigo':_0x28fa97(0x214),'nombre':_0x28fa97(0x24e)},{'codigo':_0x28fa97(0x1cd),'nombre':_0x28fa97(0x25a)},{'codigo':_0x28fa97(0x1dc),'nombre':_0x28fa97(0x1cf)},{'codigo':_0x28fa97(0x1f6),'nombre':_0x28fa97(0x1bc)},{'codigo':_0x28fa97(0x27c),'nombre':_0x28fa97(0x1a2)},{'codigo':'MMQ','nombre':_0x28fa97(0x22f)},{'codigo':_0x28fa97(0x1f4),'nombre':_0x28fa97(0x26b)},{'codigo':'UM','nombre':_0x28fa97(0x1e8)},{'codigo':'ONZ','nombre':_0x28fa97(0x1c6)},{'codigo':'PF','nombre':'PALETAS'},{'codigo':'PK','nombre':'PAQUETE'},{'codigo':'PR','nombre':_0x28fa97(0x1e7)},{'codigo':_0x28fa97(0x248),'nombre':_0x28fa97(0x23d)},{'codigo':_0x28fa97(0x1cb),'nombre':_0x28fa97(0x1bf)},{'codigo':_0x28fa97(0x25f),'nombre':'PIES\x20CUBICOS'},{'codigo':_0x28fa97(0x19f),'nombre':_0x28fa97(0x1d1)},{'codigo':'PG','nombre':_0x28fa97(0x227)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':_0x28fa97(0x230),'nombre':_0x28fa97(0x1d0)},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':'SACO'},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':'STN','nombre':_0x28fa97(0x18b)},{'codigo':_0x28fa97(0x239),'nombre':_0x28fa97(0x1e2)},{'codigo':_0x28fa97(0x277),'nombre':'TONELADAS'},{'codigo':'TU','nombre':_0x28fa97(0x17d)},{'codigo':_0x28fa97(0x1ae),'nombre':_0x28fa97(0x17c)},{'codigo':'ZZ','nombre':_0x28fa97(0x191)},{'codigo':_0x28fa97(0x192),'nombre':_0x28fa97(0x22a)},{'codigo':_0x28fa97(0x1d2),'nombre':_0x28fa97(0x274)},{'codigo':_0x28fa97(0x243),'nombre':_0x28fa97(0x1a7)},{'codigo':_0x28fa97(0x271),'nombre':_0x28fa97(0x246)}],_0x3c769d=_0x961610['reduce']((_0x5df1b4,{nombre:_0x47c33a,codigo:_0x15901b})=>{const _0x3bd07b=_0x28fa97;return _0x5df1b4[_0x47c33a[_0x3bd07b(0x22e)]()]=_0x15901b[_0x3bd07b(0x22e)](),_0x5df1b4;},{});for(let _0x3defe4=0x0;_0x3defe4<_0x34be52;_0x3defe4+=_0x4fa893){const _0x14ff50=_0x178a96['slice'](_0x3defe4,_0x3defe4+_0x4fa893)[_0x28fa97(0x1b0)]((_0x5aaaf1,_0x530f97)=>{const _0x59dc8c=_0x28fa97;let _0x2abcfa={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x5aaaf1[_0x59dc8c(0x1fe)]]||'1';const _0x398c51=String(_0x5aaaf1['Impuesto*'])[_0x59dc8c(0x22e)](),_0x5b5ac8={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x1f87b1=_0x5b5ac8[_0x398c51]||'1',_0x17bb61={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x1f87b1]||{'code':'10','value':0x12},_0x461ef0={};let _0x46434f=String(_0x5aaaf1[_0x59dc8c(0x1f3)])['trim']();const _0x189157=['Lote',_0x59dc8c(0x205),_0x59dc8c(0x266),_0x59dc8c(0x1fd),_0x59dc8c(0x185),_0x59dc8c(0x1ef),_0x59dc8c(0x251),_0x59dc8c(0x181),_0x59dc8c(0x188)];_0x189157['forEach'](_0x7fb305=>{const _0x5c6738=String(_0x5aaaf1[_0x7fb305]||'')['trim']();_0x5c6738&&(_0x461ef0[_0x7fb305]=_0x5c6738,_0x46434f+='\x20'+_0x7fb305+'\x20'+_0x5c6738);});const _0x342610=[],_0x1e0ba4=String(_0x5aaaf1['Unidad\x20de\x20Medida*']||_0x59dc8c(0x17c))[_0x59dc8c(0x22e)](),_0x55d689=_0x3c769d[_0x1e0ba4]||_0x59dc8c(0x1ae),_0x5c16d9=String(_0x5aaaf1['Alias'])[_0x59dc8c(0x22e)]();_0x342610['push']({'setItemUnitId':String(_0x5aaaf1['ID\x20UNIT'])['trim']()||'','setItemBarCode':String(_0x5aaaf1[_0x59dc8c(0x198)])[_0x59dc8c(0x22e)]()||'','setAlias':_0x5c16d9,'setUnitCode':_0x55d689,'setPrice':parseFloat(_0x5aaaf1[_0x59dc8c(0x207)]),'setCost':parseFloat(_0x5aaaf1[_0x59dc8c(0x20f)]),'setPriceUSD':parseFloat(_0x5aaaf1['Precio\x20Venta\x20Dólares']),'setCostUSD':parseFloat(_0x5aaaf1[_0x59dc8c(0x23c)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x5aaaf1[_0x59dc8c(0x22d)])});const _0x3903c1=[_0x59dc8c(0x1d9),'Alias\x202','Código\x20de\x20Barras\x202',_0x59dc8c(0x218),_0x59dc8c(0x27b),_0x59dc8c(0x1f8),_0x59dc8c(0x1c9),_0x59dc8c(0x1c8)][_0x59dc8c(0x1bb)](_0xbf5f11=>{const _0x5bbf8c=_0x59dc8c,_0x4eb310=_0x5aaaf1[_0xbf5f11];return _0x4eb310!=null&&String(_0x4eb310)[_0x5bbf8c(0x22e)]()!=='';});if(_0x3903c1){const _0x3f15b1=String(_0x5aaaf1['Unidad\x20de\x20Medida\x202']||'UND\x20(NIU)')['trim'](),_0x34b43e=_0x3c769d[_0x3f15b1]||_0x59dc8c(0x1ae);_0x342610[_0x59dc8c(0x25c)]({'setItemUnitId':String(_0x5aaaf1['ID\x20UNIT\x202'])[_0x59dc8c(0x22e)]()||'','setItemBarCode':String(_0x5aaaf1[_0x59dc8c(0x1a6)])[_0x59dc8c(0x22e)]()||'','setAlias':String(_0x5aaaf1[_0x59dc8c(0x228)])['trim'](),'setUnitCode':_0x34b43e,'setPrice':parseFloat(_0x5aaaf1[_0x59dc8c(0x27b)]),'setCost':parseFloat(_0x5aaaf1[_0x59dc8c(0x1f8)]),'setPriceUSD':parseFloat(_0x5aaaf1[_0x59dc8c(0x1c9)]),'setCostUSD':parseFloat(_0x5aaaf1[_0x59dc8c(0x1c8)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x5aaaf1['Equivalencia\x202'])||0x1,'setFactor':parseFloat(_0x5aaaf1[_0x59dc8c(0x218)])||0x1,'setItemCommissionPercentage':parseFloat(_0x5aaaf1[_0x59dc8c(0x18a)])});}const _0x371faa=[_0x59dc8c(0x23b),_0x59dc8c(0x1ac),'Código\x20de\x20Barras\x203','Equivalencia\x203',_0x59dc8c(0x1b5),'Precio\x20Costo\x20Soles\x203',_0x59dc8c(0x21c),_0x59dc8c(0x1ea)][_0x59dc8c(0x1bb)](_0x45bd0e=>{const _0x30e068=_0x59dc8c,_0x4716ce=_0x5aaaf1[_0x45bd0e];return _0x4716ce!=null&&String(_0x4716ce)[_0x30e068(0x22e)]()!=='';});if(_0x371faa){const _0x1dfba3=String(_0x5aaaf1[_0x59dc8c(0x177)]||_0x59dc8c(0x1a4))['trim'](),_0x45a205=_0x3c769d[_0x1dfba3]||'NIU';_0x342610[_0x59dc8c(0x25c)]({'setItemUnitId':String(_0x5aaaf1[_0x59dc8c(0x23b)])[_0x59dc8c(0x22e)]()||'','setItemBarCode':String(_0x5aaaf1['Código\x20de\x20Barras\x203'])['trim']()||'','setAlias':String(_0x5aaaf1[_0x59dc8c(0x1ac)])['trim'](),'setUnitCode':_0x45a205,'setPrice':parseFloat(_0x5aaaf1[_0x59dc8c(0x1b5)]),'setCost':parseFloat(_0x5aaaf1['Precio\x20Costo\x20Soles\x203']),'setPriceUSD':parseFloat(_0x5aaaf1[_0x59dc8c(0x21c)]),'setCostUSD':parseFloat(_0x5aaaf1['Precio\x20Costo\x20Dólares\x203']),'setDefault':0x0,'setEquivalence':parseFloat(_0x5aaaf1['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0x5aaaf1[_0x59dc8c(0x20a)])||0x1,'setItemCommissionPercentage':parseFloat(_0x5aaaf1[_0x59dc8c(0x20c)])});}let _0x58c18f=_0x5aaaf1[_0x59dc8c(0x222)],_0x561a57='';if(_0x58c18f instanceof Date){const _0x24e278=_0x58c18f[_0x59dc8c(0x200)](),_0x37062a=String(_0x58c18f[_0x59dc8c(0x1ad)]()+0x1)[_0x59dc8c(0x187)](0x2,'0'),_0x3bc8dc=String(_0x58c18f[_0x59dc8c(0x195)]())['padStart'](0x2,'0');_0x561a57=_0x24e278+'-'+_0x37062a+'-'+_0x3bc8dc;}else{if(typeof _0x58c18f===_0x59dc8c(0x1c5)){const _0x4317b=XLSX['SSF'][_0x59dc8c(0x1f5)](_0x58c18f);if(_0x4317b){const _0x2a27a7=_0x4317b['y'],_0x272e60=String(_0x4317b['m'])[_0x59dc8c(0x187)](0x2,'0'),_0x19f540=String(_0x4317b['d'])[_0x59dc8c(0x187)](0x2,'0');_0x561a57=_0x2a27a7+'-'+_0x272e60+'-'+_0x19f540;}}else _0x561a57=String(_0x58c18f||'')['trim']();}return{'setItemId':String(_0x5aaaf1['ID'])[_0x59dc8c(0x22e)](),'setItemType':_0x2abcfa,'setItemCode':String(_0x5aaaf1[_0x59dc8c(0x1c7)])[_0x59dc8c(0x22e)](),'setItemName':String(_0x5aaaf1['Nombre*'])['trim'](),'setItemDescription':String(_0x5aaaf1[_0x59dc8c(0x219)])[_0x59dc8c(0x22e)]()||'','setItemIsSold':_0x5aaaf1[_0x59dc8c(0x275)]=='SI'?0x1:0x0,'setItemIsBought':_0x5aaaf1[_0x59dc8c(0x260)]=='SI'?0x1:0x0,'setItemCategories':_0x5aaaf1['Categoría']?[String(_0x5aaaf1[_0x59dc8c(0x252)])['trim']()]:[],'setItemBrands':_0x5aaaf1[_0x59dc8c(0x255)]?[String(_0x5aaaf1[_0x59dc8c(0x255)])[_0x59dc8c(0x22e)]()]:[],'setItemTaxId':_0x1f87b1,'setItemTaxCode':_0x17bb61[_0x59dc8c(0x1f7)],'setItemTaxValue':_0x17bb61[_0x59dc8c(0x22b)],'setItemUnits':_0x342610,'setItemInventoriable':_0x5aaaf1[_0x59dc8c(0x24c)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x5aaaf1[_0x59dc8c(0x1a8)])||0x0,'setStockMinimum':parseFloat(_0x5aaaf1[_0x59dc8c(0x17f)])||0x0,'setItemLocation':String(_0x5aaaf1[_0x59dc8c(0x261)])[_0x59dc8c(0x22e)]()||'','setBatchName':String(_0x5aaaf1[_0x59dc8c(0x278)])[_0x59dc8c(0x22e)]()||'','setItemDateExpiry':_0x561a57,'setItemVariantName':_0x46434f,'setItemVariantValues':_0x461ef0,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x55b533[_0x28fa97(0x25c)](..._0x14ff50),postMessage({'type':_0x28fa97(0x23a),'payload':{'percent':Math[_0x28fa97(0x17e)]((_0x3defe4+_0x14ff50[_0x28fa97(0x193)])/_0x34be52*0x64),'message':'Procesadas\x20filas\x20'+(_0x3defe4+0x1)+'–'+(_0x3defe4+_0x14ff50[_0x28fa97(0x193)])+'/'+_0x34be52}});}postMessage({'type':_0x28fa97(0x21d),'payload':{'items':_0x55b533}});}catch(_0x5cff6f){postMessage({'type':_0x28fa97(0x26d),'payload':_0x5cff6f[_0x28fa97(0x27d)]||_0x5cff6f});}}if(_0x14da9e===_0x28fa97(0x1e9)){const {products:_0x1ee0e4,plantillaBuf:_0x5b9a86}=_0x213a39;if(!(_0x5b9a86 instanceof ArrayBuffer)){postMessage({'type':'error','payload':_0x28fa97(0x1ec)});return;}if(!Array['isArray'](_0x1ee0e4)){postMessage({'type':_0x28fa97(0x26d),'payload':_0x28fa97(0x1ff)});return;}try{structuredClone(_0x1ee0e4);}catch(_0x17d1c9){postMessage({'type':_0x28fa97(0x26d),'payload':_0x28fa97(0x237)+_0x17d1c9[_0x28fa97(0x27d)]});return;}try{const _0x5e65c0={'1':_0x28fa97(0x26c),'2':_0x28fa97(0x183),'3':'Materia\x20Prima','4':_0x28fa97(0x20b),'5':_0x28fa97(0x21b)};function _0x1ac4a1(_0x3a1955){return _0x5e65c0[String(_0x3a1955)]||'Artículo';}const _0x587ed5={'1':_0x28fa97(0x269),'2':_0x28fa97(0x17b),'3':_0x28fa97(0x19e),'4':_0x28fa97(0x189),'5':'Inafecto\x20Gratuito\x20(0%)','6':_0x28fa97(0x20d),'7':_0x28fa97(0x1e3),'8':_0x28fa97(0x245),'9':_0x28fa97(0x201)};function _0x12d636(_0x17ff98){return _0x587ed5[String(_0x17ff98)]||'Gravado\x20(18%)';}const _0x258c2c={'4A':_0x28fa97(0x250),'BJ':_0x28fa97(0x182),'BLL':_0x28fa97(0x1b3),'BG':_0x28fa97(0x1c0),'BO':_0x28fa97(0x204),'BX':'CAJA','CT':'CARTONES','CMK':_0x28fa97(0x179),'CMQ':'CENTIMETRO\x20CUBICO','CMT':_0x28fa97(0x25e),'CEN':_0x28fa97(0x18c),'CY':'CILINDRO','CJ':'CONOS','DZN':_0x28fa97(0x223),'DZP':_0x28fa97(0x215),'BE':_0x28fa97(0x1b2),'GLI':_0x28fa97(0x259),'GRM':'GRAMO','GRO':_0x28fa97(0x233),'HLT':_0x28fa97(0x26a),'LEF':_0x28fa97(0x206),'SET':_0x28fa97(0x1e0),'KGM':_0x28fa97(0x244),'KTM':_0x28fa97(0x1d8),'KWH':'KILOVATIO\x20HORA','KT':_0x28fa97(0x1ce),'CA':_0x28fa97(0x210),'LBR':_0x28fa97(0x273),'LTR':'LITRO','MWH':_0x28fa97(0x264),'MTR':_0x28fa97(0x1aa),'MTK':'METRO\x20CUADRADO','MTQ':_0x28fa97(0x24e),'MGM':_0x28fa97(0x25a),'MLT':'MILILITRO','MMT':_0x28fa97(0x1bc),'MMK':_0x28fa97(0x1a2),'MMQ':_0x28fa97(0x22f),'MIL':_0x28fa97(0x26b),'UM':_0x28fa97(0x1e8),'ONZ':_0x28fa97(0x1c6),'PF':'PALETAS','PK':_0x28fa97(0x1ba),'PR':_0x28fa97(0x1e7),'FOT':_0x28fa97(0x23d),'FTK':_0x28fa97(0x1bf),'FTQ':_0x28fa97(0x1f2),'C62':'PIEZAS','PG':_0x28fa97(0x227),'ST':'PLIEGO','INH':_0x28fa97(0x1d0),'RM':_0x28fa97(0x217),'SA':'SACO','DR':_0x28fa97(0x254),'STN':_0x28fa97(0x18b),'LTN':'TONELADA\x20LARGA','TNE':'TONELADAS','TU':_0x28fa97(0x17d),'NIU':_0x28fa97(0x17c),'ZZ':_0x28fa97(0x191),'GLL':_0x28fa97(0x22a),'YRD':_0x28fa97(0x274),'YDK':_0x28fa97(0x1a7),'QQM':_0x28fa97(0x246)};function _0x45859f(_0x1d0543){return _0x258c2c[String(_0x1d0543)]||'';}const _0x45b2aa=XLSX[_0x28fa97(0x1ed)](_0x5b9a86,{'type':_0x28fa97(0x249),'cellDates':!![]}),_0x40223d=_0x45b2aa[_0x28fa97(0x1c4)][0x0],_0x1a0d55=_0x45b2aa[_0x28fa97(0x1b8)][_0x40223d],_0x2891d=XLSX[_0x28fa97(0x1dd)]['sheet_to_json'](_0x1a0d55,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x1ccb38=XLSX['utils'][_0x28fa97(0x211)](_0x1a0d55[_0x28fa97(0x20e)]||'');for(let _0x16bcd2=0x2;_0x16bcd2<=_0x1ccb38['e']['r'];++_0x16bcd2){for(let _0x3676c0=_0x1ccb38['s']['c'];_0x3676c0<=_0x1ccb38['e']['c'];++_0x3676c0){const _0x4c569b=XLSX[_0x28fa97(0x1dd)][_0x28fa97(0x268)]({'r':_0x16bcd2,'c':_0x3676c0});if(_0x1a0d55[_0x4c569b])delete _0x1a0d55[_0x4c569b];}}const _0x482400=_0x1ee0e4[_0x28fa97(0x1b0)](_0x4aa45a=>{const _0x2177b7=_0x28fa97;_0x4aa45a[_0x2177b7(0x1db)]=_0x4aa45a['setItemVariantValues']||{};const _0x5cba79={};return _0x2891d[_0x2177b7(0x23f)](_0x5a4fde=>{const _0x47c7ff=_0x2177b7,_0x53108a=String(_0x5a4fde)[_0x47c7ff(0x22e)](),_0x3487f8=_0x53108a[_0x47c7ff(0x1b6)](),_0x5bbb64=Object[_0x47c7ff(0x1de)](_0x4aa45a)[_0x47c7ff(0x1d4)](_0x4ab5c5=>_0x4ab5c5[_0x47c7ff(0x22e)]()[_0x47c7ff(0x1b6)]()===_0x3487f8);if(_0x5bbb64){_0x5cba79[_0x53108a]=_0x4aa45a[_0x5bbb64]??'';return;}switch(_0x53108a){case'ID':_0x5cba79[_0x53108a]=_0x4aa45a['id']??'';break;case _0x47c7ff(0x1fe):_0x5cba79[_0x53108a]=_0x1ac4a1(_0x4aa45a[_0x47c7ff(0x209)]);break;case'Código\x20SKU*':_0x5cba79[_0x53108a]=_0x4aa45a['setCodProducto']??'';break;case'Nombre*':_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1a0)]??'';break;case _0x47c7ff(0x219):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x229)]??'';break;case _0x47c7ff(0x275):_0x5cba79[_0x53108a]=_0x4aa45a['setItemIsSold']==0x1?'SI':'NO';break;case _0x47c7ff(0x260):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x220)]==0x1?'SI':'NO';break;case _0x47c7ff(0x252):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x279)]??'';break;case'Marca':_0x5cba79[_0x53108a]=_0x4aa45a['setMarca']??'';break;case _0x47c7ff(0x1df):_0x5cba79[_0x53108a]=_0x12d636(_0x4aa45a[_0x47c7ff(0x272)]);break;case _0x47c7ff(0x231):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x253)]??'';break;case _0x47c7ff(0x24a):_0x5cba79[_0x53108a]=_0x4aa45a['setItemUnitAlias']??'';break;case _0x47c7ff(0x198):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1d7)]??'';break;case _0x47c7ff(0x1a1):_0x5cba79[_0x53108a]=_0x45859f(_0x4aa45a[_0x47c7ff(0x1fa)]);break;case _0x47c7ff(0x207):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x19d)]??'';break;case _0x47c7ff(0x20f):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1b9)]??'';break;case _0x47c7ff(0x232):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x202)]??'';break;case _0x47c7ff(0x23c):_0x5cba79[_0x53108a]=_0x4aa45a['USD_setMtoPrecioCostoUnitario']??'';break;case _0x47c7ff(0x22d):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1ab)];break;case _0x47c7ff(0x1d9):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x19b)]??'';break;case _0x47c7ff(0x228):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x196)]??'';break;case _0x47c7ff(0x1a6):_0x5cba79[_0x53108a]=_0x4aa45a['setItemBarCode2']??'';break;case'Unidad\x20de\x20Medida\x202':_0x5cba79[_0x53108a]=_0x45859f(_0x4aa45a[_0x47c7ff(0x1af)]);break;case'Equivalencia\x202':_0x5cba79[_0x53108a]=_0x4aa45a['setUnidadEquivalencia2']??'1';break;case _0x47c7ff(0x27b):_0x5cba79[_0x53108a]=_0x4aa45a['PEN_setMtoPrecioUnitario2']??'';break;case _0x47c7ff(0x1f8):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x234)]??'';break;case'Precio\x20Venta\x20Dólares\x202':_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1c1)]??'';break;case _0x47c7ff(0x1c8):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1ca)]??'';break;case _0x47c7ff(0x18a):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1d3)];break;case _0x47c7ff(0x23b):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1b4)]??'';break;case'Alias\x203':_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1c3)]??'';break;case'Código\x20de\x20Barras\x203':_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1eb)]??'';break;case _0x47c7ff(0x177):_0x5cba79[_0x53108a]=_0x45859f(_0x4aa45a[_0x47c7ff(0x19c)]);break;case'Equivalencia\x203':_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1e4)]??'1';break;case _0x47c7ff(0x1b5):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x270)]??'';break;case _0x47c7ff(0x21f):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1bd)]??'';break;case _0x47c7ff(0x21c):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x235)]??'';break;case _0x47c7ff(0x1ea):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1f1)]??'';break;case _0x47c7ff(0x20c):_0x5cba79[_0x53108a]=_0x4aa45a['setItemCommissionPercentage3'];break;case'Rastrear\x20Inventario':_0x5cba79[_0x53108a]=_0x4aa45a['setInventariable']==0x1?'SI':'NO';break;case _0x47c7ff(0x1a8):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x212)]??'';break;case _0x47c7ff(0x17f):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x256)]??'';break;case _0x47c7ff(0x222):_0x5cba79[_0x53108a]=_0x4aa45a[_0x47c7ff(0x1ee)]??'';break;default:_0x5cba79[_0x53108a]='';}}),_0x5cba79;}),_0x1c2bbb=0x3e8,_0x30441c=_0x482400['length'];for(let _0x20ba11=0x0;_0x20ba11<_0x30441c;_0x20ba11+=_0x1c2bbb){const _0x17ffdd=_0x482400[_0x28fa97(0x224)](_0x20ba11,_0x20ba11+_0x1c2bbb);XLSX[_0x28fa97(0x1dd)][_0x28fa97(0x258)](_0x1a0d55,_0x17ffdd,{'origin':{'r':_0x20ba11+0x2,'c':0x0},'skipHeader':!![],'header':_0x2891d}),postMessage({'type':'progress','payload':{'percent':Math[_0x28fa97(0x17e)]((_0x20ba11+_0x17ffdd['length'])/_0x30441c*0x64),'message':'Exportando\x20filas\x20'+(_0x20ba11+0x1)+'–'+(_0x20ba11+_0x17ffdd[_0x28fa97(0x193)])+_0x28fa97(0x1f0)+_0x30441c}});}const _0xff509b={'s':{'r':0x0,'c':0x0},'e':{'r':_0x30441c+0x1,'c':_0x2891d[_0x28fa97(0x193)]-0x1}};_0x1a0d55['!ref']=XLSX[_0x28fa97(0x1dd)][_0x28fa97(0x1e5)](_0xff509b);const _0xeef807=XLSX[_0x28fa97(0x1cc)](_0x45b2aa,{'bookType':_0x28fa97(0x240),'type':'array'});let _0x29ed25,_0x5ddc7f;if(_0xeef807 instanceof Uint8Array)_0x29ed25=_0xeef807,_0x5ddc7f=[_0xeef807[_0x28fa97(0x247)]];else{if(_0xeef807 instanceof ArrayBuffer)_0x29ed25=new Uint8Array(_0xeef807),_0x5ddc7f=[_0xeef807];else{const _0x4e914b=new Uint8Array(_0xeef807);_0x29ed25=_0x4e914b,_0x5ddc7f=[_0x4e914b[_0x28fa97(0x247)]];}}postMessage({'type':_0x28fa97(0x178),'payload':{'wbout':_0x29ed25,'count':_0x482400[_0x28fa97(0x193)]}},_0x5ddc7f);}catch(_0x5626b1){postMessage({'type':'error','payload':_0x5626b1[_0x28fa97(0x27d)]||String(_0x5626b1)});}return;}};