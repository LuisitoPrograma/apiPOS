/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.2.2
*/

const _0x2ab5d4=_0x57e3;(function(_0x30c29f,_0x15fb95){const _0x34d7c6=_0x57e3,_0x532e23=_0x30c29f();while(!![]){try{const _0x277f03=-parseInt(_0x34d7c6(0x1b5))/0x1+parseInt(_0x34d7c6(0x1c7))/0x2*(-parseInt(_0x34d7c6(0x1ae))/0x3)+-parseInt(_0x34d7c6(0x167))/0x4*(-parseInt(_0x34d7c6(0x1d8))/0x5)+-parseInt(_0x34d7c6(0x20f))/0x6+-parseInt(_0x34d7c6(0x13d))/0x7+-parseInt(_0x34d7c6(0x172))/0x8+-parseInt(_0x34d7c6(0x215))/0x9*(-parseInt(_0x34d7c6(0x207))/0xa);if(_0x277f03===_0x15fb95)break;else _0x532e23['push'](_0x532e23['shift']());}catch(_0x4360ea){_0x532e23['push'](_0x532e23['shift']());}}}(_0x537e,0xd4508));const _0x454d34=(function(){let _0x4ed6e3=!![];return function(_0x537e50,_0x19fcf5){const _0x95f92b=_0x4ed6e3?function(){if(_0x19fcf5){const _0x1045a0=_0x19fcf5['apply'](_0x537e50,arguments);return _0x19fcf5=null,_0x1045a0;}}:function(){};return _0x4ed6e3=![],_0x95f92b;};}()),_0x353691=_0x454d34(this,function(){const _0x4767ca=_0x57e3;return _0x353691[_0x4767ca(0x1af)]()[_0x4767ca(0x220)](_0x4767ca(0x1ca))[_0x4767ca(0x1af)]()['constructor'](_0x353691)[_0x4767ca(0x220)](_0x4767ca(0x1ca));});_0x353691();function _0x537e(){const _0x57f22a=['MILIMETRO\x20CUBICO','BARRILES','Comisión\x20Venta\x203\x20(%)','Exportación\x20(0%)','slice','Fecha\x20de\x20Vencimiento','METRO\x20CUBICO','12EhyorQ','Género','MMK','setUnitId2','constructor','\x20de\x20','HECTOLITRO','log','MILIMETRO','TNE','setWarehouseStockMin','11643000GvmgSg','info','TONELADA\x20CORTA','exportItems:\x20productos\x20no\x20clonables:\x20','LIBRAS','setUnitId3','Nombre*','Categoría','Modelo','Equivalencia\x203','CILINDRO','INH','setCategoria','ID\x20UNIT','setTaxId','Modelo\x20de\x20Cuello','Equivalencia\x202','Código\x20SKU*','Gravado\x20Gratuito\x20(10%)','KILOVATIO\x20HORA','Color','Precio\x20Venta\x20Soles','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','CENTIMETRO\x20CUBICO','Precio\x20Venta\x20Dólares','code','RESMA','KILOMETRO','Precio\x20Venta\x20Dólares\x203','MMQ','Impuesto*','Se\x20Compra','DZN','length','setItemIsSold','Ubicación','QUINTAL','sheet_add_json','Precio\x20Venta\x20Soles\x203','Tipo*','toLowerCase','LATAS','Artículo','buffer','C62','PIES\x20CUADRADOS','FTK','Código\x20de\x20Barras','prototype','CIENTO\x20DE\x20UNIDADES','MTK','setItemType','GLI','TONELADA\x20LARGA','setUnitId','BLL','USD_setMtoPrecioUnitario','some','Sheets','MILILITRO','751341VzyjCe','toString','FARDO','PALETAS','exportItems:\x20products\x20no\x20es\x20Array.','findIndex','Comisión\x20Venta\x202\x20(%)','103835OAKbdm','Gravado\x20Gratuito\x20(18%)','array','import','isArray','xlsx','MEGAWATT\x20HORA','CARTONES','Alias\x202','GLL','round','YARDA','encode_range','utils','USD_setMtoPrecioCostoUnitario','ID\x20UNIT\x202','setItemCommissionPercentage','Combo','8qOSsWm','error','US\x20GALON\x20(3,7843\x20L)','(((.+)+)+)+$','GRM','getFullYear','setItemBarCode','Inafecto\x20Gratuito\x20(0%)','trim','Inafecto\x20(0%)','CEN','USD_setMtoPrecioCostoUnitario3','DOCENA','MILLARES','Serie','Precio\x20Venta\x20Soles\x202','getDate','1394215hPkntG','Alias','Lote','Material','GALON\x20INGLES\x20(4,545956L)','Precio\x20Venta\x20Dólares\x202','setUnidadCodigo3','KILOGRAMO','YRD','exportDone','done','Exonerado\x20Gratuito\x20(0%)','TAMBOR','ONZ','SSF','GRAMO','FTQ','LTR','DOCENA\x20POR\x2010**6','BOBINAS','MTQ','TUBOS','UNIDAD\x20(NIU)','PIES','setSucursalStock','PEN_setMtoPrecioUnitario','FOT','Descripción','PULGADAS','setItemUnitAlias3','CONOS','GRUESA','sheet_to_json','TONELADAS','console','bind','JUEGO','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','Gravado\x20(10%)','decode_range','YARDA\x20CUADRADA','MGM','UNIDAD\x20(ZZ)','LITRO','map','CENTIMETRO\x20CUADRADO','UND\x20(NIU)','35797940DHlmrk','MILIMETRO\x20CUADRADO','Servicio','PEN_setMtoPrecioUnitario2','Código\x20de\x20Barras\x203','PEN_setMtoPrecioUnitario3','read','progress','85830CMoJXS','setItemBarCode3','CAJA','push','Precio\x20Costo\x20Soles\x203','Precio\x20Costo\x20Dólares','9SHhaxY','Precio\x20Costo\x20Soles','setItemCommissionPercentage2','PLACAS','Precio\x20Costo\x20Soles\x202','NIU','padStart','KTM','setItemIsBought','Gravado\x20(18%)','Unidad\x20de\x20Medida*','search','Modelo\x20de\x20Manga','HOJA','ID\x20UNIT\x203','PIES\x20CUBICOS','MILIGRAMOS','reduce','PEN_setMtoPrecioCostoUnitario3','Precio\x20Costo\x20Dólares\x203','Rastrear\x20Inventario','BALDE','forEach','LTN','SET','CENTIMETRO\x20LINEAL','parse_date_code','BOLSA','KIT','!ref','ONZAS','Fabricado','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','BOTELLAS','setCodProducto','Unidad\x20de\x20Medida\x203','METRO','SheetNames','setItemUnitAlias','exception','6799660xskbng','find','Alias\x203','setUnidadEquivalencia3','SACO','apply','Procesadas\x20filas\x20','Exportando\x20filas\x20','warn','PAQUETE','return\x20(function()\x20','{}.constructor(\x22return\x20this\x22)(\x20)','MILLON\x20DE\x20UNIDADES','Precio\x20Costo\x20Dólares\x202','setDescripcion','Marca','MWH','setInventariable','setMarca','KWH','setItemDescription','USD_setMtoPrecioUnitario2','Se\x20Vende','Materia\x20Prima','HLT','setItemVariantValues','METRO\x20CUADRADO','Código\x20de\x20Barras\x202','encode_cell','MLT','table','getMonth','Stock\x20Mínimo','Unidad\x20de\x20Medida\x202','message'];_0x537e=function(){return _0x57f22a;};return _0x537e();}function _0x57e3(_0x4af8dd,_0x36fcc6){const _0x1a09ca=_0x537e();return _0x57e3=function(_0x40ff84,_0x28cbba){_0x40ff84=_0x40ff84-0x132;let _0x3705e3=_0x1a09ca[_0x40ff84];return _0x3705e3;},_0x57e3(_0x4af8dd,_0x36fcc6);}const _0x28cbba=(function(){let _0x2e83a2=!![];return function(_0x54f047,_0x22930d){const _0x28a515=_0x2e83a2?function(){const _0x14f08d=_0x57e3;if(_0x22930d){const _0x13406d=_0x22930d[_0x14f08d(0x142)](_0x54f047,arguments);return _0x22930d=null,_0x13406d;}}:function(){};return _0x2e83a2=![],_0x28a515;};}()),_0x40ff84=_0x28cbba(this,function(){const _0x4e39ed=_0x57e3,_0xf449b4=function(){const _0x41472b=_0x57e3;let _0x54f088;try{_0x54f088=Function(_0x41472b(0x147)+_0x41472b(0x148)+');')();}catch(_0xf55e9c){_0x54f088=window;}return _0x54f088;},_0x3c7a79=_0xf449b4(),_0x2b9432=_0x3c7a79['console']=_0x3c7a79[_0x4e39ed(0x1fa)]||{},_0x33ca20=[_0x4e39ed(0x16e),_0x4e39ed(0x145),_0x4e39ed(0x173),_0x4e39ed(0x1c8),_0x4e39ed(0x13c),_0x4e39ed(0x15b),'trace'];for(let _0x4b6fcb=0x0;_0x4b6fcb<_0x33ca20['length'];_0x4b6fcb++){const _0x55f663=_0x28cbba[_0x4e39ed(0x16b)][_0x4e39ed(0x1a2)][_0x4e39ed(0x1fb)](_0x28cbba),_0xb9c2ea=_0x33ca20[_0x4b6fcb],_0x45e292=_0x2b9432[_0xb9c2ea]||_0x55f663;_0x55f663['__proto__']=_0x28cbba[_0x4e39ed(0x1fb)](_0x28cbba),_0x55f663[_0x4e39ed(0x1af)]=_0x45e292['toString'][_0x4e39ed(0x1fb)](_0x45e292),_0x2b9432[_0xb9c2ea]=_0x55f663;}});_0x40ff84(),importScripts(_0x2ab5d4(0x1fd)),onmessage=({data:_0x397085})=>{const _0x38697a=_0x2ab5d4,{action:_0x237f7e}=_0x397085;if(_0x237f7e===_0x38697a(0x1b8)){const {buf:_0x11c9a2,maxRows:_0x411e07}=_0x397085;try{postMessage({'type':_0x38697a(0x20e),'payload':{'percent':0x5,'message':'Iniciando\x20parseo…'}});const _0x544156=XLSX[_0x38697a(0x20d)](_0x11c9a2,{'type':_0x38697a(0x1b7),'cellDates':!![]}),_0x500d11=_0x544156['Sheets'][_0x544156[_0x38697a(0x13a)][0x0]],_0x5e59e1=XLSX['utils'][_0x38697a(0x1f8)](_0x500d11,{'defval':'','range':0x1,'cellDates':!![]}),_0x1a2306=_0x5e59e1[_0x38697a(0x1b3)](_0x5a62df=>(!_0x5a62df['Tipo*']||String(_0x5a62df['Tipo*'])['trim']()==='')&&(!_0x5a62df[_0x38697a(0x183)]||String(_0x5a62df['Código\x20SKU*'])[_0x38697a(0x1cf)]()==='')&&(!_0x5a62df[_0x38697a(0x178)]||String(_0x5a62df[_0x38697a(0x178)])[_0x38697a(0x1cf)]()==='')&&(!_0x5a62df[_0x38697a(0x21f)]||String(_0x5a62df[_0x38697a(0x21f)])[_0x38697a(0x1cf)]()==='')),_0x207cf4=_0x1a2306>=0x0?_0x5e59e1[_0x38697a(0x164)](0x0,_0x1a2306):_0x5e59e1,_0x42456b=_0x207cf4['filter'](_0x2a34ee=>_0x2a34ee[_0x38697a(0x199)]&&String(_0x2a34ee[_0x38697a(0x199)])['trim']()!==''&&_0x2a34ee[_0x38697a(0x183)]&&String(_0x2a34ee[_0x38697a(0x183)])[_0x38697a(0x1cf)]()!==''&&_0x2a34ee[_0x38697a(0x178)]&&String(_0x2a34ee[_0x38697a(0x178)])['trim']()!==''&&_0x2a34ee[_0x38697a(0x21f)]&&String(_0x2a34ee['Unidad\x20de\x20Medida*'])[_0x38697a(0x1cf)]()!==''),_0x88e789=_0x42456b[_0x38697a(0x193)];if(_0x88e789===0x0){postMessage({'type':'error','payload':_0x38697a(0x135)});return;}if(_0x88e789>_0x411e07)throw'El\x20archivo\x20tiene\x20'+_0x88e789+_0x38697a(0x188)+_0x411e07+'.';const _0x4e983a=0x1f4,_0x500cc0=[],_0x48bfac=[{'codigo':'4A','nombre':'BOBINAS'},{'codigo':'BJ','nombre':_0x38697a(0x22a)},{'codigo':_0x38697a(0x1a9),'nombre':_0x38697a(0x161)},{'codigo':'BG','nombre':_0x38697a(0x230)},{'codigo':'BO','nombre':_0x38697a(0x136)},{'codigo':'BX','nombre':_0x38697a(0x211)},{'codigo':'CT','nombre':_0x38697a(0x1bc)},{'codigo':'CMK','nombre':_0x38697a(0x205)},{'codigo':'CMQ','nombre':'CENTIMETRO\x20CUBICO'},{'codigo':'CMT','nombre':_0x38697a(0x22e)},{'codigo':_0x38697a(0x1d1),'nombre':_0x38697a(0x1a3)},{'codigo':'CY','nombre':'CILINDRO'},{'codigo':'CJ','nombre':_0x38697a(0x1f6)},{'codigo':_0x38697a(0x192),'nombre':_0x38697a(0x1d3)},{'codigo':'DZP','nombre':_0x38697a(0x1ea)},{'codigo':'BE','nombre':_0x38697a(0x1b0)},{'codigo':_0x38697a(0x1a6),'nombre':_0x38697a(0x1dc)},{'codigo':_0x38697a(0x1cb),'nombre':'GRAMO'},{'codigo':'GRO','nombre':'GRUESA'},{'codigo':_0x38697a(0x155),'nombre':'HECTOLITRO'},{'codigo':'LEF','nombre':_0x38697a(0x222)},{'codigo':_0x38697a(0x22d),'nombre':_0x38697a(0x1fc)},{'codigo':'KGM','nombre':_0x38697a(0x1df)},{'codigo':_0x38697a(0x21c),'nombre':_0x38697a(0x18d)},{'codigo':_0x38697a(0x150),'nombre':_0x38697a(0x185)},{'codigo':'KT','nombre':_0x38697a(0x231)},{'codigo':'CA','nombre':_0x38697a(0x19b)},{'codigo':'LBR','nombre':_0x38697a(0x176)},{'codigo':_0x38697a(0x1e9),'nombre':'LITRO'},{'codigo':_0x38697a(0x14d),'nombre':'MEGAWATT\x20HORA'},{'codigo':'MTR','nombre':_0x38697a(0x139)},{'codigo':_0x38697a(0x1a4),'nombre':_0x38697a(0x157)},{'codigo':_0x38697a(0x1ec),'nombre':'METRO\x20CUBICO'},{'codigo':_0x38697a(0x201),'nombre':_0x38697a(0x225)},{'codigo':_0x38697a(0x15a),'nombre':_0x38697a(0x1ad)},{'codigo':'MMT','nombre':_0x38697a(0x16f)},{'codigo':_0x38697a(0x169),'nombre':_0x38697a(0x208)},{'codigo':_0x38697a(0x18f),'nombre':_0x38697a(0x160)},{'codigo':'MIL','nombre':_0x38697a(0x1d4)},{'codigo':'UM','nombre':_0x38697a(0x149)},{'codigo':_0x38697a(0x1e5),'nombre':_0x38697a(0x133)},{'codigo':'PF','nombre':_0x38697a(0x1b1)},{'codigo':'PK','nombre':'PAQUETE'},{'codigo':'PR','nombre':'PAR'},{'codigo':_0x38697a(0x1f2),'nombre':_0x38697a(0x1ef)},{'codigo':_0x38697a(0x1a0),'nombre':_0x38697a(0x19f)},{'codigo':_0x38697a(0x1e8),'nombre':_0x38697a(0x224)},{'codigo':_0x38697a(0x19e),'nombre':'PIEZAS'},{'codigo':'PG','nombre':_0x38697a(0x218)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':_0x38697a(0x17d),'nombre':_0x38697a(0x1f4)},{'codigo':'RM','nombre':_0x38697a(0x18c)},{'codigo':'SA','nombre':_0x38697a(0x141)},{'codigo':'DR','nombre':_0x38697a(0x1e4)},{'codigo':'STN','nombre':_0x38697a(0x174)},{'codigo':_0x38697a(0x22c),'nombre':'TONELADA\x20LARGA'},{'codigo':_0x38697a(0x170),'nombre':_0x38697a(0x1f9)},{'codigo':'TU','nombre':_0x38697a(0x1ed)},{'codigo':_0x38697a(0x21a),'nombre':_0x38697a(0x1ee)},{'codigo':'ZZ','nombre':_0x38697a(0x202)},{'codigo':_0x38697a(0x1be),'nombre':_0x38697a(0x1c9)},{'codigo':_0x38697a(0x1e0),'nombre':'YARDA'},{'codigo':'YDK','nombre':_0x38697a(0x200)},{'codigo':'QQM','nombre':_0x38697a(0x196)}],_0x39bbe4=_0x48bfac[_0x38697a(0x226)]((_0x3f31d6,{nombre:_0x56d7fe,codigo:_0x292964})=>{const _0x2f19fd=_0x38697a;return _0x3f31d6[_0x56d7fe[_0x2f19fd(0x1cf)]()]=_0x292964[_0x2f19fd(0x1cf)](),_0x3f31d6;},{});for(let _0x2780f6=0x0;_0x2780f6<_0x88e789;_0x2780f6+=_0x4e983a){const _0x2f2ccf=_0x42456b['slice'](_0x2780f6,_0x2780f6+_0x4e983a)[_0x38697a(0x204)]((_0x48b0e5,_0x25de1c)=>{const _0x59a3af=_0x38697a;let _0x486dfa={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x48b0e5[_0x59a3af(0x199)]]||'1';const _0x29dddf=String(_0x48b0e5['Impuesto*'])[_0x59a3af(0x1cf)](),_0x4dae7c={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x44ef18=_0x4dae7c[_0x29dddf]||'1',_0x224c87={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x44ef18]||{'code':'10','value':0x12},_0x364682={};let _0x50ea7c=String(_0x48b0e5['Nombre*'])['trim']();const _0x3bb7f6=[_0x59a3af(0x1da),'Talla',_0x59a3af(0x186),_0x59a3af(0x168),_0x59a3af(0x17a),_0x59a3af(0x1d5),_0x59a3af(0x1db),_0x59a3af(0x181),_0x59a3af(0x221)];_0x3bb7f6[_0x59a3af(0x22b)](_0x2276be=>{const _0x348bc2=_0x59a3af,_0x595aca=String(_0x48b0e5[_0x2276be]||'')[_0x348bc2(0x1cf)]();_0x595aca&&(_0x364682[_0x2276be]=_0x595aca,_0x50ea7c+='\x20'+_0x2276be+'\x20'+_0x595aca);});const _0x13d7a6=[],_0x5e2459=String(_0x48b0e5[_0x59a3af(0x21f)]||_0x59a3af(0x1ee))[_0x59a3af(0x1cf)](),_0x5ea5f3=_0x39bbe4[_0x5e2459]||_0x59a3af(0x21a),_0x1e9d6e=String(_0x48b0e5[_0x59a3af(0x1d9)])[_0x59a3af(0x1cf)]();_0x13d7a6['push']({'setItemUnitId':String(_0x48b0e5[_0x59a3af(0x17f)])['trim']()||'','setItemBarCode':String(_0x48b0e5[_0x59a3af(0x1a1)])[_0x59a3af(0x1cf)]()||'','setAlias':_0x1e9d6e,'setUnitCode':_0x5ea5f3,'setPrice':parseFloat(_0x48b0e5[_0x59a3af(0x187)]),'setCost':parseFloat(_0x48b0e5[_0x59a3af(0x216)]),'setPriceUSD':parseFloat(_0x48b0e5[_0x59a3af(0x18a)]),'setCostUSD':parseFloat(_0x48b0e5[_0x59a3af(0x214)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x48b0e5['Comisión\x20Venta\x20(%)'])});const _0xe8d10=[_0x59a3af(0x1c4),'Alias\x202',_0x59a3af(0x158),_0x59a3af(0x182),_0x59a3af(0x1d6),_0x59a3af(0x219),_0x59a3af(0x1dd),'Precio\x20Costo\x20Dólares\x202'][_0x59a3af(0x1ab)](_0x284206=>{const _0x4402e7=_0x59a3af,_0x35c5bf=_0x48b0e5[_0x284206];return _0x35c5bf!=null&&String(_0x35c5bf)[_0x4402e7(0x1cf)]()!=='';});if(_0xe8d10){const _0x3a8fe1=String(_0x48b0e5[_0x59a3af(0x15e)]||_0x59a3af(0x206))[_0x59a3af(0x1cf)](),_0x9c719a=_0x39bbe4[_0x3a8fe1]||_0x59a3af(0x21a);_0x13d7a6[_0x59a3af(0x212)]({'setItemUnitId':String(_0x48b0e5[_0x59a3af(0x1c4)])['trim']()||'','setItemBarCode':String(_0x48b0e5[_0x59a3af(0x158)])[_0x59a3af(0x1cf)]()||'','setAlias':String(_0x48b0e5[_0x59a3af(0x1bd)])[_0x59a3af(0x1cf)](),'setUnitCode':_0x9c719a,'setPrice':parseFloat(_0x48b0e5[_0x59a3af(0x1d6)]),'setCost':parseFloat(_0x48b0e5['Precio\x20Costo\x20Soles\x202']),'setPriceUSD':parseFloat(_0x48b0e5['Precio\x20Venta\x20Dólares\x202']),'setCostUSD':parseFloat(_0x48b0e5[_0x59a3af(0x14a)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x48b0e5[_0x59a3af(0x182)])||0x1,'setFactor':parseFloat(_0x48b0e5['Equivalencia\x202'])||0x1,'setItemCommissionPercentage':parseFloat(_0x48b0e5[_0x59a3af(0x1b4)])});}const _0x1d286b=['ID\x20UNIT\x203',_0x59a3af(0x13f),_0x59a3af(0x20b),_0x59a3af(0x17b),_0x59a3af(0x198),'Precio\x20Costo\x20Soles\x203',_0x59a3af(0x18e),_0x59a3af(0x228)]['some'](_0x11471b=>{const _0x39c842=_0x48b0e5[_0x11471b];return _0x39c842!=null&&String(_0x39c842)['trim']()!=='';});if(_0x1d286b){const _0x3668ab=String(_0x48b0e5['Unidad\x20de\x20Medida\x203']||_0x59a3af(0x206))[_0x59a3af(0x1cf)](),_0x29aa34=_0x39bbe4[_0x3668ab]||'NIU';_0x13d7a6[_0x59a3af(0x212)]({'setItemUnitId':String(_0x48b0e5[_0x59a3af(0x223)])[_0x59a3af(0x1cf)]()||'','setItemBarCode':String(_0x48b0e5['Código\x20de\x20Barras\x203'])[_0x59a3af(0x1cf)]()||'','setAlias':String(_0x48b0e5[_0x59a3af(0x13f)])['trim'](),'setUnitCode':_0x29aa34,'setPrice':parseFloat(_0x48b0e5['Precio\x20Venta\x20Soles\x203']),'setCost':parseFloat(_0x48b0e5[_0x59a3af(0x213)]),'setPriceUSD':parseFloat(_0x48b0e5[_0x59a3af(0x18e)]),'setCostUSD':parseFloat(_0x48b0e5['Precio\x20Costo\x20Dólares\x203']),'setDefault':0x0,'setEquivalence':parseFloat(_0x48b0e5['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0x48b0e5[_0x59a3af(0x17b)])||0x1,'setItemCommissionPercentage':parseFloat(_0x48b0e5[_0x59a3af(0x162)])});}let _0x28b0de=_0x48b0e5[_0x59a3af(0x165)],_0x259375='';if(_0x28b0de instanceof Date){const _0x798cd1=_0x28b0de[_0x59a3af(0x1cc)](),_0x77eeb4=String(_0x28b0de[_0x59a3af(0x15c)]()+0x1)[_0x59a3af(0x21b)](0x2,'0'),_0x179171=String(_0x28b0de[_0x59a3af(0x1d7)]())['padStart'](0x2,'0');_0x259375=_0x798cd1+'-'+_0x77eeb4+'-'+_0x179171;}else{if(typeof _0x28b0de==='number'){const _0xa6b5fc=XLSX[_0x59a3af(0x1e6)][_0x59a3af(0x22f)](_0x28b0de);if(_0xa6b5fc){const _0x16d6b=_0xa6b5fc['y'],_0x469b87=String(_0xa6b5fc['m'])[_0x59a3af(0x21b)](0x2,'0'),_0x404198=String(_0xa6b5fc['d'])[_0x59a3af(0x21b)](0x2,'0');_0x259375=_0x16d6b+'-'+_0x469b87+'-'+_0x404198;}}else _0x259375=String(_0x28b0de||'')[_0x59a3af(0x1cf)]();}return{'setItemId':String(_0x48b0e5['ID'])[_0x59a3af(0x1cf)](),'setItemType':_0x486dfa,'setItemCode':String(_0x48b0e5[_0x59a3af(0x183)])['trim'](),'setItemName':String(_0x48b0e5['Nombre*'])[_0x59a3af(0x1cf)](),'setItemDescription':String(_0x48b0e5[_0x59a3af(0x1f3)])['trim']()||'','setItemIsSold':_0x48b0e5[_0x59a3af(0x153)]=='SI'?0x1:0x0,'setItemIsBought':_0x48b0e5['Se\x20Compra']=='SI'?0x1:0x0,'setItemCategories':_0x48b0e5[_0x59a3af(0x179)]?[String(_0x48b0e5['Categoría'])[_0x59a3af(0x1cf)]()]:[],'setItemBrands':_0x48b0e5[_0x59a3af(0x14c)]?[String(_0x48b0e5[_0x59a3af(0x14c)])[_0x59a3af(0x1cf)]()]:[],'setItemTaxId':_0x44ef18,'setItemTaxCode':_0x224c87[_0x59a3af(0x18b)],'setItemTaxValue':_0x224c87['value'],'setItemUnits':_0x13d7a6,'setItemInventoriable':_0x48b0e5['Rastrear\x20Inventario']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x48b0e5['Stock\x20Actual'])||0x0,'setStockMinimum':parseFloat(_0x48b0e5[_0x59a3af(0x15d)])||0x0,'setItemLocation':String(_0x48b0e5[_0x59a3af(0x195)])[_0x59a3af(0x1cf)]()||'','setBatchName':String(_0x48b0e5[_0x59a3af(0x1da)])['trim']()||'','setItemDateExpiry':_0x259375,'setItemVariantName':_0x50ea7c,'setItemVariantValues':_0x364682,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x500cc0['push'](..._0x2f2ccf),postMessage({'type':_0x38697a(0x20e),'payload':{'percent':Math[_0x38697a(0x1bf)]((_0x2780f6+_0x2f2ccf[_0x38697a(0x193)])/_0x88e789*0x64),'message':_0x38697a(0x143)+(_0x2780f6+0x1)+'–'+(_0x2780f6+_0x2f2ccf['length'])+'/'+_0x88e789}});}postMessage({'type':_0x38697a(0x1e2),'payload':{'items':_0x500cc0}});}catch(_0x594764){postMessage({'type':_0x38697a(0x1c8),'payload':_0x594764[_0x38697a(0x15f)]||_0x594764});}}if(_0x237f7e==='exportItems'){const {products:_0x42333c,plantillaBuf:_0x21818b}=_0x397085;if(!(_0x21818b instanceof ArrayBuffer)){postMessage({'type':'error','payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array[_0x38697a(0x1b9)](_0x42333c)){postMessage({'type':_0x38697a(0x1c8),'payload':_0x38697a(0x1b2)});return;}try{structuredClone(_0x42333c);}catch(_0x3b9f4c){postMessage({'type':_0x38697a(0x1c8),'payload':_0x38697a(0x175)+_0x3b9f4c[_0x38697a(0x15f)]});return;}try{const _0x512b7d={'1':_0x38697a(0x19c),'2':_0x38697a(0x209),'3':_0x38697a(0x154),'4':_0x38697a(0x1c6),'5':_0x38697a(0x134)};function _0x5a701b(_0x260f38){const _0x2e245b=_0x38697a;return _0x512b7d[String(_0x260f38)]||_0x2e245b(0x19c);}const _0x443a69={'1':_0x38697a(0x21e),'2':'Exonerado\x20(0%)','3':_0x38697a(0x1d0),'4':_0x38697a(0x1b6),'5':_0x38697a(0x1ce),'6':_0x38697a(0x1fe),'7':_0x38697a(0x1e3),'8':_0x38697a(0x163),'9':_0x38697a(0x184)};function _0x5d1f2b(_0xdde02f){const _0xee3c8c=_0x38697a;return _0x443a69[String(_0xdde02f)]||_0xee3c8c(0x21e);}const _0x4ee1b7={'4A':_0x38697a(0x1eb),'BJ':_0x38697a(0x22a),'BLL':_0x38697a(0x161),'BG':_0x38697a(0x230),'BO':_0x38697a(0x136),'BX':_0x38697a(0x211),'CT':_0x38697a(0x1bc),'CMK':'CENTIMETRO\x20CUADRADO','CMQ':_0x38697a(0x189),'CMT':'CENTIMETRO\x20LINEAL','CEN':_0x38697a(0x1a3),'CY':_0x38697a(0x17c),'CJ':_0x38697a(0x1f6),'DZN':'DOCENA','DZP':_0x38697a(0x1ea),'BE':_0x38697a(0x1b0),'GLI':_0x38697a(0x1dc),'GRM':_0x38697a(0x1e7),'GRO':_0x38697a(0x1f7),'HLT':_0x38697a(0x16d),'LEF':_0x38697a(0x222),'SET':_0x38697a(0x1fc),'KGM':_0x38697a(0x1df),'KTM':_0x38697a(0x18d),'KWH':'KILOVATIO\x20HORA','KT':_0x38697a(0x231),'CA':_0x38697a(0x19b),'LBR':_0x38697a(0x176),'LTR':_0x38697a(0x203),'MWH':_0x38697a(0x1bb),'MTR':_0x38697a(0x139),'MTK':_0x38697a(0x157),'MTQ':_0x38697a(0x166),'MGM':_0x38697a(0x225),'MLT':_0x38697a(0x1ad),'MMT':_0x38697a(0x16f),'MMK':_0x38697a(0x208),'MMQ':_0x38697a(0x160),'MIL':_0x38697a(0x1d4),'UM':_0x38697a(0x149),'ONZ':_0x38697a(0x133),'PF':'PALETAS','PK':_0x38697a(0x146),'PR':'PAR','FOT':_0x38697a(0x1ef),'FTK':_0x38697a(0x19f),'FTQ':_0x38697a(0x224),'C62':'PIEZAS','PG':_0x38697a(0x218),'ST':'PLIEGO','INH':'PULGADAS','RM':_0x38697a(0x18c),'SA':_0x38697a(0x141),'DR':_0x38697a(0x1e4),'STN':_0x38697a(0x174),'LTN':_0x38697a(0x1a7),'TNE':_0x38697a(0x1f9),'TU':_0x38697a(0x1ed),'NIU':_0x38697a(0x1ee),'ZZ':_0x38697a(0x202),'GLL':_0x38697a(0x1c9),'YRD':_0x38697a(0x1c0),'YDK':_0x38697a(0x200),'QQM':'QUINTAL'};function _0x5c56eb(_0x4a5601){return _0x4ee1b7[String(_0x4a5601)]||'';}const _0x190d77=XLSX[_0x38697a(0x20d)](_0x21818b,{'type':_0x38697a(0x1b7),'cellDates':!![]}),_0x150e56=_0x190d77['SheetNames'][0x0],_0xb33e72=_0x190d77[_0x38697a(0x1ac)][_0x150e56],_0x5e3d05=XLSX[_0x38697a(0x1c2)][_0x38697a(0x1f8)](_0xb33e72,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x267d6e=XLSX[_0x38697a(0x1c2)][_0x38697a(0x1ff)](_0xb33e72[_0x38697a(0x132)]||'');for(let _0x37b29b=0x2;_0x37b29b<=_0x267d6e['e']['r'];++_0x37b29b){for(let _0x4be116=_0x267d6e['s']['c'];_0x4be116<=_0x267d6e['e']['c'];++_0x4be116){const _0x4888ba=XLSX[_0x38697a(0x1c2)][_0x38697a(0x159)]({'r':_0x37b29b,'c':_0x4be116});if(_0xb33e72[_0x4888ba])delete _0xb33e72[_0x4888ba];}}const _0x2671df=_0x42333c[_0x38697a(0x204)](_0x206a13=>{const _0x215a66=_0x38697a;_0x206a13[_0x215a66(0x156)]=_0x206a13['setItemVariantValues']||{};const _0x5e72d8={};return _0x5e3d05['forEach'](_0xc7fc2a=>{const _0x348bcd=_0x215a66,_0x363690=String(_0xc7fc2a)[_0x348bcd(0x1cf)](),_0x3c543e=_0x363690['toLowerCase'](),_0x1e44eb=Object['keys'](_0x206a13)[_0x348bcd(0x13e)](_0x29e934=>_0x29e934['trim']()[_0x348bcd(0x19a)]()===_0x3c543e);if(_0x1e44eb){_0x5e72d8[_0x363690]=_0x206a13[_0x1e44eb]??'';return;}switch(_0x363690){case'ID':_0x5e72d8[_0x363690]=_0x206a13['id']??'';break;case _0x348bcd(0x199):_0x5e72d8[_0x363690]=_0x5a701b(_0x206a13[_0x348bcd(0x1a5)]);break;case _0x348bcd(0x183):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x137)]??'';break;case _0x348bcd(0x178):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x14b)]??'';break;case'Descripción':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x151)]??'';break;case _0x348bcd(0x153):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x194)]==0x1?'SI':'NO';break;case _0x348bcd(0x191):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x21d)]==0x1?'SI':'NO';break;case _0x348bcd(0x179):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x17e)]??'';break;case _0x348bcd(0x14c):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x14f)]??'';break;case _0x348bcd(0x190):_0x5e72d8[_0x363690]=_0x5d1f2b(_0x206a13[_0x348bcd(0x180)]);break;case _0x348bcd(0x17f):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1a8)]??'';break;case _0x348bcd(0x1d9):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x13b)]??'';break;case _0x348bcd(0x1a1):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1cd)]??'';break;case _0x348bcd(0x21f):_0x5e72d8[_0x363690]=_0x5c56eb(_0x206a13['setUnidadCodigo']);break;case _0x348bcd(0x187):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1f1)]??'';break;case _0x348bcd(0x216):_0x5e72d8[_0x363690]=_0x206a13['PEN_setMtoPrecioCostoUnitario']??'';break;case _0x348bcd(0x18a):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1aa)]??'';break;case'Precio\x20Costo\x20Dólares':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1c3)]??'';break;case'Comisión\x20Venta\x20(%)':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1c5)];break;case _0x348bcd(0x1c4):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x16a)]??'';break;case _0x348bcd(0x1bd):_0x5e72d8[_0x363690]=_0x206a13['setItemUnitAlias2']??'';break;case'Código\x20de\x20Barras\x202':_0x5e72d8[_0x363690]=_0x206a13['setItemBarCode2']??'';break;case _0x348bcd(0x15e):_0x5e72d8[_0x363690]=_0x5c56eb(_0x206a13['setUnidadCodigo2']);break;case _0x348bcd(0x182):_0x5e72d8[_0x363690]=_0x206a13['setUnidadEquivalencia2']??'1';break;case'Precio\x20Venta\x20Soles\x202':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x20a)]??'';break;case _0x348bcd(0x219):_0x5e72d8[_0x363690]=_0x206a13['PEN_setMtoPrecioCostoUnitario2']??'';break;case _0x348bcd(0x1dd):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x152)]??'';break;case _0x348bcd(0x14a):_0x5e72d8[_0x363690]=_0x206a13['USD_setMtoPrecioCostoUnitario2']??'';break;case'Comisión\x20Venta\x202\x20(%)':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x217)];break;case'ID\x20UNIT\x203':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x177)]??'';break;case _0x348bcd(0x13f):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1f5)]??'';break;case'Código\x20de\x20Barras\x203':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x210)]??'';break;case _0x348bcd(0x138):_0x5e72d8[_0x363690]=_0x5c56eb(_0x206a13[_0x348bcd(0x1de)]);break;case _0x348bcd(0x17b):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x140)]??'1';break;case _0x348bcd(0x198):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x20c)]??'';break;case'Precio\x20Costo\x20Soles\x203':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x227)]??'';break;case _0x348bcd(0x18e):_0x5e72d8[_0x363690]=_0x206a13['USD_setMtoPrecioUnitario3']??'';break;case _0x348bcd(0x228):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1d2)]??'';break;case _0x348bcd(0x162):_0x5e72d8[_0x363690]=_0x206a13['setItemCommissionPercentage3'];break;case _0x348bcd(0x229):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x14e)]==0x1?'SI':'NO';break;case'Stock\x20Actual':_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x1f0)]??'';break;case _0x348bcd(0x15d):_0x5e72d8[_0x363690]=_0x206a13[_0x348bcd(0x171)]??'';break;case _0x348bcd(0x165):_0x5e72d8[_0x363690]=_0x206a13['setBatchExpirationDate']??'';break;default:_0x5e72d8[_0x363690]='';}}),_0x5e72d8;}),_0x2d7f47=0x3e8,_0x2a198f=_0x2671df['length'];for(let _0x44891d=0x0;_0x44891d<_0x2a198f;_0x44891d+=_0x2d7f47){const _0x138fd1=_0x2671df[_0x38697a(0x164)](_0x44891d,_0x44891d+_0x2d7f47);XLSX[_0x38697a(0x1c2)][_0x38697a(0x197)](_0xb33e72,_0x138fd1,{'origin':{'r':_0x44891d+0x2,'c':0x0},'skipHeader':!![],'header':_0x5e3d05}),postMessage({'type':_0x38697a(0x20e),'payload':{'percent':Math['round']((_0x44891d+_0x138fd1[_0x38697a(0x193)])/_0x2a198f*0x64),'message':_0x38697a(0x144)+(_0x44891d+0x1)+'–'+(_0x44891d+_0x138fd1['length'])+_0x38697a(0x16c)+_0x2a198f}});}const _0x543e89={'s':{'r':0x0,'c':0x0},'e':{'r':_0x2a198f+0x1,'c':_0x5e3d05[_0x38697a(0x193)]-0x1}};_0xb33e72['!ref']=XLSX['utils'][_0x38697a(0x1c1)](_0x543e89);const _0x45f4ed=XLSX['write'](_0x190d77,{'bookType':_0x38697a(0x1ba),'type':'array'});let _0x32ff0e,_0x323c7a;if(_0x45f4ed instanceof Uint8Array)_0x32ff0e=_0x45f4ed,_0x323c7a=[_0x45f4ed[_0x38697a(0x19d)]];else{if(_0x45f4ed instanceof ArrayBuffer)_0x32ff0e=new Uint8Array(_0x45f4ed),_0x323c7a=[_0x45f4ed];else{const _0x17e4cb=new Uint8Array(_0x45f4ed);_0x32ff0e=_0x17e4cb,_0x323c7a=[_0x17e4cb[_0x38697a(0x19d)]];}}postMessage({'type':_0x38697a(0x1e1),'payload':{'wbout':_0x32ff0e,'count':_0x2671df[_0x38697a(0x193)]}},_0x323c7a);}catch(_0x5430cd){postMessage({'type':_0x38697a(0x1c8),'payload':_0x5430cd[_0x38697a(0x15f)]||String(_0x5430cd)});}return;}};