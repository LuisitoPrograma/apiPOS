/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 5.1.0
*/

function _0x4693(_0x3113d1,_0x5edc08){const _0xf2f0d=_0x15bf();return _0x4693=function(_0x770276,_0x275ecf){_0x770276=_0x770276-0x17c;let _0xd453d9=_0xf2f0d[_0x770276];return _0xd453d9;},_0x4693(_0x3113d1,_0x5edc08);}const _0x55b79b=_0x4693;(function(_0xec00b,_0x4b02d5){const _0x49b9fb=_0x4693,_0x57e69a=_0xec00b();while(!![]){try{const _0x554f53=-parseInt(_0x49b9fb(0x200))/0x1+parseInt(_0x49b9fb(0x224))/0x2+parseInt(_0x49b9fb(0x17d))/0x3+parseInt(_0x49b9fb(0x1ba))/0x4*(parseInt(_0x49b9fb(0x191))/0x5)+-parseInt(_0x49b9fb(0x24b))/0x6*(-parseInt(_0x49b9fb(0x1dc))/0x7)+parseInt(_0x49b9fb(0x1a1))/0x8*(parseInt(_0x49b9fb(0x1c9))/0x9)+-parseInt(_0x49b9fb(0x18c))/0xa;if(_0x554f53===_0x4b02d5)break;else _0x57e69a['push'](_0x57e69a['shift']());}catch(_0x2a0078){_0x57e69a['push'](_0x57e69a['shift']());}}}(_0x15bf,0x7e142));const _0xee254d=(function(){let _0x4442d6=!![];return function(_0x9c0121,_0x2dc80f){const _0x8b873=_0x4442d6?function(){const _0x2975da=_0x4693;if(_0x2dc80f){const _0x2797d3=_0x2dc80f[_0x2975da(0x20f)](_0x9c0121,arguments);return _0x2dc80f=null,_0x2797d3;}}:function(){};return _0x4442d6=![],_0x8b873;};}()),_0x14eae8=_0xee254d(this,function(){const _0x42be41=_0x4693;return _0x14eae8[_0x42be41(0x1d1)]()[_0x42be41(0x223)]('(((.+)+)+)+$')[_0x42be41(0x1d1)]()['constructor'](_0x14eae8)['search'](_0x42be41(0x1e1));});function _0x15bf(){const _0x454f35=['padStart','LATAS','exportItems:\x20products\x20no\x20es\x20Array.','PEN_setMtoPrecioCostoUnitario2','MILILITRO','Precio\x20Costo\x20Dólares\x203','FTQ','LBR','142983scCHMN','STN','TAMBOR','GLI','Comisión\x20Venta\x202\x20(%)','progress','Fecha\x20de\x20Vencimiento','setItemCommissionPercentage2','toString','Stock\x20Mínimo','Artículo','Modelo\x20de\x20Manga','PEN_setMtoPrecioUnitario3','PAQUETE','array','reduce','\x20de\x20','MTQ','KIT','77fElDGB','Marca','DZP','GRUESA','C62','(((.+)+)+)+$','Precio\x20Venta\x20Soles\x202','setItemUnitAlias3','Sheets','RESMA','find','Precio\x20Costo\x20Soles','GLL','Precio\x20Venta\x20Dólares\x203','Stock\x20Actual','Se\x20Compra','QQM','setSucursalStock','Precio\x20Venta\x20Soles','ID\x20UNIT\x203','MILLARES','LITRO','Combo','GRO','GRAMO','DOCENA','PIES','Unidad\x20de\x20Medida*','Servicio','exportDone','setItemDescription','setMarca','YDK','setTaxId','Código\x20SKU*','CMQ','1004038GCRdng','Alias\x202','setDescripcion','CENTIMETRO\x20LINEAL','CMT','PLACAS','done','Precio\x20Venta\x20Soles\x203','setUnidadCodigo','JUEGO','LIBRAS','Comisión\x20Venta\x20(%)','Equivalencia\x202','BOTELLAS','MILIMETRO\x20CUADRADO','apply','PIES\x20CUBICOS','YARDA','setUnitId','PEN_setMtoPrecioUnitario2','keys','PALETAS','Inafecto\x20(0%)','TONELADA\x20LARGA','CENTIMETRO\x20CUBICO','some','HOJA','return\x20(function()\x20','KILOMETRO','GRM','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','Tipo*','push','setItemBarCode','MEGAWATT\x20HORA','search','1310328nAZiTa','log','filter','warn','MILIMETRO','utils','trim','Talla','PEN_setMtoPrecioCostoUnitario3','error','Gravado\x20Gratuito\x20(10%)','USD_setMtoPrecioUnitario','Impuesto*','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','FTK','El\x20archivo\x20tiene\x20','setUnidadEquivalencia2','ID\x20UNIT\x202','PLIEGO','Precio\x20Venta\x20Dólares\x202','MILIGRAMOS','Código\x20de\x20Barras','isArray','Gravado\x20(10%)','setInventariable','USD_setMtoPrecioUnitario2','BLL','Precio\x20Costo\x20Dólares','METRO\x20CUBICO','bind','Exportando\x20filas\x20','CONOS','KILOVATIO\x20HORA','USD_setMtoPrecioCostoUnitario3','length','map','parse_date_code','Color','setCodProducto','132834ydKCNZ','SSF','CAJA','xlsx','Modelo\x20de\x20Cuello','BARRILES','METRO\x20CUADRADO','Material','ONZ','BOBINAS','findIndex','getDate','code','encode_cell','QUINTAL','Serie','forEach','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','MTR','setUnitId2','ID\x20UNIT','LTN','TONELADAS','setItemIsBought','CARTONES','console','TUBOS','DOCENA\x20POR\x2010**6','Lote','Género','USD_setMtoPrecioCostoUnitario','KWH','setItemIsSold','value','Procesadas\x20filas\x20','toLowerCase','UND\x20(NIU)','__proto__','TONELADA\x20CORTA','prototype','Descripción','Precio\x20Costo\x20Dólares\x202','INH','900747sMNTdc','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','PIEZAS','Se\x20Vende','Exonerado\x20Gratuito\x20(0%)','Precio\x20Costo\x20Soles\x203','message','setItemBarCode3','getMonth','Equivalencia\x203','constructor','{}.constructor(\x22return\x20this\x22)(\x20)','Código\x20de\x20Barras\x203','Nombre*','Código\x20de\x20Barras\x202','5028890NRRcJB','LTR','encode_range','Fabricado','Unidad\x20de\x20Medida\x203','67160LQeCik','Exportación\x20(0%)','MLT','MILLON\x20DE\x20UNIDADES','setItemBarCode2','Comisión\x20Venta\x203\x20(%)','US\x20GALON\x20(3,7843\x20L)','Precio\x20Costo\x20Soles\x202','MWH','setUnidadEquivalencia3','TNE','Rastrear\x20Inventario','setItemType','exportItems:\x20productos\x20no\x20clonables:\x20','YRD','Alias\x203','104xZUVbA','BOLSA','!ref','PULGADAS','Ubicación','setItemCommissionPercentage','setItemVariantValues','NIU','HLT','round','PEN_setMtoPrecioCostoUnitario','Categoría','Precio\x20Venta\x20Dólares','YARDA\x20CUADRADA','number','CENTIMETRO\x20CUADRADO','sheet_add_json','UNIDAD\x20(ZZ)','CILINDRO','DZN','slice','GALON\x20INGLES\x20(4,545956L)','MGM','table','SACO','184Zodlgj','sheet_to_json','FARDO','LEF','Alias','Unidad\x20de\x20Medida\x202','CIENTO\x20DE\x20UNIDADES'];_0x15bf=function(){return _0x454f35;};return _0x15bf();}_0x14eae8();const _0x275ecf=(function(){let _0x55e489=!![];return function(_0x20827b,_0x4b88d1){const _0x196f5a=_0x55e489?function(){const _0x5807e7=_0x4693;if(_0x4b88d1){const _0x4f31c8=_0x4b88d1[_0x5807e7(0x20f)](_0x20827b,arguments);return _0x4b88d1=null,_0x4f31c8;}}:function(){};return _0x55e489=![],_0x196f5a;};}()),_0x770276=_0x275ecf(this,function(){const _0x5b0cd5=_0x4693;let _0x4c5135;try{const _0x26b248=Function(_0x5b0cd5(0x21b)+_0x5b0cd5(0x188)+');');_0x4c5135=_0x26b248();}catch(_0x43d30b){_0x4c5135=window;}const _0x1fc789=_0x4c5135[_0x5b0cd5(0x264)]=_0x4c5135[_0x5b0cd5(0x264)]||{},_0x890273=[_0x5b0cd5(0x225),_0x5b0cd5(0x227),'info',_0x5b0cd5(0x22d),'exception',_0x5b0cd5(0x1b8),'trace'];for(let _0x586256=0x0;_0x586256<_0x890273[_0x5b0cd5(0x246)];_0x586256++){const _0x29af28=_0x275ecf[_0x5b0cd5(0x187)][_0x5b0cd5(0x272)][_0x5b0cd5(0x241)](_0x275ecf),_0xa34518=_0x890273[_0x586256],_0x2aebe5=_0x1fc789[_0xa34518]||_0x29af28;_0x29af28[_0x5b0cd5(0x270)]=_0x275ecf[_0x5b0cd5(0x241)](_0x275ecf),_0x29af28[_0x5b0cd5(0x1d1)]=_0x2aebe5[_0x5b0cd5(0x1d1)][_0x5b0cd5(0x241)](_0x2aebe5),_0x1fc789[_0xa34518]=_0x29af28;}});_0x770276(),importScripts(_0x55b79b(0x25c)),onmessage=({data:_0x4b732b})=>{const _0x4b975d=_0x55b79b,{action:_0x3c305a}=_0x4b732b;if(_0x3c305a==='import'){const {buf:_0xa1b136,maxRows:_0x4a146c}=_0x4b732b;try{postMessage({'type':_0x4b975d(0x1ce),'payload':{'percent':0x5,'message':'Iniciando\x20parseo…'}});const _0x929575=XLSX['read'](_0xa1b136,{'type':'array','cellDates':!![]}),_0x3e192d=_0x929575['Sheets'][_0x929575['SheetNames'][0x0]],_0x5a0adc=XLSX[_0x4b975d(0x229)][_0x4b975d(0x1bb)](_0x3e192d,{'defval':'','range':0x1,'cellDates':!![]}),_0x283147=_0x5a0adc[_0x4b975d(0x255)](_0xf9b11c=>(!_0xf9b11c[_0x4b975d(0x21f)]||String(_0xf9b11c[_0x4b975d(0x21f)])[_0x4b975d(0x22a)]()==='')&&(!_0xf9b11c[_0x4b975d(0x1fe)]||String(_0xf9b11c[_0x4b975d(0x1fe)])[_0x4b975d(0x22a)]()==='')&&(!_0xf9b11c[_0x4b975d(0x18a)]||String(_0xf9b11c[_0x4b975d(0x18a)])['trim']()==='')&&(!_0xf9b11c[_0x4b975d(0x1f7)]||String(_0xf9b11c[_0x4b975d(0x1f7)])[_0x4b975d(0x22a)]()==='')),_0x55546b=_0x283147>=0x0?_0x5a0adc[_0x4b975d(0x1b5)](0x0,_0x283147):_0x5a0adc,_0x2aadae=_0x55546b[_0x4b975d(0x226)](_0xd4ab80=>_0xd4ab80[_0x4b975d(0x21f)]&&String(_0xd4ab80[_0x4b975d(0x21f)])[_0x4b975d(0x22a)]()!==''&&_0xd4ab80[_0x4b975d(0x1fe)]&&String(_0xd4ab80[_0x4b975d(0x1fe)])['trim']()!==''&&_0xd4ab80[_0x4b975d(0x18a)]&&String(_0xd4ab80[_0x4b975d(0x18a)])[_0x4b975d(0x22a)]()!==''&&_0xd4ab80['Unidad\x20de\x20Medida*']&&String(_0xd4ab80['Unidad\x20de\x20Medida*'])[_0x4b975d(0x22a)]()!==''),_0x417c8d=_0x2aadae[_0x4b975d(0x246)];if(_0x417c8d===0x0){postMessage({'type':'error','payload':_0x4b975d(0x231)});return;}if(_0x417c8d>_0x4a146c)throw _0x4b975d(0x233)+_0x417c8d+_0x4b975d(0x17e)+_0x4a146c+'.';const _0x39fbb4=0x1f4,_0x582784=[],_0x2606df=[{'codigo':'4A','nombre':_0x4b975d(0x254)},{'codigo':'BJ','nombre':'BALDE'},{'codigo':_0x4b975d(0x23e),'nombre':_0x4b975d(0x250)},{'codigo':'BG','nombre':_0x4b975d(0x1a2)},{'codigo':'BO','nombre':_0x4b975d(0x20d)},{'codigo':'BX','nombre':_0x4b975d(0x24d)},{'codigo':'CT','nombre':_0x4b975d(0x263)},{'codigo':'CMK','nombre':_0x4b975d(0x1b0)},{'codigo':_0x4b975d(0x1ff),'nombre':_0x4b975d(0x218)},{'codigo':_0x4b975d(0x204),'nombre':_0x4b975d(0x203)},{'codigo':'CEN','nombre':_0x4b975d(0x1c0)},{'codigo':'CY','nombre':_0x4b975d(0x1b3)},{'codigo':'CJ','nombre':_0x4b975d(0x243)},{'codigo':_0x4b975d(0x1b4),'nombre':_0x4b975d(0x1f5)},{'codigo':_0x4b975d(0x1de),'nombre':'DOCENA\x20POR\x2010**6'},{'codigo':'BE','nombre':_0x4b975d(0x1bc)},{'codigo':_0x4b975d(0x1cc),'nombre':_0x4b975d(0x1b6)},{'codigo':_0x4b975d(0x21d),'nombre':_0x4b975d(0x1f4)},{'codigo':_0x4b975d(0x1f3),'nombre':_0x4b975d(0x1df)},{'codigo':_0x4b975d(0x1a9),'nombre':'HECTOLITRO'},{'codigo':_0x4b975d(0x1bd),'nombre':_0x4b975d(0x21a)},{'codigo':'SET','nombre':_0x4b975d(0x209)},{'codigo':'KGM','nombre':'KILOGRAMO'},{'codigo':'KTM','nombre':_0x4b975d(0x21c)},{'codigo':_0x4b975d(0x26a),'nombre':_0x4b975d(0x244)},{'codigo':'KT','nombre':_0x4b975d(0x1db)},{'codigo':'CA','nombre':_0x4b975d(0x1c2)},{'codigo':_0x4b975d(0x1c8),'nombre':_0x4b975d(0x20a)},{'codigo':_0x4b975d(0x18d),'nombre':_0x4b975d(0x1f1)},{'codigo':_0x4b975d(0x199),'nombre':_0x4b975d(0x222)},{'codigo':_0x4b975d(0x25d),'nombre':'METRO'},{'codigo':'MTK','nombre':_0x4b975d(0x251)},{'codigo':_0x4b975d(0x1da),'nombre':_0x4b975d(0x240)},{'codigo':_0x4b975d(0x1b7),'nombre':_0x4b975d(0x238)},{'codigo':_0x4b975d(0x193),'nombre':_0x4b975d(0x1c5)},{'codigo':'MMT','nombre':_0x4b975d(0x228)},{'codigo':'MMK','nombre':_0x4b975d(0x20e)},{'codigo':'MMQ','nombre':'MILIMETRO\x20CUBICO'},{'codigo':'MIL','nombre':_0x4b975d(0x1f0)},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':_0x4b975d(0x253),'nombre':'ONZAS'},{'codigo':'PF','nombre':_0x4b975d(0x215)},{'codigo':'PK','nombre':'PAQUETE'},{'codigo':'PR','nombre':'PAR'},{'codigo':'FOT','nombre':_0x4b975d(0x1f6)},{'codigo':_0x4b975d(0x232),'nombre':'PIES\x20CUADRADOS'},{'codigo':_0x4b975d(0x1c7),'nombre':_0x4b975d(0x210)},{'codigo':_0x4b975d(0x1e0),'nombre':_0x4b975d(0x17f)},{'codigo':'PG','nombre':_0x4b975d(0x205)},{'codigo':'ST','nombre':_0x4b975d(0x236)},{'codigo':_0x4b975d(0x17c),'nombre':_0x4b975d(0x1a4)},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':_0x4b975d(0x1b9)},{'codigo':'DR','nombre':_0x4b975d(0x1cb)},{'codigo':_0x4b975d(0x1ca),'nombre':_0x4b975d(0x271)},{'codigo':_0x4b975d(0x260),'nombre':_0x4b975d(0x217)},{'codigo':_0x4b975d(0x19b),'nombre':'TONELADAS'},{'codigo':'TU','nombre':_0x4b975d(0x265)},{'codigo':_0x4b975d(0x1a8),'nombre':'UNIDAD\x20(NIU)'},{'codigo':'ZZ','nombre':_0x4b975d(0x1b2)},{'codigo':_0x4b975d(0x1e8),'nombre':'US\x20GALON\x20(3,7843\x20L)'},{'codigo':_0x4b975d(0x19f),'nombre':_0x4b975d(0x211)},{'codigo':_0x4b975d(0x1fc),'nombre':_0x4b975d(0x1ae)},{'codigo':_0x4b975d(0x1ec),'nombre':_0x4b975d(0x259)}],_0x33801b=_0x2606df[_0x4b975d(0x1d8)]((_0xfbda20,{nombre:_0x543c37,codigo:_0x24ba98})=>{const _0x783d86=_0x4b975d;return _0xfbda20[_0x543c37['trim']()]=_0x24ba98[_0x783d86(0x22a)](),_0xfbda20;},{});for(let _0x444230=0x0;_0x444230<_0x417c8d;_0x444230+=_0x39fbb4){const _0x2d8b86=_0x2aadae[_0x4b975d(0x1b5)](_0x444230,_0x444230+_0x39fbb4)[_0x4b975d(0x247)]((_0x43390c,_0x744496)=>{const _0x4280fe=_0x4b975d;let _0x4d958a={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x43390c[_0x4280fe(0x21f)]]||'1';const _0x4cfba7=String(_0x43390c[_0x4280fe(0x230)])[_0x4280fe(0x22a)](),_0xcdff8e={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0xbc31c3=_0xcdff8e[_0x4cfba7]||'1',_0x25241d={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0xbc31c3]||{'code':'10','value':0x12},_0x402e8c={};let _0xf57c47=String(_0x43390c[_0x4280fe(0x18a)])[_0x4280fe(0x22a)]();const _0x12cc38=[_0x4280fe(0x267),_0x4280fe(0x22b),_0x4280fe(0x249),_0x4280fe(0x268),'Modelo',_0x4280fe(0x25a),_0x4280fe(0x252),_0x4280fe(0x24f),_0x4280fe(0x1d4)];_0x12cc38[_0x4280fe(0x25b)](_0x16c2a6=>{const _0x308a63=_0x4280fe,_0x2ddcb2=String(_0x43390c[_0x16c2a6]||'')[_0x308a63(0x22a)]();_0x2ddcb2&&(_0x402e8c[_0x16c2a6]=_0x2ddcb2,_0xf57c47+='\x20'+_0x16c2a6+'\x20'+_0x2ddcb2);});const _0x1a696e=[],_0x129976=String(_0x43390c['Unidad\x20de\x20Medida*']||'UNIDAD\x20(NIU)')[_0x4280fe(0x22a)](),_0xb5b692=_0x33801b[_0x129976]||_0x4280fe(0x1a8),_0x3565a1=String(_0x43390c[_0x4280fe(0x1be)])['trim']();_0x1a696e[_0x4280fe(0x220)]({'setItemUnitId':String(_0x43390c[_0x4280fe(0x25f)])[_0x4280fe(0x22a)]()||'','setItemBarCode':String(_0x43390c[_0x4280fe(0x239)])[_0x4280fe(0x22a)]()||'','setAlias':_0x3565a1,'setUnitCode':_0xb5b692,'setPrice':parseFloat(_0x43390c[_0x4280fe(0x1ee)]),'setCost':parseFloat(_0x43390c[_0x4280fe(0x1e7)]),'setPriceUSD':parseFloat(_0x43390c[_0x4280fe(0x1ad)]),'setCostUSD':parseFloat(_0x43390c[_0x4280fe(0x23f)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x43390c[_0x4280fe(0x20b)])});const _0x3701e1=[_0x4280fe(0x235),_0x4280fe(0x201),_0x4280fe(0x18b),_0x4280fe(0x20c),_0x4280fe(0x1e2),_0x4280fe(0x198),_0x4280fe(0x237),'Precio\x20Costo\x20Dólares\x202'][_0x4280fe(0x219)](_0x150b82=>{const _0x246754=_0x4280fe,_0x29685c=_0x43390c[_0x150b82];return _0x29685c!=null&&String(_0x29685c)[_0x246754(0x22a)]()!=='';});if(_0x3701e1){const _0x58a13f=String(_0x43390c[_0x4280fe(0x1bf)]||_0x4280fe(0x26f))[_0x4280fe(0x22a)](),_0x1e1ffa=_0x33801b[_0x58a13f]||_0x4280fe(0x1a8);_0x1a696e['push']({'setItemUnitId':String(_0x43390c[_0x4280fe(0x235)])['trim']()||'','setItemBarCode':String(_0x43390c[_0x4280fe(0x18b)])[_0x4280fe(0x22a)]()||'','setAlias':String(_0x43390c[_0x4280fe(0x201)])[_0x4280fe(0x22a)](),'setUnitCode':_0x1e1ffa,'setPrice':parseFloat(_0x43390c['Precio\x20Venta\x20Soles\x202']),'setCost':parseFloat(_0x43390c[_0x4280fe(0x198)]),'setPriceUSD':parseFloat(_0x43390c[_0x4280fe(0x237)]),'setCostUSD':parseFloat(_0x43390c[_0x4280fe(0x274)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x43390c[_0x4280fe(0x20c)])||0x1,'setFactor':parseFloat(_0x43390c['Equivalencia\x202'])||0x1,'setItemCommissionPercentage':parseFloat(_0x43390c['Comisión\x20Venta\x202\x20(%)'])});}const _0x5319f1=[_0x4280fe(0x1ef),_0x4280fe(0x1a0),_0x4280fe(0x189),'Equivalencia\x203',_0x4280fe(0x207),'Precio\x20Costo\x20Soles\x203','Precio\x20Venta\x20Dólares\x203',_0x4280fe(0x1c6)][_0x4280fe(0x219)](_0x8ce7eb=>{const _0x10cb67=_0x4280fe,_0x17b312=_0x43390c[_0x8ce7eb];return _0x17b312!=null&&String(_0x17b312)[_0x10cb67(0x22a)]()!=='';});if(_0x5319f1){const _0x5cab34=String(_0x43390c[_0x4280fe(0x190)]||_0x4280fe(0x26f))[_0x4280fe(0x22a)](),_0x212cd6=_0x33801b[_0x5cab34]||_0x4280fe(0x1a8);_0x1a696e[_0x4280fe(0x220)]({'setItemUnitId':String(_0x43390c[_0x4280fe(0x1ef)])['trim']()||'','setItemBarCode':String(_0x43390c[_0x4280fe(0x189)])[_0x4280fe(0x22a)]()||'','setAlias':String(_0x43390c[_0x4280fe(0x1a0)])['trim'](),'setUnitCode':_0x212cd6,'setPrice':parseFloat(_0x43390c[_0x4280fe(0x207)]),'setCost':parseFloat(_0x43390c[_0x4280fe(0x182)]),'setPriceUSD':parseFloat(_0x43390c[_0x4280fe(0x1e9)]),'setCostUSD':parseFloat(_0x43390c['Precio\x20Costo\x20Dólares\x203']),'setDefault':0x0,'setEquivalence':parseFloat(_0x43390c[_0x4280fe(0x186)])||0x1,'setFactor':parseFloat(_0x43390c[_0x4280fe(0x186)])||0x1,'setItemCommissionPercentage':parseFloat(_0x43390c[_0x4280fe(0x196)])});}let _0x535552=_0x43390c[_0x4280fe(0x1cf)],_0x28bcb3='';if(_0x535552 instanceof Date){const _0x1d8fb1=_0x535552['getFullYear'](),_0xc2b675=String(_0x535552[_0x4280fe(0x185)]()+0x1)['padStart'](0x2,'0'),_0x2da28a=String(_0x535552[_0x4280fe(0x256)]())['padStart'](0x2,'0');_0x28bcb3=_0x1d8fb1+'-'+_0xc2b675+'-'+_0x2da28a;}else{if(typeof _0x535552===_0x4280fe(0x1af)){const _0x4ff478=XLSX[_0x4280fe(0x24c)][_0x4280fe(0x248)](_0x535552);if(_0x4ff478){const _0x27fe3f=_0x4ff478['y'],_0xd93076=String(_0x4ff478['m'])[_0x4280fe(0x1c1)](0x2,'0'),_0x5a5e7f=String(_0x4ff478['d'])['padStart'](0x2,'0');_0x28bcb3=_0x27fe3f+'-'+_0xd93076+'-'+_0x5a5e7f;}}else _0x28bcb3=String(_0x535552||'')['trim']();}return{'setItemId':String(_0x43390c['ID'])['trim'](),'setItemType':_0x4d958a,'setItemCode':String(_0x43390c[_0x4280fe(0x1fe)])[_0x4280fe(0x22a)](),'setItemName':String(_0x43390c[_0x4280fe(0x18a)])[_0x4280fe(0x22a)](),'setItemDescription':String(_0x43390c[_0x4280fe(0x273)])['trim']()||'','setItemIsSold':_0x43390c[_0x4280fe(0x180)]=='SI'?0x1:0x0,'setItemIsBought':_0x43390c[_0x4280fe(0x1eb)]=='SI'?0x1:0x0,'setItemCategories':_0x43390c['Categoría']?[String(_0x43390c['Categoría'])[_0x4280fe(0x22a)]()]:[],'setItemBrands':_0x43390c[_0x4280fe(0x1dd)]?[String(_0x43390c['Marca'])[_0x4280fe(0x22a)]()]:[],'setItemTaxId':_0xbc31c3,'setItemTaxCode':_0x25241d[_0x4280fe(0x257)],'setItemTaxValue':_0x25241d[_0x4280fe(0x26c)],'setItemUnits':_0x1a696e,'setItemInventoriable':_0x43390c[_0x4280fe(0x19c)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x43390c[_0x4280fe(0x1ea)])||0x0,'setStockMinimum':parseFloat(_0x43390c[_0x4280fe(0x1d2)])||0x0,'setItemLocation':String(_0x43390c[_0x4280fe(0x1a5)])[_0x4280fe(0x22a)]()||'','setBatchName':String(_0x43390c[_0x4280fe(0x267)])[_0x4280fe(0x22a)]()||'','setItemDateExpiry':_0x28bcb3,'setItemVariantName':_0xf57c47,'setItemVariantValues':_0x402e8c,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x582784[_0x4b975d(0x220)](..._0x2d8b86),postMessage({'type':_0x4b975d(0x1ce),'payload':{'percent':Math['round']((_0x444230+_0x2d8b86['length'])/_0x417c8d*0x64),'message':_0x4b975d(0x26d)+(_0x444230+0x1)+'–'+(_0x444230+_0x2d8b86['length'])+'/'+_0x417c8d}});}postMessage({'type':_0x4b975d(0x206),'payload':{'items':_0x582784}});}catch(_0x42582c){postMessage({'type':_0x4b975d(0x22d),'payload':_0x42582c[_0x4b975d(0x183)]||_0x42582c});}}if(_0x3c305a==='exportItems'){const {products:_0xd4a93e,plantillaBuf:_0x32d47c}=_0x4b732b;if(!(_0x32d47c instanceof ArrayBuffer)){postMessage({'type':_0x4b975d(0x22d),'payload':_0x4b975d(0x21e)});return;}if(!Array[_0x4b975d(0x23a)](_0xd4a93e)){postMessage({'type':_0x4b975d(0x22d),'payload':_0x4b975d(0x1c3)});return;}try{structuredClone(_0xd4a93e);}catch(_0x164ab3){postMessage({'type':_0x4b975d(0x22d),'payload':_0x4b975d(0x19e)+_0x164ab3[_0x4b975d(0x183)]});return;}try{const _0x59c8ee={'1':_0x4b975d(0x1d3),'2':_0x4b975d(0x1f8),'3':'Materia\x20Prima','4':_0x4b975d(0x1f2),'5':_0x4b975d(0x18f)};function _0x400d0f(_0x126f33){return _0x59c8ee[String(_0x126f33)]||'Artículo';}const _0x5900a1={'1':'Gravado\x20(18%)','2':'Exonerado\x20(0%)','3':_0x4b975d(0x216),'4':'Gravado\x20Gratuito\x20(18%)','5':'Inafecto\x20Gratuito\x20(0%)','6':_0x4b975d(0x23b),'7':_0x4b975d(0x181),'8':_0x4b975d(0x192),'9':_0x4b975d(0x22e)};function _0xedcb49(_0x37e82d){return _0x5900a1[String(_0x37e82d)]||'Gravado\x20(18%)';}const _0x169e3a={'4A':'BOBINAS','BJ':'BALDE','BLL':_0x4b975d(0x250),'BG':_0x4b975d(0x1a2),'BO':_0x4b975d(0x20d),'BX':'CAJA','CT':_0x4b975d(0x263),'CMK':_0x4b975d(0x1b0),'CMQ':'CENTIMETRO\x20CUBICO','CMT':_0x4b975d(0x203),'CEN':_0x4b975d(0x1c0),'CY':'CILINDRO','CJ':'CONOS','DZN':_0x4b975d(0x1f5),'DZP':_0x4b975d(0x266),'BE':_0x4b975d(0x1bc),'GLI':_0x4b975d(0x1b6),'GRM':_0x4b975d(0x1f4),'GRO':_0x4b975d(0x1df),'HLT':'HECTOLITRO','LEF':_0x4b975d(0x21a),'SET':'JUEGO','KGM':'KILOGRAMO','KTM':_0x4b975d(0x21c),'KWH':'KILOVATIO\x20HORA','KT':_0x4b975d(0x1db),'CA':_0x4b975d(0x1c2),'LBR':_0x4b975d(0x20a),'LTR':_0x4b975d(0x1f1),'MWH':_0x4b975d(0x222),'MTR':'METRO','MTK':_0x4b975d(0x251),'MTQ':'METRO\x20CUBICO','MGM':'MILIGRAMOS','MLT':'MILILITRO','MMT':'MILIMETRO','MMK':_0x4b975d(0x20e),'MMQ':'MILIMETRO\x20CUBICO','MIL':_0x4b975d(0x1f0),'UM':_0x4b975d(0x194),'ONZ':'ONZAS','PF':_0x4b975d(0x215),'PK':_0x4b975d(0x1d6),'PR':'PAR','FOT':_0x4b975d(0x1f6),'FTK':'PIES\x20CUADRADOS','FTQ':'PIES\x20CUBICOS','C62':_0x4b975d(0x17f),'PG':_0x4b975d(0x205),'ST':_0x4b975d(0x236),'INH':_0x4b975d(0x1a4),'RM':_0x4b975d(0x1e5),'SA':_0x4b975d(0x1b9),'DR':_0x4b975d(0x1cb),'STN':'TONELADA\x20CORTA','LTN':_0x4b975d(0x217),'TNE':_0x4b975d(0x261),'TU':_0x4b975d(0x265),'NIU':'UNIDAD\x20(NIU)','ZZ':_0x4b975d(0x1b2),'GLL':_0x4b975d(0x197),'YRD':_0x4b975d(0x211),'YDK':_0x4b975d(0x1ae),'QQM':_0x4b975d(0x259)};function _0x179773(_0x20d0ed){return _0x169e3a[String(_0x20d0ed)]||'';}const _0x30b5a9=XLSX['read'](_0x32d47c,{'type':'array','cellDates':!![]}),_0x59d0e8=_0x30b5a9['SheetNames'][0x0],_0x5a6e7c=_0x30b5a9[_0x4b975d(0x1e4)][_0x59d0e8],_0x44b374=XLSX[_0x4b975d(0x229)][_0x4b975d(0x1bb)](_0x5a6e7c,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x12d53f=XLSX[_0x4b975d(0x229)]['decode_range'](_0x5a6e7c[_0x4b975d(0x1a3)]||'');for(let _0x146bd1=0x2;_0x146bd1<=_0x12d53f['e']['r'];++_0x146bd1){for(let _0x1f0934=_0x12d53f['s']['c'];_0x1f0934<=_0x12d53f['e']['c'];++_0x1f0934){const _0x1b3e7f=XLSX['utils'][_0x4b975d(0x258)]({'r':_0x146bd1,'c':_0x1f0934});if(_0x5a6e7c[_0x1b3e7f])delete _0x5a6e7c[_0x1b3e7f];}}const _0x2646b5=_0xd4a93e[_0x4b975d(0x247)](_0x121dcc=>{const _0x33393a=_0x4b975d;_0x121dcc[_0x33393a(0x1a7)]=_0x121dcc['setItemVariantValues']||{};const _0x56b5c2={};return _0x44b374[_0x33393a(0x25b)](_0x1cedcc=>{const _0x3a8d79=_0x33393a,_0x413a20=String(_0x1cedcc)[_0x3a8d79(0x22a)](),_0x23fe40=_0x413a20[_0x3a8d79(0x26e)](),_0x4d10aa=Object[_0x3a8d79(0x214)](_0x121dcc)[_0x3a8d79(0x1e6)](_0x4d5e02=>_0x4d5e02[_0x3a8d79(0x22a)]()[_0x3a8d79(0x26e)]()===_0x23fe40);if(_0x4d10aa){_0x56b5c2[_0x413a20]=_0x121dcc[_0x4d10aa]??'';return;}switch(_0x413a20){case'ID':_0x56b5c2[_0x413a20]=_0x121dcc['id']??'';break;case _0x3a8d79(0x21f):_0x56b5c2[_0x413a20]=_0x400d0f(_0x121dcc[_0x3a8d79(0x19d)]);break;case _0x3a8d79(0x1fe):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x24a)]??'';break;case _0x3a8d79(0x18a):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x202)]??'';break;case'Descripción':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1fa)]??'';break;case'Se\x20Vende':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x26b)]==0x1?'SI':'NO';break;case'Se\x20Compra':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x262)]==0x1?'SI':'NO';break;case _0x3a8d79(0x1ac):_0x56b5c2[_0x413a20]=_0x121dcc['setCategoria']??'';break;case _0x3a8d79(0x1dd):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1fb)]??'';break;case'Impuesto*':_0x56b5c2[_0x413a20]=_0xedcb49(_0x121dcc[_0x3a8d79(0x1fd)]);break;case'ID\x20UNIT':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x212)]??'';break;case _0x3a8d79(0x1be):_0x56b5c2[_0x413a20]=_0x121dcc['setItemUnitAlias']??'';break;case'Código\x20de\x20Barras':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x221)]??'';break;case _0x3a8d79(0x1f7):_0x56b5c2[_0x413a20]=_0x179773(_0x121dcc[_0x3a8d79(0x208)]);break;case _0x3a8d79(0x1ee):_0x56b5c2[_0x413a20]=_0x121dcc['PEN_setMtoPrecioUnitario']??'';break;case _0x3a8d79(0x1e7):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1ab)]??'';break;case _0x3a8d79(0x1ad):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x22f)]??'';break;case'Precio\x20Costo\x20Dólares':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x269)]??'';break;case'Comisión\x20Venta\x20(%)':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1a6)];break;case _0x3a8d79(0x235):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x25e)]??'';break;case _0x3a8d79(0x201):_0x56b5c2[_0x413a20]=_0x121dcc['setItemUnitAlias2']??'';break;case'Código\x20de\x20Barras\x202':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x195)]??'';break;case _0x3a8d79(0x1bf):_0x56b5c2[_0x413a20]=_0x179773(_0x121dcc['setUnidadCodigo2']);break;case'Equivalencia\x202':_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x234)]??'1';break;case _0x3a8d79(0x1e2):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x213)]??'';break;case _0x3a8d79(0x198):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1c4)]??'';break;case _0x3a8d79(0x237):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x23d)]??'';break;case'Precio\x20Costo\x20Dólares\x202':_0x56b5c2[_0x413a20]=_0x121dcc['USD_setMtoPrecioCostoUnitario2']??'';break;case _0x3a8d79(0x1cd):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1d0)];break;case'ID\x20UNIT\x203':_0x56b5c2[_0x413a20]=_0x121dcc['setUnitId3']??'';break;case _0x3a8d79(0x1a0):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1e3)]??'';break;case _0x3a8d79(0x189):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x184)]??'';break;case _0x3a8d79(0x190):_0x56b5c2[_0x413a20]=_0x179773(_0x121dcc['setUnidadCodigo3']);break;case _0x3a8d79(0x186):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x19a)]??'1';break;case _0x3a8d79(0x207):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1d5)]??'';break;case _0x3a8d79(0x182):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x22c)]??'';break;case _0x3a8d79(0x1e9):_0x56b5c2[_0x413a20]=_0x121dcc['USD_setMtoPrecioUnitario3']??'';break;case _0x3a8d79(0x1c6):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x245)]??'';break;case _0x3a8d79(0x196):_0x56b5c2[_0x413a20]=_0x121dcc['setItemCommissionPercentage3'];break;case _0x3a8d79(0x19c):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x23c)]==0x1?'SI':'NO';break;case _0x3a8d79(0x1ea):_0x56b5c2[_0x413a20]=_0x121dcc[_0x3a8d79(0x1ed)]??'';break;case'Stock\x20Mínimo':_0x56b5c2[_0x413a20]=_0x121dcc['setWarehouseStockMin']??'';break;case _0x3a8d79(0x1cf):_0x56b5c2[_0x413a20]=_0x121dcc['setBatchExpirationDate']??'';break;default:_0x56b5c2[_0x413a20]='';}}),_0x56b5c2;}),_0x59dee0=0x3e8,_0x5e143f=_0x2646b5[_0x4b975d(0x246)];for(let _0x1b7529=0x0;_0x1b7529<_0x5e143f;_0x1b7529+=_0x59dee0){const _0x20bb5b=_0x2646b5['slice'](_0x1b7529,_0x1b7529+_0x59dee0);XLSX[_0x4b975d(0x229)][_0x4b975d(0x1b1)](_0x5a6e7c,_0x20bb5b,{'origin':{'r':_0x1b7529+0x2,'c':0x0},'skipHeader':!![],'header':_0x44b374}),postMessage({'type':_0x4b975d(0x1ce),'payload':{'percent':Math[_0x4b975d(0x1aa)]((_0x1b7529+_0x20bb5b[_0x4b975d(0x246)])/_0x5e143f*0x64),'message':_0x4b975d(0x242)+(_0x1b7529+0x1)+'–'+(_0x1b7529+_0x20bb5b['length'])+_0x4b975d(0x1d9)+_0x5e143f}});}const _0x45545b={'s':{'r':0x0,'c':0x0},'e':{'r':_0x5e143f+0x1,'c':_0x44b374['length']-0x1}};_0x5a6e7c[_0x4b975d(0x1a3)]=XLSX[_0x4b975d(0x229)][_0x4b975d(0x18e)](_0x45545b);const _0x3fdf8e=XLSX['write'](_0x30b5a9,{'bookType':_0x4b975d(0x24e),'type':_0x4b975d(0x1d7)});let _0xa1d489,_0x3fde40;if(_0x3fdf8e instanceof Uint8Array)_0xa1d489=_0x3fdf8e,_0x3fde40=[_0x3fdf8e['buffer']];else{if(_0x3fdf8e instanceof ArrayBuffer)_0xa1d489=new Uint8Array(_0x3fdf8e),_0x3fde40=[_0x3fdf8e];else{const _0x3b8bac=new Uint8Array(_0x3fdf8e);_0xa1d489=_0x3b8bac,_0x3fde40=[_0x3b8bac['buffer']];}}postMessage({'type':_0x4b975d(0x1f9),'payload':{'wbout':_0xa1d489,'count':_0x2646b5[_0x4b975d(0x246)]}},_0x3fde40);}catch(_0x39bf7c){postMessage({'type':_0x4b975d(0x22d),'payload':_0x39bf7c[_0x4b975d(0x183)]||String(_0x39bf7c)});}return;}};