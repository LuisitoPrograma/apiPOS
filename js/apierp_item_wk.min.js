/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.4.6
*/

const _0xc6c249=_0x306b;(function(_0x2d0ac7,_0x5ecd1f){const _0x4893d4=_0x306b,_0x44390e=_0x2d0ac7();while(!![]){try{const _0x1fa2dc=-parseInt(_0x4893d4(0x12f))/0x1+-parseInt(_0x4893d4(0x149))/0x2*(parseInt(_0x4893d4(0x13c))/0x3)+-parseInt(_0x4893d4(0xd1))/0x4+-parseInt(_0x4893d4(0xba))/0x5+-parseInt(_0x4893d4(0x96))/0x6*(-parseInt(_0x4893d4(0x12a))/0x7)+-parseInt(_0x4893d4(0x95))/0x8*(parseInt(_0x4893d4(0xd6))/0x9)+parseInt(_0x4893d4(0xdc))/0xa;if(_0x1fa2dc===_0x5ecd1f)break;else _0x44390e['push'](_0x44390e['shift']());}catch(_0x2181b4){_0x44390e['push'](_0x44390e['shift']());}}}(_0x496b,0x9bd24));const _0x56ec9c=(function(){let _0x543cad=!![];return function(_0x5f0379,_0x189add){const _0x58dce6=_0x543cad?function(){if(_0x189add){const _0x5ec85f=_0x189add['apply'](_0x5f0379,arguments);return _0x189add=null,_0x5ec85f;}}:function(){};return _0x543cad=![],_0x58dce6;};}()),_0x1d6e48=_0x56ec9c(this,function(){const _0x3196cc=_0x306b;return _0x1d6e48['toString']()[_0x3196cc(0xa4)](_0x3196cc(0xc5))['toString']()[_0x3196cc(0xb7)](_0x1d6e48)['search'](_0x3196cc(0xc5));});function _0x306b(_0x562b97,_0x7e58b0){const _0x442e62=_0x496b();return _0x306b=function(_0x3dee22,_0x20f86b){_0x3dee22=_0x3dee22-0x6e;let _0x18bd70=_0x442e62[_0x3dee22];return _0x18bd70;},_0x306b(_0x562b97,_0x7e58b0);}_0x1d6e48();function _0x496b(){const _0x1688ef=['KILOMETRO','PAR','MTR','MMT','xlsx','CARTONES','push','USD_setMtoPrecioUnitario','LIBRAS','code','JUEGO','PEN_setMtoPrecioUnitario','TONELADA\x20CORTA','Unidad\x20de\x20Medida\x203','read','Precio\x20Venta\x20Soles\x203','PEN_setMtoPrecioCostoUnitario3','US\x20GALON\x20(3,7843\x20L)','trace','Modelo','apply','MILLARES','bind','setUnitId','sheet_to_json','Exonerado\x20Gratuito\x20(0%)','setItemType','GRAMO','array','Género','MILIGRAMOS','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','setTaxId','Color','CIENTO\x20DE\x20UNIDADES','encode_cell','MILIMETRO\x20CUADRADO','setWarehouseStockMin','getFullYear','BOTELLAS','YDK','toString','Alias','setDescripcion','STN','Unidad\x20de\x20Medida\x202','MILLON\x20DE\x20UNIDADES','setItemBarCode2','decode_range','toLowerCase','TONELADA\x20LARGA','Alias\x203','Unidad\x20de\x20Medida*','length','Precio\x20Venta\x20Soles','MILIMETRO','Exonerado\x20(0%)','CENTIMETRO\x20CUBICO','setUnidadCodigo','Precio\x20Venta\x20Dólares','CMK','Nombre*','KWH','setBatchExpirationDate','Precio\x20Costo\x20Soles\x202','PEN_setMtoPrecioCostoUnitario','LITRO','exception','GLI','4977ekgkyK','CAJA','Gravado\x20Gratuito\x20(10%)','warn','Gravado\x20(18%)','215043inhNTQ','LTN','import','FARDO','DOCENA','KIT','YARDA','setUnidadEquivalencia2','getMonth','Precio\x20Costo\x20Dólares\x203','Alias\x202','Categoría','TUBOS','686988dcjIRd','MILILITRO','Código\x20de\x20Barras\x203','LATAS','KGM','setCodProducto','USD_setMtoPrecioCostoUnitario','MEGAWATT\x20HORA','exportDone','slice','map','setCategoria','message','10zFWNvx','PAQUETE','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','encode_range','PIES\x20CUADRADOS','Iniciando\x20parseo…','MGM','PLIEGO','DZP','setUnitId3','CMT','SSF','write','ONZAS','exportItems','Precio\x20Venta\x20Soles\x202','BARRILES','buffer','LTR','METRO\x20CUADRADO','setInventariable','Artículo','setUnidadEquivalencia3','SheetNames','Fecha\x20de\x20Vencimiento','HOJA','SACO','Precio\x20Venta\x20Dólares\x202','FOT','Inafecto\x20Gratuito\x20(0%)','Materia\x20Prima','value','PIES','KILOVATIO\x20HORA','Modelo\x20de\x20Manga','PULGADAS','CILINDRO','info','USD_setMtoPrecioCostoUnitario3','ID\x20UNIT\x203','exportItems:\x20products\x20no\x20es\x20Array.','Código\x20de\x20Barras\x202','Gravado\x20Gratuito\x20(18%)','__proto__','error','CENTIMETRO\x20LINEAL','Lote','trim','number','padStart','PIES\x20CUBICOS','Precio\x20Costo\x20Soles','getDate','Sheets','Precio\x20Costo\x20Dólares\x202','Serie','setMarca','MWH','table','MTK','FTQ','Descripción','METRO','setUnitId2','Inafecto\x20(0%)','Precio\x20Venta\x20Dólares\x203','YRD','8MhpUzT','1302EormsC','keys','find','UNIDAD\x20(NIU)','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','Código\x20SKU*','setItemBarCode3','BOBINAS','YARDA\x20CUADRADA','MMQ','PALETAS','Stock\x20Actual','LBR','Equivalencia\x203','search','METRO\x20CUBICO','NIU','Exportando\x20filas\x20','INH','setItemUnitAlias','GRM','Stock\x20Mínimo','ID\x20UNIT','some','Equivalencia\x202','KTM','MTQ','GALON\x20INGLES\x20(4,545956L)','CENTIMETRO\x20CUADRADO','!ref','USD_setMtoPrecioCostoUnitario2','Código\x20de\x20Barras','utils','constructor','Precio\x20Costo\x20Soles\x203','RESMA','3081570zsMtiK','MILIMETRO\x20CUBICO','DZN','TAMBOR','UNIDAD\x20(ZZ)','parse_date_code','PIEZAS','Exportación\x20(0%)','round','progress','KILOGRAMO','(((.+)+)+)+$','Tipo*','CMQ','HECTOLITRO','reduce','QQM','\x20de\x20','ID\x20UNIT\x202','Fabricado','Gravado\x20(10%)','forEach','DOCENA\x20POR\x2010**6','4484272pIBKcM','done','Ubicación','BOLSA','PLACAS','1141488DZHILN','prototype','GRUESA','C62','log','setItemVariantValues','37081940tHFHwZ','USD_setMtoPrecioUnitario2','TONELADAS','Talla','Material','Marca','GRO','FTK','BALDE'];_0x496b=function(){return _0x1688ef;};return _0x496b();}const _0x20f86b=(function(){let _0x48b0b4=!![];return function(_0x1387a9,_0x30cd21){const _0x156865=_0x48b0b4?function(){const _0x3521c2=_0x306b;if(_0x30cd21){const _0x59e127=_0x30cd21[_0x3521c2(0xf9)](_0x1387a9,arguments);return _0x30cd21=null,_0x59e127;}}:function(){};return _0x48b0b4=![],_0x156865;};}()),_0x3dee22=_0x20f86b(this,function(){const _0x3014e5=_0x306b;let _0x67b879;try{const _0x20e5e5=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x67b879=_0x20e5e5();}catch(_0x10bca4){_0x67b879=window;}const _0x32d952=_0x67b879['console']=_0x67b879['console']||{},_0x426f39=[_0x3014e5(0xda),_0x3014e5(0x12d),_0x3014e5(0x77),_0x3014e5(0x7e),_0x3014e5(0x128),_0x3014e5(0x8c),_0x3014e5(0xf7)];for(let _0xafe944=0x0;_0xafe944<_0x426f39[_0x3014e5(0x11a)];_0xafe944++){const _0x424f5a=_0x20f86b[_0x3014e5(0xb7)][_0x3014e5(0xd7)][_0x3014e5(0xfb)](_0x20f86b),_0x56c993=_0x426f39[_0xafe944],_0x104825=_0x32d952[_0x56c993]||_0x424f5a;_0x424f5a[_0x3014e5(0x7d)]=_0x20f86b[_0x3014e5(0xfb)](_0x20f86b),_0x424f5a[_0x3014e5(0x10e)]=_0x104825['toString']['bind'](_0x104825),_0x32d952[_0x56c993]=_0x424f5a;}});_0x3dee22(),importScripts(_0xc6c249(0x14b)),onmessage=({data:_0x496385})=>{const _0x311a77=_0xc6c249,{action:_0x3ba3b6}=_0x496385;if(_0x3ba3b6===_0x311a77(0x131)){const {buf:_0x6b4295,maxRows:_0x28daad}=_0x496385;try{postMessage({'type':'progress','payload':{'percent':0x5,'message':_0x311a77(0x14f)}});const _0x4ecc52=XLSX[_0x311a77(0xf3)](_0x6b4295,{'type':'array','cellDates':!![]}),_0xe2fd14=_0x4ecc52['Sheets'][_0x4ecc52[_0x311a77(0x161)][0x0]],_0x4f19b7=XLSX[_0x311a77(0xb6)][_0x311a77(0xfd)](_0xe2fd14,{'defval':'','range':0x1,'cellDates':!![]}),_0x47480f=_0x4f19b7['findIndex'](_0x51b752=>(!_0x51b752[_0x311a77(0xc6)]||String(_0x51b752[_0x311a77(0xc6)])[_0x311a77(0x81)]()==='')&&(!_0x51b752[_0x311a77(0x9b)]||String(_0x51b752[_0x311a77(0x9b)])[_0x311a77(0x81)]()==='')&&(!_0x51b752[_0x311a77(0x122)]||String(_0x51b752['Nombre*'])['trim']()==='')&&(!_0x51b752[_0x311a77(0x119)]||String(_0x51b752[_0x311a77(0x119)])['trim']()==='')),_0x3f4d60=_0x47480f>=0x0?_0x4f19b7[_0x311a77(0x145)](0x0,_0x47480f):_0x4f19b7,_0x24c39d=_0x3f4d60['filter'](_0xe4f77=>_0xe4f77[_0x311a77(0xc6)]&&String(_0xe4f77[_0x311a77(0xc6)])[_0x311a77(0x81)]()!==''&&_0xe4f77[_0x311a77(0x9b)]&&String(_0xe4f77[_0x311a77(0x9b)])[_0x311a77(0x81)]()!==''&&_0xe4f77['Nombre*']&&String(_0xe4f77[_0x311a77(0x122)])[_0x311a77(0x81)]()!==''&&_0xe4f77[_0x311a77(0x119)]&&String(_0xe4f77[_0x311a77(0x119)])[_0x311a77(0x81)]()!==''),_0xb24b82=_0x24c39d['length'];if(_0xb24b82===0x0){postMessage({'type':'error','payload':_0x311a77(0x14c)});return;}if(_0xb24b82>_0x28daad)throw'El\x20archivo\x20tiene\x20'+_0xb24b82+_0x311a77(0x104)+_0x28daad+'.';const _0x54d450=0x1f4,_0x2c0dbf=[],_0x50c89d=[{'codigo':'4A','nombre':_0x311a77(0x9d)},{'codigo':'BJ','nombre':_0x311a77(0xe4)},{'codigo':'BLL','nombre':_0x311a77(0x15a)},{'codigo':'BG','nombre':_0x311a77(0xd4)},{'codigo':'BO','nombre':_0x311a77(0x10c)},{'codigo':'BX','nombre':_0x311a77(0x12b)},{'codigo':'CT','nombre':_0x311a77(0xea)},{'codigo':_0x311a77(0x121),'nombre':_0x311a77(0xb2)},{'codigo':_0x311a77(0xc7),'nombre':'CENTIMETRO\x20CUBICO'},{'codigo':_0x311a77(0x154),'nombre':_0x311a77(0x7f)},{'codigo':'CEN','nombre':_0x311a77(0x107)},{'codigo':'CY','nombre':_0x311a77(0x76)},{'codigo':'CJ','nombre':'CONOS'},{'codigo':_0x311a77(0xbc),'nombre':_0x311a77(0x133)},{'codigo':_0x311a77(0x152),'nombre':_0x311a77(0xd0)},{'codigo':'BE','nombre':'FARDO'},{'codigo':_0x311a77(0x129),'nombre':'GALON\x20INGLES\x20(4,545956L)'},{'codigo':_0x311a77(0xaa),'nombre':_0x311a77(0x100)},{'codigo':_0x311a77(0xe2),'nombre':'GRUESA'},{'codigo':'HLT','nombre':_0x311a77(0xc8)},{'codigo':'LEF','nombre':'HOJA'},{'codigo':'SET','nombre':_0x311a77(0xef)},{'codigo':_0x311a77(0x140),'nombre':_0x311a77(0xc4)},{'codigo':_0x311a77(0xaf),'nombre':_0x311a77(0xe5)},{'codigo':_0x311a77(0x123),'nombre':_0x311a77(0x73)},{'codigo':'KT','nombre':_0x311a77(0x134)},{'codigo':'CA','nombre':_0x311a77(0x13f)},{'codigo':_0x311a77(0xa2),'nombre':_0x311a77(0xed)},{'codigo':_0x311a77(0x15c),'nombre':_0x311a77(0x127)},{'codigo':_0x311a77(0x8b),'nombre':_0x311a77(0x143)},{'codigo':_0x311a77(0xe7),'nombre':_0x311a77(0x90)},{'codigo':_0x311a77(0x8d),'nombre':_0x311a77(0x15d)},{'codigo':_0x311a77(0xb0),'nombre':_0x311a77(0xa5)},{'codigo':_0x311a77(0x150),'nombre':_0x311a77(0x103)},{'codigo':'MLT','nombre':_0x311a77(0x13d)},{'codigo':_0x311a77(0xe8),'nombre':_0x311a77(0x11c)},{'codigo':'MMK','nombre':_0x311a77(0x109)},{'codigo':_0x311a77(0x9f),'nombre':_0x311a77(0xbb)},{'codigo':'MIL','nombre':_0x311a77(0xfa)},{'codigo':'UM','nombre':_0x311a77(0x113)},{'codigo':'ONZ','nombre':_0x311a77(0x157)},{'codigo':'PF','nombre':_0x311a77(0xa0)},{'codigo':'PK','nombre':_0x311a77(0x14a)},{'codigo':'PR','nombre':'PAR'},{'codigo':_0x311a77(0x6e),'nombre':_0x311a77(0x72)},{'codigo':_0x311a77(0xe3),'nombre':_0x311a77(0x14e)},{'codigo':_0x311a77(0x8e),'nombre':_0x311a77(0x84)},{'codigo':_0x311a77(0xd9),'nombre':'PIEZAS'},{'codigo':'PG','nombre':_0x311a77(0xd5)},{'codigo':'ST','nombre':_0x311a77(0x151)},{'codigo':_0x311a77(0xa8),'nombre':'PULGADAS'},{'codigo':'RM','nombre':_0x311a77(0xb9)},{'codigo':'SA','nombre':_0x311a77(0x164)},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':_0x311a77(0x111),'nombre':_0x311a77(0xf1)},{'codigo':_0x311a77(0x130),'nombre':_0x311a77(0x117)},{'codigo':'TNE','nombre':_0x311a77(0xde)},{'codigo':'TU','nombre':_0x311a77(0x13b)},{'codigo':'NIU','nombre':'UNIDAD\x20(NIU)'},{'codigo':'ZZ','nombre':'UNIDAD\x20(ZZ)'},{'codigo':'GLL','nombre':_0x311a77(0xf6)},{'codigo':_0x311a77(0x94),'nombre':_0x311a77(0x135)},{'codigo':_0x311a77(0x10d),'nombre':_0x311a77(0x9e)},{'codigo':_0x311a77(0xca),'nombre':'QUINTAL'}],_0x150cf6=_0x50c89d[_0x311a77(0xc9)]((_0x2798b5,{nombre:_0x28dde4,codigo:_0x24134f})=>{const _0x4b0fa9=_0x311a77;return _0x2798b5[_0x28dde4[_0x4b0fa9(0x81)]()]=_0x24134f[_0x4b0fa9(0x81)](),_0x2798b5;},{});for(let _0x21a5f5=0x0;_0x21a5f5<_0xb24b82;_0x21a5f5+=_0x54d450){const _0x5399df=_0x24c39d[_0x311a77(0x145)](_0x21a5f5,_0x21a5f5+_0x54d450)[_0x311a77(0x146)]((_0x408b68,_0x4984b7)=>{const _0x2c2ca1=_0x311a77;let _0xe186cb={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x408b68[_0x2c2ca1(0xc6)]]||'1';const _0x3c40ce=String(_0x408b68['Impuesto*'])[_0x2c2ca1(0x81)](),_0xb01414={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x518e61=_0xb01414[_0x3c40ce]||'1',_0x5d7c29={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x518e61]||{'code':'10','value':0x12},_0x291a67={};let _0x29d2e4=String(_0x408b68['Nombre*'])[_0x2c2ca1(0x81)]();const _0x2f63da=[_0x2c2ca1(0x80),_0x2c2ca1(0xdf),_0x2c2ca1(0x106),_0x2c2ca1(0x102),_0x2c2ca1(0xf8),_0x2c2ca1(0x89),_0x2c2ca1(0xe0),'Modelo\x20de\x20Cuello',_0x2c2ca1(0x74)];_0x2f63da[_0x2c2ca1(0xcf)](_0x4dc5f4=>{const _0x3e709c=_0x2c2ca1,_0x4797da=String(_0x408b68[_0x4dc5f4]||'')[_0x3e709c(0x81)]();_0x4797da&&(_0x291a67[_0x4dc5f4]=_0x4797da,_0x29d2e4+='\x20'+_0x4dc5f4+'\x20'+_0x4797da);});const _0x1b34ea=[],_0x145913=String(_0x408b68[_0x2c2ca1(0x119)]||_0x2c2ca1(0x99))['trim'](),_0x1f06e4=_0x150cf6[_0x145913]||_0x2c2ca1(0xa6),_0x2f2b96=String(_0x408b68['Alias'])[_0x2c2ca1(0x81)]();_0x1b34ea['push']({'setItemUnitId':String(_0x408b68[_0x2c2ca1(0xac)])[_0x2c2ca1(0x81)]()||'','setItemBarCode':String(_0x408b68[_0x2c2ca1(0xb5)])['trim']()||'','setAlias':_0x2f2b96,'setUnitCode':_0x1f06e4,'setPrice':parseFloat(_0x408b68[_0x2c2ca1(0x11b)])||0x0,'setCost':parseFloat(_0x408b68[_0x2c2ca1(0x85)])||0x0,'setPriceUSD':parseFloat(_0x408b68[_0x2c2ca1(0x120)])||0x0,'setCostUSD':parseFloat(_0x408b68['Precio\x20Costo\x20Dólares'])||0x0,'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1});const _0x413ae6=[_0x2c2ca1(0xcc),_0x2c2ca1(0x139),_0x2c2ca1(0x7b),'Equivalencia\x202',_0x2c2ca1(0x159),'Precio\x20Costo\x20Soles\x202',_0x2c2ca1(0x165),'Precio\x20Costo\x20Dólares\x202'][_0x2c2ca1(0xad)](_0x2cb54a=>{const _0x1f2f03=_0x2c2ca1,_0x2f12ba=_0x408b68[_0x2cb54a];return _0x2f12ba!=null&&String(_0x2f12ba)[_0x1f2f03(0x81)]()!=='';});if(_0x413ae6){const _0x4a1f04=String(_0x408b68[_0x2c2ca1(0x112)]||'UND\x20(NIU)')[_0x2c2ca1(0x81)](),_0x3b69d0=_0x150cf6[_0x4a1f04]||_0x2c2ca1(0xa6),_0x3f2e9b=String(_0x408b68[_0x2c2ca1(0x139)])[_0x2c2ca1(0x81)](),_0x38b96c=parseFloat(_0x408b68[_0x2c2ca1(0x159)])||0x0,_0x271b5e=parseFloat(_0x408b68[_0x2c2ca1(0x125)])||0x0,_0x249f1a=parseFloat(_0x408b68[_0x2c2ca1(0x165)])||0x0,_0x311f3a=parseFloat(_0x408b68[_0x2c2ca1(0x88)])||0x0,_0x5b97c8=parseFloat(_0x408b68[_0x2c2ca1(0xae)])||0x1;_0x1b34ea['push']({'setItemUnitId':String(_0x408b68[_0x2c2ca1(0xcc)])['trim']()||'','setItemBarCode':String(_0x408b68[_0x2c2ca1(0x7b)])[_0x2c2ca1(0x81)]()||'','setAlias':_0x3f2e9b,'setUnitCode':_0x3b69d0,'setPrice':_0x38b96c,'setCost':_0x271b5e,'setPriceUSD':_0x249f1a,'setCostUSD':_0x311f3a,'setDefault':0x0,'setEquivalence':_0x5b97c8,'setFactor':_0x5b97c8});}const _0x45a1f8=[_0x2c2ca1(0x79),'Alias\x203',_0x2c2ca1(0x13e),_0x2c2ca1(0xa3),'Precio\x20Venta\x20Soles\x203',_0x2c2ca1(0xb8),'Precio\x20Venta\x20Dólares\x203',_0x2c2ca1(0x138)]['some'](_0x16f169=>{const _0x2b68b5=_0x2c2ca1,_0x29652f=_0x408b68[_0x16f169];return _0x29652f!=null&&String(_0x29652f)[_0x2b68b5(0x81)]()!=='';});if(_0x45a1f8){const _0x318c2a=String(_0x408b68['Unidad\x20de\x20Medida\x203']||'UND\x20(NIU)')[_0x2c2ca1(0x81)](),_0x3bf690=_0x150cf6[_0x318c2a]||_0x2c2ca1(0xa6),_0x223119=String(_0x408b68['Alias\x203'])[_0x2c2ca1(0x81)](),_0x173dc2=parseFloat(_0x408b68['Precio\x20Venta\x20Soles\x203'])||0x0,_0x1cf3e5=parseFloat(_0x408b68[_0x2c2ca1(0xb8)])||0x0,_0x1ddbce=parseFloat(_0x408b68['Precio\x20Venta\x20Dólares\x203'])||0x0,_0x4b646d=parseFloat(_0x408b68['Precio\x20Costo\x20Dólares\x203'])||0x0,_0x2cd217=parseFloat(_0x408b68[_0x2c2ca1(0xa3)])||0x1;_0x1b34ea[_0x2c2ca1(0xeb)]({'setItemUnitId':String(_0x408b68[_0x2c2ca1(0x79)])[_0x2c2ca1(0x81)]()||'','setItemBarCode':String(_0x408b68[_0x2c2ca1(0x13e)])[_0x2c2ca1(0x81)]()||'','setAlias':_0x223119,'setUnitCode':_0x3bf690,'setPrice':_0x173dc2,'setCost':_0x1cf3e5,'setPriceUSD':_0x1ddbce,'setCostUSD':_0x4b646d,'setDefault':0x0,'setEquivalence':_0x2cd217,'setFactor':_0x2cd217});}let _0x54cb2d=_0x408b68[_0x2c2ca1(0x162)],_0x3f2712='';if(_0x54cb2d instanceof Date){const _0x58d163=_0x54cb2d[_0x2c2ca1(0x10b)](),_0x1a20b2=String(_0x54cb2d[_0x2c2ca1(0x137)]()+0x1)['padStart'](0x2,'0'),_0x39ac7e=String(_0x54cb2d[_0x2c2ca1(0x86)]())[_0x2c2ca1(0x83)](0x2,'0');_0x3f2712=_0x58d163+'-'+_0x1a20b2+'-'+_0x39ac7e;}else{if(typeof _0x54cb2d===_0x2c2ca1(0x82)){const _0xa7bdfc=XLSX[_0x2c2ca1(0x155)][_0x2c2ca1(0xbf)](_0x54cb2d);if(_0xa7bdfc){const _0x1a5944=_0xa7bdfc['y'],_0x1f8ebe=String(_0xa7bdfc['m'])[_0x2c2ca1(0x83)](0x2,'0'),_0x47710e=String(_0xa7bdfc['d'])[_0x2c2ca1(0x83)](0x2,'0');_0x3f2712=_0x1a5944+'-'+_0x1f8ebe+'-'+_0x47710e;}}else _0x3f2712=String(_0x54cb2d||'')[_0x2c2ca1(0x81)]();}return{'setItemId':String(_0x408b68['ID'])['trim'](),'setItemType':_0xe186cb,'setItemCode':String(_0x408b68[_0x2c2ca1(0x9b)])[_0x2c2ca1(0x81)](),'setItemName':String(_0x408b68[_0x2c2ca1(0x122)])[_0x2c2ca1(0x81)](),'setItemDescription':String(_0x408b68[_0x2c2ca1(0x8f)])['trim']()||'','setItemCategories':_0x408b68[_0x2c2ca1(0x13a)]?[String(_0x408b68['Categoría'])[_0x2c2ca1(0x81)]()]:[],'setItemBrands':_0x408b68['Marca']?[String(_0x408b68['Marca'])[_0x2c2ca1(0x81)]()]:[],'setItemTaxId':_0x518e61,'setItemTaxCode':_0x5d7c29[_0x2c2ca1(0xee)],'setItemTaxValue':_0x5d7c29[_0x2c2ca1(0x71)],'setItemUnits':_0x1b34ea,'setItemInventoriable':_0x408b68['¿Rastrear\x20Inventario?']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x408b68[_0x2c2ca1(0xa1)])||0x0,'setStockMinimum':parseFloat(_0x408b68[_0x2c2ca1(0xab)])||0x0,'setItemLocation':String(_0x408b68[_0x2c2ca1(0xd3)])['trim']()||'','setBatchName':String(_0x408b68[_0x2c2ca1(0x80)])[_0x2c2ca1(0x81)]()||'','setItemDateExpiry':_0x3f2712,'setItemVariantName':_0x29d2e4,'setItemVariantValues':_0x291a67,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0,'setItemIsBought':0x1,'setItemIsSold':0x1};});_0x2c0dbf['push'](..._0x5399df),postMessage({'type':_0x311a77(0xc3),'payload':{'percent':Math[_0x311a77(0xc2)]((_0x21a5f5+_0x5399df[_0x311a77(0x11a)])/_0xb24b82*0x64),'message':'Procesadas\x20filas\x20'+(_0x21a5f5+0x1)+'–'+(_0x21a5f5+_0x5399df[_0x311a77(0x11a)])+'/'+_0xb24b82}});}postMessage({'type':_0x311a77(0xd2),'payload':{'items':_0x2c0dbf}});}catch(_0x50b865){postMessage({'type':'error','payload':_0x50b865['message']||_0x50b865});}}if(_0x3ba3b6===_0x311a77(0x158)){const {products:_0x32227b,plantillaBuf:_0x197d3b}=_0x496385;if(!(_0x197d3b instanceof ArrayBuffer)){postMessage({'type':_0x311a77(0x7e),'payload':_0x311a77(0x9a)});return;}if(!Array['isArray'](_0x32227b)){postMessage({'type':'error','payload':_0x311a77(0x7a)});return;}try{structuredClone(_0x32227b);}catch(_0x5670ad){postMessage({'type':'error','payload':'exportItems:\x20productos\x20no\x20clonables:\x20'+_0x5670ad[_0x311a77(0x148)]});return;}try{const _0xdbbd9d={'1':_0x311a77(0x15f),'2':'Servicio','3':_0x311a77(0x70),'4':'Combo','5':_0x311a77(0xcd)};function _0x312f84(_0x22a2a6){const _0x1a1404=_0x311a77;return _0xdbbd9d[String(_0x22a2a6)]||_0x1a1404(0x15f);}const _0x271708={'1':_0x311a77(0x12e),'2':_0x311a77(0x11d),'3':_0x311a77(0x92),'4':_0x311a77(0x7c),'5':_0x311a77(0x6f),'6':_0x311a77(0xce),'7':_0x311a77(0xfe),'8':_0x311a77(0xc1),'9':_0x311a77(0x12c)};function _0x45833d(_0x5120ec){const _0x4957ad=_0x311a77;return _0x271708[String(_0x5120ec)]||_0x4957ad(0x12e);}const _0xfe78da={'4A':_0x311a77(0x9d),'BJ':_0x311a77(0xe4),'BLL':_0x311a77(0x15a),'BG':'BOLSA','BO':'BOTELLAS','BX':_0x311a77(0x12b),'CT':_0x311a77(0xea),'CMK':_0x311a77(0xb2),'CMQ':_0x311a77(0x11e),'CMT':_0x311a77(0x7f),'CEN':_0x311a77(0x107),'CY':_0x311a77(0x76),'CJ':'CONOS','DZN':_0x311a77(0x133),'DZP':_0x311a77(0xd0),'BE':_0x311a77(0x132),'GLI':_0x311a77(0xb1),'GRM':_0x311a77(0x100),'GRO':_0x311a77(0xd8),'HLT':_0x311a77(0xc8),'LEF':_0x311a77(0x163),'SET':'JUEGO','KGM':_0x311a77(0xc4),'KTM':_0x311a77(0xe5),'KWH':'KILOVATIO\x20HORA','KT':_0x311a77(0x134),'CA':_0x311a77(0x13f),'LBR':'LIBRAS','LTR':_0x311a77(0x127),'MWH':_0x311a77(0x143),'MTR':_0x311a77(0x90),'MTK':_0x311a77(0x15d),'MTQ':_0x311a77(0xa5),'MGM':_0x311a77(0x103),'MLT':_0x311a77(0x13d),'MMT':'MILIMETRO','MMK':_0x311a77(0x109),'MMQ':_0x311a77(0xbb),'MIL':'MILLARES','UM':_0x311a77(0x113),'ONZ':_0x311a77(0x157),'PF':_0x311a77(0xa0),'PK':'PAQUETE','PR':_0x311a77(0xe6),'FOT':_0x311a77(0x72),'FTK':_0x311a77(0x14e),'FTQ':'PIES\x20CUBICOS','C62':_0x311a77(0xc0),'PG':_0x311a77(0xd5),'ST':_0x311a77(0x151),'INH':_0x311a77(0x75),'RM':_0x311a77(0xb9),'SA':_0x311a77(0x164),'DR':_0x311a77(0xbd),'STN':_0x311a77(0xf1),'LTN':_0x311a77(0x117),'TNE':'TONELADAS','TU':_0x311a77(0x13b),'NIU':_0x311a77(0x99),'ZZ':_0x311a77(0xbe),'GLL':'US\x20GALON\x20(3,7843\x20L)','YRD':_0x311a77(0x135),'YDK':_0x311a77(0x9e),'QQM':'QUINTAL'};function _0x53b9e0(_0xbdff2c){return _0xfe78da[String(_0xbdff2c)]||'';}const _0x222e2b=XLSX[_0x311a77(0xf3)](_0x197d3b,{'type':_0x311a77(0x101),'cellDates':!![]}),_0x37a98c=_0x222e2b[_0x311a77(0x161)][0x0],_0x28b368=_0x222e2b[_0x311a77(0x87)][_0x37a98c],_0xe6e19b=XLSX['utils'][_0x311a77(0xfd)](_0x28b368,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x7aa148=XLSX[_0x311a77(0xb6)][_0x311a77(0x115)](_0x28b368[_0x311a77(0xb3)]||'');for(let _0x4ce269=0x2;_0x4ce269<=_0x7aa148['e']['r'];++_0x4ce269){for(let _0x254e6a=_0x7aa148['s']['c'];_0x254e6a<=_0x7aa148['e']['c'];++_0x254e6a){const _0x55bda7=XLSX['utils'][_0x311a77(0x108)]({'r':_0x4ce269,'c':_0x254e6a});if(_0x28b368[_0x55bda7])delete _0x28b368[_0x55bda7];}}const _0x1fa540=_0x32227b['map'](_0x411ed0=>{const _0x15c1e6=_0x311a77;_0x411ed0[_0x15c1e6(0xdb)]=_0x411ed0[_0x15c1e6(0xdb)]||{};const _0xbd0a65={};return _0xe6e19b[_0x15c1e6(0xcf)](_0x3dd142=>{const _0x9c0695=_0x15c1e6,_0x1caf51=String(_0x3dd142)[_0x9c0695(0x81)](),_0x5de66c=_0x1caf51[_0x9c0695(0x116)](),_0xe9d3f4=Object[_0x9c0695(0x97)](_0x411ed0)[_0x9c0695(0x98)](_0x37b4c9=>_0x37b4c9[_0x9c0695(0x81)]()[_0x9c0695(0x116)]()===_0x5de66c);if(_0xe9d3f4){_0xbd0a65[_0x1caf51]=_0x411ed0[_0xe9d3f4]??'';return;}switch(_0x1caf51){case'ID':_0xbd0a65[_0x1caf51]=_0x411ed0['id']??'';break;case _0x9c0695(0xc6):_0xbd0a65[_0x1caf51]=_0x312f84(_0x411ed0[_0x9c0695(0xff)]);break;case _0x9c0695(0x9b):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x141)]??'';break;case _0x9c0695(0x122):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x110)]??'';break;case _0x9c0695(0x8f):_0xbd0a65[_0x1caf51]=_0x411ed0['setItemDescription']??'';break;case'Categoría':_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x147)]??'';break;case _0x9c0695(0xe1):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x8a)]??'';break;case'Impuesto*':_0xbd0a65[_0x1caf51]=_0x45833d(_0x411ed0[_0x9c0695(0x105)]);break;case _0x9c0695(0xac):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0xfc)]??'';break;case _0x9c0695(0x10f):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0xa9)]??'';break;case _0x9c0695(0xb5):_0xbd0a65[_0x1caf51]=_0x411ed0['setItemBarCode']??'';break;case _0x9c0695(0x119):_0xbd0a65[_0x1caf51]=_0x53b9e0(_0x411ed0[_0x9c0695(0x11f)]);break;case _0x9c0695(0x11b):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0xf0)]??'';break;case _0x9c0695(0x85):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x126)]??'';break;case _0x9c0695(0x120):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0xec)]??'';break;case'Precio\x20Costo\x20Dólares':_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x142)]??'';break;case'ID\x20UNIT\x202':_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x91)]??'';break;case'Alias\x202':_0xbd0a65[_0x1caf51]=_0x411ed0['setItemUnitAlias2']??'';break;case _0x9c0695(0x7b):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x114)]??'';break;case _0x9c0695(0x112):_0xbd0a65[_0x1caf51]=_0x53b9e0(_0x411ed0['setUnidadCodigo2']);break;case'Equivalencia\x202':_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x136)]??'1';break;case _0x9c0695(0x159):_0xbd0a65[_0x1caf51]=_0x411ed0['PEN_setMtoPrecioUnitario2']??'';break;case'Precio\x20Costo\x20Soles\x202':_0xbd0a65[_0x1caf51]=_0x411ed0['PEN_setMtoPrecioCostoUnitario2']??'';break;case _0x9c0695(0x165):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0xdd)]??'';break;case _0x9c0695(0x88):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0xb4)]??'';break;case _0x9c0695(0x79):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x153)]??'';break;case _0x9c0695(0x118):_0xbd0a65[_0x1caf51]=_0x411ed0['setItemUnitAlias3']??'';break;case _0x9c0695(0x13e):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x9c)]??'';break;case _0x9c0695(0xf2):_0xbd0a65[_0x1caf51]=_0x53b9e0(_0x411ed0['setUnidadCodigo3']);break;case _0x9c0695(0xa3):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x160)]??'1';break;case _0x9c0695(0xf4):_0xbd0a65[_0x1caf51]=_0x411ed0['PEN_setMtoPrecioUnitario3']??'';break;case _0x9c0695(0xb8):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0xf5)]??'';break;case _0x9c0695(0x93):_0xbd0a65[_0x1caf51]=_0x411ed0['USD_setMtoPrecioUnitario3']??'';break;case'Precio\x20Costo\x20Dólares\x203':_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x78)]??'';break;case'¿Rastrear\x20Inventario?':_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x15e)]==0x1?'SI':'NO';break;case _0x9c0695(0xa1):_0xbd0a65[_0x1caf51]=_0x411ed0['setSucursalStock']??'';break;case'Stock\x20Mínimo':_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x10a)]??'';break;case _0x9c0695(0x162):_0xbd0a65[_0x1caf51]=_0x411ed0[_0x9c0695(0x124)]??'';break;default:_0xbd0a65[_0x1caf51]='';}}),_0xbd0a65;}),_0x47e269=0x3e8,_0x4d3f68=_0x1fa540['length'];for(let _0x551cd6=0x0;_0x551cd6<_0x4d3f68;_0x551cd6+=_0x47e269){const _0x15aed8=_0x1fa540['slice'](_0x551cd6,_0x551cd6+_0x47e269);XLSX[_0x311a77(0xb6)]['sheet_add_json'](_0x28b368,_0x15aed8,{'origin':{'r':_0x551cd6+0x2,'c':0x0},'skipHeader':!![],'header':_0xe6e19b}),postMessage({'type':_0x311a77(0xc3),'payload':{'percent':Math[_0x311a77(0xc2)]((_0x551cd6+_0x15aed8[_0x311a77(0x11a)])/_0x4d3f68*0x64),'message':_0x311a77(0xa7)+(_0x551cd6+0x1)+'–'+(_0x551cd6+_0x15aed8['length'])+_0x311a77(0xcb)+_0x4d3f68}});}const _0x1d6d76={'s':{'r':0x0,'c':0x0},'e':{'r':_0x4d3f68+0x1,'c':_0xe6e19b[_0x311a77(0x11a)]-0x1}};_0x28b368[_0x311a77(0xb3)]=XLSX[_0x311a77(0xb6)][_0x311a77(0x14d)](_0x1d6d76);const _0x6bf089=XLSX[_0x311a77(0x156)](_0x222e2b,{'bookType':_0x311a77(0xe9),'type':_0x311a77(0x101)});let _0x5ed20f,_0x22a7c3;if(_0x6bf089 instanceof Uint8Array)_0x5ed20f=_0x6bf089,_0x22a7c3=[_0x6bf089[_0x311a77(0x15b)]];else{if(_0x6bf089 instanceof ArrayBuffer)_0x5ed20f=new Uint8Array(_0x6bf089),_0x22a7c3=[_0x6bf089];else{const _0x14b722=new Uint8Array(_0x6bf089);_0x5ed20f=_0x14b722,_0x22a7c3=[_0x14b722[_0x311a77(0x15b)]];}}postMessage({'type':_0x311a77(0x144),'payload':{'wbout':_0x5ed20f,'count':_0x1fa540['length']}},_0x22a7c3);}catch(_0x1d9c5c){postMessage({'type':_0x311a77(0x7e),'payload':_0x1d9c5c['message']||String(_0x1d9c5c)});}return;}};