/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.4.7
*/

const _0x3982ed=_0x3592;(function(_0x29de16,_0x270d85){const _0x3a2058=_0x3592,_0x38eb27=_0x29de16();while(!![]){try{const _0xc4c428=parseInt(_0x3a2058(0x148))/0x1*(parseInt(_0x3a2058(0x20a))/0x2)+-parseInt(_0x3a2058(0x1d0))/0x3*(parseInt(_0x3a2058(0x1d3))/0x4)+parseInt(_0x3a2058(0x1de))/0x5+parseInt(_0x3a2058(0x1af))/0x6+parseInt(_0x3a2058(0x21e))/0x7*(-parseInt(_0x3a2058(0x1a3))/0x8)+parseInt(_0x3a2058(0x140))/0x9+parseInt(_0x3a2058(0x1c1))/0xa;if(_0xc4c428===_0x270d85)break;else _0x38eb27['push'](_0x38eb27['shift']());}catch(_0x1c47f9){_0x38eb27['push'](_0x38eb27['shift']());}}}(_0x2b93,0x3f11d));const _0x46bb6e=(function(){let _0x173516=!![];return function(_0x2f921b,_0x247108){const _0x349cb3=_0x173516?function(){const _0x186d02=_0x3592;if(_0x247108){const _0x57baa3=_0x247108[_0x186d02(0x131)](_0x2f921b,arguments);return _0x247108=null,_0x57baa3;}}:function(){};return _0x173516=![],_0x349cb3;};}()),_0x211bbf=_0x46bb6e(this,function(){const _0x50b8f4=_0x3592;return _0x211bbf[_0x50b8f4(0x19d)]()[_0x50b8f4(0x1ed)](_0x50b8f4(0x166))[_0x50b8f4(0x19d)]()['constructor'](_0x211bbf)[_0x50b8f4(0x1ed)](_0x50b8f4(0x166));});_0x211bbf();const _0xdfd0af=(function(){let _0x2398d0=!![];return function(_0x14a8ae,_0x66f20a){const _0x57bfb6=_0x2398d0?function(){if(_0x66f20a){const _0x4a34fd=_0x66f20a['apply'](_0x14a8ae,arguments);return _0x66f20a=null,_0x4a34fd;}}:function(){};return _0x2398d0=![],_0x57bfb6;};}()),_0x17cf7f=_0xdfd0af(this,function(){const _0x31a8e0=_0x3592;let _0x453cdb;try{const _0x54f4a7=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x453cdb=_0x54f4a7();}catch(_0x14a43a){_0x453cdb=window;}const _0x52992f=_0x453cdb['console']=_0x453cdb[_0x31a8e0(0x141)]||{},_0x4791ab=[_0x31a8e0(0x220),_0x31a8e0(0x1aa),_0x31a8e0(0x14e),'error',_0x31a8e0(0x177),_0x31a8e0(0x15e),_0x31a8e0(0x1ca)];for(let _0x191a87=0x0;_0x191a87<_0x4791ab['length'];_0x191a87++){const _0x1e80d7=_0xdfd0af['constructor'][_0x31a8e0(0x1b2)][_0x31a8e0(0x221)](_0xdfd0af),_0x5503db=_0x4791ab[_0x191a87],_0x2491a3=_0x52992f[_0x5503db]||_0x1e80d7;_0x1e80d7[_0x31a8e0(0x1a4)]=_0xdfd0af[_0x31a8e0(0x221)](_0xdfd0af),_0x1e80d7[_0x31a8e0(0x19d)]=_0x2491a3[_0x31a8e0(0x19d)][_0x31a8e0(0x221)](_0x2491a3),_0x52992f[_0x5503db]=_0x1e80d7;}});function _0x2b93(){const _0x582780=['168uNaUfs','__proto__','Alias\x203','setWarehouseStockMin','ID\x20UNIT','Alias','Precio\x20Costo\x20Dólares','warn','padStart','progress','keys','Precio\x20Costo\x20Soles','116532yeNLEa','FOT','SET','prototype','Servicio','PAQUETE','PIES\x20CUADRADOS','Exportando\x20filas\x20','MILILITRO','Gravado\x20Gratuito\x20(18%)','FARDO','MILLON\x20DE\x20UNIDADES','setItemBarCode3','setItemVariantValues','BARRILES','MTQ','KILOGRAMO','Artículo','1004300wACKrz','Comisión\x20Venta\x203\x20(%)','HECTOLITRO','length','YARDA','Serie','PEN_setMtoPrecioCostoUnitario3','Precio\x20Venta\x20Soles\x202','Stock\x20Mínimo','trace','setBatchExpirationDate','LTR','done','Precio\x20Costo\x20Dólares\x203','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','6pQekND','USD_setMtoPrecioCostoUnitario2','setUnidadCodigo3','204416eRCEvt','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','DZN','setItemBarCode2','TNE','LATAS','CENTIMETRO\x20CUADRADO','decode_range','CAJA','MEGAWATT\x20HORA','DOCENA\x20POR\x2010**6','2176870mYPHmC','setUnidadEquivalencia2','HOJA','Equivalencia\x203','KIT','MMT','SACO','UNIDAD\x20(NIU)','setDescripcion','Sheets','MMQ','Gravado\x20(18%)','RESMA','LTN','Descripción','search','Iniciando\x20parseo…','array','setMarca','reduce','GALON\x20INGLES\x20(4,545956L)','isArray','USD_setMtoPrecioCostoUnitario','Precio\x20Venta\x20Soles\x203','Unidad\x20de\x20Medida*','MMK','exportItems:\x20productos\x20no\x20clonables:\x20','CONOS','Lote','PEN_setMtoPrecioUnitario3','PEN_setMtoPrecioCostoUnitario2','Combo','MTK','setItemCommissionPercentage2','push','Código\x20SKU*','UNIDAD\x20(ZZ)','TAMBOR','exportDone','STN','setUnidadEquivalencia3','MTR','setItemType','Marca','24zwNhGW','Precio\x20Venta\x20Dólares','CIENTO\x20DE\x20UNIDADES','import','Equivalencia\x202','Unidad\x20de\x20Medida\x203','forEach','utils','Comisión\x20Venta\x20(%)','parse_date_code','Fecha\x20de\x20Vencimiento','setItemIsBought','KWH','CARTONES','\x20de\x20','YRD','write','ONZ','Alias\x202','DOCENA','110173jMPRiR','Color','log','bind','read','PEN_setMtoPrecioCostoUnitario','LEF','setUnitId','encode_range','MILIMETRO','setUnitId2','trim','CEN','Precio\x20Costo\x20Dólares\x202','buffer','Rastrear\x20Inventario','C62','DZP','setInventariable','setUnitId3','MGM','Precio\x20Costo\x20Soles\x202','setItemIsSold','Inafecto\x20Gratuito\x20(0%)','PALETAS','ID\x20UNIT\x203','MILLARES','GLL','apply','setTaxId','JUEGO','KILOMETRO','map','Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.','CENTIMETRO\x20LINEAL','TONELADA\x20LARGA','CMK','METRO\x20CUBICO','MILIGRAMOS','CILINDRO','!ref','MILIMETRO\x20CUADRADO','QUINTAL','1034262mNDOhI','console','MILIMETRO\x20CUBICO','find','SheetNames','Gravado\x20(10%)','PLIEGO','xlsx','1743WgrLgh','NIU','Comisión\x20Venta\x202\x20(%)','Modelo\x20de\x20Manga','setItemUnitAlias2','Se\x20Compra','info','FTK','Unidad\x20de\x20Medida\x202','QQM','setCategoria','PAR','setItemDescription','USD_setMtoPrecioUnitario2','message','HLT','value','TONELADAS','SSF','PULGADAS','Exonerado\x20(0%)','USD_setMtoPrecioUnitario3','table','YARDA\x20CUADRADA','Talla','Fabricado','Procesadas\x20filas\x20','US\x20GALON\x20(3,7843\x20L)','MLT','code','(((.+)+)+)+$','filter','Nombre*','error','setItemCommissionPercentage','YDK','LIBRAS','BOTELLAS','ID\x20UNIT\x202','Precio\x20Venta\x20Soles','ONZAS','Ubicación','Exonerado\x20Gratuito\x20(0%)','setItemBarCode','KGM','toLowerCase','PEN_setMtoPrecioUnitario2','exception','round','FTQ','KILOVATIO\x20HORA','getFullYear','sheet_to_json','GRM','METRO','PIES','CMQ','exportItems:\x20products\x20no\x20es\x20Array.','sheet_add_json','setUnidadCodigo','Precio\x20Venta\x20Dólares\x202','PIES\x20CUBICOS','UND\x20(NIU)','BOLSA','Stock\x20Actual','some','Se\x20Vende','TONELADA\x20CORTA','getMonth','Precio\x20Venta\x20Dólares\x203','No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).','USD_setMtoPrecioCostoUnitario3','PIEZAS','Tipo*','Impuesto*','METRO\x20CUADRADO','Precio\x20Costo\x20Soles\x203','CENTIMETRO\x20CUBICO','BOBINAS','BLL','slice','Código\x20de\x20Barras\x203','GRAMO','BALDE','Categoría','toString','PLACAS','Código\x20de\x20Barras','GRUESA','KTM','Código\x20de\x20Barras\x202'];_0x2b93=function(){return _0x582780;};return _0x2b93();}function _0x3592(_0x5e5281,_0x48ea6d){const _0xe5d7d=_0x2b93();return _0x3592=function(_0x17cf7f,_0xdfd0af){_0x17cf7f=_0x17cf7f-0x119;let _0x1c16b5=_0xe5d7d[_0x17cf7f];return _0x1c16b5;},_0x3592(_0x5e5281,_0x48ea6d);}_0x17cf7f(),importScripts(_0x3982ed(0x1d4)),onmessage=({data:_0x474452})=>{const _0x459fa8=_0x3982ed,{action:_0x52965f}=_0x474452;if(_0x52965f===_0x459fa8(0x20d)){const {buf:_0x3baa18,maxRows:_0x247d8b}=_0x474452;try{postMessage({'type':_0x459fa8(0x1ac),'payload':{'percent':0x5,'message':_0x459fa8(0x1ee)}});const _0x9076b8=XLSX['read'](_0x3baa18,{'type':_0x459fa8(0x1ef),'cellDates':!![]}),_0x2c4511=_0x9076b8[_0x459fa8(0x1e7)][_0x9076b8[_0x459fa8(0x144)][0x0]],_0x5e9b32=XLSX[_0x459fa8(0x211)]['sheet_to_json'](_0x2c4511,{'defval':'','range':0x1,'cellDates':!![]}),_0x43b65d=_0x5e9b32['findIndex'](_0xb73da9=>(!_0xb73da9[_0x459fa8(0x191)]||String(_0xb73da9['Tipo*'])[_0x459fa8(0x120)]()==='')&&(!_0xb73da9[_0x459fa8(0x201)]||String(_0xb73da9[_0x459fa8(0x201)])[_0x459fa8(0x120)]()==='')&&(!_0xb73da9[_0x459fa8(0x168)]||String(_0xb73da9[_0x459fa8(0x168)])[_0x459fa8(0x120)]()==='')&&(!_0xb73da9[_0x459fa8(0x1f6)]||String(_0xb73da9[_0x459fa8(0x1f6)])[_0x459fa8(0x120)]()==='')),_0x39c1c0=_0x43b65d>=0x0?_0x5e9b32['slice'](0x0,_0x43b65d):_0x5e9b32,_0x407149=_0x39c1c0[_0x459fa8(0x167)](_0x30941=>_0x30941[_0x459fa8(0x191)]&&String(_0x30941[_0x459fa8(0x191)])[_0x459fa8(0x120)]()!==''&&_0x30941[_0x459fa8(0x201)]&&String(_0x30941[_0x459fa8(0x201)])[_0x459fa8(0x120)]()!==''&&_0x30941['Nombre*']&&String(_0x30941[_0x459fa8(0x168)])['trim']()!==''&&_0x30941['Unidad\x20de\x20Medida*']&&String(_0x30941['Unidad\x20de\x20Medida*'])['trim']()!==''),_0x265d13=_0x407149[_0x459fa8(0x1c4)];if(_0x265d13===0x0){postMessage({'type':_0x459fa8(0x169),'payload':_0x459fa8(0x18e)});return;}if(_0x265d13>_0x247d8b)throw'El\x20archivo\x20tiene\x20'+_0x265d13+_0x459fa8(0x1cf)+_0x247d8b+'.';const _0x8b27ec=0x1f4,_0x6e3776=[],_0x5f0bda=[{'codigo':'4A','nombre':_0x459fa8(0x196)},{'codigo':'BJ','nombre':_0x459fa8(0x19b)},{'codigo':_0x459fa8(0x197),'nombre':_0x459fa8(0x1bd)},{'codigo':'BG','nombre':_0x459fa8(0x187)},{'codigo':'BO','nombre':_0x459fa8(0x16d)},{'codigo':'BX','nombre':_0x459fa8(0x1db)},{'codigo':'CT','nombre':_0x459fa8(0x217)},{'codigo':_0x459fa8(0x139),'nombre':_0x459fa8(0x1d9)},{'codigo':_0x459fa8(0x180),'nombre':_0x459fa8(0x195)},{'codigo':'CMT','nombre':_0x459fa8(0x137)},{'codigo':_0x459fa8(0x121),'nombre':_0x459fa8(0x20c)},{'codigo':'CY','nombre':'CILINDRO'},{'codigo':'CJ','nombre':_0x459fa8(0x1f9)},{'codigo':_0x459fa8(0x1d5),'nombre':_0x459fa8(0x21d)},{'codigo':_0x459fa8(0x126),'nombre':_0x459fa8(0x1dd)},{'codigo':'BE','nombre':_0x459fa8(0x1b9)},{'codigo':'GLI','nombre':_0x459fa8(0x1f2)},{'codigo':_0x459fa8(0x17d),'nombre':_0x459fa8(0x19a)},{'codigo':'GRO','nombre':'GRUESA'},{'codigo':_0x459fa8(0x157),'nombre':_0x459fa8(0x1c3)},{'codigo':_0x459fa8(0x11b),'nombre':_0x459fa8(0x1e0)},{'codigo':_0x459fa8(0x1b1),'nombre':'JUEGO'},{'codigo':_0x459fa8(0x174),'nombre':_0x459fa8(0x1bf)},{'codigo':_0x459fa8(0x1a1),'nombre':_0x459fa8(0x134)},{'codigo':_0x459fa8(0x216),'nombre':_0x459fa8(0x17a)},{'codigo':'KT','nombre':_0x459fa8(0x1e2)},{'codigo':'CA','nombre':_0x459fa8(0x1d8)},{'codigo':'LBR','nombre':_0x459fa8(0x16c)},{'codigo':_0x459fa8(0x1cc),'nombre':'LITRO'},{'codigo':'MWH','nombre':_0x459fa8(0x1dc)},{'codigo':_0x459fa8(0x207),'nombre':_0x459fa8(0x17e)},{'codigo':_0x459fa8(0x1fe),'nombre':_0x459fa8(0x193)},{'codigo':_0x459fa8(0x1be),'nombre':_0x459fa8(0x13a)},{'codigo':_0x459fa8(0x129),'nombre':_0x459fa8(0x13b)},{'codigo':_0x459fa8(0x164),'nombre':_0x459fa8(0x1b7)},{'codigo':_0x459fa8(0x1e3),'nombre':_0x459fa8(0x11e)},{'codigo':_0x459fa8(0x1f7),'nombre':_0x459fa8(0x13e)},{'codigo':_0x459fa8(0x1e8),'nombre':_0x459fa8(0x142)},{'codigo':'MIL','nombre':_0x459fa8(0x12f)},{'codigo':'UM','nombre':_0x459fa8(0x1ba)},{'codigo':_0x459fa8(0x21b),'nombre':_0x459fa8(0x170)},{'codigo':'PF','nombre':_0x459fa8(0x12d)},{'codigo':'PK','nombre':_0x459fa8(0x1b4)},{'codigo':'PR','nombre':_0x459fa8(0x153)},{'codigo':_0x459fa8(0x1b0),'nombre':_0x459fa8(0x17f)},{'codigo':_0x459fa8(0x14f),'nombre':_0x459fa8(0x1b5)},{'codigo':_0x459fa8(0x179),'nombre':_0x459fa8(0x185)},{'codigo':_0x459fa8(0x125),'nombre':_0x459fa8(0x190)},{'codigo':'PG','nombre':_0x459fa8(0x19e)},{'codigo':'ST','nombre':'PLIEGO'},{'codigo':'INH','nombre':_0x459fa8(0x15b)},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':_0x459fa8(0x1e4)},{'codigo':'DR','nombre':_0x459fa8(0x203)},{'codigo':_0x459fa8(0x205),'nombre':_0x459fa8(0x18b)},{'codigo':_0x459fa8(0x1eb),'nombre':_0x459fa8(0x138)},{'codigo':_0x459fa8(0x1d7),'nombre':_0x459fa8(0x159)},{'codigo':'TU','nombre':'TUBOS'},{'codigo':_0x459fa8(0x149),'nombre':_0x459fa8(0x1e5)},{'codigo':'ZZ','nombre':'UNIDAD\x20(ZZ)'},{'codigo':_0x459fa8(0x130),'nombre':_0x459fa8(0x163)},{'codigo':_0x459fa8(0x219),'nombre':_0x459fa8(0x1c5)},{'codigo':_0x459fa8(0x16b),'nombre':_0x459fa8(0x15f)},{'codigo':_0x459fa8(0x151),'nombre':_0x459fa8(0x13f)}],_0x19e5b5=_0x5f0bda[_0x459fa8(0x1f1)]((_0x4aea70,{nombre:_0x694183,codigo:_0x49ac5f})=>{const _0x10119d=_0x459fa8;return _0x4aea70[_0x694183[_0x10119d(0x120)]()]=_0x49ac5f[_0x10119d(0x120)](),_0x4aea70;},{});for(let _0x176b9e=0x0;_0x176b9e<_0x265d13;_0x176b9e+=_0x8b27ec){const _0x2e656f=_0x407149[_0x459fa8(0x198)](_0x176b9e,_0x176b9e+_0x8b27ec)[_0x459fa8(0x135)]((_0x9558db,_0x9d7933)=>{const _0xea6273=_0x459fa8;let _0x57e195={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x9558db[_0xea6273(0x191)]]||'1';const _0x437bf9=String(_0x9558db[_0xea6273(0x192)])[_0xea6273(0x120)](),_0x5eba66={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0x50abab=_0x5eba66[_0x437bf9]||'1',_0x3f7af7={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0x50abab]||{'code':'10','value':0x12},_0x17d71f={};let _0x3349c2=String(_0x9558db[_0xea6273(0x168)])['trim']();const _0x5dcf19=[_0xea6273(0x1fa),_0xea6273(0x160),_0xea6273(0x21f),'Género','Modelo',_0xea6273(0x1c6),'Material','Modelo\x20de\x20Cuello',_0xea6273(0x14b)];_0x5dcf19[_0xea6273(0x210)](_0x1455e2=>{const _0x4e4e54=_0xea6273,_0x4f73d3=String(_0x9558db[_0x1455e2]||'')[_0x4e4e54(0x120)]();_0x4f73d3&&(_0x17d71f[_0x1455e2]=_0x4f73d3,_0x3349c2+='\x20'+_0x1455e2+'\x20'+_0x4f73d3);});const _0x908864=[],_0x5cc7db=String(_0x9558db['Unidad\x20de\x20Medida*']||_0xea6273(0x1e5))[_0xea6273(0x120)](),_0x3ac146=_0x19e5b5[_0x5cc7db]||'NIU',_0x242f5c=String(_0x9558db[_0xea6273(0x1a8)])[_0xea6273(0x120)]();_0x908864[_0xea6273(0x200)]({'setItemUnitId':String(_0x9558db[_0xea6273(0x1a7)])[_0xea6273(0x120)]()||'','setItemBarCode':String(_0x9558db[_0xea6273(0x19f)])[_0xea6273(0x120)]()||'','setAlias':_0x242f5c,'setUnitCode':_0x3ac146,'setPrice':parseFloat(_0x9558db[_0xea6273(0x16f)]),'setCost':parseFloat(_0x9558db[_0xea6273(0x1ae)]),'setPriceUSD':parseFloat(_0x9558db[_0xea6273(0x20b)]),'setCostUSD':parseFloat(_0x9558db[_0xea6273(0x1a9)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x9558db[_0xea6273(0x212)])});const _0x4e21e7=[_0xea6273(0x16e),_0xea6273(0x21c),_0xea6273(0x1a2),'Equivalencia\x202',_0xea6273(0x1c8),_0xea6273(0x12a),_0xea6273(0x184),'Precio\x20Costo\x20Dólares\x202'][_0xea6273(0x189)](_0x1dd30c=>{const _0x1fc1df=_0xea6273,_0x35f1a0=_0x9558db[_0x1dd30c];return _0x35f1a0!=null&&String(_0x35f1a0)[_0x1fc1df(0x120)]()!=='';});if(_0x4e21e7){const _0xb49c7b=String(_0x9558db['Unidad\x20de\x20Medida\x202']||_0xea6273(0x186))[_0xea6273(0x120)](),_0x98e90b=_0x19e5b5[_0xb49c7b]||_0xea6273(0x149);_0x908864['push']({'setItemUnitId':String(_0x9558db['ID\x20UNIT\x202'])[_0xea6273(0x120)]()||'','setItemBarCode':String(_0x9558db[_0xea6273(0x1a2)])[_0xea6273(0x120)]()||'','setAlias':String(_0x9558db[_0xea6273(0x21c)])[_0xea6273(0x120)](),'setUnitCode':_0x98e90b,'setPrice':parseFloat(_0x9558db[_0xea6273(0x1c8)]),'setCost':parseFloat(_0x9558db[_0xea6273(0x12a)]),'setPriceUSD':parseFloat(_0x9558db[_0xea6273(0x184)]),'setCostUSD':parseFloat(_0x9558db[_0xea6273(0x122)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x9558db[_0xea6273(0x20e)])||0x1,'setFactor':parseFloat(_0x9558db[_0xea6273(0x20e)])||0x1,'setItemCommissionPercentage':parseFloat(_0x9558db[_0xea6273(0x14a)])});}const _0x396cd0=[_0xea6273(0x12e),_0xea6273(0x1a5),'Código\x20de\x20Barras\x203','Equivalencia\x203','Precio\x20Venta\x20Soles\x203',_0xea6273(0x194),_0xea6273(0x18d),_0xea6273(0x1ce)][_0xea6273(0x189)](_0x55eec8=>{const _0x3e715e=_0xea6273,_0x5690bc=_0x9558db[_0x55eec8];return _0x5690bc!=null&&String(_0x5690bc)[_0x3e715e(0x120)]()!=='';});if(_0x396cd0){const _0x4d716e=String(_0x9558db[_0xea6273(0x20f)]||_0xea6273(0x186))['trim'](),_0x3af1b4=_0x19e5b5[_0x4d716e]||_0xea6273(0x149);_0x908864['push']({'setItemUnitId':String(_0x9558db[_0xea6273(0x12e)])[_0xea6273(0x120)]()||'','setItemBarCode':String(_0x9558db[_0xea6273(0x199)])[_0xea6273(0x120)]()||'','setAlias':String(_0x9558db[_0xea6273(0x1a5)])['trim'](),'setUnitCode':_0x3af1b4,'setPrice':parseFloat(_0x9558db[_0xea6273(0x1f5)]),'setCost':parseFloat(_0x9558db['Precio\x20Costo\x20Soles\x203']),'setPriceUSD':parseFloat(_0x9558db[_0xea6273(0x18d)]),'setCostUSD':parseFloat(_0x9558db[_0xea6273(0x1ce)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x9558db['Equivalencia\x203'])||0x1,'setFactor':parseFloat(_0x9558db[_0xea6273(0x1e1)])||0x1,'setItemCommissionPercentage':parseFloat(_0x9558db[_0xea6273(0x1c2)])});}let _0x351771=_0x9558db[_0xea6273(0x214)],_0x3c772d='';if(_0x351771 instanceof Date){const _0x178f3c=_0x351771[_0xea6273(0x17b)](),_0x4ff7f8=String(_0x351771[_0xea6273(0x18c)]()+0x1)[_0xea6273(0x1ab)](0x2,'0'),_0x38914a=String(_0x351771['getDate']())[_0xea6273(0x1ab)](0x2,'0');_0x3c772d=_0x178f3c+'-'+_0x4ff7f8+'-'+_0x38914a;}else{if(typeof _0x351771==='number'){const _0x24946=XLSX[_0xea6273(0x15a)][_0xea6273(0x213)](_0x351771);if(_0x24946){const _0x393a78=_0x24946['y'],_0x3c75c7=String(_0x24946['m'])[_0xea6273(0x1ab)](0x2,'0'),_0x4df8b6=String(_0x24946['d'])[_0xea6273(0x1ab)](0x2,'0');_0x3c772d=_0x393a78+'-'+_0x3c75c7+'-'+_0x4df8b6;}}else _0x3c772d=String(_0x351771||'')[_0xea6273(0x120)]();}return{'setItemId':String(_0x9558db['ID'])[_0xea6273(0x120)](),'setItemType':_0x57e195,'setItemCode':String(_0x9558db[_0xea6273(0x201)])[_0xea6273(0x120)](),'setItemName':String(_0x9558db['Nombre*'])[_0xea6273(0x120)](),'setItemDescription':String(_0x9558db[_0xea6273(0x1ec)])['trim']()||'','setItemIsSold':_0x9558db[_0xea6273(0x18a)]=='SI'?0x1:0x0,'setItemIsBought':_0x9558db[_0xea6273(0x14d)]=='SI'?0x1:0x0,'setItemCategories':_0x9558db[_0xea6273(0x19c)]?[String(_0x9558db[_0xea6273(0x19c)])['trim']()]:[],'setItemBrands':_0x9558db[_0xea6273(0x209)]?[String(_0x9558db['Marca'])['trim']()]:[],'setItemTaxId':_0x50abab,'setItemTaxCode':_0x3f7af7[_0xea6273(0x165)],'setItemTaxValue':_0x3f7af7[_0xea6273(0x158)],'setItemUnits':_0x908864,'setItemInventoriable':_0x9558db[_0xea6273(0x124)]=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x9558db[_0xea6273(0x188)])||0x0,'setStockMinimum':parseFloat(_0x9558db[_0xea6273(0x1c9)])||0x0,'setItemLocation':String(_0x9558db[_0xea6273(0x171)])[_0xea6273(0x120)]()||'','setBatchName':String(_0x9558db[_0xea6273(0x1fa)])[_0xea6273(0x120)]()||'','setItemDateExpiry':_0x3c772d,'setItemVariantName':_0x3349c2,'setItemVariantValues':_0x17d71f,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x6e3776['push'](..._0x2e656f),postMessage({'type':'progress','payload':{'percent':Math[_0x459fa8(0x178)]((_0x176b9e+_0x2e656f['length'])/_0x265d13*0x64),'message':_0x459fa8(0x162)+(_0x176b9e+0x1)+'–'+(_0x176b9e+_0x2e656f[_0x459fa8(0x1c4)])+'/'+_0x265d13}});}postMessage({'type':_0x459fa8(0x1cd),'payload':{'items':_0x6e3776}});}catch(_0x2b9538){postMessage({'type':'error','payload':_0x2b9538[_0x459fa8(0x156)]||_0x2b9538});}}if(_0x52965f==='exportItems'){const {products:_0x6cf80c,plantillaBuf:_0x5f3c96}=_0x474452;if(!(_0x5f3c96 instanceof ArrayBuffer)){postMessage({'type':_0x459fa8(0x169),'payload':_0x459fa8(0x136)});return;}if(!Array[_0x459fa8(0x1f3)](_0x6cf80c)){postMessage({'type':_0x459fa8(0x169),'payload':_0x459fa8(0x181)});return;}try{structuredClone(_0x6cf80c);}catch(_0xc6e2af){postMessage({'type':'error','payload':_0x459fa8(0x1f8)+_0xc6e2af['message']});return;}try{const _0x11cf90={'1':'Artículo','2':_0x459fa8(0x1b3),'3':'Materia\x20Prima','4':_0x459fa8(0x1fd),'5':_0x459fa8(0x161)};function _0x5dac62(_0x35216a){const _0x2f6d36=_0x459fa8;return _0x11cf90[String(_0x35216a)]||_0x2f6d36(0x1c0);}const _0x34c6c6={'1':_0x459fa8(0x1e9),'2':_0x459fa8(0x15c),'3':'Inafecto\x20(0%)','4':_0x459fa8(0x1b8),'5':_0x459fa8(0x12c),'6':_0x459fa8(0x145),'7':_0x459fa8(0x172),'8':'Exportación\x20(0%)','9':'Gravado\x20Gratuito\x20(10%)'};function _0xd2d4c2(_0x6c2fea){const _0x5d7cad=_0x459fa8;return _0x34c6c6[String(_0x6c2fea)]||_0x5d7cad(0x1e9);}const _0x27102c={'4A':'BOBINAS','BJ':_0x459fa8(0x19b),'BLL':_0x459fa8(0x1bd),'BG':_0x459fa8(0x187),'BO':_0x459fa8(0x16d),'BX':_0x459fa8(0x1db),'CT':'CARTONES','CMK':_0x459fa8(0x1d9),'CMQ':_0x459fa8(0x195),'CMT':_0x459fa8(0x137),'CEN':_0x459fa8(0x20c),'CY':_0x459fa8(0x13c),'CJ':'CONOS','DZN':_0x459fa8(0x21d),'DZP':_0x459fa8(0x1dd),'BE':_0x459fa8(0x1b9),'GLI':_0x459fa8(0x1f2),'GRM':_0x459fa8(0x19a),'GRO':_0x459fa8(0x1a0),'HLT':'HECTOLITRO','LEF':_0x459fa8(0x1e0),'SET':_0x459fa8(0x133),'KGM':_0x459fa8(0x1bf),'KTM':_0x459fa8(0x134),'KWH':'KILOVATIO\x20HORA','KT':_0x459fa8(0x1e2),'CA':_0x459fa8(0x1d8),'LBR':_0x459fa8(0x16c),'LTR':'LITRO','MWH':_0x459fa8(0x1dc),'MTR':_0x459fa8(0x17e),'MTK':_0x459fa8(0x193),'MTQ':_0x459fa8(0x13a),'MGM':_0x459fa8(0x13b),'MLT':_0x459fa8(0x1b7),'MMT':_0x459fa8(0x11e),'MMK':_0x459fa8(0x13e),'MMQ':_0x459fa8(0x142),'MIL':_0x459fa8(0x12f),'UM':_0x459fa8(0x1ba),'ONZ':_0x459fa8(0x170),'PF':_0x459fa8(0x12d),'PK':_0x459fa8(0x1b4),'PR':'PAR','FOT':'PIES','FTK':_0x459fa8(0x1b5),'FTQ':_0x459fa8(0x185),'C62':_0x459fa8(0x190),'PG':_0x459fa8(0x19e),'ST':_0x459fa8(0x146),'INH':_0x459fa8(0x15b),'RM':_0x459fa8(0x1ea),'SA':_0x459fa8(0x1e4),'DR':_0x459fa8(0x203),'STN':'TONELADA\x20CORTA','LTN':_0x459fa8(0x138),'TNE':'TONELADAS','TU':'TUBOS','NIU':_0x459fa8(0x1e5),'ZZ':_0x459fa8(0x202),'GLL':_0x459fa8(0x163),'YRD':_0x459fa8(0x1c5),'YDK':_0x459fa8(0x15f),'QQM':_0x459fa8(0x13f)};function _0x4fce1b(_0x1821eb){return _0x27102c[String(_0x1821eb)]||'';}const _0x1bfbab=XLSX[_0x459fa8(0x119)](_0x5f3c96,{'type':'array','cellDates':!![]}),_0x3b5051=_0x1bfbab[_0x459fa8(0x144)][0x0],_0x5646d2=_0x1bfbab[_0x459fa8(0x1e7)][_0x3b5051],_0x58d1b1=XLSX[_0x459fa8(0x211)][_0x459fa8(0x17c)](_0x5646d2,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x131b2c=XLSX['utils'][_0x459fa8(0x1da)](_0x5646d2[_0x459fa8(0x13d)]||'');for(let _0x59174c=0x2;_0x59174c<=_0x131b2c['e']['r'];++_0x59174c){for(let _0x43e1ab=_0x131b2c['s']['c'];_0x43e1ab<=_0x131b2c['e']['c'];++_0x43e1ab){const _0x10d3c8=XLSX[_0x459fa8(0x211)]['encode_cell']({'r':_0x59174c,'c':_0x43e1ab});if(_0x5646d2[_0x10d3c8])delete _0x5646d2[_0x10d3c8];}}const _0x3e2402=_0x6cf80c['map'](_0x341e5e=>{const _0x512de6=_0x459fa8;_0x341e5e[_0x512de6(0x1bc)]=_0x341e5e[_0x512de6(0x1bc)]||{};const _0x3e7f50={};return _0x58d1b1[_0x512de6(0x210)](_0x454cab=>{const _0x1e4fcd=_0x512de6,_0x552cf5=String(_0x454cab)[_0x1e4fcd(0x120)](),_0x5ac3e0=_0x552cf5[_0x1e4fcd(0x175)](),_0x797778=Object[_0x1e4fcd(0x1ad)](_0x341e5e)[_0x1e4fcd(0x143)](_0x41bc1f=>_0x41bc1f['trim']()[_0x1e4fcd(0x175)]()===_0x5ac3e0);if(_0x797778){_0x3e7f50[_0x552cf5]=_0x341e5e[_0x797778]??'';return;}switch(_0x552cf5){case'ID':_0x3e7f50[_0x552cf5]=_0x341e5e['id']??'';break;case'Tipo*':_0x3e7f50[_0x552cf5]=_0x5dac62(_0x341e5e[_0x1e4fcd(0x208)]);break;case'Código\x20SKU*':_0x3e7f50[_0x552cf5]=_0x341e5e['setCodProducto']??'';break;case _0x1e4fcd(0x168):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1e6)]??'';break;case _0x1e4fcd(0x1ec):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x154)]??'';break;case _0x1e4fcd(0x18a):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x12b)]==0x1?'SI':'NO';break;case'Se\x20Compra':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x215)]==0x1?'SI':'NO';break;case'Categoría':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x152)]??'';break;case _0x1e4fcd(0x209):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1f0)]??'';break;case'Impuesto*':_0x3e7f50[_0x552cf5]=_0xd2d4c2(_0x341e5e[_0x1e4fcd(0x132)]);break;case'ID\x20UNIT':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x11c)]??'';break;case _0x1e4fcd(0x1a8):_0x3e7f50[_0x552cf5]=_0x341e5e['setItemUnitAlias']??'';break;case'Código\x20de\x20Barras':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x173)]??'';break;case _0x1e4fcd(0x1f6):_0x3e7f50[_0x552cf5]=_0x4fce1b(_0x341e5e[_0x1e4fcd(0x183)]);break;case _0x1e4fcd(0x16f):_0x3e7f50[_0x552cf5]=_0x341e5e['PEN_setMtoPrecioUnitario']??'';break;case'Precio\x20Costo\x20Soles':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x11a)]??'';break;case'Precio\x20Venta\x20Dólares':_0x3e7f50[_0x552cf5]=_0x341e5e['USD_setMtoPrecioUnitario']??'';break;case'Precio\x20Costo\x20Dólares':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1f4)]??'';break;case _0x1e4fcd(0x212):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x16a)]??0x0;break;case _0x1e4fcd(0x16e):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x11f)]??'';break;case _0x1e4fcd(0x21c):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x14c)]??'';break;case _0x1e4fcd(0x1a2):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1d6)]??'';break;case _0x1e4fcd(0x150):_0x3e7f50[_0x552cf5]=_0x4fce1b(_0x341e5e['setUnidadCodigo2']);break;case _0x1e4fcd(0x20e):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1df)]??'1';break;case'Precio\x20Venta\x20Soles\x202':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x176)]??'';break;case'Precio\x20Costo\x20Soles\x202':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1fc)]??'';break;case'Precio\x20Venta\x20Dólares\x202':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x155)]??'';break;case _0x1e4fcd(0x122):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1d1)]??'';break;case'Comisión\x20Venta\x202\x20(%)':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1ff)]??0x0;break;case'ID\x20UNIT\x203':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x128)]??'';break;case _0x1e4fcd(0x1a5):_0x3e7f50[_0x552cf5]=_0x341e5e['setItemUnitAlias3']??'';break;case _0x1e4fcd(0x199):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1bb)]??'';break;case _0x1e4fcd(0x20f):_0x3e7f50[_0x552cf5]=_0x4fce1b(_0x341e5e[_0x1e4fcd(0x1d2)]);break;case _0x1e4fcd(0x1e1):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x206)]??'1';break;case'Precio\x20Venta\x20Soles\x203':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1fb)]??'';break;case _0x1e4fcd(0x194):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1c7)]??'';break;case _0x1e4fcd(0x18d):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x15d)]??'';break;case _0x1e4fcd(0x1ce):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x18f)]??'';break;case _0x1e4fcd(0x1c2):_0x3e7f50[_0x552cf5]=_0x341e5e['setItemCommissionPercentage3']??0x0;break;case'Rastrear\x20Inventario':_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x127)]==0x1?'SI':'NO';break;case _0x1e4fcd(0x188):_0x3e7f50[_0x552cf5]=_0x341e5e['setSucursalStock']??'';break;case _0x1e4fcd(0x1c9):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1a6)]??'';break;case _0x1e4fcd(0x214):_0x3e7f50[_0x552cf5]=_0x341e5e[_0x1e4fcd(0x1cb)]??'';break;default:_0x3e7f50[_0x552cf5]='';}}),_0x3e7f50;}),_0x12479e=0x3e8,_0x5a002f=_0x3e2402[_0x459fa8(0x1c4)];for(let _0x3a75a9=0x0;_0x3a75a9<_0x5a002f;_0x3a75a9+=_0x12479e){const _0x14b945=_0x3e2402[_0x459fa8(0x198)](_0x3a75a9,_0x3a75a9+_0x12479e);XLSX[_0x459fa8(0x211)][_0x459fa8(0x182)](_0x5646d2,_0x14b945,{'origin':{'r':_0x3a75a9+0x2,'c':0x0},'skipHeader':!![],'header':_0x58d1b1}),postMessage({'type':_0x459fa8(0x1ac),'payload':{'percent':Math['round']((_0x3a75a9+_0x14b945['length'])/_0x5a002f*0x64),'message':_0x459fa8(0x1b6)+(_0x3a75a9+0x1)+'–'+(_0x3a75a9+_0x14b945[_0x459fa8(0x1c4)])+_0x459fa8(0x218)+_0x5a002f}});}const _0x54ab05={'s':{'r':0x0,'c':0x0},'e':{'r':_0x5a002f+0x1,'c':_0x58d1b1[_0x459fa8(0x1c4)]-0x1}};_0x5646d2[_0x459fa8(0x13d)]=XLSX['utils'][_0x459fa8(0x11d)](_0x54ab05);const _0x3adf12=XLSX[_0x459fa8(0x21a)](_0x1bfbab,{'bookType':_0x459fa8(0x147),'type':'array'});let _0x3d3892,_0x58fdea;if(_0x3adf12 instanceof Uint8Array)_0x3d3892=_0x3adf12,_0x58fdea=[_0x3adf12['buffer']];else{if(_0x3adf12 instanceof ArrayBuffer)_0x3d3892=new Uint8Array(_0x3adf12),_0x58fdea=[_0x3adf12];else{const _0x3b7195=new Uint8Array(_0x3adf12);_0x3d3892=_0x3b7195,_0x58fdea=[_0x3b7195[_0x459fa8(0x123)]];}}postMessage({'type':_0x459fa8(0x204),'payload':{'wbout':_0x3d3892,'count':_0x3e2402[_0x459fa8(0x1c4)]}},_0x58fdea);}catch(_0x4f776c){postMessage({'type':_0x459fa8(0x169),'payload':_0x4f776c[_0x459fa8(0x156)]||String(_0x4f776c)});}return;}};