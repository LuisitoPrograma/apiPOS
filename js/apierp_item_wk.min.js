/*
Name: apiPOS
Author: Luisito Programa
Website 1: luisitoprograma.com
Website 2: apiERP.dev
version: 4.4.8
*/

const _0x1a9177=_0x2e56;(function(_0xb5d54e,_0x264f32){const _0x540814=_0x2e56,_0x11ce74=_0xb5d54e();while(!![]){try{const _0x1ea213=parseInt(_0x540814(0xf6))/0x1+-parseInt(_0x540814(0x173))/0x2+parseInt(_0x540814(0x16b))/0x3+-parseInt(_0x540814(0x158))/0x4+parseInt(_0x540814(0xdf))/0x5*(parseInt(_0x540814(0x1a1))/0x6)+parseInt(_0x540814(0x181))/0x7+-parseInt(_0x540814(0x1aa))/0x8*(parseInt(_0x540814(0x183))/0x9);if(_0x1ea213===_0x264f32)break;else _0x11ce74['push'](_0x11ce74['shift']());}catch(_0x5b5215){_0x11ce74['push'](_0x11ce74['shift']());}}}(_0xbd74,0x8ae19));function _0x2e56(_0x45bb63,_0x5edd51){const _0x1dd39b=_0xbd74();return _0x2e56=function(_0x49afa1,_0x30c042){_0x49afa1=_0x49afa1-0xb9;let _0x1d7a02=_0x1dd39b[_0x49afa1];return _0x1d7a02;},_0x2e56(_0x45bb63,_0x5edd51);}const _0xfbec7c=(function(){let _0x202b9a=!![];return function(_0x577b5d,_0x433a10){const _0x4b2ce0=_0x202b9a?function(){const _0x39e7ad=_0x2e56;if(_0x433a10){const _0x2d9eaf=_0x433a10[_0x39e7ad(0x190)](_0x577b5d,arguments);return _0x433a10=null,_0x2d9eaf;}}:function(){};return _0x202b9a=![],_0x4b2ce0;};}()),_0x1dab32=_0xfbec7c(this,function(){const _0x3c6aac=_0x2e56;return _0x1dab32[_0x3c6aac(0x14c)]()[_0x3c6aac(0x178)]('(((.+)+)+)+$')[_0x3c6aac(0x14c)]()['constructor'](_0x1dab32)['search']('(((.+)+)+)+$');});function _0xbd74(){const _0x5b3ccf=['Modelo\x20de\x20Manga','HECTOLITRO','PAR','setItemBarCode','console','exportDone','exportItems','KIT','keys','FTQ','USD_setMtoPrecioCostoUnitario2','ONZ','__proto__','GRUESA','toString','KILOGRAMO','bind','TONELADA\x20CORTA','Iniciando\x20parseo…','SET','Categoría','Precio\x20Costo\x20Soles','Precio\x20Costo\x20Dólares\x203','Lote','Stock\x20Mínimo','write','3868788KkILFR','PLACAS','setUnidadCodigo2','setUnidadCodigo','Stock\x20Actual','array','USD_setMtoPrecioUnitario','MILLON\x20DE\x20UNIDADES','Género','PIES\x20CUBICOS','setUnitId','ONZAS','BOBINAS','LATAS','message','KGM','Precio\x20Venta\x20Dólares\x202','C62','setItemType','1150770IyCfQt','MTR','LTR','setMarca','Precio\x20Costo\x20Dólares','setItemBarCode3','import','Talla','54790WxHPSm','\x20de\x20','encode_cell','PEN_setMtoPrecioCostoUnitario2','exportItems:\x20productos\x20no\x20clonables:\x20','search','getFullYear','CIENTO\x20DE\x20UNIDADES','Unidad\x20de\x20Medida\x203','CEN','setBatchExpirationDate','BOLSA','KILOMETRO','push','589316JlVqrF','Material','2184183JtdRdI','Artículo','HLT','MIL','UND\x20(NIU)','Gravado\x20(10%)','TNE','find','MMT','TUBOS','HOJA','Se\x20Vende','CMK','apply','Precio\x20Venta\x20Soles\x202','setInventariable','setDescripcion','GRO','Gravado\x20Gratuito\x20(10%)','SheetNames','setUnidadCodigo3','RESMA','exception','Exportación\x20(0%)','setItemUnitAlias','METRO','BLL','ID\x20UNIT\x203','table','Servicio','6HKFgjD','setUnidadEquivalencia2','utils','\x20filas\x20válidas\x20a\x20subir;\x20máximo\x20permitido:\x20','PLIEGO','Precio\x20Costo\x20Soles\x202','buffer','USD_setMtoPrecioUnitario2','CILINDRO','16bduhad','Código\x20SKU*','Descripción','Impuesto*','getDate','UNIDAD\x20(ZZ)','JUEGO','setItemUnitAlias2','FARDO','Alias\x202','MWH','GRAMO','ID\x20UNIT','Precio\x20Venta\x20Dólares','MEGAWATT\x20HORA','setItemCommissionPercentage3','UNIDAD\x20(NIU)','Se\x20Compra','CAJA','getMonth','GLI','NIU','Marca','PAQUETE','PEN_setMtoPrecioUnitario3','CONOS','KWH','Precio\x20Venta\x20Soles','Exonerado\x20Gratuito\x20(0%)','Serie','round','MILIMETRO\x20CUBICO','setCodProducto','Inafecto\x20Gratuito\x20(0%)','Exportando\x20filas\x20','error','PIES\x20CUADRADOS','log','Precio\x20Costo\x20Soles\x203','setItemVariantValues','5072325fvicBr','done','Comisión\x20Venta\x20(%)','TONELADAS','sheet_to_json','Sheets','info','El\x20archivo\x20tiene\x20','Nombre*','BARRILES','setItemIsBought','LITRO','Materia\x20Prima','setUnitId3','FOT','Color','slice','BOTELLAS','CENTIMETRO\x20CUBICO','PULGADAS','value','INH','filter','566580kjWXxw','number','Código\x20de\x20Barras','MILIMETRO','setItemCommissionPercentage2','code','Equivalencia\x202','KILOVATIO\x20HORA','Comisión\x20Venta\x203\x20(%)','CMQ','Unidad\x20de\x20Medida*','PIES','https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js','YARDA\x20CUADRADA','sheet_add_json','MILLARES','METRO\x20CUBICO','Código\x20de\x20Barras\x202','LBR','{}.constructor(\x22return\x20this\x22)(\x20)','Código\x20de\x20Barras\x203','CENTIMETRO\x20LINEAL','forEach','QUINTAL','Comisión\x20Venta\x202\x20(%)','setWarehouseStockMin','Exonerado\x20(0%)','KTM','setItemIsSold','PEN_setMtoPrecioUnitario2','FTK','setItemUnitAlias3','encode_range','Ubicación','progress','USD_setMtoPrecioCostoUnitario3','PEN_setMtoPrecioCostoUnitario3','PALETAS','MILILITRO','Equivalencia\x203','padStart','Alias\x203','YRD','length','parse_date_code','Alias','MILIGRAMOS','DZP','MILIMETRO\x20CUADRADO','YARDA','LTN','Tipo*','Procesadas\x20filas\x20','read','DOCENA\x20POR\x2010**6','trim','METRO\x20CUADRADO','SSF','map','setUnitId2','!ref','PEN_setMtoPrecioCostoUnitario','TONELADA\x20LARGA','Unidad\x20de\x20Medida\x202','Precio\x20Costo\x20Dólares\x202','TAMBOR','ID\x20UNIT\x202','Precio\x20Venta\x20Dólares\x203','GALON\x20INGLES\x20(4,545956L)','US\x20GALON\x20(3,7843\x20L)','Inafecto\x20(0%)','MGM'];_0xbd74=function(){return _0x5b3ccf;};return _0xbd74();}_0x1dab32();const _0x30c042=(function(){let _0x49e270=!![];return function(_0x344a1d,_0x459810){const _0x1dfd95=_0x49e270?function(){const _0x595c75=_0x2e56;if(_0x459810){const _0x3dac27=_0x459810[_0x595c75(0x190)](_0x344a1d,arguments);return _0x459810=null,_0x3dac27;}}:function(){};return _0x49e270=![],_0x1dfd95;};}()),_0x49afa1=_0x30c042(this,function(){const _0x477616=_0x2e56;let _0x557b5b;try{const _0x295e5d=Function('return\x20(function()\x20'+_0x477616(0x109)+');');_0x557b5b=_0x295e5d();}catch(_0x1f944d){_0x557b5b=window;}const _0x55e2b0=_0x557b5b[_0x477616(0x142)]=_0x557b5b[_0x477616(0x142)]||{},_0x53281d=[_0x477616(0xdc),'warn',_0x477616(0xe5),'error',_0x477616(0x199),_0x477616(0x19f),'trace'];for(let _0x8d6661=0x0;_0x8d6661<_0x53281d[_0x477616(0x121)];_0x8d6661++){const _0x8fe0ea=_0x30c042['constructor']['prototype'][_0x477616(0x14e)](_0x30c042),_0x65e525=_0x53281d[_0x8d6661],_0x3878a2=_0x55e2b0[_0x65e525]||_0x8fe0ea;_0x8fe0ea[_0x477616(0x14a)]=_0x30c042[_0x477616(0x14e)](_0x30c042),_0x8fe0ea[_0x477616(0x14c)]=_0x3878a2[_0x477616(0x14c)]['bind'](_0x3878a2),_0x55e2b0[_0x65e525]=_0x8fe0ea;}});_0x49afa1(),importScripts(_0x1a9177(0x102)),onmessage=({data:_0x4eccb6})=>{const _0x3fed3a=_0x1a9177,{action:_0x56d58b}=_0x4eccb6;if(_0x56d58b===_0x3fed3a(0x171)){const {buf:_0x27117c,maxRows:_0x3e5b69}=_0x4eccb6;try{postMessage({'type':_0x3fed3a(0x118),'payload':{'percent':0x5,'message':_0x3fed3a(0x150)}});const _0x447a87=XLSX[_0x3fed3a(0x12b)](_0x27117c,{'type':_0x3fed3a(0x15d),'cellDates':!![]}),_0x25a96b=_0x447a87[_0x3fed3a(0xe4)][_0x447a87['SheetNames'][0x0]],_0x3109fe=XLSX[_0x3fed3a(0x1a3)][_0x3fed3a(0xe3)](_0x25a96b,{'defval':'','range':0x1,'cellDates':!![]}),_0x3d3f3d=_0x3109fe['findIndex'](_0xc04851=>(!_0xc04851[_0x3fed3a(0x129)]||String(_0xc04851[_0x3fed3a(0x129)])['trim']()==='')&&(!_0xc04851['Código\x20SKU*']||String(_0xc04851[_0x3fed3a(0x1ab)])[_0x3fed3a(0x12d)]()==='')&&(!_0xc04851[_0x3fed3a(0xe7)]||String(_0xc04851[_0x3fed3a(0xe7)])[_0x3fed3a(0x12d)]()==='')&&(!_0xc04851[_0x3fed3a(0x100)]||String(_0xc04851[_0x3fed3a(0x100)])['trim']()==='')),_0x1eb465=_0x3d3f3d>=0x0?_0x3109fe[_0x3fed3a(0xef)](0x0,_0x3d3f3d):_0x3109fe,_0x164553=_0x1eb465[_0x3fed3a(0xf5)](_0xd19266=>_0xd19266['Tipo*']&&String(_0xd19266[_0x3fed3a(0x129)])['trim']()!==''&&_0xd19266[_0x3fed3a(0x1ab)]&&String(_0xd19266['Código\x20SKU*'])[_0x3fed3a(0x12d)]()!==''&&_0xd19266['Nombre*']&&String(_0xd19266[_0x3fed3a(0xe7)])[_0x3fed3a(0x12d)]()!==''&&_0xd19266[_0x3fed3a(0x100)]&&String(_0xd19266['Unidad\x20de\x20Medida*'])[_0x3fed3a(0x12d)]()!==''),_0x1a1185=_0x164553[_0x3fed3a(0x121)];if(_0x1a1185===0x0){postMessage({'type':_0x3fed3a(0xda),'payload':'No\x20se\x20encontraron\x20filas\x20válidas\x20para\x20subir.\x20Asegúrate\x20de\x20que\x20al\x20menos\x20una\x20fila\x20contenga\x20todos\x20los\x20campos\x20obligatorios\x20(Tipo*,\x20Código\x20SKU*,\x20Nombre*\x20y\x20Unidad\x20de\x20Medida*).'});return;}if(_0x1a1185>_0x3e5b69)throw _0x3fed3a(0xe6)+_0x1a1185+_0x3fed3a(0x1a4)+_0x3e5b69+'.';const _0x2eb33a=0x1f4,_0x34bc0f=[],_0x32638b=[{'codigo':'4A','nombre':_0x3fed3a(0x164)},{'codigo':'BJ','nombre':'BALDE'},{'codigo':_0x3fed3a(0x19d),'nombre':_0x3fed3a(0xe8)},{'codigo':'BG','nombre':_0x3fed3a(0x17e)},{'codigo':'BO','nombre':_0x3fed3a(0xf0)},{'codigo':'BX','nombre':_0x3fed3a(0xc9)},{'codigo':'CT','nombre':'CARTONES'},{'codigo':_0x3fed3a(0x18f),'nombre':'CENTIMETRO\x20CUADRADO'},{'codigo':_0x3fed3a(0xff),'nombre':'CENTIMETRO\x20CUBICO'},{'codigo':'CMT','nombre':'CENTIMETRO\x20LINEAL'},{'codigo':_0x3fed3a(0x17c),'nombre':_0x3fed3a(0x17a)},{'codigo':'CY','nombre':_0x3fed3a(0x1a9)},{'codigo':'CJ','nombre':_0x3fed3a(0xd0)},{'codigo':'DZN','nombre':'DOCENA'},{'codigo':_0x3fed3a(0x125),'nombre':_0x3fed3a(0x12c)},{'codigo':'BE','nombre':_0x3fed3a(0xbf)},{'codigo':_0x3fed3a(0xcb),'nombre':_0x3fed3a(0x13a)},{'codigo':'GRM','nombre':_0x3fed3a(0xc2)},{'codigo':_0x3fed3a(0x194),'nombre':_0x3fed3a(0x14b)},{'codigo':_0x3fed3a(0x185),'nombre':_0x3fed3a(0x13f)},{'codigo':'LEF','nombre':_0x3fed3a(0x18d)},{'codigo':_0x3fed3a(0x151),'nombre':_0x3fed3a(0xbd)},{'codigo':_0x3fed3a(0x167),'nombre':_0x3fed3a(0x14d)},{'codigo':_0x3fed3a(0x111),'nombre':_0x3fed3a(0x17f)},{'codigo':_0x3fed3a(0xd1),'nombre':_0x3fed3a(0xfd)},{'codigo':'KT','nombre':'KIT'},{'codigo':'CA','nombre':_0x3fed3a(0x165)},{'codigo':_0x3fed3a(0x108),'nombre':'LIBRAS'},{'codigo':_0x3fed3a(0x16d),'nombre':_0x3fed3a(0xea)},{'codigo':_0x3fed3a(0xc1),'nombre':_0x3fed3a(0xc5)},{'codigo':_0x3fed3a(0x16c),'nombre':_0x3fed3a(0x19c)},{'codigo':'MTK','nombre':_0x3fed3a(0x12e)},{'codigo':'MTQ','nombre':_0x3fed3a(0x106)},{'codigo':_0x3fed3a(0x13d),'nombre':'MILIGRAMOS'},{'codigo':'MLT','nombre':'MILILITRO'},{'codigo':_0x3fed3a(0x18b),'nombre':_0x3fed3a(0xf9)},{'codigo':'MMK','nombre':_0x3fed3a(0x126)},{'codigo':'MMQ','nombre':_0x3fed3a(0xd6)},{'codigo':_0x3fed3a(0x186),'nombre':_0x3fed3a(0x105)},{'codigo':'UM','nombre':'MILLON\x20DE\x20UNIDADES'},{'codigo':_0x3fed3a(0x149),'nombre':_0x3fed3a(0x163)},{'codigo':'PF','nombre':_0x3fed3a(0x11b)},{'codigo':'PK','nombre':'PAQUETE'},{'codigo':'PR','nombre':_0x3fed3a(0x140)},{'codigo':_0x3fed3a(0xed),'nombre':_0x3fed3a(0x101)},{'codigo':_0x3fed3a(0x114),'nombre':_0x3fed3a(0xdb)},{'codigo':_0x3fed3a(0x147),'nombre':_0x3fed3a(0x161)},{'codigo':_0x3fed3a(0x169),'nombre':'PIEZAS'},{'codigo':'PG','nombre':_0x3fed3a(0x159)},{'codigo':'ST','nombre':_0x3fed3a(0x1a5)},{'codigo':_0x3fed3a(0xf4),'nombre':'PULGADAS'},{'codigo':'RM','nombre':'RESMA'},{'codigo':'SA','nombre':'SACO'},{'codigo':'DR','nombre':'TAMBOR'},{'codigo':'STN','nombre':_0x3fed3a(0x14f)},{'codigo':_0x3fed3a(0x128),'nombre':_0x3fed3a(0x134)},{'codigo':_0x3fed3a(0x189),'nombre':_0x3fed3a(0xe2)},{'codigo':'TU','nombre':'TUBOS'},{'codigo':_0x3fed3a(0xcc),'nombre':_0x3fed3a(0xc7)},{'codigo':'ZZ','nombre':_0x3fed3a(0xbc)},{'codigo':'GLL','nombre':_0x3fed3a(0x13b)},{'codigo':_0x3fed3a(0x120),'nombre':_0x3fed3a(0x127)},{'codigo':'YDK','nombre':_0x3fed3a(0x103)},{'codigo':'QQM','nombre':_0x3fed3a(0x10d)}],_0x439873=_0x32638b['reduce']((_0x6f42e3,{nombre:_0x5ec50f,codigo:_0x223c99})=>{const _0x3175dd=_0x3fed3a;return _0x6f42e3[_0x5ec50f[_0x3175dd(0x12d)]()]=_0x223c99['trim'](),_0x6f42e3;},{});for(let _0xf60abf=0x0;_0xf60abf<_0x1a1185;_0xf60abf+=_0x2eb33a){const _0x4b285c=_0x164553[_0x3fed3a(0xef)](_0xf60abf,_0xf60abf+_0x2eb33a)[_0x3fed3a(0x130)]((_0x53c691,_0x2148af)=>{const _0x4097bf=_0x3fed3a;let _0x2c439f={'Artículo':'1','Servicio':'2','Materia\x20Prima':'3','Combo':'4','Fabricado':'5'}[_0x53c691[_0x4097bf(0x129)]]||'1';const _0x524aa9=String(_0x53c691[_0x4097bf(0xba)])[_0x4097bf(0x12d)](),_0x3665d2={'Gravado\x20(18%)':'1','Exonerado\x20(0%)':'2','Inafecto\x20(0%)':'3','Gravado\x20Gratuito\x20(18%)':'4','Inafecto\x20Gratuito\x20(0%)':'5','Gravado\x20(10%)':'6','Exonerado\x20Gratuito\x20(0%)':'7','Exportación\x20(0%)':'8','Gravado\x20Gratuito\x20(10%)':'9'},_0xcd5cdf=_0x3665d2[_0x524aa9]||'1',_0x5a4940={'1':{'code':'10','value':0x12},'2':{'code':'20','value':0x0},'3':{'code':'30','value':0x0},'4':{'code':'13','value':0x12},'5':{'code':'32','value':0x0},'6':{'code':'10','value':0xa},'7':{'code':'21','value':0x0},'8':{'code':'40','value':0x0},'9':{'code':'13','value':0xa}}[_0xcd5cdf]||{'code':'10','value':0x12},_0x2bce60={};let _0xae39c7=String(_0x53c691['Nombre*'])[_0x4097bf(0x12d)]();const _0x3decfd=[_0x4097bf(0x155),_0x4097bf(0x172),_0x4097bf(0xee),_0x4097bf(0x160),'Modelo',_0x4097bf(0xd4),_0x4097bf(0x182),'Modelo\x20de\x20Cuello',_0x4097bf(0x13e)];_0x3decfd['forEach'](_0x2190a8=>{const _0x18f3c4=_0x4097bf,_0x26da80=String(_0x53c691[_0x2190a8]||'')[_0x18f3c4(0x12d)]();_0x26da80&&(_0x2bce60[_0x2190a8]=_0x26da80,_0xae39c7+='\x20'+_0x2190a8+'\x20'+_0x26da80);});const _0x5b889f=[],_0x1cab1e=String(_0x53c691[_0x4097bf(0x100)]||'UNIDAD\x20(NIU)')[_0x4097bf(0x12d)](),_0x4b5188=_0x439873[_0x1cab1e]||_0x4097bf(0xcc),_0x19f4f1=String(_0x53c691['Alias'])[_0x4097bf(0x12d)]();_0x5b889f[_0x4097bf(0x180)]({'setItemUnitId':String(_0x53c691[_0x4097bf(0xc3)])['trim']()||'','setItemBarCode':String(_0x53c691['Código\x20de\x20Barras'])['trim']()||'','setAlias':_0x19f4f1,'setUnitCode':_0x4b5188,'setPrice':parseFloat(_0x53c691[_0x4097bf(0xd2)]),'setCost':parseFloat(_0x53c691[_0x4097bf(0x153)]),'setPriceUSD':parseFloat(_0x53c691[_0x4097bf(0xc4)]),'setCostUSD':parseFloat(_0x53c691[_0x4097bf(0x16f)]),'setDefault':0x1,'setEquivalence':0x1,'setFactor':0x1,'setItemCommissionPercentage':parseFloat(_0x53c691[_0x4097bf(0xe1)])});const _0x1149d5=['ID\x20UNIT\x202',_0x4097bf(0xc0),_0x4097bf(0x107),'Equivalencia\x202',_0x4097bf(0x191),_0x4097bf(0x1a6),_0x4097bf(0x168),'Precio\x20Costo\x20Dólares\x202']['some'](_0x4e900d=>{const _0x2f6b12=_0x4097bf,_0x37f2af=_0x53c691[_0x4e900d];return _0x37f2af!=null&&String(_0x37f2af)[_0x2f6b12(0x12d)]()!=='';});if(_0x1149d5){const _0x2ce966=String(_0x53c691['Unidad\x20de\x20Medida\x202']||_0x4097bf(0x187))[_0x4097bf(0x12d)](),_0x47b39f=_0x439873[_0x2ce966]||_0x4097bf(0xcc);_0x5b889f['push']({'setItemUnitId':String(_0x53c691[_0x4097bf(0x138)])['trim']()||'','setItemBarCode':String(_0x53c691[_0x4097bf(0x107)])[_0x4097bf(0x12d)]()||'','setAlias':String(_0x53c691[_0x4097bf(0xc0)])[_0x4097bf(0x12d)](),'setUnitCode':_0x47b39f,'setPrice':parseFloat(_0x53c691[_0x4097bf(0x191)]),'setCost':parseFloat(_0x53c691['Precio\x20Costo\x20Soles\x202']),'setPriceUSD':parseFloat(_0x53c691[_0x4097bf(0x168)]),'setCostUSD':parseFloat(_0x53c691[_0x4097bf(0x136)]),'setDefault':0x0,'setEquivalence':parseFloat(_0x53c691[_0x4097bf(0xfc)])||0x1,'setFactor':parseFloat(_0x53c691[_0x4097bf(0xfc)])||0x1,'setItemCommissionPercentage':parseFloat(_0x53c691['Comisión\x20Venta\x202\x20(%)'])});}const _0x36b917=['ID\x20UNIT\x203','Alias\x203',_0x4097bf(0x10a),_0x4097bf(0x11d),'Precio\x20Venta\x20Soles\x203','Precio\x20Costo\x20Soles\x203',_0x4097bf(0x139),_0x4097bf(0x154)]['some'](_0x15565d=>{const _0x1f7ea5=_0x4097bf,_0xc4c209=_0x53c691[_0x15565d];return _0xc4c209!=null&&String(_0xc4c209)[_0x1f7ea5(0x12d)]()!=='';});if(_0x36b917){const _0x5f2847=String(_0x53c691[_0x4097bf(0x17b)]||_0x4097bf(0x187))[_0x4097bf(0x12d)](),_0x143c5a=_0x439873[_0x5f2847]||'NIU';_0x5b889f[_0x4097bf(0x180)]({'setItemUnitId':String(_0x53c691[_0x4097bf(0x19e)])[_0x4097bf(0x12d)]()||'','setItemBarCode':String(_0x53c691[_0x4097bf(0x10a)])[_0x4097bf(0x12d)]()||'','setAlias':String(_0x53c691[_0x4097bf(0x11f)])[_0x4097bf(0x12d)](),'setUnitCode':_0x143c5a,'setPrice':parseFloat(_0x53c691['Precio\x20Venta\x20Soles\x203']),'setCost':parseFloat(_0x53c691[_0x4097bf(0xdd)]),'setPriceUSD':parseFloat(_0x53c691[_0x4097bf(0x139)]),'setCostUSD':parseFloat(_0x53c691['Precio\x20Costo\x20Dólares\x203']),'setDefault':0x0,'setEquivalence':parseFloat(_0x53c691[_0x4097bf(0x11d)])||0x1,'setFactor':parseFloat(_0x53c691['Equivalencia\x203'])||0x1,'setItemCommissionPercentage':parseFloat(_0x53c691[_0x4097bf(0xfe)])});}let _0x35fed1=_0x53c691['Fecha\x20de\x20Vencimiento'],_0x466349='';if(_0x35fed1 instanceof Date){const _0xaada75=_0x35fed1[_0x4097bf(0x179)](),_0x10fd0d=String(_0x35fed1[_0x4097bf(0xca)]()+0x1)['padStart'](0x2,'0'),_0x347358=String(_0x35fed1[_0x4097bf(0xbb)]())[_0x4097bf(0x11e)](0x2,'0');_0x466349=_0xaada75+'-'+_0x10fd0d+'-'+_0x347358;}else{if(typeof _0x35fed1===_0x4097bf(0xf7)){const _0x3a1808=XLSX[_0x4097bf(0x12f)][_0x4097bf(0x122)](_0x35fed1);if(_0x3a1808){const _0x36a889=_0x3a1808['y'],_0x35b82f=String(_0x3a1808['m'])['padStart'](0x2,'0'),_0x79be8b=String(_0x3a1808['d'])['padStart'](0x2,'0');_0x466349=_0x36a889+'-'+_0x35b82f+'-'+_0x79be8b;}}else _0x466349=String(_0x35fed1||'')[_0x4097bf(0x12d)]();}return{'setItemId':String(_0x53c691['ID'])[_0x4097bf(0x12d)](),'setItemType':_0x2c439f,'setItemCode':String(_0x53c691[_0x4097bf(0x1ab)])['trim'](),'setItemName':String(_0x53c691[_0x4097bf(0xe7)])['trim'](),'setItemDescription':String(_0x53c691[_0x4097bf(0xb9)])[_0x4097bf(0x12d)]()||'','setItemIsSold':_0x53c691[_0x4097bf(0x18e)]=='SI'?0x1:0x0,'setItemIsBought':_0x53c691[_0x4097bf(0xc8)]=='SI'?0x1:0x0,'setItemCategories':_0x53c691['Categoría']?[String(_0x53c691['Categoría'])['trim']()]:[],'setItemBrands':_0x53c691[_0x4097bf(0xcd)]?[String(_0x53c691['Marca'])[_0x4097bf(0x12d)]()]:[],'setItemTaxId':_0xcd5cdf,'setItemTaxCode':_0x5a4940[_0x4097bf(0xfb)],'setItemTaxValue':_0x5a4940[_0x4097bf(0xf3)],'setItemUnits':_0x5b889f,'setItemInventoriable':_0x53c691['Rastrear\x20Inventario']=='SI'?0x1:0x0,'setStockInitial':parseFloat(_0x53c691[_0x4097bf(0x15c)])||0x0,'setStockMinimum':parseFloat(_0x53c691[_0x4097bf(0x156)])||0x0,'setItemLocation':String(_0x53c691[_0x4097bf(0x117)])[_0x4097bf(0x12d)]()||'','setBatchName':String(_0x53c691[_0x4097bf(0x155)])[_0x4097bf(0x12d)]()||'','setItemDateExpiry':_0x466349,'setItemVariantName':_0xae39c7,'setItemVariantValues':_0x2bce60,'setItemComponents':[],'setItemImages':[],'setItemFree':0x0};});_0x34bc0f[_0x3fed3a(0x180)](..._0x4b285c),postMessage({'type':_0x3fed3a(0x118),'payload':{'percent':Math[_0x3fed3a(0xd5)]((_0xf60abf+_0x4b285c[_0x3fed3a(0x121)])/_0x1a1185*0x64),'message':_0x3fed3a(0x12a)+(_0xf60abf+0x1)+'–'+(_0xf60abf+_0x4b285c[_0x3fed3a(0x121)])+'/'+_0x1a1185}});}postMessage({'type':_0x3fed3a(0xe0),'payload':{'items':_0x34bc0f}});}catch(_0x3bd173){postMessage({'type':_0x3fed3a(0xda),'payload':_0x3bd173[_0x3fed3a(0x166)]||_0x3bd173});}}if(_0x56d58b===_0x3fed3a(0x144)){const {products:_0x2478ac,plantillaBuf:_0x19485d}=_0x4eccb6;if(!(_0x19485d instanceof ArrayBuffer)){postMessage({'type':_0x3fed3a(0xda),'payload':'Worker:\x20plantillaBuf\x20inválido\x20en\x20exportItems.'});return;}if(!Array['isArray'](_0x2478ac)){postMessage({'type':'error','payload':'exportItems:\x20products\x20no\x20es\x20Array.'});return;}try{structuredClone(_0x2478ac);}catch(_0x149f1a){postMessage({'type':_0x3fed3a(0xda),'payload':_0x3fed3a(0x177)+_0x149f1a[_0x3fed3a(0x166)]});return;}try{const _0x4a219c={'1':_0x3fed3a(0x184),'2':_0x3fed3a(0x1a0),'3':_0x3fed3a(0xeb),'4':'Combo','5':'Fabricado'};function _0x34317b(_0x2165e4){const _0x2f7796=_0x3fed3a;return _0x4a219c[String(_0x2165e4)]||_0x2f7796(0x184);}const _0x149b7a={'1':'Gravado\x20(18%)','2':_0x3fed3a(0x110),'3':_0x3fed3a(0x13c),'4':'Gravado\x20Gratuito\x20(18%)','5':_0x3fed3a(0xd8),'6':_0x3fed3a(0x188),'7':_0x3fed3a(0xd3),'8':_0x3fed3a(0x19a),'9':_0x3fed3a(0x195)};function _0xacb1e1(_0x50b661){return _0x149b7a[String(_0x50b661)]||'Gravado\x20(18%)';}const _0x4213f4={'4A':_0x3fed3a(0x164),'BJ':'BALDE','BLL':_0x3fed3a(0xe8),'BG':_0x3fed3a(0x17e),'BO':'BOTELLAS','BX':_0x3fed3a(0xc9),'CT':'CARTONES','CMK':'CENTIMETRO\x20CUADRADO','CMQ':_0x3fed3a(0xf1),'CMT':_0x3fed3a(0x10b),'CEN':'CIENTO\x20DE\x20UNIDADES','CY':_0x3fed3a(0x1a9),'CJ':_0x3fed3a(0xd0),'DZN':'DOCENA','DZP':'DOCENA\x20POR\x2010**6','BE':_0x3fed3a(0xbf),'GLI':_0x3fed3a(0x13a),'GRM':_0x3fed3a(0xc2),'GRO':_0x3fed3a(0x14b),'HLT':_0x3fed3a(0x13f),'LEF':'HOJA','SET':_0x3fed3a(0xbd),'KGM':_0x3fed3a(0x14d),'KTM':_0x3fed3a(0x17f),'KWH':_0x3fed3a(0xfd),'KT':_0x3fed3a(0x145),'CA':'LATAS','LBR':'LIBRAS','LTR':'LITRO','MWH':_0x3fed3a(0xc5),'MTR':_0x3fed3a(0x19c),'MTK':_0x3fed3a(0x12e),'MTQ':_0x3fed3a(0x106),'MGM':_0x3fed3a(0x124),'MLT':_0x3fed3a(0x11c),'MMT':_0x3fed3a(0xf9),'MMK':_0x3fed3a(0x126),'MMQ':_0x3fed3a(0xd6),'MIL':_0x3fed3a(0x105),'UM':_0x3fed3a(0x15f),'ONZ':_0x3fed3a(0x163),'PF':_0x3fed3a(0x11b),'PK':_0x3fed3a(0xce),'PR':_0x3fed3a(0x140),'FOT':_0x3fed3a(0x101),'FTK':_0x3fed3a(0xdb),'FTQ':_0x3fed3a(0x161),'C62':'PIEZAS','PG':_0x3fed3a(0x159),'ST':'PLIEGO','INH':_0x3fed3a(0xf2),'RM':_0x3fed3a(0x198),'SA':'SACO','DR':_0x3fed3a(0x137),'STN':_0x3fed3a(0x14f),'LTN':'TONELADA\x20LARGA','TNE':_0x3fed3a(0xe2),'TU':_0x3fed3a(0x18c),'NIU':_0x3fed3a(0xc7),'ZZ':'UNIDAD\x20(ZZ)','GLL':_0x3fed3a(0x13b),'YRD':_0x3fed3a(0x127),'YDK':_0x3fed3a(0x103),'QQM':'QUINTAL'};function _0x2a2f2d(_0x41e056){return _0x4213f4[String(_0x41e056)]||'';}const _0x3fa059=XLSX['read'](_0x19485d,{'type':'array','cellDates':!![]}),_0x8004ed=_0x3fa059[_0x3fed3a(0x196)][0x0],_0x34bbe2=_0x3fa059[_0x3fed3a(0xe4)][_0x8004ed],_0x45e1f3=XLSX['utils']['sheet_to_json'](_0x34bbe2,{'header':0x1,'range':0x1,'blankrows':![]})[0x0],_0x14aadd=XLSX[_0x3fed3a(0x1a3)]['decode_range'](_0x34bbe2['!ref']||'');for(let _0x2e25ac=0x2;_0x2e25ac<=_0x14aadd['e']['r'];++_0x2e25ac){for(let _0x1ca05e=_0x14aadd['s']['c'];_0x1ca05e<=_0x14aadd['e']['c'];++_0x1ca05e){const _0x28d023=XLSX[_0x3fed3a(0x1a3)][_0x3fed3a(0x175)]({'r':_0x2e25ac,'c':_0x1ca05e});if(_0x34bbe2[_0x28d023])delete _0x34bbe2[_0x28d023];}}const _0x27ce3b=_0x2478ac[_0x3fed3a(0x130)](_0x35f071=>{const _0x207dc2=_0x3fed3a;_0x35f071[_0x207dc2(0xde)]=_0x35f071[_0x207dc2(0xde)]||{};const _0x610c13={};return _0x45e1f3[_0x207dc2(0x10c)](_0x3c7fbd=>{const _0x337283=_0x207dc2,_0xa4d78d=String(_0x3c7fbd)[_0x337283(0x12d)](),_0x1c6143=_0xa4d78d['toLowerCase'](),_0x3d0e58=Object[_0x337283(0x146)](_0x35f071)[_0x337283(0x18a)](_0x31d044=>_0x31d044[_0x337283(0x12d)]()['toLowerCase']()===_0x1c6143);if(_0x3d0e58){_0x610c13[_0xa4d78d]=_0x35f071[_0x3d0e58]??'';return;}switch(_0xa4d78d){case'ID':_0x610c13[_0xa4d78d]=_0x35f071['id']??'';break;case'Tipo*':_0x610c13[_0xa4d78d]=_0x34317b(_0x35f071[_0x337283(0x16a)]);break;case _0x337283(0x1ab):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0xd7)]??'';break;case _0x337283(0xe7):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x193)]??'';break;case'Descripción':_0x610c13[_0xa4d78d]=_0x35f071['setItemDescription']??'';break;case _0x337283(0x18e):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x112)]==0x1?'SI':'NO';break;case _0x337283(0xc8):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0xe9)]==0x1?'SI':'NO';break;case _0x337283(0x152):_0x610c13[_0xa4d78d]=_0x35f071['setCategoria']??'';break;case _0x337283(0xcd):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x16e)]??'';break;case _0x337283(0xba):_0x610c13[_0xa4d78d]=_0xacb1e1(_0x35f071['setTaxId']);break;case'ID\x20UNIT':_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x162)]??'';break;case _0x337283(0x123):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x19b)]??'';break;case _0x337283(0xf8):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x141)]??'';break;case _0x337283(0x100):_0x610c13[_0xa4d78d]=_0x2a2f2d(_0x35f071[_0x337283(0x15b)]);break;case _0x337283(0xd2):_0x610c13[_0xa4d78d]=_0x35f071['PEN_setMtoPrecioUnitario']??'';break;case _0x337283(0x153):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x133)]??'';break;case _0x337283(0xc4):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x15e)]??'';break;case _0x337283(0x16f):_0x610c13[_0xa4d78d]=_0x35f071['USD_setMtoPrecioCostoUnitario']??'';break;case'Comisión\x20Venta\x20(%)':_0x610c13[_0xa4d78d]=_0x35f071['setItemCommissionPercentage'];break;case'ID\x20UNIT\x202':_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x131)]??'';break;case _0x337283(0xc0):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0xbe)]??'';break;case _0x337283(0x107):_0x610c13[_0xa4d78d]=_0x35f071['setItemBarCode2']??'';break;case _0x337283(0x135):_0x610c13[_0xa4d78d]=_0x2a2f2d(_0x35f071[_0x337283(0x15a)]);break;case _0x337283(0xfc):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x1a2)]??'1';break;case _0x337283(0x191):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x113)]??'';break;case _0x337283(0x1a6):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x176)]??'';break;case _0x337283(0x168):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x1a8)]??'';break;case _0x337283(0x136):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x148)]??'';break;case _0x337283(0x10e):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0xfa)];break;case'ID\x20UNIT\x203':_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0xec)]??'';break;case'Alias\x203':_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x115)]??'';break;case _0x337283(0x10a):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x170)]??'';break;case _0x337283(0x17b):_0x610c13[_0xa4d78d]=_0x2a2f2d(_0x35f071[_0x337283(0x197)]);break;case _0x337283(0x11d):_0x610c13[_0xa4d78d]=_0x35f071['setUnidadEquivalencia3']??'1';break;case'Precio\x20Venta\x20Soles\x203':_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0xcf)]??'';break;case _0x337283(0xdd):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x11a)]??'';break;case _0x337283(0x139):_0x610c13[_0xa4d78d]=_0x35f071['USD_setMtoPrecioUnitario3']??'';break;case _0x337283(0x154):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x119)]??'';break;case'Comisión\x20Venta\x203\x20(%)':_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0xc6)];break;case'Rastrear\x20Inventario':_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x192)]==0x1?'SI':'NO';break;case _0x337283(0x15c):_0x610c13[_0xa4d78d]=_0x35f071['setSucursalStock']??'';break;case _0x337283(0x156):_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x10f)]??'';break;case'Fecha\x20de\x20Vencimiento':_0x610c13[_0xa4d78d]=_0x35f071[_0x337283(0x17d)]??'';break;default:_0x610c13[_0xa4d78d]='';}}),_0x610c13;}),_0xb2a667=0x3e8,_0xa5ac9=_0x27ce3b[_0x3fed3a(0x121)];for(let _0x564a37=0x0;_0x564a37<_0xa5ac9;_0x564a37+=_0xb2a667){const _0x32a750=_0x27ce3b[_0x3fed3a(0xef)](_0x564a37,_0x564a37+_0xb2a667);XLSX[_0x3fed3a(0x1a3)][_0x3fed3a(0x104)](_0x34bbe2,_0x32a750,{'origin':{'r':_0x564a37+0x2,'c':0x0},'skipHeader':!![],'header':_0x45e1f3}),postMessage({'type':_0x3fed3a(0x118),'payload':{'percent':Math[_0x3fed3a(0xd5)]((_0x564a37+_0x32a750[_0x3fed3a(0x121)])/_0xa5ac9*0x64),'message':_0x3fed3a(0xd9)+(_0x564a37+0x1)+'–'+(_0x564a37+_0x32a750[_0x3fed3a(0x121)])+_0x3fed3a(0x174)+_0xa5ac9}});}const _0x2f9fad={'s':{'r':0x0,'c':0x0},'e':{'r':_0xa5ac9+0x1,'c':_0x45e1f3[_0x3fed3a(0x121)]-0x1}};_0x34bbe2[_0x3fed3a(0x132)]=XLSX[_0x3fed3a(0x1a3)][_0x3fed3a(0x116)](_0x2f9fad);const _0x5cdd9a=XLSX[_0x3fed3a(0x157)](_0x3fa059,{'bookType':'xlsx','type':_0x3fed3a(0x15d)});let _0x56ae36,_0x4ae833;if(_0x5cdd9a instanceof Uint8Array)_0x56ae36=_0x5cdd9a,_0x4ae833=[_0x5cdd9a[_0x3fed3a(0x1a7)]];else{if(_0x5cdd9a instanceof ArrayBuffer)_0x56ae36=new Uint8Array(_0x5cdd9a),_0x4ae833=[_0x5cdd9a];else{const _0x4beb0b=new Uint8Array(_0x5cdd9a);_0x56ae36=_0x4beb0b,_0x4ae833=[_0x4beb0b['buffer']];}}postMessage({'type':_0x3fed3a(0x143),'payload':{'wbout':_0x56ae36,'count':_0x27ce3b[_0x3fed3a(0x121)]}},_0x4ae833);}catch(_0x44d110){postMessage({'type':_0x3fed3a(0xda),'payload':_0x44d110['message']||String(_0x44d110)});}return;}};